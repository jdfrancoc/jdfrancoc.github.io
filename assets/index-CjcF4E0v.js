(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function b4(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fd={exports:{}},_a={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s0;function Z9(){if(s0)return _a;s0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(i,s,o){var l=null;if(o!==void 0&&(l=""+o),s.key!==void 0&&(l=""+s.key),"key"in s){o={};for(var c in s)c!=="key"&&(o[c]=s[c])}else o=s;return s=o.ref,{$$typeof:n,type:i,key:l,ref:s!==void 0?s:null,props:o}}return _a.Fragment=e,_a.jsx=t,_a.jsxs=t,_a}var r0;function K9(){return r0||(r0=1,fd.exports=Z9()),fd.exports}var P=K9(),hd={exports:{}},Pe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var o0;function G9(){if(o0)return Pe;o0=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),_=Symbol.iterator;function y(A){return A===null||typeof A!="object"?null:(A=_&&A[_]||A["@@iterator"],typeof A=="function"?A:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,S={};function M(A,F,X){this.props=A,this.context=F,this.refs=S,this.updater=X||v}M.prototype.isReactComponent={},M.prototype.setState=function(A,F){if(typeof A!="object"&&typeof A!="function"&&A!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,A,F,"setState")},M.prototype.forceUpdate=function(A){this.updater.enqueueForceUpdate(this,A,"forceUpdate")};function C(){}C.prototype=M.prototype;function U(A,F,X){this.props=A,this.context=F,this.refs=S,this.updater=X||v}var R=U.prototype=new C;R.constructor=U,x(R,M.prototype),R.isPureReactComponent=!0;var D=Array.isArray,B={H:null,A:null,T:null,S:null,V:null},Q=Object.prototype.hasOwnProperty;function ce(A,F,X,G,ae,fe){return X=fe.ref,{$$typeof:n,type:A,key:F,ref:X!==void 0?X:null,props:fe}}function Z(A,F){return ce(A.type,F,void 0,void 0,void 0,A.props)}function ee(A){return typeof A=="object"&&A!==null&&A.$$typeof===n}function he(A){var F={"=":"=0",":":"=2"};return"$"+A.replace(/[=:]/g,function(X){return F[X]})}var de=/\/+/g;function _e(A,F){return typeof A=="object"&&A!==null&&A.key!=null?he(""+A.key):F.toString(36)}function ge(){}function ue(A){switch(A.status){case"fulfilled":return A.value;case"rejected":throw A.reason;default:switch(typeof A.status=="string"?A.then(ge,ge):(A.status="pending",A.then(function(F){A.status==="pending"&&(A.status="fulfilled",A.value=F)},function(F){A.status==="pending"&&(A.status="rejected",A.reason=F)})),A.status){case"fulfilled":return A.value;case"rejected":throw A.reason}}throw A}function Se(A,F,X,G,ae){var fe=typeof A;(fe==="undefined"||fe==="boolean")&&(A=null);var me=!1;if(A===null)me=!0;else switch(fe){case"bigint":case"string":case"number":me=!0;break;case"object":switch(A.$$typeof){case n:case e:me=!0;break;case p:return me=A._init,Se(me(A._payload),F,X,G,ae)}}if(me)return ae=ae(A),me=G===""?"."+_e(A,0):G,D(ae)?(X="",me!=null&&(X=me.replace(de,"$&/")+"/"),Se(ae,F,X,"",function(We){return We})):ae!=null&&(ee(ae)&&(ae=Z(ae,X+(ae.key==null||A&&A.key===ae.key?"":(""+ae.key).replace(de,"$&/")+"/")+me)),F.push(ae)),1;me=0;var xe=G===""?".":G+":";if(D(A))for(var Te=0;Te<A.length;Te++)G=A[Te],fe=xe+_e(G,Te),me+=Se(G,F,X,fe,ae);else if(Te=y(A),typeof Te=="function")for(A=Te.call(A),Te=0;!(G=A.next()).done;)G=G.value,fe=xe+_e(G,Te++),me+=Se(G,F,X,fe,ae);else if(fe==="object"){if(typeof A.then=="function")return Se(ue(A),F,X,G,ae);throw F=String(A),Error("Objects are not valid as a React child (found: "+(F==="[object Object]"?"object with keys {"+Object.keys(A).join(", ")+"}":F)+"). If you meant to render a collection of children, use an array instead.")}return me}function w(A,F,X){if(A==null)return A;var G=[],ae=0;return Se(A,G,"","",function(fe){return F.call(X,fe,ae++)}),G}function N(A){if(A._status===-1){var F=A._result;F=F(),F.then(function(X){(A._status===0||A._status===-1)&&(A._status=1,A._result=X)},function(X){(A._status===0||A._status===-1)&&(A._status=2,A._result=X)}),A._status===-1&&(A._status=0,A._result=F)}if(A._status===1)return A._result.default;throw A._result}var O=typeof reportError=="function"?reportError:function(A){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var F=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof A=="object"&&A!==null&&typeof A.message=="string"?String(A.message):String(A),error:A});if(!window.dispatchEvent(F))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",A);return}console.error(A)};function ne(){}return Pe.Children={map:w,forEach:function(A,F,X){w(A,function(){F.apply(this,arguments)},X)},count:function(A){var F=0;return w(A,function(){F++}),F},toArray:function(A){return w(A,function(F){return F})||[]},only:function(A){if(!ee(A))throw Error("React.Children.only expected to receive a single React element child.");return A}},Pe.Component=M,Pe.Fragment=t,Pe.Profiler=s,Pe.PureComponent=U,Pe.StrictMode=i,Pe.Suspense=f,Pe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=B,Pe.__COMPILER_RUNTIME={__proto__:null,c:function(A){return B.H.useMemoCache(A)}},Pe.cache=function(A){return function(){return A.apply(null,arguments)}},Pe.cloneElement=function(A,F,X){if(A==null)throw Error("The argument must be a React element, but you passed "+A+".");var G=x({},A.props),ae=A.key,fe=void 0;if(F!=null)for(me in F.ref!==void 0&&(fe=void 0),F.key!==void 0&&(ae=""+F.key),F)!Q.call(F,me)||me==="key"||me==="__self"||me==="__source"||me==="ref"&&F.ref===void 0||(G[me]=F[me]);var me=arguments.length-2;if(me===1)G.children=X;else if(1<me){for(var xe=Array(me),Te=0;Te<me;Te++)xe[Te]=arguments[Te+2];G.children=xe}return ce(A.type,ae,void 0,void 0,fe,G)},Pe.createContext=function(A){return A={$$typeof:l,_currentValue:A,_currentValue2:A,_threadCount:0,Provider:null,Consumer:null},A.Provider=A,A.Consumer={$$typeof:o,_context:A},A},Pe.createElement=function(A,F,X){var G,ae={},fe=null;if(F!=null)for(G in F.key!==void 0&&(fe=""+F.key),F)Q.call(F,G)&&G!=="key"&&G!=="__self"&&G!=="__source"&&(ae[G]=F[G]);var me=arguments.length-2;if(me===1)ae.children=X;else if(1<me){for(var xe=Array(me),Te=0;Te<me;Te++)xe[Te]=arguments[Te+2];ae.children=xe}if(A&&A.defaultProps)for(G in me=A.defaultProps,me)ae[G]===void 0&&(ae[G]=me[G]);return ce(A,fe,void 0,void 0,null,ae)},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(A){return{$$typeof:c,render:A}},Pe.isValidElement=ee,Pe.lazy=function(A){return{$$typeof:p,_payload:{_status:-1,_result:A},_init:N}},Pe.memo=function(A,F){return{$$typeof:d,type:A,compare:F===void 0?null:F}},Pe.startTransition=function(A){var F=B.T,X={};B.T=X;try{var G=A(),ae=B.S;ae!==null&&ae(X,G),typeof G=="object"&&G!==null&&typeof G.then=="function"&&G.then(ne,O)}catch(fe){O(fe)}finally{B.T=F}},Pe.unstable_useCacheRefresh=function(){return B.H.useCacheRefresh()},Pe.use=function(A){return B.H.use(A)},Pe.useActionState=function(A,F,X){return B.H.useActionState(A,F,X)},Pe.useCallback=function(A,F){return B.H.useCallback(A,F)},Pe.useContext=function(A){return B.H.useContext(A)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(A,F){return B.H.useDeferredValue(A,F)},Pe.useEffect=function(A,F,X){var G=B.H;if(typeof X=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return G.useEffect(A,F)},Pe.useId=function(){return B.H.useId()},Pe.useImperativeHandle=function(A,F,X){return B.H.useImperativeHandle(A,F,X)},Pe.useInsertionEffect=function(A,F){return B.H.useInsertionEffect(A,F)},Pe.useLayoutEffect=function(A,F){return B.H.useLayoutEffect(A,F)},Pe.useMemo=function(A,F){return B.H.useMemo(A,F)},Pe.useOptimistic=function(A,F){return B.H.useOptimistic(A,F)},Pe.useReducer=function(A,F,X){return B.H.useReducer(A,F,X)},Pe.useRef=function(A){return B.H.useRef(A)},Pe.useState=function(A){return B.H.useState(A)},Pe.useSyncExternalStore=function(A,F,X){return B.H.useSyncExternalStore(A,F,X)},Pe.useTransition=function(){return B.H.useTransition()},Pe.version="19.1.0",Pe}var a0;function ng(){return a0||(a0=1,hd.exports=G9()),hd.exports}var L=ng();const fp=b4(L);var dd={exports:{}},ya={},pd={exports:{}},gd={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l0;function Q9(){return l0||(l0=1,function(n){function e(w,N){var O=w.length;w.push(N);e:for(;0<O;){var ne=O-1>>>1,A=w[ne];if(0<s(A,N))w[ne]=N,w[O]=A,O=ne;else break e}}function t(w){return w.length===0?null:w[0]}function i(w){if(w.length===0)return null;var N=w[0],O=w.pop();if(O!==N){w[0]=O;e:for(var ne=0,A=w.length,F=A>>>1;ne<F;){var X=2*(ne+1)-1,G=w[X],ae=X+1,fe=w[ae];if(0>s(G,O))ae<A&&0>s(fe,G)?(w[ne]=fe,w[ae]=O,ne=ae):(w[ne]=G,w[X]=O,ne=X);else if(ae<A&&0>s(fe,O))w[ne]=fe,w[ae]=O,ne=ae;else break e}}return N}function s(w,N){var O=w.sortIndex-N.sortIndex;return O!==0?O:w.id-N.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var f=[],d=[],p=1,_=null,y=3,v=!1,x=!1,S=!1,M=!1,C=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function D(w){for(var N=t(d);N!==null;){if(N.callback===null)i(d);else if(N.startTime<=w)i(d),N.sortIndex=N.expirationTime,e(f,N);else break;N=t(d)}}function B(w){if(S=!1,D(w),!x)if(t(f)!==null)x=!0,Q||(Q=!0,_e());else{var N=t(d);N!==null&&Se(B,N.startTime-w)}}var Q=!1,ce=-1,Z=5,ee=-1;function he(){return M?!0:!(n.unstable_now()-ee<Z)}function de(){if(M=!1,Q){var w=n.unstable_now();ee=w;var N=!0;try{e:{x=!1,S&&(S=!1,U(ce),ce=-1),v=!0;var O=y;try{t:{for(D(w),_=t(f);_!==null&&!(_.expirationTime>w&&he());){var ne=_.callback;if(typeof ne=="function"){_.callback=null,y=_.priorityLevel;var A=ne(_.expirationTime<=w);if(w=n.unstable_now(),typeof A=="function"){_.callback=A,D(w),N=!0;break t}_===t(f)&&i(f),D(w)}else i(f);_=t(f)}if(_!==null)N=!0;else{var F=t(d);F!==null&&Se(B,F.startTime-w),N=!1}}break e}finally{_=null,y=O,v=!1}N=void 0}}finally{N?_e():Q=!1}}}var _e;if(typeof R=="function")_e=function(){R(de)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,ue=ge.port2;ge.port1.onmessage=de,_e=function(){ue.postMessage(null)}}else _e=function(){C(de,0)};function Se(w,N){ce=C(function(){w(n.unstable_now())},N)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(w){w.callback=null},n.unstable_forceFrameRate=function(w){0>w||125<w?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<w?Math.floor(1e3/w):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function(w){switch(y){case 1:case 2:case 3:var N=3;break;default:N=y}var O=y;y=N;try{return w()}finally{y=O}},n.unstable_requestPaint=function(){M=!0},n.unstable_runWithPriority=function(w,N){switch(w){case 1:case 2:case 3:case 4:case 5:break;default:w=3}var O=y;y=w;try{return N()}finally{y=O}},n.unstable_scheduleCallback=function(w,N,O){var ne=n.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?ne+O:ne):O=ne,w){case 1:var A=-1;break;case 2:A=250;break;case 5:A=1073741823;break;case 4:A=1e4;break;default:A=5e3}return A=O+A,w={id:p++,callback:N,priorityLevel:w,startTime:O,expirationTime:A,sortIndex:-1},O>ne?(w.sortIndex=O,e(d,w),t(f)===null&&w===t(d)&&(S?(U(ce),ce=-1):S=!0,Se(B,O-ne))):(w.sortIndex=A,e(f,w),x||v||(x=!0,Q||(Q=!0,_e()))),w},n.unstable_shouldYield=he,n.unstable_wrapCallback=function(w){var N=y;return function(){var O=y;y=N;try{return w.apply(this,arguments)}finally{y=O}}}}(gd)),gd}var c0;function J9(){return c0||(c0=1,pd.exports=Q9()),pd.exports}var md={exports:{}},Dt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u0;function ex(){if(u0)return Dt;u0=1;var n=ng();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var i={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function o(f,d,p){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:_==null?null:""+_,children:f,containerInfo:d,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Dt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Dt.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(f,d,null,p)},Dt.flushSync=function(f){var d=l.T,p=i.p;try{if(l.T=null,i.p=2,f)return f()}finally{l.T=d,i.p=p,i.d.f()}},Dt.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(f,d))},Dt.prefetchDNS=function(f){typeof f=="string"&&i.d.D(f)},Dt.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,_=c(p,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,v=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?i.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:y,fetchPriority:v}):p==="script"&&i.d.X(f,{crossOrigin:_,integrity:y,fetchPriority:v,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Dt.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);i.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(f)},Dt.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,_=c(p,d.crossOrigin);i.d.L(f,p,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Dt.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=c(d.as,d.crossOrigin);i.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(f)},Dt.requestFormReset=function(f){i.d.r(f)},Dt.unstable_batchedUpdates=function(f,d){return f(d)},Dt.useFormState=function(f,d,p){return l.H.useFormState(f,d,p)},Dt.useFormStatus=function(){return l.H.useHostTransitionStatus()},Dt.version="19.1.0",Dt}var f0;function v4(){if(f0)return md.exports;f0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),md.exports=ex(),md.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h0;function tx(){if(h0)return ya;h0=1;var n=J9(),e=ng(),t=v4();function i(r){var a="https://react.dev/errors/"+r;if(1<arguments.length){a+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)a+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function o(r){var a=r,u=r;if(r.alternate)for(;a.return;)a=a.return;else{r=a;do a=r,(a.flags&4098)!==0&&(u=a.return),r=a.return;while(r)}return a.tag===3?u:null}function l(r){if(r.tag===13){var a=r.memoizedState;if(a===null&&(r=r.alternate,r!==null&&(a=r.memoizedState)),a!==null)return a.dehydrated}return null}function c(r){if(o(r)!==r)throw Error(i(188))}function f(r){var a=r.alternate;if(!a){if(a=o(r),a===null)throw Error(i(188));return a!==r?null:r}for(var u=r,h=a;;){var g=u.return;if(g===null)break;var m=g.alternate;if(m===null){if(h=g.return,h!==null){u=h;continue}break}if(g.child===m.child){for(m=g.child;m;){if(m===u)return c(g),r;if(m===h)return c(g),a;m=m.sibling}throw Error(i(188))}if(u.return!==h.return)u=g,h=m;else{for(var b=!1,T=g.child;T;){if(T===u){b=!0,u=g,h=m;break}if(T===h){b=!0,h=g,u=m;break}T=T.sibling}if(!b){for(T=m.child;T;){if(T===u){b=!0,u=m,h=g;break}if(T===h){b=!0,h=m,u=g;break}T=T.sibling}if(!b)throw Error(i(189))}}if(u.alternate!==h)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?r:a}function d(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r;for(r=r.child;r!==null;){if(a=d(r),a!==null)return a;r=r.sibling}return null}var p=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),U=Symbol.for("react.consumer"),R=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),Q=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),ee=Symbol.for("react.activity"),he=Symbol.for("react.memo_cache_sentinel"),de=Symbol.iterator;function _e(r){return r===null||typeof r!="object"?null:(r=de&&r[de]||r["@@iterator"],typeof r=="function"?r:null)}var ge=Symbol.for("react.client.reference");function ue(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===ge?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case x:return"Fragment";case M:return"Profiler";case S:return"StrictMode";case B:return"Suspense";case Q:return"SuspenseList";case ee:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case v:return"Portal";case R:return(r.displayName||"Context")+".Provider";case U:return(r._context.displayName||"Context")+".Consumer";case D:var a=r.render;return r=r.displayName,r||(r=a.displayName||a.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case ce:return a=r.displayName||null,a!==null?a:ue(r.type)||"Memo";case Z:a=r._payload,r=r._init;try{return ue(r(a))}catch{}}return null}var Se=Array.isArray,w=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,N=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,O={pending:!1,data:null,method:null,action:null},ne=[],A=-1;function F(r){return{current:r}}function X(r){0>A||(r.current=ne[A],ne[A]=null,A--)}function G(r,a){A++,ne[A]=r.current,r.current=a}var ae=F(null),fe=F(null),me=F(null),xe=F(null);function Te(r,a){switch(G(me,a),G(fe,r),G(ae,null),a.nodeType){case 9:case 11:r=(r=a.documentElement)&&(r=r.namespaceURI)?Im(r):0;break;default:if(r=a.tagName,a=a.namespaceURI)a=Im(a),r=Nm(a,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}X(ae),G(ae,r)}function We(){X(ae),X(fe),X(me)}function Be(r){r.memoizedState!==null&&G(xe,r);var a=ae.current,u=Nm(a,r.type);a!==u&&(G(fe,r),G(ae,u))}function Ht(r){fe.current===r&&(X(ae),X(fe)),xe.current===r&&(X(xe),ha._currentValue=O)}var $t=Object.prototype.hasOwnProperty,qs=n.unstable_scheduleCallback,Zs=n.unstable_cancelCallback,ze=n.unstable_shouldYield,je=n.unstable_requestPaint,Bn=n.unstable_now,Mv=n.unstable_getCurrentPriorityLevel,h2=n.unstable_ImmediatePriority,d2=n.unstable_UserBlockingPriority,ul=n.unstable_NormalPriority,Pv=n.unstable_LowPriority,p2=n.unstable_IdlePriority,Ov=n.log,Iv=n.unstable_setDisableYieldValue,vo=null,Gt=null;function Si(r){if(typeof Ov=="function"&&Iv(r),Gt&&typeof Gt.setStrictMode=="function")try{Gt.setStrictMode(vo,r)}catch{}}var Qt=Math.clz32?Math.clz32:Dv,Nv=Math.log,kv=Math.LN2;function Dv(r){return r>>>=0,r===0?32:31-(Nv(r)/kv|0)|0}var fl=256,hl=4194304;function ls(r){var a=r&42;if(a!==0)return a;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function dl(r,a,u){var h=r.pendingLanes;if(h===0)return 0;var g=0,m=r.suspendedLanes,b=r.pingedLanes;r=r.warmLanes;var T=h&134217727;return T!==0?(h=T&~m,h!==0?g=ls(h):(b&=T,b!==0?g=ls(b):u||(u=T&~r,u!==0&&(g=ls(u))))):(T=h&~m,T!==0?g=ls(T):b!==0?g=ls(b):u||(u=h&~r,u!==0&&(g=ls(u)))),g===0?0:a!==0&&a!==g&&(a&m)===0&&(m=g&-g,u=a&-a,m>=u||m===32&&(u&4194048)!==0)?a:g}function xo(r,a){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&a)===0}function Lv(r,a){switch(r){case 1:case 2:case 4:case 8:case 64:return a+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function g2(){var r=fl;return fl<<=1,(fl&4194048)===0&&(fl=256),r}function m2(){var r=hl;return hl<<=1,(hl&62914560)===0&&(hl=4194304),r}function Ju(r){for(var a=[],u=0;31>u;u++)a.push(r);return a}function To(r,a){r.pendingLanes|=a,a!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function Bv(r,a,u,h,g,m){var b=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var T=r.entanglements,k=r.expirationTimes,K=r.hiddenUpdates;for(u=b&~u;0<u;){var ie=31-Qt(u),oe=1<<ie;T[ie]=0,k[ie]=-1;var J=K[ie];if(J!==null)for(K[ie]=null,ie=0;ie<J.length;ie++){var te=J[ie];te!==null&&(te.lane&=-536870913)}u&=~oe}h!==0&&_2(r,h,0),m!==0&&g===0&&r.tag!==0&&(r.suspendedLanes|=m&~(b&~a))}function _2(r,a,u){r.pendingLanes|=a,r.suspendedLanes&=~a;var h=31-Qt(a);r.entangledLanes|=a,r.entanglements[h]=r.entanglements[h]|1073741824|u&4194090}function y2(r,a){var u=r.entangledLanes|=a;for(r=r.entanglements;u;){var h=31-Qt(u),g=1<<h;g&a|r[h]&a&&(r[h]|=a),u&=~g}}function ef(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function tf(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function b2(){var r=N.p;return r!==0?r:(r=window.event,r===void 0?32:Qm(r.type))}function Uv(r,a){var u=N.p;try{return N.p=r,a()}finally{N.p=u}}var Ai=Math.random().toString(36).slice(2),Nt="__reactFiber$"+Ai,Wt="__reactProps$"+Ai,Ks="__reactContainer$"+Ai,nf="__reactEvents$"+Ai,Fv="__reactListeners$"+Ai,zv="__reactHandles$"+Ai,v2="__reactResources$"+Ai,wo="__reactMarker$"+Ai;function sf(r){delete r[Nt],delete r[Wt],delete r[nf],delete r[Fv],delete r[zv]}function Gs(r){var a=r[Nt];if(a)return a;for(var u=r.parentNode;u;){if(a=u[Ks]||u[Nt]){if(u=a.alternate,a.child!==null||u!==null&&u.child!==null)for(r=Bm(r);r!==null;){if(u=r[Nt])return u;r=Bm(r)}return a}r=u,u=r.parentNode}return null}function Qs(r){if(r=r[Nt]||r[Ks]){var a=r.tag;if(a===5||a===6||a===13||a===26||a===27||a===3)return r}return null}function So(r){var a=r.tag;if(a===5||a===26||a===27||a===6)return r.stateNode;throw Error(i(33))}function Js(r){var a=r[v2];return a||(a=r[v2]={hoistableStyles:new Map,hoistableScripts:new Map}),a}function St(r){r[wo]=!0}var x2=new Set,T2={};function cs(r,a){er(r,a),er(r+"Capture",a)}function er(r,a){for(T2[r]=a,r=0;r<a.length;r++)x2.add(a[r])}var jv=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),w2={},S2={};function Vv(r){return $t.call(S2,r)?!0:$t.call(w2,r)?!1:jv.test(r)?S2[r]=!0:(w2[r]=!0,!1)}function pl(r,a,u){if(Vv(a))if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(a);return;case"boolean":var h=a.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){r.removeAttribute(a);return}}r.setAttribute(a,""+u)}}function gl(r,a,u){if(u===null)r.removeAttribute(a);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(a);return}r.setAttribute(a,""+u)}}function Gn(r,a,u,h){if(h===null)r.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(a,u,""+h)}}var rf,A2;function tr(r){if(rf===void 0)try{throw Error()}catch(u){var a=u.stack.trim().match(/\n( *(at )?)/);rf=a&&a[1]||"",A2=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+rf+r+A2}var of=!1;function af(r,a){if(!r||of)return"";of=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(a){var oe=function(){throw Error()};if(Object.defineProperty(oe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(oe,[])}catch(te){var J=te}Reflect.construct(r,[],oe)}else{try{oe.call()}catch(te){J=te}r.call(oe.prototype)}}else{try{throw Error()}catch(te){J=te}(oe=r())&&typeof oe.catch=="function"&&oe.catch(function(){})}}catch(te){if(te&&J&&typeof te.stack=="string")return[te.stack,J.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=h.DetermineComponentFrameRoot(),b=m[0],T=m[1];if(b&&T){var k=b.split(`
`),K=T.split(`
`);for(g=h=0;h<k.length&&!k[h].includes("DetermineComponentFrameRoot");)h++;for(;g<K.length&&!K[g].includes("DetermineComponentFrameRoot");)g++;if(h===k.length||g===K.length)for(h=k.length-1,g=K.length-1;1<=h&&0<=g&&k[h]!==K[g];)g--;for(;1<=h&&0<=g;h--,g--)if(k[h]!==K[g]){if(h!==1||g!==1)do if(h--,g--,0>g||k[h]!==K[g]){var ie=`
`+k[h].replace(" at new "," at ");return r.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",r.displayName)),ie}while(1<=h&&0<=g);break}}}finally{of=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?tr(u):""}function Hv(r){switch(r.tag){case 26:case 27:case 5:return tr(r.type);case 16:return tr("Lazy");case 13:return tr("Suspense");case 19:return tr("SuspenseList");case 0:case 15:return af(r.type,!1);case 11:return af(r.type.render,!1);case 1:return af(r.type,!0);case 31:return tr("Activity");default:return""}}function E2(r){try{var a="";do a+=Hv(r),r=r.return;while(r);return a}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function hn(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function C2(r){var a=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(a==="checkbox"||a==="radio")}function $v(r){var a=C2(r)?"checked":"value",u=Object.getOwnPropertyDescriptor(r.constructor.prototype,a),h=""+r[a];if(!r.hasOwnProperty(a)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,m=u.set;return Object.defineProperty(r,a,{configurable:!0,get:function(){return g.call(this)},set:function(b){h=""+b,m.call(this,b)}}),Object.defineProperty(r,a,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(b){h=""+b},stopTracking:function(){r._valueTracker=null,delete r[a]}}}}function ml(r){r._valueTracker||(r._valueTracker=$v(r))}function R2(r){if(!r)return!1;var a=r._valueTracker;if(!a)return!0;var u=a.getValue(),h="";return r&&(h=C2(r)?r.checked?"true":"false":r.value),r=h,r!==u?(a.setValue(r),!0):!1}function _l(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Wv=/[\n"\\]/g;function dn(r){return r.replace(Wv,function(a){return"\\"+a.charCodeAt(0).toString(16)+" "})}function lf(r,a,u,h,g,m,b,T){r.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?r.type=b:r.removeAttribute("type"),a!=null?b==="number"?(a===0&&r.value===""||r.value!=a)&&(r.value=""+hn(a)):r.value!==""+hn(a)&&(r.value=""+hn(a)):b!=="submit"&&b!=="reset"||r.removeAttribute("value"),a!=null?cf(r,b,hn(a)):u!=null?cf(r,b,hn(u)):h!=null&&r.removeAttribute("value"),g==null&&m!=null&&(r.defaultChecked=!!m),g!=null&&(r.checked=g&&typeof g!="function"&&typeof g!="symbol"),T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?r.name=""+hn(T):r.removeAttribute("name")}function M2(r,a,u,h,g,m,b,T){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(r.type=m),a!=null||u!=null){if(!(m!=="submit"&&m!=="reset"||a!=null))return;u=u!=null?""+hn(u):"",a=a!=null?""+hn(a):u,T||a===r.value||(r.value=a),r.defaultValue=a}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,r.checked=T?r.checked:!!h,r.defaultChecked=!!h,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(r.name=b)}function cf(r,a,u){a==="number"&&_l(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function nr(r,a,u,h){if(r=r.options,a){a={};for(var g=0;g<u.length;g++)a["$"+u[g]]=!0;for(u=0;u<r.length;u++)g=a.hasOwnProperty("$"+r[u].value),r[u].selected!==g&&(r[u].selected=g),g&&h&&(r[u].defaultSelected=!0)}else{for(u=""+hn(u),a=null,g=0;g<r.length;g++){if(r[g].value===u){r[g].selected=!0,h&&(r[g].defaultSelected=!0);return}a!==null||r[g].disabled||(a=r[g])}a!==null&&(a.selected=!0)}}function P2(r,a,u){if(a!=null&&(a=""+hn(a),a!==r.value&&(r.value=a),u==null)){r.defaultValue!==a&&(r.defaultValue=a);return}r.defaultValue=u!=null?""+hn(u):""}function O2(r,a,u,h){if(a==null){if(h!=null){if(u!=null)throw Error(i(92));if(Se(h)){if(1<h.length)throw Error(i(93));h=h[0]}u=h}u==null&&(u=""),a=u}u=hn(a),r.defaultValue=u,h=r.textContent,h===u&&h!==""&&h!==null&&(r.value=h)}function ir(r,a){if(a){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=a;return}}r.textContent=a}var Xv=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function I2(r,a,u){var h=a.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?r.setProperty(a,""):a==="float"?r.cssFloat="":r[a]="":h?r.setProperty(a,u):typeof u!="number"||u===0||Xv.has(a)?a==="float"?r.cssFloat=u:r[a]=(""+u).trim():r[a]=u+"px"}function N2(r,a,u){if(a!=null&&typeof a!="object")throw Error(i(62));if(r=r.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||a!=null&&a.hasOwnProperty(h)||(h.indexOf("--")===0?r.setProperty(h,""):h==="float"?r.cssFloat="":r[h]="");for(var g in a)h=a[g],a.hasOwnProperty(g)&&u[g]!==h&&I2(r,g,h)}else for(var m in a)a.hasOwnProperty(m)&&I2(r,m,a[m])}function uf(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yv=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qv=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yl(r){return qv.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var ff=null;function hf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var sr=null,rr=null;function k2(r){var a=Qs(r);if(a&&(r=a.stateNode)){var u=r[Wt]||null;e:switch(r=a.stateNode,a.type){case"input":if(lf(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),a=u.name,u.type==="radio"&&a!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+dn(""+a)+'"][type="radio"]'),a=0;a<u.length;a++){var h=u[a];if(h!==r&&h.form===r.form){var g=h[Wt]||null;if(!g)throw Error(i(90));lf(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(a=0;a<u.length;a++)h=u[a],h.form===r.form&&R2(h)}break e;case"textarea":P2(r,u.value,u.defaultValue);break e;case"select":a=u.value,a!=null&&nr(r,!!u.multiple,a,!1)}}}var df=!1;function D2(r,a,u){if(df)return r(a,u);df=!0;try{var h=r(a);return h}finally{if(df=!1,(sr!==null||rr!==null)&&(ic(),sr&&(a=sr,r=rr,rr=sr=null,k2(a),r)))for(a=0;a<r.length;a++)k2(r[a])}}function Ao(r,a){var u=r.stateNode;if(u===null)return null;var h=u[Wt]||null;if(h===null)return null;u=h[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(r=r.type,h=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!h;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(i(231,a,typeof u));return u}var Qn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pf=!1;if(Qn)try{var Eo={};Object.defineProperty(Eo,"passive",{get:function(){pf=!0}}),window.addEventListener("test",Eo,Eo),window.removeEventListener("test",Eo,Eo)}catch{pf=!1}var Ei=null,gf=null,bl=null;function L2(){if(bl)return bl;var r,a=gf,u=a.length,h,g="value"in Ei?Ei.value:Ei.textContent,m=g.length;for(r=0;r<u&&a[r]===g[r];r++);var b=u-r;for(h=1;h<=b&&a[u-h]===g[m-h];h++);return bl=g.slice(r,1<h?1-h:void 0)}function vl(r){var a=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&a===13&&(r=13)):r=a,r===10&&(r=13),32<=r||r===13?r:0}function xl(){return!0}function B2(){return!1}function Xt(r){function a(u,h,g,m,b){this._reactName=u,this._targetInst=g,this.type=h,this.nativeEvent=m,this.target=b,this.currentTarget=null;for(var T in r)r.hasOwnProperty(T)&&(u=r[T],this[T]=u?u(m):m[T]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?xl:B2,this.isPropagationStopped=B2,this}return p(a.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=xl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=xl)},persist:function(){},isPersistent:xl}),a}var us={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tl=Xt(us),Co=p({},us,{view:0,detail:0}),Zv=Xt(Co),mf,_f,Ro,wl=p({},Co,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ro&&(Ro&&r.type==="mousemove"?(mf=r.screenX-Ro.screenX,_f=r.screenY-Ro.screenY):_f=mf=0,Ro=r),mf)},movementY:function(r){return"movementY"in r?r.movementY:_f}}),U2=Xt(wl),Kv=p({},wl,{dataTransfer:0}),Gv=Xt(Kv),Qv=p({},Co,{relatedTarget:0}),yf=Xt(Qv),Jv=p({},us,{animationName:0,elapsedTime:0,pseudoElement:0}),e6=Xt(Jv),t6=p({},us,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),n6=Xt(t6),i6=p({},us,{data:0}),F2=Xt(i6),s6={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},r6={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},o6={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a6(r){var a=this.nativeEvent;return a.getModifierState?a.getModifierState(r):(r=o6[r])?!!a[r]:!1}function bf(){return a6}var l6=p({},Co,{key:function(r){if(r.key){var a=s6[r.key]||r.key;if(a!=="Unidentified")return a}return r.type==="keypress"?(r=vl(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?r6[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bf,charCode:function(r){return r.type==="keypress"?vl(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?vl(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),c6=Xt(l6),u6=p({},wl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),z2=Xt(u6),f6=p({},Co,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bf}),h6=Xt(f6),d6=p({},us,{propertyName:0,elapsedTime:0,pseudoElement:0}),p6=Xt(d6),g6=p({},wl,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),m6=Xt(g6),_6=p({},us,{newState:0,oldState:0}),y6=Xt(_6),b6=[9,13,27,32],vf=Qn&&"CompositionEvent"in window,Mo=null;Qn&&"documentMode"in document&&(Mo=document.documentMode);var v6=Qn&&"TextEvent"in window&&!Mo,j2=Qn&&(!vf||Mo&&8<Mo&&11>=Mo),V2=" ",H2=!1;function $2(r,a){switch(r){case"keyup":return b6.indexOf(a.keyCode)!==-1;case"keydown":return a.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function W2(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var or=!1;function x6(r,a){switch(r){case"compositionend":return W2(a);case"keypress":return a.which!==32?null:(H2=!0,V2);case"textInput":return r=a.data,r===V2&&H2?null:r;default:return null}}function T6(r,a){if(or)return r==="compositionend"||!vf&&$2(r,a)?(r=L2(),bl=gf=Ei=null,or=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(a.ctrlKey||a.altKey||a.metaKey)||a.ctrlKey&&a.altKey){if(a.char&&1<a.char.length)return a.char;if(a.which)return String.fromCharCode(a.which)}return null;case"compositionend":return j2&&a.locale!=="ko"?null:a.data;default:return null}}var w6={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function X2(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a==="input"?!!w6[r.type]:a==="textarea"}function Y2(r,a,u,h){sr?rr?rr.push(h):rr=[h]:sr=h,a=cc(a,"onChange"),0<a.length&&(u=new Tl("onChange","change",null,u,h),r.push({event:u,listeners:a}))}var Po=null,Oo=null;function S6(r){Cm(r,0)}function Sl(r){var a=So(r);if(R2(a))return r}function q2(r,a){if(r==="change")return a}var Z2=!1;if(Qn){var xf;if(Qn){var Tf="oninput"in document;if(!Tf){var K2=document.createElement("div");K2.setAttribute("oninput","return;"),Tf=typeof K2.oninput=="function"}xf=Tf}else xf=!1;Z2=xf&&(!document.documentMode||9<document.documentMode)}function G2(){Po&&(Po.detachEvent("onpropertychange",Q2),Oo=Po=null)}function Q2(r){if(r.propertyName==="value"&&Sl(Oo)){var a=[];Y2(a,Oo,r,hf(r)),D2(S6,a)}}function A6(r,a,u){r==="focusin"?(G2(),Po=a,Oo=u,Po.attachEvent("onpropertychange",Q2)):r==="focusout"&&G2()}function E6(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Sl(Oo)}function C6(r,a){if(r==="click")return Sl(a)}function R6(r,a){if(r==="input"||r==="change")return Sl(a)}function M6(r,a){return r===a&&(r!==0||1/r===1/a)||r!==r&&a!==a}var Jt=typeof Object.is=="function"?Object.is:M6;function Io(r,a){if(Jt(r,a))return!0;if(typeof r!="object"||r===null||typeof a!="object"||a===null)return!1;var u=Object.keys(r),h=Object.keys(a);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var g=u[h];if(!$t.call(a,g)||!Jt(r[g],a[g]))return!1}return!0}function J2(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function e3(r,a){var u=J2(r);r=0;for(var h;u;){if(u.nodeType===3){if(h=r+u.textContent.length,r<=a&&h>=a)return{node:u,offset:a-r};r=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=J2(u)}}function t3(r,a){return r&&a?r===a?!0:r&&r.nodeType===3?!1:a&&a.nodeType===3?t3(r,a.parentNode):"contains"in r?r.contains(a):r.compareDocumentPosition?!!(r.compareDocumentPosition(a)&16):!1:!1}function n3(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var a=_l(r.document);a instanceof r.HTMLIFrameElement;){try{var u=typeof a.contentWindow.location.href=="string"}catch{u=!1}if(u)r=a.contentWindow;else break;a=_l(r.document)}return a}function wf(r){var a=r&&r.nodeName&&r.nodeName.toLowerCase();return a&&(a==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||a==="textarea"||r.contentEditable==="true")}var P6=Qn&&"documentMode"in document&&11>=document.documentMode,ar=null,Sf=null,No=null,Af=!1;function i3(r,a,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;Af||ar==null||ar!==_l(h)||(h=ar,"selectionStart"in h&&wf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),No&&Io(No,h)||(No=h,h=cc(Sf,"onSelect"),0<h.length&&(a=new Tl("onSelect","select",null,a,u),r.push({event:a,listeners:h}),a.target=ar)))}function fs(r,a){var u={};return u[r.toLowerCase()]=a.toLowerCase(),u["Webkit"+r]="webkit"+a,u["Moz"+r]="moz"+a,u}var lr={animationend:fs("Animation","AnimationEnd"),animationiteration:fs("Animation","AnimationIteration"),animationstart:fs("Animation","AnimationStart"),transitionrun:fs("Transition","TransitionRun"),transitionstart:fs("Transition","TransitionStart"),transitioncancel:fs("Transition","TransitionCancel"),transitionend:fs("Transition","TransitionEnd")},Ef={},s3={};Qn&&(s3=document.createElement("div").style,"AnimationEvent"in window||(delete lr.animationend.animation,delete lr.animationiteration.animation,delete lr.animationstart.animation),"TransitionEvent"in window||delete lr.transitionend.transition);function hs(r){if(Ef[r])return Ef[r];if(!lr[r])return r;var a=lr[r],u;for(u in a)if(a.hasOwnProperty(u)&&u in s3)return Ef[r]=a[u];return r}var r3=hs("animationend"),o3=hs("animationiteration"),a3=hs("animationstart"),O6=hs("transitionrun"),I6=hs("transitionstart"),N6=hs("transitioncancel"),l3=hs("transitionend"),c3=new Map,Cf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Cf.push("scrollEnd");function Cn(r,a){c3.set(r,a),cs(a,[r])}var u3=new WeakMap;function pn(r,a){if(typeof r=="object"&&r!==null){var u=u3.get(r);return u!==void 0?u:(a={value:r,source:a,stack:E2(a)},u3.set(r,a),a)}return{value:r,source:a,stack:E2(a)}}var gn=[],cr=0,Rf=0;function Al(){for(var r=cr,a=Rf=cr=0;a<r;){var u=gn[a];gn[a++]=null;var h=gn[a];gn[a++]=null;var g=gn[a];gn[a++]=null;var m=gn[a];if(gn[a++]=null,h!==null&&g!==null){var b=h.pending;b===null?g.next=g:(g.next=b.next,b.next=g),h.pending=g}m!==0&&f3(u,g,m)}}function El(r,a,u,h){gn[cr++]=r,gn[cr++]=a,gn[cr++]=u,gn[cr++]=h,Rf|=h,r.lanes|=h,r=r.alternate,r!==null&&(r.lanes|=h)}function Mf(r,a,u,h){return El(r,a,u,h),Cl(r)}function ur(r,a){return El(r,null,null,a),Cl(r)}function f3(r,a,u){r.lanes|=u;var h=r.alternate;h!==null&&(h.lanes|=u);for(var g=!1,m=r.return;m!==null;)m.childLanes|=u,h=m.alternate,h!==null&&(h.childLanes|=u),m.tag===22&&(r=m.stateNode,r===null||r._visibility&1||(g=!0)),r=m,m=m.return;return r.tag===3?(m=r.stateNode,g&&a!==null&&(g=31-Qt(u),r=m.hiddenUpdates,h=r[g],h===null?r[g]=[a]:h.push(a),a.lane=u|536870912),m):null}function Cl(r){if(50<sa)throw sa=0,Dh=null,Error(i(185));for(var a=r.return;a!==null;)r=a,a=r.return;return r.tag===3?r.stateNode:null}var fr={};function k6(r,a,u,h){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(r,a,u,h){return new k6(r,a,u,h)}function Pf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Jn(r,a){var u=r.alternate;return u===null?(u=en(r.tag,a,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=a,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,a=r.dependencies,u.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function h3(r,a){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=a,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,a=u.dependencies,r.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),r}function Rl(r,a,u,h,g,m){var b=0;if(h=r,typeof r=="function")Pf(r)&&(b=1);else if(typeof r=="string")b=L9(r,u,ae.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case ee:return r=en(31,u,a,g),r.elementType=ee,r.lanes=m,r;case x:return ds(u.children,g,m,a);case S:b=8,g|=24;break;case M:return r=en(12,u,a,g|2),r.elementType=M,r.lanes=m,r;case B:return r=en(13,u,a,g),r.elementType=B,r.lanes=m,r;case Q:return r=en(19,u,a,g),r.elementType=Q,r.lanes=m,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case C:case R:b=10;break e;case U:b=9;break e;case D:b=11;break e;case ce:b=14;break e;case Z:b=16,h=null;break e}b=29,u=Error(i(130,r===null?"null":typeof r,"")),h=null}return a=en(b,u,a,g),a.elementType=r,a.type=h,a.lanes=m,a}function ds(r,a,u,h){return r=en(7,r,h,a),r.lanes=u,r}function Of(r,a,u){return r=en(6,r,null,a),r.lanes=u,r}function If(r,a,u){return a=en(4,r.children!==null?r.children:[],r.key,a),a.lanes=u,a.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},a}var hr=[],dr=0,Ml=null,Pl=0,mn=[],_n=0,ps=null,ei=1,ti="";function gs(r,a){hr[dr++]=Pl,hr[dr++]=Ml,Ml=r,Pl=a}function d3(r,a,u){mn[_n++]=ei,mn[_n++]=ti,mn[_n++]=ps,ps=r;var h=ei;r=ti;var g=32-Qt(h)-1;h&=~(1<<g),u+=1;var m=32-Qt(a)+g;if(30<m){var b=g-g%5;m=(h&(1<<b)-1).toString(32),h>>=b,g-=b,ei=1<<32-Qt(a)+g|u<<g|h,ti=m+r}else ei=1<<m|u<<g|h,ti=r}function Nf(r){r.return!==null&&(gs(r,1),d3(r,1,0))}function kf(r){for(;r===Ml;)Ml=hr[--dr],hr[dr]=null,Pl=hr[--dr],hr[dr]=null;for(;r===ps;)ps=mn[--_n],mn[_n]=null,ti=mn[--_n],mn[_n]=null,ei=mn[--_n],mn[_n]=null}var zt=null,at=null,He=!1,ms=null,Un=!1,Df=Error(i(519));function _s(r){var a=Error(i(418,""));throw Lo(pn(a,r)),Df}function p3(r){var a=r.stateNode,u=r.type,h=r.memoizedProps;switch(a[Nt]=r,a[Wt]=h,u){case"dialog":Le("cancel",a),Le("close",a);break;case"iframe":case"object":case"embed":Le("load",a);break;case"video":case"audio":for(u=0;u<oa.length;u++)Le(oa[u],a);break;case"source":Le("error",a);break;case"img":case"image":case"link":Le("error",a),Le("load",a);break;case"details":Le("toggle",a);break;case"input":Le("invalid",a),M2(a,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),ml(a);break;case"select":Le("invalid",a);break;case"textarea":Le("invalid",a),O2(a,h.value,h.defaultValue,h.children),ml(a)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||a.textContent===""+u||h.suppressHydrationWarning===!0||Om(a.textContent,u)?(h.popover!=null&&(Le("beforetoggle",a),Le("toggle",a)),h.onScroll!=null&&Le("scroll",a),h.onScrollEnd!=null&&Le("scrollend",a),h.onClick!=null&&(a.onclick=uc),a=!0):a=!1,a||_s(r)}function g3(r){for(zt=r.return;zt;)switch(zt.tag){case 5:case 13:Un=!1;return;case 27:case 3:Un=!0;return;default:zt=zt.return}}function ko(r){if(r!==zt)return!1;if(!He)return g3(r),He=!0,!1;var a=r.tag,u;if((u=a!==3&&a!==27)&&((u=a===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||Gh(r.type,r.memoizedProps)),u=!u),u&&at&&_s(r),g3(r),a===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));e:{for(r=r.nextSibling,a=0;r;){if(r.nodeType===8)if(u=r.data,u==="/$"){if(a===0){at=Mn(r.nextSibling);break e}a--}else u!=="$"&&u!=="$!"&&u!=="$?"||a++;r=r.nextSibling}at=null}}else a===27?(a=at,Vi(r.type)?(r=td,td=null,at=r):at=a):at=zt?Mn(r.stateNode.nextSibling):null;return!0}function Do(){at=zt=null,He=!1}function m3(){var r=ms;return r!==null&&(Zt===null?Zt=r:Zt.push.apply(Zt,r),ms=null),r}function Lo(r){ms===null?ms=[r]:ms.push(r)}var Lf=F(null),ys=null,ni=null;function Ci(r,a,u){G(Lf,a._currentValue),a._currentValue=u}function ii(r){r._currentValue=Lf.current,X(Lf)}function Bf(r,a,u){for(;r!==null;){var h=r.alternate;if((r.childLanes&a)!==a?(r.childLanes|=a,h!==null&&(h.childLanes|=a)):h!==null&&(h.childLanes&a)!==a&&(h.childLanes|=a),r===u)break;r=r.return}}function Uf(r,a,u,h){var g=r.child;for(g!==null&&(g.return=r);g!==null;){var m=g.dependencies;if(m!==null){var b=g.child;m=m.firstContext;e:for(;m!==null;){var T=m;m=g;for(var k=0;k<a.length;k++)if(T.context===a[k]){m.lanes|=u,T=m.alternate,T!==null&&(T.lanes|=u),Bf(m.return,u,r),h||(b=null);break e}m=T.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(i(341));b.lanes|=u,m=b.alternate,m!==null&&(m.lanes|=u),Bf(b,u,r),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===r){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Bo(r,a,u,h){r=null;for(var g=a,m=!1;g!==null;){if(!m){if((g.flags&524288)!==0)m=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(i(387));if(b=b.memoizedProps,b!==null){var T=g.type;Jt(g.pendingProps.value,b.value)||(r!==null?r.push(T):r=[T])}}else if(g===xe.current){if(b=g.alternate,b===null)throw Error(i(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(r!==null?r.push(ha):r=[ha])}g=g.return}r!==null&&Uf(a,r,u,h),a.flags|=262144}function Ol(r){for(r=r.firstContext;r!==null;){if(!Jt(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function bs(r){ys=r,ni=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function kt(r){return _3(ys,r)}function Il(r,a){return ys===null&&bs(r),_3(r,a)}function _3(r,a){var u=a._currentValue;if(a={context:a,memoizedValue:u,next:null},ni===null){if(r===null)throw Error(i(308));ni=a,r.dependencies={lanes:0,firstContext:a},r.flags|=524288}else ni=ni.next=a;return u}var D6=typeof AbortController<"u"?AbortController:function(){var r=[],a=this.signal={aborted:!1,addEventListener:function(u,h){r.push(h)}};this.abort=function(){a.aborted=!0,r.forEach(function(u){return u()})}},L6=n.unstable_scheduleCallback,B6=n.unstable_NormalPriority,yt={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new D6,data:new Map,refCount:0}}function Uo(r){r.refCount--,r.refCount===0&&L6(B6,function(){r.controller.abort()})}var Fo=null,zf=0,pr=0,gr=null;function U6(r,a){if(Fo===null){var u=Fo=[];zf=0,pr=Vh(),gr={status:"pending",value:void 0,then:function(h){u.push(h)}}}return zf++,a.then(y3,y3),a}function y3(){if(--zf===0&&Fo!==null){gr!==null&&(gr.status="fulfilled");var r=Fo;Fo=null,pr=0,gr=null;for(var a=0;a<r.length;a++)(0,r[a])()}}function F6(r,a){var u=[],h={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return r.then(function(){h.status="fulfilled",h.value=a;for(var g=0;g<u.length;g++)(0,u[g])(a)},function(g){for(h.status="rejected",h.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),h}var b3=w.S;w.S=function(r,a){typeof a=="object"&&a!==null&&typeof a.then=="function"&&U6(r,a),b3!==null&&b3(r,a)};var vs=F(null);function jf(){var r=vs.current;return r!==null?r:nt.pooledCache}function Nl(r,a){a===null?G(vs,vs.current):G(vs,a.pool)}function v3(){var r=jf();return r===null?null:{parent:yt._currentValue,pool:r}}var zo=Error(i(460)),x3=Error(i(474)),kl=Error(i(542)),Vf={then:function(){}};function T3(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Dl(){}function w3(r,a,u){switch(u=r[u],u===void 0?r.push(a):u!==a&&(a.then(Dl,Dl),a=u),a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,A3(r),r;default:if(typeof a.status=="string")a.then(Dl,Dl);else{if(r=nt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=a,r.status="pending",r.then(function(h){if(a.status==="pending"){var g=a;g.status="fulfilled",g.value=h}},function(h){if(a.status==="pending"){var g=a;g.status="rejected",g.reason=h}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw r=a.reason,A3(r),r}throw jo=a,zo}}var jo=null;function S3(){if(jo===null)throw Error(i(459));var r=jo;return jo=null,r}function A3(r){if(r===zo||r===kl)throw Error(i(483))}var Ri=!1;function Hf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(r,a){r=r.updateQueue,a.updateQueue===r&&(a.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Mi(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Pi(r,a,u){var h=r.updateQueue;if(h===null)return null;if(h=h.shared,(Ye&2)!==0){var g=h.pending;return g===null?a.next=a:(a.next=g.next,g.next=a),h.pending=a,a=Cl(r),f3(r,null,u),a}return El(r,h,a,u),Cl(r)}function Vo(r,a,u){if(a=a.updateQueue,a!==null&&(a=a.shared,(u&4194048)!==0)){var h=a.lanes;h&=r.pendingLanes,u|=h,a.lanes=u,y2(r,u)}}function Wf(r,a){var u=r.updateQueue,h=r.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var g=null,m=null;if(u=u.firstBaseUpdate,u!==null){do{var b={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};m===null?g=m=b:m=m.next=b,u=u.next}while(u!==null);m===null?g=m=a:m=m.next=a}else g=m=a;u={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:m,shared:h.shared,callbacks:h.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=a:r.next=a,u.lastBaseUpdate=a}var Xf=!1;function Ho(){if(Xf){var r=gr;if(r!==null)throw r}}function $o(r,a,u,h){Xf=!1;var g=r.updateQueue;Ri=!1;var m=g.firstBaseUpdate,b=g.lastBaseUpdate,T=g.shared.pending;if(T!==null){g.shared.pending=null;var k=T,K=k.next;k.next=null,b===null?m=K:b.next=K,b=k;var ie=r.alternate;ie!==null&&(ie=ie.updateQueue,T=ie.lastBaseUpdate,T!==b&&(T===null?ie.firstBaseUpdate=K:T.next=K,ie.lastBaseUpdate=k))}if(m!==null){var oe=g.baseState;b=0,ie=K=k=null,T=m;do{var J=T.lane&-536870913,te=J!==T.lane;if(te?(Ue&J)===J:(h&J)===J){J!==0&&J===pr&&(Xf=!0),ie!==null&&(ie=ie.next={lane:0,tag:T.tag,payload:T.payload,callback:null,next:null});e:{var Re=r,Ae=T;J=a;var Ge=u;switch(Ae.tag){case 1:if(Re=Ae.payload,typeof Re=="function"){oe=Re.call(Ge,oe,J);break e}oe=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Ae.payload,J=typeof Re=="function"?Re.call(Ge,oe,J):Re,J==null)break e;oe=p({},oe,J);break e;case 2:Ri=!0}}J=T.callback,J!==null&&(r.flags|=64,te&&(r.flags|=8192),te=g.callbacks,te===null?g.callbacks=[J]:te.push(J))}else te={lane:J,tag:T.tag,payload:T.payload,callback:T.callback,next:null},ie===null?(K=ie=te,k=oe):ie=ie.next=te,b|=J;if(T=T.next,T===null){if(T=g.shared.pending,T===null)break;te=T,T=te.next,te.next=null,g.lastBaseUpdate=te,g.shared.pending=null}}while(!0);ie===null&&(k=oe),g.baseState=k,g.firstBaseUpdate=K,g.lastBaseUpdate=ie,m===null&&(g.shared.lanes=0),Ui|=b,r.lanes=b,r.memoizedState=oe}}function E3(r,a){if(typeof r!="function")throw Error(i(191,r));r.call(a)}function C3(r,a){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)E3(u[r],a)}var mr=F(null),Ll=F(0);function R3(r,a){r=ui,G(Ll,r),G(mr,a),ui=r|a.baseLanes}function Yf(){G(Ll,ui),G(mr,mr.current)}function qf(){ui=Ll.current,X(mr),X(Ll)}var Oi=0,Oe=null,Ze=null,dt=null,Bl=!1,_r=!1,xs=!1,Ul=0,Wo=0,yr=null,z6=0;function ft(){throw Error(i(321))}function Zf(r,a){if(a===null)return!1;for(var u=0;u<a.length&&u<r.length;u++)if(!Jt(r[u],a[u]))return!1;return!0}function Kf(r,a,u,h,g,m){return Oi=m,Oe=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,w.H=r===null||r.memoizedState===null?f1:h1,xs=!1,m=u(h,g),xs=!1,_r&&(m=P3(a,u,h,g)),M3(r),m}function M3(r){w.H=$l;var a=Ze!==null&&Ze.next!==null;if(Oi=0,dt=Ze=Oe=null,Bl=!1,Wo=0,yr=null,a)throw Error(i(300));r===null||At||(r=r.dependencies,r!==null&&Ol(r)&&(At=!0))}function P3(r,a,u,h){Oe=r;var g=0;do{if(_r&&(yr=null),Wo=0,_r=!1,25<=g)throw Error(i(301));if(g+=1,dt=Ze=null,r.updateQueue!=null){var m=r.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}w.H=Y6,m=a(u,h)}while(_r);return m}function j6(){var r=w.H,a=r.useState()[0];return a=typeof a.then=="function"?Xo(a):a,r=r.useState()[0],(Ze!==null?Ze.memoizedState:null)!==r&&(Oe.flags|=1024),a}function Gf(){var r=Ul!==0;return Ul=0,r}function Qf(r,a,u){a.updateQueue=r.updateQueue,a.flags&=-2053,r.lanes&=~u}function Jf(r){if(Bl){for(r=r.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}Bl=!1}Oi=0,dt=Ze=Oe=null,_r=!1,Wo=Ul=0,yr=null}function Yt(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Oe.memoizedState=dt=r:dt=dt.next=r,dt}function pt(){if(Ze===null){var r=Oe.alternate;r=r!==null?r.memoizedState:null}else r=Ze.next;var a=dt===null?Oe.memoizedState:dt.next;if(a!==null)dt=a,Ze=r;else{if(r===null)throw Oe.alternate===null?Error(i(467)):Error(i(310));Ze=r,r={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},dt===null?Oe.memoizedState=dt=r:dt=dt.next=r}return dt}function eh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Xo(r){var a=Wo;return Wo+=1,yr===null&&(yr=[]),r=w3(yr,r,a),a=Oe,(dt===null?a.memoizedState:dt.next)===null&&(a=a.alternate,w.H=a===null||a.memoizedState===null?f1:h1),r}function Fl(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Xo(r);if(r.$$typeof===R)return kt(r)}throw Error(i(438,String(r)))}function th(r){var a=null,u=Oe.updateQueue;if(u!==null&&(a=u.memoCache),a==null){var h=Oe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(a={data:h.data.map(function(g){return g.slice()}),index:0})))}if(a==null&&(a={data:[],index:0}),u===null&&(u=eh(),Oe.updateQueue=u),u.memoCache=a,u=a.data[a.index],u===void 0)for(u=a.data[a.index]=Array(r),h=0;h<r;h++)u[h]=he;return a.index++,u}function si(r,a){return typeof a=="function"?a(r):a}function zl(r){var a=pt();return nh(a,Ze,r)}function nh(r,a,u){var h=r.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=u;var g=r.baseQueue,m=h.pending;if(m!==null){if(g!==null){var b=g.next;g.next=m.next,m.next=b}a.baseQueue=g=m,h.pending=null}if(m=r.baseState,g===null)r.memoizedState=m;else{a=g.next;var T=b=null,k=null,K=a,ie=!1;do{var oe=K.lane&-536870913;if(oe!==K.lane?(Ue&oe)===oe:(Oi&oe)===oe){var J=K.revertLane;if(J===0)k!==null&&(k=k.next={lane:0,revertLane:0,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null}),oe===pr&&(ie=!0);else if((Oi&J)===J){K=K.next,J===pr&&(ie=!0);continue}else oe={lane:0,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},k===null?(T=k=oe,b=m):k=k.next=oe,Oe.lanes|=J,Ui|=J;oe=K.action,xs&&u(m,oe),m=K.hasEagerState?K.eagerState:u(m,oe)}else J={lane:oe,revertLane:K.revertLane,action:K.action,hasEagerState:K.hasEagerState,eagerState:K.eagerState,next:null},k===null?(T=k=J,b=m):k=k.next=J,Oe.lanes|=oe,Ui|=oe;K=K.next}while(K!==null&&K!==a);if(k===null?b=m:k.next=T,!Jt(m,r.memoizedState)&&(At=!0,ie&&(u=gr,u!==null)))throw u;r.memoizedState=m,r.baseState=b,r.baseQueue=k,h.lastRenderedState=m}return g===null&&(h.lanes=0),[r.memoizedState,h.dispatch]}function ih(r){var a=pt(),u=a.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=r;var h=u.dispatch,g=u.pending,m=a.memoizedState;if(g!==null){u.pending=null;var b=g=g.next;do m=r(m,b.action),b=b.next;while(b!==g);Jt(m,a.memoizedState)||(At=!0),a.memoizedState=m,a.baseQueue===null&&(a.baseState=m),u.lastRenderedState=m}return[m,h]}function O3(r,a,u){var h=Oe,g=pt(),m=He;if(m){if(u===void 0)throw Error(i(407));u=u()}else u=a();var b=!Jt((Ze||g).memoizedState,u);b&&(g.memoizedState=u,At=!0),g=g.queue;var T=k3.bind(null,h,g,r);if(Yo(2048,8,T,[r]),g.getSnapshot!==a||b||dt!==null&&dt.memoizedState.tag&1){if(h.flags|=2048,br(9,jl(),N3.bind(null,h,g,u,a),null),nt===null)throw Error(i(349));m||(Oi&124)!==0||I3(h,a,u)}return u}function I3(r,a,u){r.flags|=16384,r={getSnapshot:a,value:u},a=Oe.updateQueue,a===null?(a=eh(),Oe.updateQueue=a,a.stores=[r]):(u=a.stores,u===null?a.stores=[r]:u.push(r))}function N3(r,a,u,h){a.value=u,a.getSnapshot=h,D3(a)&&L3(r)}function k3(r,a,u){return u(function(){D3(a)&&L3(r)})}function D3(r){var a=r.getSnapshot;r=r.value;try{var u=a();return!Jt(r,u)}catch{return!0}}function L3(r){var a=ur(r,2);a!==null&&on(a,r,2)}function sh(r){var a=Yt();if(typeof r=="function"){var u=r;if(r=u(),xs){Si(!0);try{u()}finally{Si(!1)}}}return a.memoizedState=a.baseState=r,a.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:r},a}function B3(r,a,u,h){return r.baseState=u,nh(r,Ze,typeof h=="function"?h:si)}function V6(r,a,u,h,g){if(Hl(r))throw Error(i(485));if(r=a.action,r!==null){var m={payload:g,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){m.listeners.push(b)}};w.T!==null?u(!0):m.isTransition=!1,h(m),u=a.pending,u===null?(m.next=a.pending=m,U3(a,m)):(m.next=u.next,a.pending=u.next=m)}}function U3(r,a){var u=a.action,h=a.payload,g=r.state;if(a.isTransition){var m=w.T,b={};w.T=b;try{var T=u(g,h),k=w.S;k!==null&&k(b,T),F3(r,a,T)}catch(K){rh(r,a,K)}finally{w.T=m}}else try{m=u(g,h),F3(r,a,m)}catch(K){rh(r,a,K)}}function F3(r,a,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){z3(r,a,h)},function(h){return rh(r,a,h)}):z3(r,a,u)}function z3(r,a,u){a.status="fulfilled",a.value=u,j3(a),r.state=u,a=r.pending,a!==null&&(u=a.next,u===a?r.pending=null:(u=u.next,a.next=u,U3(r,u)))}function rh(r,a,u){var h=r.pending;if(r.pending=null,h!==null){h=h.next;do a.status="rejected",a.reason=u,j3(a),a=a.next;while(a!==h)}r.action=null}function j3(r){r=r.listeners;for(var a=0;a<r.length;a++)(0,r[a])()}function V3(r,a){return a}function H3(r,a){if(He){var u=nt.formState;if(u!==null){e:{var h=Oe;if(He){if(at){t:{for(var g=at,m=Un;g.nodeType!==8;){if(!m){g=null;break t}if(g=Mn(g.nextSibling),g===null){g=null;break t}}m=g.data,g=m==="F!"||m==="F"?g:null}if(g){at=Mn(g.nextSibling),h=g.data==="F!";break e}}_s(h)}h=!1}h&&(a=u[0])}}return u=Yt(),u.memoizedState=u.baseState=a,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:V3,lastRenderedState:a},u.queue=h,u=l1.bind(null,Oe,h),h.dispatch=u,h=sh(!1),m=uh.bind(null,Oe,!1,h.queue),h=Yt(),g={state:a,dispatch:null,action:r,pending:null},h.queue=g,u=V6.bind(null,Oe,g,m,u),g.dispatch=u,h.memoizedState=r,[a,u,!1]}function $3(r){var a=pt();return W3(a,Ze,r)}function W3(r,a,u){if(a=nh(r,a,V3)[0],r=zl(si)[0],typeof a=="object"&&a!==null&&typeof a.then=="function")try{var h=Xo(a)}catch(b){throw b===zo?kl:b}else h=a;a=pt();var g=a.queue,m=g.dispatch;return u!==a.memoizedState&&(Oe.flags|=2048,br(9,jl(),H6.bind(null,g,u),null)),[h,m,r]}function H6(r,a){r.action=a}function X3(r){var a=pt(),u=Ze;if(u!==null)return W3(a,u,r);pt(),a=a.memoizedState,u=pt();var h=u.queue.dispatch;return u.memoizedState=r,[a,h,!1]}function br(r,a,u,h){return r={tag:r,create:u,deps:h,inst:a,next:null},a=Oe.updateQueue,a===null&&(a=eh(),Oe.updateQueue=a),u=a.lastEffect,u===null?a.lastEffect=r.next=r:(h=u.next,u.next=r,r.next=h,a.lastEffect=r),r}function jl(){return{destroy:void 0,resource:void 0}}function Y3(){return pt().memoizedState}function Vl(r,a,u,h){var g=Yt();h=h===void 0?null:h,Oe.flags|=r,g.memoizedState=br(1|a,jl(),u,h)}function Yo(r,a,u,h){var g=pt();h=h===void 0?null:h;var m=g.memoizedState.inst;Ze!==null&&h!==null&&Zf(h,Ze.memoizedState.deps)?g.memoizedState=br(a,m,u,h):(Oe.flags|=r,g.memoizedState=br(1|a,m,u,h))}function q3(r,a){Vl(8390656,8,r,a)}function Z3(r,a){Yo(2048,8,r,a)}function K3(r,a){return Yo(4,2,r,a)}function G3(r,a){return Yo(4,4,r,a)}function Q3(r,a){if(typeof a=="function"){r=r();var u=a(r);return function(){typeof u=="function"?u():a(null)}}if(a!=null)return r=r(),a.current=r,function(){a.current=null}}function J3(r,a,u){u=u!=null?u.concat([r]):null,Yo(4,4,Q3.bind(null,a,r),u)}function oh(){}function e1(r,a){var u=pt();a=a===void 0?null:a;var h=u.memoizedState;return a!==null&&Zf(a,h[1])?h[0]:(u.memoizedState=[r,a],r)}function t1(r,a){var u=pt();a=a===void 0?null:a;var h=u.memoizedState;if(a!==null&&Zf(a,h[1]))return h[0];if(h=r(),xs){Si(!0);try{r()}finally{Si(!1)}}return u.memoizedState=[h,a],h}function ah(r,a,u){return u===void 0||(Oi&1073741824)!==0?r.memoizedState=a:(r.memoizedState=u,r=sm(),Oe.lanes|=r,Ui|=r,u)}function n1(r,a,u,h){return Jt(u,a)?u:mr.current!==null?(r=ah(r,u,h),Jt(r,a)||(At=!0),r):(Oi&42)===0?(At=!0,r.memoizedState=u):(r=sm(),Oe.lanes|=r,Ui|=r,a)}function i1(r,a,u,h,g){var m=N.p;N.p=m!==0&&8>m?m:8;var b=w.T,T={};w.T=T,uh(r,!1,a,u);try{var k=g(),K=w.S;if(K!==null&&K(T,k),k!==null&&typeof k=="object"&&typeof k.then=="function"){var ie=F6(k,h);qo(r,a,ie,rn(r))}else qo(r,a,h,rn(r))}catch(oe){qo(r,a,{then:function(){},status:"rejected",reason:oe},rn())}finally{N.p=m,w.T=b}}function $6(){}function lh(r,a,u,h){if(r.tag!==5)throw Error(i(476));var g=s1(r).queue;i1(r,g,a,O,u===null?$6:function(){return r1(r),u(h)})}function s1(r){var a=r.memoizedState;if(a!==null)return a;a={memoizedState:O,baseState:O,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:O},next:null};var u={};return a.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:si,lastRenderedState:u},next:null},r.memoizedState=a,r=r.alternate,r!==null&&(r.memoizedState=a),a}function r1(r){var a=s1(r).next.queue;qo(r,a,{},rn())}function ch(){return kt(ha)}function o1(){return pt().memoizedState}function a1(){return pt().memoizedState}function W6(r){for(var a=r.return;a!==null;){switch(a.tag){case 24:case 3:var u=rn();r=Mi(u);var h=Pi(a,r,u);h!==null&&(on(h,a,u),Vo(h,a,u)),a={cache:Ff()},r.payload=a;return}a=a.return}}function X6(r,a,u){var h=rn();u={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},Hl(r)?c1(a,u):(u=Mf(r,a,u,h),u!==null&&(on(u,r,h),u1(u,a,h)))}function l1(r,a,u){var h=rn();qo(r,a,u,h)}function qo(r,a,u,h){var g={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(Hl(r))c1(a,g);else{var m=r.alternate;if(r.lanes===0&&(m===null||m.lanes===0)&&(m=a.lastRenderedReducer,m!==null))try{var b=a.lastRenderedState,T=m(b,u);if(g.hasEagerState=!0,g.eagerState=T,Jt(T,b))return El(r,a,g,0),nt===null&&Al(),!1}catch{}finally{}if(u=Mf(r,a,g,h),u!==null)return on(u,r,h),u1(u,a,h),!0}return!1}function uh(r,a,u,h){if(h={lane:2,revertLane:Vh(),action:h,hasEagerState:!1,eagerState:null,next:null},Hl(r)){if(a)throw Error(i(479))}else a=Mf(r,u,h,2),a!==null&&on(a,r,2)}function Hl(r){var a=r.alternate;return r===Oe||a!==null&&a===Oe}function c1(r,a){_r=Bl=!0;var u=r.pending;u===null?a.next=a:(a.next=u.next,u.next=a),r.pending=a}function u1(r,a,u){if((u&4194048)!==0){var h=a.lanes;h&=r.pendingLanes,u|=h,a.lanes=u,y2(r,u)}}var $l={readContext:kt,use:Fl,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useLayoutEffect:ft,useInsertionEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useSyncExternalStore:ft,useId:ft,useHostTransitionStatus:ft,useFormState:ft,useActionState:ft,useOptimistic:ft,useMemoCache:ft,useCacheRefresh:ft},f1={readContext:kt,use:Fl,useCallback:function(r,a){return Yt().memoizedState=[r,a===void 0?null:a],r},useContext:kt,useEffect:q3,useImperativeHandle:function(r,a,u){u=u!=null?u.concat([r]):null,Vl(4194308,4,Q3.bind(null,a,r),u)},useLayoutEffect:function(r,a){return Vl(4194308,4,r,a)},useInsertionEffect:function(r,a){Vl(4,2,r,a)},useMemo:function(r,a){var u=Yt();a=a===void 0?null:a;var h=r();if(xs){Si(!0);try{r()}finally{Si(!1)}}return u.memoizedState=[h,a],h},useReducer:function(r,a,u){var h=Yt();if(u!==void 0){var g=u(a);if(xs){Si(!0);try{u(a)}finally{Si(!1)}}}else g=a;return h.memoizedState=h.baseState=g,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:g},h.queue=r,r=r.dispatch=X6.bind(null,Oe,r),[h.memoizedState,r]},useRef:function(r){var a=Yt();return r={current:r},a.memoizedState=r},useState:function(r){r=sh(r);var a=r.queue,u=l1.bind(null,Oe,a);return a.dispatch=u,[r.memoizedState,u]},useDebugValue:oh,useDeferredValue:function(r,a){var u=Yt();return ah(u,r,a)},useTransition:function(){var r=sh(!1);return r=i1.bind(null,Oe,r.queue,!0,!1),Yt().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,a,u){var h=Oe,g=Yt();if(He){if(u===void 0)throw Error(i(407));u=u()}else{if(u=a(),nt===null)throw Error(i(349));(Ue&124)!==0||I3(h,a,u)}g.memoizedState=u;var m={value:u,getSnapshot:a};return g.queue=m,q3(k3.bind(null,h,m,r),[r]),h.flags|=2048,br(9,jl(),N3.bind(null,h,m,u,a),null),u},useId:function(){var r=Yt(),a=nt.identifierPrefix;if(He){var u=ti,h=ei;u=(h&~(1<<32-Qt(h)-1)).toString(32)+u,a=""+a+"R"+u,u=Ul++,0<u&&(a+="H"+u.toString(32)),a+=""}else u=z6++,a=""+a+"r"+u.toString(32)+"";return r.memoizedState=a},useHostTransitionStatus:ch,useFormState:H3,useActionState:H3,useOptimistic:function(r){var a=Yt();a.memoizedState=a.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return a.queue=u,a=uh.bind(null,Oe,!0,u),u.dispatch=a,[r,a]},useMemoCache:th,useCacheRefresh:function(){return Yt().memoizedState=W6.bind(null,Oe)}},h1={readContext:kt,use:Fl,useCallback:e1,useContext:kt,useEffect:Z3,useImperativeHandle:J3,useInsertionEffect:K3,useLayoutEffect:G3,useMemo:t1,useReducer:zl,useRef:Y3,useState:function(){return zl(si)},useDebugValue:oh,useDeferredValue:function(r,a){var u=pt();return n1(u,Ze.memoizedState,r,a)},useTransition:function(){var r=zl(si)[0],a=pt().memoizedState;return[typeof r=="boolean"?r:Xo(r),a]},useSyncExternalStore:O3,useId:o1,useHostTransitionStatus:ch,useFormState:$3,useActionState:$3,useOptimistic:function(r,a){var u=pt();return B3(u,Ze,r,a)},useMemoCache:th,useCacheRefresh:a1},Y6={readContext:kt,use:Fl,useCallback:e1,useContext:kt,useEffect:Z3,useImperativeHandle:J3,useInsertionEffect:K3,useLayoutEffect:G3,useMemo:t1,useReducer:ih,useRef:Y3,useState:function(){return ih(si)},useDebugValue:oh,useDeferredValue:function(r,a){var u=pt();return Ze===null?ah(u,r,a):n1(u,Ze.memoizedState,r,a)},useTransition:function(){var r=ih(si)[0],a=pt().memoizedState;return[typeof r=="boolean"?r:Xo(r),a]},useSyncExternalStore:O3,useId:o1,useHostTransitionStatus:ch,useFormState:X3,useActionState:X3,useOptimistic:function(r,a){var u=pt();return Ze!==null?B3(u,Ze,r,a):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:th,useCacheRefresh:a1},vr=null,Zo=0;function Wl(r){var a=Zo;return Zo+=1,vr===null&&(vr=[]),w3(vr,r,a)}function Ko(r,a){a=a.props.ref,r.ref=a!==void 0?a:null}function Xl(r,a){throw a.$$typeof===_?Error(i(525)):(r=Object.prototype.toString.call(a),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":r)))}function d1(r){var a=r._init;return a(r._payload)}function p1(r){function a($,z){if(r){var q=$.deletions;q===null?($.deletions=[z],$.flags|=16):q.push(z)}}function u($,z){if(!r)return null;for(;z!==null;)a($,z),z=z.sibling;return null}function h($){for(var z=new Map;$!==null;)$.key!==null?z.set($.key,$):z.set($.index,$),$=$.sibling;return z}function g($,z){return $=Jn($,z),$.index=0,$.sibling=null,$}function m($,z,q){return $.index=q,r?(q=$.alternate,q!==null?(q=q.index,q<z?($.flags|=67108866,z):q):($.flags|=67108866,z)):($.flags|=1048576,z)}function b($){return r&&$.alternate===null&&($.flags|=67108866),$}function T($,z,q,se){return z===null||z.tag!==6?(z=Of(q,$.mode,se),z.return=$,z):(z=g(z,q),z.return=$,z)}function k($,z,q,se){var ye=q.type;return ye===x?ie($,z,q.props.children,se,q.key):z!==null&&(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Z&&d1(ye)===z.type)?(z=g(z,q.props),Ko(z,q),z.return=$,z):(z=Rl(q.type,q.key,q.props,null,$.mode,se),Ko(z,q),z.return=$,z)}function K($,z,q,se){return z===null||z.tag!==4||z.stateNode.containerInfo!==q.containerInfo||z.stateNode.implementation!==q.implementation?(z=If(q,$.mode,se),z.return=$,z):(z=g(z,q.children||[]),z.return=$,z)}function ie($,z,q,se,ye){return z===null||z.tag!==7?(z=ds(q,$.mode,se,ye),z.return=$,z):(z=g(z,q),z.return=$,z)}function oe($,z,q){if(typeof z=="string"&&z!==""||typeof z=="number"||typeof z=="bigint")return z=Of(""+z,$.mode,q),z.return=$,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case y:return q=Rl(z.type,z.key,z.props,null,$.mode,q),Ko(q,z),q.return=$,q;case v:return z=If(z,$.mode,q),z.return=$,z;case Z:var se=z._init;return z=se(z._payload),oe($,z,q)}if(Se(z)||_e(z))return z=ds(z,$.mode,q,null),z.return=$,z;if(typeof z.then=="function")return oe($,Wl(z),q);if(z.$$typeof===R)return oe($,Il($,z),q);Xl($,z)}return null}function J($,z,q,se){var ye=z!==null?z.key:null;if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return ye!==null?null:T($,z,""+q,se);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case y:return q.key===ye?k($,z,q,se):null;case v:return q.key===ye?K($,z,q,se):null;case Z:return ye=q._init,q=ye(q._payload),J($,z,q,se)}if(Se(q)||_e(q))return ye!==null?null:ie($,z,q,se,null);if(typeof q.then=="function")return J($,z,Wl(q),se);if(q.$$typeof===R)return J($,z,Il($,q),se);Xl($,q)}return null}function te($,z,q,se,ye){if(typeof se=="string"&&se!==""||typeof se=="number"||typeof se=="bigint")return $=$.get(q)||null,T(z,$,""+se,ye);if(typeof se=="object"&&se!==null){switch(se.$$typeof){case y:return $=$.get(se.key===null?q:se.key)||null,k(z,$,se,ye);case v:return $=$.get(se.key===null?q:se.key)||null,K(z,$,se,ye);case Z:var Ne=se._init;return se=Ne(se._payload),te($,z,q,se,ye)}if(Se(se)||_e(se))return $=$.get(q)||null,ie(z,$,se,ye,null);if(typeof se.then=="function")return te($,z,q,Wl(se),ye);if(se.$$typeof===R)return te($,z,q,Il(z,se),ye);Xl(z,se)}return null}function Re($,z,q,se){for(var ye=null,Ne=null,we=z,Ee=z=0,Ct=null;we!==null&&Ee<q.length;Ee++){we.index>Ee?(Ct=we,we=null):Ct=we.sibling;var Ve=J($,we,q[Ee],se);if(Ve===null){we===null&&(we=Ct);break}r&&we&&Ve.alternate===null&&a($,we),z=m(Ve,z,Ee),Ne===null?ye=Ve:Ne.sibling=Ve,Ne=Ve,we=Ct}if(Ee===q.length)return u($,we),He&&gs($,Ee),ye;if(we===null){for(;Ee<q.length;Ee++)we=oe($,q[Ee],se),we!==null&&(z=m(we,z,Ee),Ne===null?ye=we:Ne.sibling=we,Ne=we);return He&&gs($,Ee),ye}for(we=h(we);Ee<q.length;Ee++)Ct=te(we,$,Ee,q[Ee],se),Ct!==null&&(r&&Ct.alternate!==null&&we.delete(Ct.key===null?Ee:Ct.key),z=m(Ct,z,Ee),Ne===null?ye=Ct:Ne.sibling=Ct,Ne=Ct);return r&&we.forEach(function(Yi){return a($,Yi)}),He&&gs($,Ee),ye}function Ae($,z,q,se){if(q==null)throw Error(i(151));for(var ye=null,Ne=null,we=z,Ee=z=0,Ct=null,Ve=q.next();we!==null&&!Ve.done;Ee++,Ve=q.next()){we.index>Ee?(Ct=we,we=null):Ct=we.sibling;var Yi=J($,we,Ve.value,se);if(Yi===null){we===null&&(we=Ct);break}r&&we&&Yi.alternate===null&&a($,we),z=m(Yi,z,Ee),Ne===null?ye=Yi:Ne.sibling=Yi,Ne=Yi,we=Ct}if(Ve.done)return u($,we),He&&gs($,Ee),ye;if(we===null){for(;!Ve.done;Ee++,Ve=q.next())Ve=oe($,Ve.value,se),Ve!==null&&(z=m(Ve,z,Ee),Ne===null?ye=Ve:Ne.sibling=Ve,Ne=Ve);return He&&gs($,Ee),ye}for(we=h(we);!Ve.done;Ee++,Ve=q.next())Ve=te(we,$,Ee,Ve.value,se),Ve!==null&&(r&&Ve.alternate!==null&&we.delete(Ve.key===null?Ee:Ve.key),z=m(Ve,z,Ee),Ne===null?ye=Ve:Ne.sibling=Ve,Ne=Ve);return r&&we.forEach(function(q9){return a($,q9)}),He&&gs($,Ee),ye}function Ge($,z,q,se){if(typeof q=="object"&&q!==null&&q.type===x&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case y:e:{for(var ye=q.key;z!==null;){if(z.key===ye){if(ye=q.type,ye===x){if(z.tag===7){u($,z.sibling),se=g(z,q.props.children),se.return=$,$=se;break e}}else if(z.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===Z&&d1(ye)===z.type){u($,z.sibling),se=g(z,q.props),Ko(se,q),se.return=$,$=se;break e}u($,z);break}else a($,z);z=z.sibling}q.type===x?(se=ds(q.props.children,$.mode,se,q.key),se.return=$,$=se):(se=Rl(q.type,q.key,q.props,null,$.mode,se),Ko(se,q),se.return=$,$=se)}return b($);case v:e:{for(ye=q.key;z!==null;){if(z.key===ye)if(z.tag===4&&z.stateNode.containerInfo===q.containerInfo&&z.stateNode.implementation===q.implementation){u($,z.sibling),se=g(z,q.children||[]),se.return=$,$=se;break e}else{u($,z);break}else a($,z);z=z.sibling}se=If(q,$.mode,se),se.return=$,$=se}return b($);case Z:return ye=q._init,q=ye(q._payload),Ge($,z,q,se)}if(Se(q))return Re($,z,q,se);if(_e(q)){if(ye=_e(q),typeof ye!="function")throw Error(i(150));return q=ye.call(q),Ae($,z,q,se)}if(typeof q.then=="function")return Ge($,z,Wl(q),se);if(q.$$typeof===R)return Ge($,z,Il($,q),se);Xl($,q)}return typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint"?(q=""+q,z!==null&&z.tag===6?(u($,z.sibling),se=g(z,q),se.return=$,$=se):(u($,z),se=Of(q,$.mode,se),se.return=$,$=se),b($)):u($,z)}return function($,z,q,se){try{Zo=0;var ye=Ge($,z,q,se);return vr=null,ye}catch(we){if(we===zo||we===kl)throw we;var Ne=en(29,we,null,$.mode);return Ne.lanes=se,Ne.return=$,Ne}finally{}}}var xr=p1(!0),g1=p1(!1),yn=F(null),Fn=null;function Ii(r){var a=r.alternate;G(bt,bt.current&1),G(yn,r),Fn===null&&(a===null||mr.current!==null||a.memoizedState!==null)&&(Fn=r)}function m1(r){if(r.tag===22){if(G(bt,bt.current),G(yn,r),Fn===null){var a=r.alternate;a!==null&&a.memoizedState!==null&&(Fn=r)}}else Ni()}function Ni(){G(bt,bt.current),G(yn,yn.current)}function ri(r){X(yn),Fn===r&&(Fn=null),X(bt)}var bt=F(0);function Yl(r){for(var a=r;a!==null;){if(a.tag===13){var u=a.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||ed(u)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if((a.flags&128)!==0)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}function fh(r,a,u,h){a=r.memoizedState,u=u(h,a),u=u==null?a:p({},a,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var hh={enqueueSetState:function(r,a,u){r=r._reactInternals;var h=rn(),g=Mi(h);g.payload=a,u!=null&&(g.callback=u),a=Pi(r,g,h),a!==null&&(on(a,r,h),Vo(a,r,h))},enqueueReplaceState:function(r,a,u){r=r._reactInternals;var h=rn(),g=Mi(h);g.tag=1,g.payload=a,u!=null&&(g.callback=u),a=Pi(r,g,h),a!==null&&(on(a,r,h),Vo(a,r,h))},enqueueForceUpdate:function(r,a){r=r._reactInternals;var u=rn(),h=Mi(u);h.tag=2,a!=null&&(h.callback=a),a=Pi(r,h,u),a!==null&&(on(a,r,u),Vo(a,r,u))}};function _1(r,a,u,h,g,m,b){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(h,m,b):a.prototype&&a.prototype.isPureReactComponent?!Io(u,h)||!Io(g,m):!0}function y1(r,a,u,h){r=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(u,h),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(u,h),a.state!==r&&hh.enqueueReplaceState(a,a.state,null)}function Ts(r,a){var u=a;if("ref"in a){u={};for(var h in a)h!=="ref"&&(u[h]=a[h])}if(r=r.defaultProps){u===a&&(u=p({},u));for(var g in r)u[g]===void 0&&(u[g]=r[g])}return u}var ql=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var a=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(a))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function b1(r){ql(r)}function v1(r){console.error(r)}function x1(r){ql(r)}function Zl(r,a){try{var u=r.onUncaughtError;u(a.value,{componentStack:a.stack})}catch(h){setTimeout(function(){throw h})}}function T1(r,a,u){try{var h=r.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:a.tag===1?a.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function dh(r,a,u){return u=Mi(u),u.tag=3,u.payload={element:null},u.callback=function(){Zl(r,a)},u}function w1(r){return r=Mi(r),r.tag=3,r}function S1(r,a,u,h){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var m=h.value;r.payload=function(){return g(m)},r.callback=function(){T1(a,u,h)}}var b=u.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(r.callback=function(){T1(a,u,h),typeof g!="function"&&(Fi===null?Fi=new Set([this]):Fi.add(this));var T=h.stack;this.componentDidCatch(h.value,{componentStack:T!==null?T:""})})}function q6(r,a,u,h,g){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(a=u.alternate,a!==null&&Bo(a,u,g,!0),u=yn.current,u!==null){switch(u.tag){case 13:return Fn===null?Bh():u.alternate===null&&lt===0&&(lt=3),u.flags&=-257,u.flags|=65536,u.lanes=g,h===Vf?u.flags|=16384:(a=u.updateQueue,a===null?u.updateQueue=new Set([h]):a.add(h),Fh(r,h,g)),!1;case 22:return u.flags|=65536,h===Vf?u.flags|=16384:(a=u.updateQueue,a===null?(a={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=a):(u=a.retryQueue,u===null?a.retryQueue=new Set([h]):u.add(h)),Fh(r,h,g)),!1}throw Error(i(435,u.tag))}return Fh(r,h,g),Bh(),!1}if(He)return a=yn.current,a!==null?((a.flags&65536)===0&&(a.flags|=256),a.flags|=65536,a.lanes=g,h!==Df&&(r=Error(i(422),{cause:h}),Lo(pn(r,u)))):(h!==Df&&(a=Error(i(423),{cause:h}),Lo(pn(a,u))),r=r.current.alternate,r.flags|=65536,g&=-g,r.lanes|=g,h=pn(h,u),g=dh(r.stateNode,h,g),Wf(r,g),lt!==4&&(lt=2)),!1;var m=Error(i(520),{cause:h});if(m=pn(m,u),ia===null?ia=[m]:ia.push(m),lt!==4&&(lt=2),a===null)return!0;h=pn(h,u),u=a;do{switch(u.tag){case 3:return u.flags|=65536,r=g&-g,u.lanes|=r,r=dh(u.stateNode,h,r),Wf(u,r),!1;case 1:if(a=u.type,m=u.stateNode,(u.flags&128)===0&&(typeof a.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Fi===null||!Fi.has(m))))return u.flags|=65536,g&=-g,u.lanes|=g,g=w1(g),S1(g,r,u,h),Wf(u,g),!1}u=u.return}while(u!==null);return!1}var A1=Error(i(461)),At=!1;function Pt(r,a,u,h){a.child=r===null?g1(a,null,u,h):xr(a,r.child,u,h)}function E1(r,a,u,h,g){u=u.render;var m=a.ref;if("ref"in h){var b={};for(var T in h)T!=="ref"&&(b[T]=h[T])}else b=h;return bs(a),h=Kf(r,a,u,b,m,g),T=Gf(),r!==null&&!At?(Qf(r,a,g),oi(r,a,g)):(He&&T&&Nf(a),a.flags|=1,Pt(r,a,h,g),a.child)}function C1(r,a,u,h,g){if(r===null){var m=u.type;return typeof m=="function"&&!Pf(m)&&m.defaultProps===void 0&&u.compare===null?(a.tag=15,a.type=m,R1(r,a,m,h,g)):(r=Rl(u.type,null,h,a,a.mode,g),r.ref=a.ref,r.return=a,a.child=r)}if(m=r.child,!xh(r,g)){var b=m.memoizedProps;if(u=u.compare,u=u!==null?u:Io,u(b,h)&&r.ref===a.ref)return oi(r,a,g)}return a.flags|=1,r=Jn(m,h),r.ref=a.ref,r.return=a,a.child=r}function R1(r,a,u,h,g){if(r!==null){var m=r.memoizedProps;if(Io(m,h)&&r.ref===a.ref)if(At=!1,a.pendingProps=h=m,xh(r,g))(r.flags&131072)!==0&&(At=!0);else return a.lanes=r.lanes,oi(r,a,g)}return ph(r,a,u,h,g)}function M1(r,a,u){var h=a.pendingProps,g=h.children,m=r!==null?r.memoizedState:null;if(h.mode==="hidden"){if((a.flags&128)!==0){if(h=m!==null?m.baseLanes|u:u,r!==null){for(g=a.child=r.child,m=0;g!==null;)m=m|g.lanes|g.childLanes,g=g.sibling;a.childLanes=m&~h}else a.childLanes=0,a.child=null;return P1(r,a,h,u)}if((u&536870912)!==0)a.memoizedState={baseLanes:0,cachePool:null},r!==null&&Nl(a,m!==null?m.cachePool:null),m!==null?R3(a,m):Yf(),m1(a);else return a.lanes=a.childLanes=536870912,P1(r,a,m!==null?m.baseLanes|u:u,u)}else m!==null?(Nl(a,m.cachePool),R3(a,m),Ni(),a.memoizedState=null):(r!==null&&Nl(a,null),Yf(),Ni());return Pt(r,a,g,u),a.child}function P1(r,a,u,h){var g=jf();return g=g===null?null:{parent:yt._currentValue,pool:g},a.memoizedState={baseLanes:u,cachePool:g},r!==null&&Nl(a,null),Yf(),m1(a),r!==null&&Bo(r,a,h,!0),null}function Kl(r,a){var u=a.ref;if(u===null)r!==null&&r.ref!==null&&(a.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(r===null||r.ref!==u)&&(a.flags|=4194816)}}function ph(r,a,u,h,g){return bs(a),u=Kf(r,a,u,h,void 0,g),h=Gf(),r!==null&&!At?(Qf(r,a,g),oi(r,a,g)):(He&&h&&Nf(a),a.flags|=1,Pt(r,a,u,g),a.child)}function O1(r,a,u,h,g,m){return bs(a),a.updateQueue=null,u=P3(a,h,u,g),M3(r),h=Gf(),r!==null&&!At?(Qf(r,a,m),oi(r,a,m)):(He&&h&&Nf(a),a.flags|=1,Pt(r,a,u,m),a.child)}function I1(r,a,u,h,g){if(bs(a),a.stateNode===null){var m=fr,b=u.contextType;typeof b=="object"&&b!==null&&(m=kt(b)),m=new u(h,m),a.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=hh,a.stateNode=m,m._reactInternals=a,m=a.stateNode,m.props=h,m.state=a.memoizedState,m.refs={},Hf(a),b=u.contextType,m.context=typeof b=="object"&&b!==null?kt(b):fr,m.state=a.memoizedState,b=u.getDerivedStateFromProps,typeof b=="function"&&(fh(a,u,b,h),m.state=a.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(b=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),b!==m.state&&hh.enqueueReplaceState(m,m.state,null),$o(a,h,m,g),Ho(),m.state=a.memoizedState),typeof m.componentDidMount=="function"&&(a.flags|=4194308),h=!0}else if(r===null){m=a.stateNode;var T=a.memoizedProps,k=Ts(u,T);m.props=k;var K=m.context,ie=u.contextType;b=fr,typeof ie=="object"&&ie!==null&&(b=kt(ie));var oe=u.getDerivedStateFromProps;ie=typeof oe=="function"||typeof m.getSnapshotBeforeUpdate=="function",T=a.pendingProps!==T,ie||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(T||K!==b)&&y1(a,m,h,b),Ri=!1;var J=a.memoizedState;m.state=J,$o(a,h,m,g),Ho(),K=a.memoizedState,T||J!==K||Ri?(typeof oe=="function"&&(fh(a,u,oe,h),K=a.memoizedState),(k=Ri||_1(a,u,k,h,J,K,b))?(ie||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(a.flags|=4194308)):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=h,a.memoizedState=K),m.props=h,m.state=K,m.context=b,h=k):(typeof m.componentDidMount=="function"&&(a.flags|=4194308),h=!1)}else{m=a.stateNode,$f(r,a),b=a.memoizedProps,ie=Ts(u,b),m.props=ie,oe=a.pendingProps,J=m.context,K=u.contextType,k=fr,typeof K=="object"&&K!==null&&(k=kt(K)),T=u.getDerivedStateFromProps,(K=typeof T=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(b!==oe||J!==k)&&y1(a,m,h,k),Ri=!1,J=a.memoizedState,m.state=J,$o(a,h,m,g),Ho();var te=a.memoizedState;b!==oe||J!==te||Ri||r!==null&&r.dependencies!==null&&Ol(r.dependencies)?(typeof T=="function"&&(fh(a,u,T,h),te=a.memoizedState),(ie=Ri||_1(a,u,ie,h,J,te,k)||r!==null&&r.dependencies!==null&&Ol(r.dependencies))?(K||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(h,te,k),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(h,te,k)),typeof m.componentDidUpdate=="function"&&(a.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof m.componentDidUpdate!="function"||b===r.memoizedProps&&J===r.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&J===r.memoizedState||(a.flags|=1024),a.memoizedProps=h,a.memoizedState=te),m.props=h,m.state=te,m.context=k,h=ie):(typeof m.componentDidUpdate!="function"||b===r.memoizedProps&&J===r.memoizedState||(a.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||b===r.memoizedProps&&J===r.memoizedState||(a.flags|=1024),h=!1)}return m=h,Kl(r,a),h=(a.flags&128)!==0,m||h?(m=a.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:m.render(),a.flags|=1,r!==null&&h?(a.child=xr(a,r.child,null,g),a.child=xr(a,null,u,g)):Pt(r,a,u,g),a.memoizedState=m.state,r=a.child):r=oi(r,a,g),r}function N1(r,a,u,h){return Do(),a.flags|=256,Pt(r,a,u,h),a.child}var gh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function mh(r){return{baseLanes:r,cachePool:v3()}}function _h(r,a,u){return r=r!==null?r.childLanes&~u:0,a&&(r|=bn),r}function k1(r,a,u){var h=a.pendingProps,g=!1,m=(a.flags&128)!==0,b;if((b=m)||(b=r!==null&&r.memoizedState===null?!1:(bt.current&2)!==0),b&&(g=!0,a.flags&=-129),b=(a.flags&32)!==0,a.flags&=-33,r===null){if(He){if(g?Ii(a):Ni(),He){var T=at,k;if(k=T){e:{for(k=T,T=Un;k.nodeType!==8;){if(!T){T=null;break e}if(k=Mn(k.nextSibling),k===null){T=null;break e}}T=k}T!==null?(a.memoizedState={dehydrated:T,treeContext:ps!==null?{id:ei,overflow:ti}:null,retryLane:536870912,hydrationErrors:null},k=en(18,null,null,0),k.stateNode=T,k.return=a,a.child=k,zt=a,at=null,k=!0):k=!1}k||_s(a)}if(T=a.memoizedState,T!==null&&(T=T.dehydrated,T!==null))return ed(T)?a.lanes=32:a.lanes=536870912,null;ri(a)}return T=h.children,h=h.fallback,g?(Ni(),g=a.mode,T=Gl({mode:"hidden",children:T},g),h=ds(h,g,u,null),T.return=a,h.return=a,T.sibling=h,a.child=T,g=a.child,g.memoizedState=mh(u),g.childLanes=_h(r,b,u),a.memoizedState=gh,h):(Ii(a),yh(a,T))}if(k=r.memoizedState,k!==null&&(T=k.dehydrated,T!==null)){if(m)a.flags&256?(Ii(a),a.flags&=-257,a=bh(r,a,u)):a.memoizedState!==null?(Ni(),a.child=r.child,a.flags|=128,a=null):(Ni(),g=h.fallback,T=a.mode,h=Gl({mode:"visible",children:h.children},T),g=ds(g,T,u,null),g.flags|=2,h.return=a,g.return=a,h.sibling=g,a.child=h,xr(a,r.child,null,u),h=a.child,h.memoizedState=mh(u),h.childLanes=_h(r,b,u),a.memoizedState=gh,a=g);else if(Ii(a),ed(T)){if(b=T.nextSibling&&T.nextSibling.dataset,b)var K=b.dgst;b=K,h=Error(i(419)),h.stack="",h.digest=b,Lo({value:h,source:null,stack:null}),a=bh(r,a,u)}else if(At||Bo(r,a,u,!1),b=(u&r.childLanes)!==0,At||b){if(b=nt,b!==null&&(h=u&-u,h=(h&42)!==0?1:ef(h),h=(h&(b.suspendedLanes|u))!==0?0:h,h!==0&&h!==k.retryLane))throw k.retryLane=h,ur(r,h),on(b,r,h),A1;T.data==="$?"||Bh(),a=bh(r,a,u)}else T.data==="$?"?(a.flags|=192,a.child=r.child,a=null):(r=k.treeContext,at=Mn(T.nextSibling),zt=a,He=!0,ms=null,Un=!1,r!==null&&(mn[_n++]=ei,mn[_n++]=ti,mn[_n++]=ps,ei=r.id,ti=r.overflow,ps=a),a=yh(a,h.children),a.flags|=4096);return a}return g?(Ni(),g=h.fallback,T=a.mode,k=r.child,K=k.sibling,h=Jn(k,{mode:"hidden",children:h.children}),h.subtreeFlags=k.subtreeFlags&65011712,K!==null?g=Jn(K,g):(g=ds(g,T,u,null),g.flags|=2),g.return=a,h.return=a,h.sibling=g,a.child=h,h=g,g=a.child,T=r.child.memoizedState,T===null?T=mh(u):(k=T.cachePool,k!==null?(K=yt._currentValue,k=k.parent!==K?{parent:K,pool:K}:k):k=v3(),T={baseLanes:T.baseLanes|u,cachePool:k}),g.memoizedState=T,g.childLanes=_h(r,b,u),a.memoizedState=gh,h):(Ii(a),u=r.child,r=u.sibling,u=Jn(u,{mode:"visible",children:h.children}),u.return=a,u.sibling=null,r!==null&&(b=a.deletions,b===null?(a.deletions=[r],a.flags|=16):b.push(r)),a.child=u,a.memoizedState=null,u)}function yh(r,a){return a=Gl({mode:"visible",children:a},r.mode),a.return=r,r.child=a}function Gl(r,a){return r=en(22,r,null,a),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function bh(r,a,u){return xr(a,r.child,null,u),r=yh(a,a.pendingProps.children),r.flags|=2,a.memoizedState=null,r}function D1(r,a,u){r.lanes|=a;var h=r.alternate;h!==null&&(h.lanes|=a),Bf(r.return,a,u)}function vh(r,a,u,h,g){var m=r.memoizedState;m===null?r.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:g}:(m.isBackwards=a,m.rendering=null,m.renderingStartTime=0,m.last=h,m.tail=u,m.tailMode=g)}function L1(r,a,u){var h=a.pendingProps,g=h.revealOrder,m=h.tail;if(Pt(r,a,h.children,u),h=bt.current,(h&2)!==0)h=h&1|2,a.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=a.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&D1(r,u,a);else if(r.tag===19)D1(r,u,a);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===a)break e;for(;r.sibling===null;){if(r.return===null||r.return===a)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}h&=1}switch(G(bt,h),g){case"forwards":for(u=a.child,g=null;u!==null;)r=u.alternate,r!==null&&Yl(r)===null&&(g=u),u=u.sibling;u=g,u===null?(g=a.child,a.child=null):(g=u.sibling,u.sibling=null),vh(a,!1,g,u,m);break;case"backwards":for(u=null,g=a.child,a.child=null;g!==null;){if(r=g.alternate,r!==null&&Yl(r)===null){a.child=g;break}r=g.sibling,g.sibling=u,u=g,g=r}vh(a,!0,u,null,m);break;case"together":vh(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function oi(r,a,u){if(r!==null&&(a.dependencies=r.dependencies),Ui|=a.lanes,(u&a.childLanes)===0)if(r!==null){if(Bo(r,a,u,!1),(u&a.childLanes)===0)return null}else return null;if(r!==null&&a.child!==r.child)throw Error(i(153));if(a.child!==null){for(r=a.child,u=Jn(r,r.pendingProps),a.child=u,u.return=a;r.sibling!==null;)r=r.sibling,u=u.sibling=Jn(r,r.pendingProps),u.return=a;u.sibling=null}return a.child}function xh(r,a){return(r.lanes&a)!==0?!0:(r=r.dependencies,!!(r!==null&&Ol(r)))}function Z6(r,a,u){switch(a.tag){case 3:Te(a,a.stateNode.containerInfo),Ci(a,yt,r.memoizedState.cache),Do();break;case 27:case 5:Be(a);break;case 4:Te(a,a.stateNode.containerInfo);break;case 10:Ci(a,a.type,a.memoizedProps.value);break;case 13:var h=a.memoizedState;if(h!==null)return h.dehydrated!==null?(Ii(a),a.flags|=128,null):(u&a.child.childLanes)!==0?k1(r,a,u):(Ii(a),r=oi(r,a,u),r!==null?r.sibling:null);Ii(a);break;case 19:var g=(r.flags&128)!==0;if(h=(u&a.childLanes)!==0,h||(Bo(r,a,u,!1),h=(u&a.childLanes)!==0),g){if(h)return L1(r,a,u);a.flags|=128}if(g=a.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),G(bt,bt.current),h)break;return null;case 22:case 23:return a.lanes=0,M1(r,a,u);case 24:Ci(a,yt,r.memoizedState.cache)}return oi(r,a,u)}function B1(r,a,u){if(r!==null)if(r.memoizedProps!==a.pendingProps)At=!0;else{if(!xh(r,u)&&(a.flags&128)===0)return At=!1,Z6(r,a,u);At=(r.flags&131072)!==0}else At=!1,He&&(a.flags&1048576)!==0&&d3(a,Pl,a.index);switch(a.lanes=0,a.tag){case 16:e:{r=a.pendingProps;var h=a.elementType,g=h._init;if(h=g(h._payload),a.type=h,typeof h=="function")Pf(h)?(r=Ts(h,r),a.tag=1,a=I1(null,a,h,r,u)):(a.tag=0,a=ph(null,a,h,r,u));else{if(h!=null){if(g=h.$$typeof,g===D){a.tag=11,a=E1(null,a,h,r,u);break e}else if(g===ce){a.tag=14,a=C1(null,a,h,r,u);break e}}throw a=ue(h)||h,Error(i(306,a,""))}}return a;case 0:return ph(r,a,a.type,a.pendingProps,u);case 1:return h=a.type,g=Ts(h,a.pendingProps),I1(r,a,h,g,u);case 3:e:{if(Te(a,a.stateNode.containerInfo),r===null)throw Error(i(387));h=a.pendingProps;var m=a.memoizedState;g=m.element,$f(r,a),$o(a,h,null,u);var b=a.memoizedState;if(h=b.cache,Ci(a,yt,h),h!==m.cache&&Uf(a,[yt],u,!0),Ho(),h=b.element,m.isDehydrated)if(m={element:h,isDehydrated:!1,cache:b.cache},a.updateQueue.baseState=m,a.memoizedState=m,a.flags&256){a=N1(r,a,h,u);break e}else if(h!==g){g=pn(Error(i(424)),a),Lo(g),a=N1(r,a,h,u);break e}else{switch(r=a.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(at=Mn(r.firstChild),zt=a,He=!0,ms=null,Un=!0,u=g1(a,null,h,u),a.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Do(),h===g){a=oi(r,a,u);break e}Pt(r,a,h,u)}a=a.child}return a;case 26:return Kl(r,a),r===null?(u=jm(a.type,null,a.pendingProps,null))?a.memoizedState=u:He||(u=a.type,r=a.pendingProps,h=fc(me.current).createElement(u),h[Nt]=a,h[Wt]=r,It(h,u,r),St(h),a.stateNode=h):a.memoizedState=jm(a.type,r.memoizedProps,a.pendingProps,r.memoizedState),null;case 27:return Be(a),r===null&&He&&(h=a.stateNode=Um(a.type,a.pendingProps,me.current),zt=a,Un=!0,g=at,Vi(a.type)?(td=g,at=Mn(h.firstChild)):at=g),Pt(r,a,a.pendingProps.children,u),Kl(r,a),r===null&&(a.flags|=4194304),a.child;case 5:return r===null&&He&&((g=h=at)&&(h=w9(h,a.type,a.pendingProps,Un),h!==null?(a.stateNode=h,zt=a,at=Mn(h.firstChild),Un=!1,g=!0):g=!1),g||_s(a)),Be(a),g=a.type,m=a.pendingProps,b=r!==null?r.memoizedProps:null,h=m.children,Gh(g,m)?h=null:b!==null&&Gh(g,b)&&(a.flags|=32),a.memoizedState!==null&&(g=Kf(r,a,j6,null,null,u),ha._currentValue=g),Kl(r,a),Pt(r,a,h,u),a.child;case 6:return r===null&&He&&((r=u=at)&&(u=S9(u,a.pendingProps,Un),u!==null?(a.stateNode=u,zt=a,at=null,r=!0):r=!1),r||_s(a)),null;case 13:return k1(r,a,u);case 4:return Te(a,a.stateNode.containerInfo),h=a.pendingProps,r===null?a.child=xr(a,null,h,u):Pt(r,a,h,u),a.child;case 11:return E1(r,a,a.type,a.pendingProps,u);case 7:return Pt(r,a,a.pendingProps,u),a.child;case 8:return Pt(r,a,a.pendingProps.children,u),a.child;case 12:return Pt(r,a,a.pendingProps.children,u),a.child;case 10:return h=a.pendingProps,Ci(a,a.type,h.value),Pt(r,a,h.children,u),a.child;case 9:return g=a.type._context,h=a.pendingProps.children,bs(a),g=kt(g),h=h(g),a.flags|=1,Pt(r,a,h,u),a.child;case 14:return C1(r,a,a.type,a.pendingProps,u);case 15:return R1(r,a,a.type,a.pendingProps,u);case 19:return L1(r,a,u);case 31:return h=a.pendingProps,u=a.mode,h={mode:h.mode,children:h.children},r===null?(u=Gl(h,u),u.ref=a.ref,a.child=u,u.return=a,a=u):(u=Jn(r.child,h),u.ref=a.ref,a.child=u,u.return=a,a=u),a;case 22:return M1(r,a,u);case 24:return bs(a),h=kt(yt),r===null?(g=jf(),g===null&&(g=nt,m=Ff(),g.pooledCache=m,m.refCount++,m!==null&&(g.pooledCacheLanes|=u),g=m),a.memoizedState={parent:h,cache:g},Hf(a),Ci(a,yt,g)):((r.lanes&u)!==0&&($f(r,a),$o(a,null,null,u),Ho()),g=r.memoizedState,m=a.memoizedState,g.parent!==h?(g={parent:h,cache:h},a.memoizedState=g,a.lanes===0&&(a.memoizedState=a.updateQueue.baseState=g),Ci(a,yt,h)):(h=m.cache,Ci(a,yt,h),h!==g.cache&&Uf(a,[yt],u,!0))),Pt(r,a,a.pendingProps.children,u),a.child;case 29:throw a.pendingProps}throw Error(i(156,a.tag))}function ai(r){r.flags|=4}function U1(r,a){if(a.type!=="stylesheet"||(a.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Xm(a)){if(a=yn.current,a!==null&&((Ue&4194048)===Ue?Fn!==null:(Ue&62914560)!==Ue&&(Ue&536870912)===0||a!==Fn))throw jo=Vf,x3;r.flags|=8192}}function Ql(r,a){a!==null&&(r.flags|=4),r.flags&16384&&(a=r.tag!==22?m2():536870912,r.lanes|=a,Ar|=a)}function Go(r,a){if(!He)switch(r.tailMode){case"hidden":a=r.tail;for(var u=null;a!==null;)a.alternate!==null&&(u=a),a=a.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?a||r.tail===null?r.tail=null:r.tail.sibling=null:h.sibling=null}}function rt(r){var a=r.alternate!==null&&r.alternate.child===r.child,u=0,h=0;if(a)for(var g=r.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=r,g=g.sibling;else for(g=r.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=r,g=g.sibling;return r.subtreeFlags|=h,r.childLanes=u,a}function K6(r,a,u){var h=a.pendingProps;switch(kf(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rt(a),null;case 1:return rt(a),null;case 3:return u=a.stateNode,h=null,r!==null&&(h=r.memoizedState.cache),a.memoizedState.cache!==h&&(a.flags|=2048),ii(yt),We(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(ko(a)?ai(a):r===null||r.memoizedState.isDehydrated&&(a.flags&256)===0||(a.flags|=1024,m3())),rt(a),null;case 26:return u=a.memoizedState,r===null?(ai(a),u!==null?(rt(a),U1(a,u)):(rt(a),a.flags&=-16777217)):u?u!==r.memoizedState?(ai(a),rt(a),U1(a,u)):(rt(a),a.flags&=-16777217):(r.memoizedProps!==h&&ai(a),rt(a),a.flags&=-16777217),null;case 27:Ht(a),u=me.current;var g=a.type;if(r!==null&&a.stateNode!=null)r.memoizedProps!==h&&ai(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return rt(a),null}r=ae.current,ko(a)?p3(a):(r=Um(g,h,u),a.stateNode=r,ai(a))}return rt(a),null;case 5:if(Ht(a),u=a.type,r!==null&&a.stateNode!=null)r.memoizedProps!==h&&ai(a);else{if(!h){if(a.stateNode===null)throw Error(i(166));return rt(a),null}if(r=ae.current,ko(a))p3(a);else{switch(g=fc(me.current),r){case 1:r=g.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:r=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":r=g.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":r=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":r=g.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?r.multiple=!0:h.size&&(r.size=h.size);break;default:r=typeof h.is=="string"?g.createElement(u,{is:h.is}):g.createElement(u)}}r[Nt]=a,r[Wt]=h;e:for(g=a.child;g!==null;){if(g.tag===5||g.tag===6)r.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===a)break e;for(;g.sibling===null;){if(g.return===null||g.return===a)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}a.stateNode=r;e:switch(It(r,u,h),u){case"button":case"input":case"select":case"textarea":r=!!h.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&ai(a)}}return rt(a),a.flags&=-16777217,null;case 6:if(r&&a.stateNode!=null)r.memoizedProps!==h&&ai(a);else{if(typeof h!="string"&&a.stateNode===null)throw Error(i(166));if(r=me.current,ko(a)){if(r=a.stateNode,u=a.memoizedProps,h=null,g=zt,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}r[Nt]=a,r=!!(r.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||Om(r.nodeValue,u)),r||_s(a)}else r=fc(r).createTextNode(h),r[Nt]=a,a.stateNode=r}return rt(a),null;case 13:if(h=a.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(g=ko(a),h!==null&&h.dehydrated!==null){if(r===null){if(!g)throw Error(i(318));if(g=a.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[Nt]=a}else Do(),(a.flags&128)===0&&(a.memoizedState=null),a.flags|=4;rt(a),g=!1}else g=m3(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=g),g=!0;if(!g)return a.flags&256?(ri(a),a):(ri(a),null)}if(ri(a),(a.flags&128)!==0)return a.lanes=u,a;if(u=h!==null,r=r!==null&&r.memoizedState!==null,u){h=a.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var m=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(m=h.memoizedState.cachePool.pool),m!==g&&(h.flags|=2048)}return u!==r&&u&&(a.child.flags|=8192),Ql(a,a.updateQueue),rt(a),null;case 4:return We(),r===null&&Xh(a.stateNode.containerInfo),rt(a),null;case 10:return ii(a.type),rt(a),null;case 19:if(X(bt),g=a.memoizedState,g===null)return rt(a),null;if(h=(a.flags&128)!==0,m=g.rendering,m===null)if(h)Go(g,!1);else{if(lt!==0||r!==null&&(r.flags&128)!==0)for(r=a.child;r!==null;){if(m=Yl(r),m!==null){for(a.flags|=128,Go(g,!1),r=m.updateQueue,a.updateQueue=r,Ql(a,r),a.subtreeFlags=0,r=u,u=a.child;u!==null;)h3(u,r),u=u.sibling;return G(bt,bt.current&1|2),a.child}r=r.sibling}g.tail!==null&&Bn()>tc&&(a.flags|=128,h=!0,Go(g,!1),a.lanes=4194304)}else{if(!h)if(r=Yl(m),r!==null){if(a.flags|=128,h=!0,r=r.updateQueue,a.updateQueue=r,Ql(a,r),Go(g,!0),g.tail===null&&g.tailMode==="hidden"&&!m.alternate&&!He)return rt(a),null}else 2*Bn()-g.renderingStartTime>tc&&u!==536870912&&(a.flags|=128,h=!0,Go(g,!1),a.lanes=4194304);g.isBackwards?(m.sibling=a.child,a.child=m):(r=g.last,r!==null?r.sibling=m:a.child=m,g.last=m)}return g.tail!==null?(a=g.tail,g.rendering=a,g.tail=a.sibling,g.renderingStartTime=Bn(),a.sibling=null,r=bt.current,G(bt,h?r&1|2:r&1),a):(rt(a),null);case 22:case 23:return ri(a),qf(),h=a.memoizedState!==null,r!==null?r.memoizedState!==null!==h&&(a.flags|=8192):h&&(a.flags|=8192),h?(u&536870912)!==0&&(a.flags&128)===0&&(rt(a),a.subtreeFlags&6&&(a.flags|=8192)):rt(a),u=a.updateQueue,u!==null&&Ql(a,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),h=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(h=a.memoizedState.cachePool.pool),h!==u&&(a.flags|=2048),r!==null&&X(vs),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),a.memoizedState.cache!==u&&(a.flags|=2048),ii(yt),rt(a),null;case 25:return null;case 30:return null}throw Error(i(156,a.tag))}function G6(r,a){switch(kf(a),a.tag){case 1:return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 3:return ii(yt),We(),r=a.flags,(r&65536)!==0&&(r&128)===0?(a.flags=r&-65537|128,a):null;case 26:case 27:case 5:return Ht(a),null;case 13:if(ri(a),r=a.memoizedState,r!==null&&r.dehydrated!==null){if(a.alternate===null)throw Error(i(340));Do()}return r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 19:return X(bt),null;case 4:return We(),null;case 10:return ii(a.type),null;case 22:case 23:return ri(a),qf(),r!==null&&X(vs),r=a.flags,r&65536?(a.flags=r&-65537|128,a):null;case 24:return ii(yt),null;case 25:return null;default:return null}}function F1(r,a){switch(kf(a),a.tag){case 3:ii(yt),We();break;case 26:case 27:case 5:Ht(a);break;case 4:We();break;case 13:ri(a);break;case 19:X(bt);break;case 10:ii(a.type);break;case 22:case 23:ri(a),qf(),r!==null&&X(vs);break;case 24:ii(yt)}}function Qo(r,a){try{var u=a.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&r)===r){h=void 0;var m=u.create,b=u.inst;h=m(),b.destroy=h}u=u.next}while(u!==g)}}catch(T){et(a,a.return,T)}}function ki(r,a,u){try{var h=a.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var m=g.next;h=m;do{if((h.tag&r)===r){var b=h.inst,T=b.destroy;if(T!==void 0){b.destroy=void 0,g=a;var k=u,K=T;try{K()}catch(ie){et(g,k,ie)}}}h=h.next}while(h!==m)}}catch(ie){et(a,a.return,ie)}}function z1(r){var a=r.updateQueue;if(a!==null){var u=r.stateNode;try{C3(a,u)}catch(h){et(r,r.return,h)}}}function j1(r,a,u){u.props=Ts(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(h){et(r,a,h)}}function Jo(r,a){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var h=r.stateNode;break;case 30:h=r.stateNode;break;default:h=r.stateNode}typeof u=="function"?r.refCleanup=u(h):u.current=h}}catch(g){et(r,a,g)}}function zn(r,a){var u=r.ref,h=r.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(g){et(r,a,g)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){et(r,a,g)}else u.current=null}function V1(r){var a=r.type,u=r.memoizedProps,h=r.stateNode;try{e:switch(a){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(g){et(r,r.return,g)}}function Th(r,a,u){try{var h=r.stateNode;y9(h,r.type,u,a),h[Wt]=a}catch(g){et(r,r.return,g)}}function H1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Vi(r.type)||r.tag===4}function wh(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||H1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Vi(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Sh(r,a,u){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,a):(a=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,a.appendChild(r),u=u._reactRootContainer,u!=null||a.onclick!==null||(a.onclick=uc));else if(h!==4&&(h===27&&Vi(r.type)&&(u=r.stateNode,a=null),r=r.child,r!==null))for(Sh(r,a,u),r=r.sibling;r!==null;)Sh(r,a,u),r=r.sibling}function Jl(r,a,u){var h=r.tag;if(h===5||h===6)r=r.stateNode,a?u.insertBefore(r,a):u.appendChild(r);else if(h!==4&&(h===27&&Vi(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(Jl(r,a,u),r=r.sibling;r!==null;)Jl(r,a,u),r=r.sibling}function $1(r){var a=r.stateNode,u=r.memoizedProps;try{for(var h=r.type,g=a.attributes;g.length;)a.removeAttributeNode(g[0]);It(a,h,u),a[Nt]=r,a[Wt]=u}catch(m){et(r,r.return,m)}}var li=!1,ht=!1,Ah=!1,W1=typeof WeakSet=="function"?WeakSet:Set,Et=null;function Q6(r,a){if(r=r.containerInfo,Zh=_c,r=n3(r),wf(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var g=h.anchorOffset,m=h.focusNode;h=h.focusOffset;try{u.nodeType,m.nodeType}catch{u=null;break e}var b=0,T=-1,k=-1,K=0,ie=0,oe=r,J=null;t:for(;;){for(var te;oe!==u||g!==0&&oe.nodeType!==3||(T=b+g),oe!==m||h!==0&&oe.nodeType!==3||(k=b+h),oe.nodeType===3&&(b+=oe.nodeValue.length),(te=oe.firstChild)!==null;)J=oe,oe=te;for(;;){if(oe===r)break t;if(J===u&&++K===g&&(T=b),J===m&&++ie===h&&(k=b),(te=oe.nextSibling)!==null)break;oe=J,J=oe.parentNode}oe=te}u=T===-1||k===-1?null:{start:T,end:k}}else u=null}u=u||{start:0,end:0}}else u=null;for(Kh={focusedElem:r,selectionRange:u},_c=!1,Et=a;Et!==null;)if(a=Et,r=a.child,(a.subtreeFlags&1024)!==0&&r!==null)r.return=a,Et=r;else for(;Et!==null;){switch(a=Et,m=a.alternate,r=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&m!==null){r=void 0,u=a,g=m.memoizedProps,m=m.memoizedState,h=u.stateNode;try{var Re=Ts(u.type,g,u.elementType===u.type);r=h.getSnapshotBeforeUpdate(Re,m),h.__reactInternalSnapshotBeforeUpdate=r}catch(Ae){et(u,u.return,Ae)}}break;case 3:if((r&1024)!==0){if(r=a.stateNode.containerInfo,u=r.nodeType,u===9)Jh(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Jh(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=a.sibling,r!==null){r.return=a.return,Et=r;break}Et=a.return}}function X1(r,a,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:Di(r,u),h&4&&Qo(5,u);break;case 1:if(Di(r,u),h&4)if(r=u.stateNode,a===null)try{r.componentDidMount()}catch(b){et(u,u.return,b)}else{var g=Ts(u.type,a.memoizedProps);a=a.memoizedState;try{r.componentDidUpdate(g,a,r.__reactInternalSnapshotBeforeUpdate)}catch(b){et(u,u.return,b)}}h&64&&z1(u),h&512&&Jo(u,u.return);break;case 3:if(Di(r,u),h&64&&(r=u.updateQueue,r!==null)){if(a=null,u.child!==null)switch(u.child.tag){case 27:case 5:a=u.child.stateNode;break;case 1:a=u.child.stateNode}try{C3(r,a)}catch(b){et(u,u.return,b)}}break;case 27:a===null&&h&4&&$1(u);case 26:case 5:Di(r,u),a===null&&h&4&&V1(u),h&512&&Jo(u,u.return);break;case 12:Di(r,u);break;case 13:Di(r,u),h&4&&Z1(r,u),h&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=a9.bind(null,u),A9(r,u))));break;case 22:if(h=u.memoizedState!==null||li,!h){a=a!==null&&a.memoizedState!==null||ht,g=li;var m=ht;li=h,(ht=a)&&!m?Li(r,u,(u.subtreeFlags&8772)!==0):Di(r,u),li=g,ht=m}break;case 30:break;default:Di(r,u)}}function Y1(r){var a=r.alternate;a!==null&&(r.alternate=null,Y1(a)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(a=r.stateNode,a!==null&&sf(a)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var it=null,qt=!1;function ci(r,a,u){for(u=u.child;u!==null;)q1(r,a,u),u=u.sibling}function q1(r,a,u){if(Gt&&typeof Gt.onCommitFiberUnmount=="function")try{Gt.onCommitFiberUnmount(vo,u)}catch{}switch(u.tag){case 26:ht||zn(u,a),ci(r,a,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ht||zn(u,a);var h=it,g=qt;Vi(u.type)&&(it=u.stateNode,qt=!1),ci(r,a,u),la(u.stateNode),it=h,qt=g;break;case 5:ht||zn(u,a);case 6:if(h=it,g=qt,it=null,ci(r,a,u),it=h,qt=g,it!==null)if(qt)try{(it.nodeType===9?it.body:it.nodeName==="HTML"?it.ownerDocument.body:it).removeChild(u.stateNode)}catch(m){et(u,a,m)}else try{it.removeChild(u.stateNode)}catch(m){et(u,a,m)}break;case 18:it!==null&&(qt?(r=it,Lm(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),ma(r)):Lm(it,u.stateNode));break;case 4:h=it,g=qt,it=u.stateNode.containerInfo,qt=!0,ci(r,a,u),it=h,qt=g;break;case 0:case 11:case 14:case 15:ht||ki(2,u,a),ht||ki(4,u,a),ci(r,a,u);break;case 1:ht||(zn(u,a),h=u.stateNode,typeof h.componentWillUnmount=="function"&&j1(u,a,h)),ci(r,a,u);break;case 21:ci(r,a,u);break;case 22:ht=(h=ht)||u.memoizedState!==null,ci(r,a,u),ht=h;break;default:ci(r,a,u)}}function Z1(r,a){if(a.memoizedState===null&&(r=a.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{ma(r)}catch(u){et(a,a.return,u)}}function J6(r){switch(r.tag){case 13:case 19:var a=r.stateNode;return a===null&&(a=r.stateNode=new W1),a;case 22:return r=r.stateNode,a=r._retryCache,a===null&&(a=r._retryCache=new W1),a;default:throw Error(i(435,r.tag))}}function Eh(r,a){var u=J6(r);a.forEach(function(h){var g=l9.bind(null,r,h);u.has(h)||(u.add(h),h.then(g,g))})}function tn(r,a){var u=a.deletions;if(u!==null)for(var h=0;h<u.length;h++){var g=u[h],m=r,b=a,T=b;e:for(;T!==null;){switch(T.tag){case 27:if(Vi(T.type)){it=T.stateNode,qt=!1;break e}break;case 5:it=T.stateNode,qt=!1;break e;case 3:case 4:it=T.stateNode.containerInfo,qt=!0;break e}T=T.return}if(it===null)throw Error(i(160));q1(m,b,g),it=null,qt=!1,m=g.alternate,m!==null&&(m.return=null),g.return=null}if(a.subtreeFlags&13878)for(a=a.child;a!==null;)K1(a,r),a=a.sibling}var Rn=null;function K1(r,a){var u=r.alternate,h=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:tn(a,r),nn(r),h&4&&(ki(3,r,r.return),Qo(3,r),ki(5,r,r.return));break;case 1:tn(a,r),nn(r),h&512&&(ht||u===null||zn(u,u.return)),h&64&&li&&(r=r.updateQueue,r!==null&&(h=r.callbacks,h!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var g=Rn;if(tn(a,r),nn(r),h&512&&(ht||u===null||zn(u,u.return)),h&4){var m=u!==null?u.memoizedState:null;if(h=r.memoizedState,u===null)if(h===null)if(r.stateNode===null){e:{h=r.type,u=r.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":m=g.getElementsByTagName("title")[0],(!m||m[wo]||m[Nt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=g.createElement(h),g.head.insertBefore(m,g.querySelector("head > title"))),It(m,h,u),m[Nt]=r,St(m),h=m;break e;case"link":var b=$m("link","href",g).get(h+(u.href||""));if(b){for(var T=0;T<b.length;T++)if(m=b[T],m.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&m.getAttribute("rel")===(u.rel==null?null:u.rel)&&m.getAttribute("title")===(u.title==null?null:u.title)&&m.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){b.splice(T,1);break t}}m=g.createElement(h),It(m,h,u),g.head.appendChild(m);break;case"meta":if(b=$m("meta","content",g).get(h+(u.content||""))){for(T=0;T<b.length;T++)if(m=b[T],m.getAttribute("content")===(u.content==null?null:""+u.content)&&m.getAttribute("name")===(u.name==null?null:u.name)&&m.getAttribute("property")===(u.property==null?null:u.property)&&m.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&m.getAttribute("charset")===(u.charSet==null?null:u.charSet)){b.splice(T,1);break t}}m=g.createElement(h),It(m,h,u),g.head.appendChild(m);break;default:throw Error(i(468,h))}m[Nt]=r,St(m),h=m}r.stateNode=h}else Wm(g,r.type,r.stateNode);else r.stateNode=Hm(g,h,r.memoizedProps);else m!==h?(m===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):m.count--,h===null?Wm(g,r.type,r.stateNode):Hm(g,h,r.memoizedProps)):h===null&&r.stateNode!==null&&Th(r,r.memoizedProps,u.memoizedProps)}break;case 27:tn(a,r),nn(r),h&512&&(ht||u===null||zn(u,u.return)),u!==null&&h&4&&Th(r,r.memoizedProps,u.memoizedProps);break;case 5:if(tn(a,r),nn(r),h&512&&(ht||u===null||zn(u,u.return)),r.flags&32){g=r.stateNode;try{ir(g,"")}catch(te){et(r,r.return,te)}}h&4&&r.stateNode!=null&&(g=r.memoizedProps,Th(r,g,u!==null?u.memoizedProps:g)),h&1024&&(Ah=!0);break;case 6:if(tn(a,r),nn(r),h&4){if(r.stateNode===null)throw Error(i(162));h=r.memoizedProps,u=r.stateNode;try{u.nodeValue=h}catch(te){et(r,r.return,te)}}break;case 3:if(pc=null,g=Rn,Rn=hc(a.containerInfo),tn(a,r),Rn=g,nn(r),h&4&&u!==null&&u.memoizedState.isDehydrated)try{ma(a.containerInfo)}catch(te){et(r,r.return,te)}Ah&&(Ah=!1,G1(r));break;case 4:h=Rn,Rn=hc(r.stateNode.containerInfo),tn(a,r),nn(r),Rn=h;break;case 12:tn(a,r),nn(r);break;case 13:tn(a,r),nn(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ih=Bn()),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Eh(r,h)));break;case 22:g=r.memoizedState!==null;var k=u!==null&&u.memoizedState!==null,K=li,ie=ht;if(li=K||g,ht=ie||k,tn(a,r),ht=ie,li=K,nn(r),h&8192)e:for(a=r.stateNode,a._visibility=g?a._visibility&-2:a._visibility|1,g&&(u===null||k||li||ht||ws(r)),u=null,a=r;;){if(a.tag===5||a.tag===26){if(u===null){k=u=a;try{if(m=k.stateNode,g)b=m.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{T=k.stateNode;var oe=k.memoizedProps.style,J=oe!=null&&oe.hasOwnProperty("display")?oe.display:null;T.style.display=J==null||typeof J=="boolean"?"":(""+J).trim()}}catch(te){et(k,k.return,te)}}}else if(a.tag===6){if(u===null){k=a;try{k.stateNode.nodeValue=g?"":k.memoizedProps}catch(te){et(k,k.return,te)}}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===r)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break e;for(;a.sibling===null;){if(a.return===null||a.return===r)break e;u===a&&(u=null),a=a.return}u===a&&(u=null),a.sibling.return=a.return,a=a.sibling}h&4&&(h=r.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,Eh(r,u))));break;case 19:tn(a,r),nn(r),h&4&&(h=r.updateQueue,h!==null&&(r.updateQueue=null,Eh(r,h)));break;case 30:break;case 21:break;default:tn(a,r),nn(r)}}function nn(r){var a=r.flags;if(a&2){try{for(var u,h=r.return;h!==null;){if(H1(h)){u=h;break}h=h.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var g=u.stateNode,m=wh(r);Jl(r,m,g);break;case 5:var b=u.stateNode;u.flags&32&&(ir(b,""),u.flags&=-33);var T=wh(r);Jl(r,T,b);break;case 3:case 4:var k=u.stateNode.containerInfo,K=wh(r);Sh(r,K,k);break;default:throw Error(i(161))}}catch(ie){et(r,r.return,ie)}r.flags&=-3}a&4096&&(r.flags&=-4097)}function G1(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var a=r;G1(a),a.tag===5&&a.flags&1024&&a.stateNode.reset(),r=r.sibling}}function Di(r,a){if(a.subtreeFlags&8772)for(a=a.child;a!==null;)X1(r,a.alternate,a),a=a.sibling}function ws(r){for(r=r.child;r!==null;){var a=r;switch(a.tag){case 0:case 11:case 14:case 15:ki(4,a,a.return),ws(a);break;case 1:zn(a,a.return);var u=a.stateNode;typeof u.componentWillUnmount=="function"&&j1(a,a.return,u),ws(a);break;case 27:la(a.stateNode);case 26:case 5:zn(a,a.return),ws(a);break;case 22:a.memoizedState===null&&ws(a);break;case 30:ws(a);break;default:ws(a)}r=r.sibling}}function Li(r,a,u){for(u=u&&(a.subtreeFlags&8772)!==0,a=a.child;a!==null;){var h=a.alternate,g=r,m=a,b=m.flags;switch(m.tag){case 0:case 11:case 15:Li(g,m,u),Qo(4,m);break;case 1:if(Li(g,m,u),h=m,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(K){et(h,h.return,K)}if(h=m,g=h.updateQueue,g!==null){var T=h.stateNode;try{var k=g.shared.hiddenCallbacks;if(k!==null)for(g.shared.hiddenCallbacks=null,g=0;g<k.length;g++)E3(k[g],T)}catch(K){et(h,h.return,K)}}u&&b&64&&z1(m),Jo(m,m.return);break;case 27:$1(m);case 26:case 5:Li(g,m,u),u&&h===null&&b&4&&V1(m),Jo(m,m.return);break;case 12:Li(g,m,u);break;case 13:Li(g,m,u),u&&b&4&&Z1(g,m);break;case 22:m.memoizedState===null&&Li(g,m,u),Jo(m,m.return);break;case 30:break;default:Li(g,m,u)}a=a.sibling}}function Ch(r,a){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(r=a.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Uo(u))}function Rh(r,a){r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Uo(r))}function jn(r,a,u,h){if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Q1(r,a,u,h),a=a.sibling}function Q1(r,a,u,h){var g=a.flags;switch(a.tag){case 0:case 11:case 15:jn(r,a,u,h),g&2048&&Qo(9,a);break;case 1:jn(r,a,u,h);break;case 3:jn(r,a,u,h),g&2048&&(r=null,a.alternate!==null&&(r=a.alternate.memoizedState.cache),a=a.memoizedState.cache,a!==r&&(a.refCount++,r!=null&&Uo(r)));break;case 12:if(g&2048){jn(r,a,u,h),r=a.stateNode;try{var m=a.memoizedProps,b=m.id,T=m.onPostCommit;typeof T=="function"&&T(b,a.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(k){et(a,a.return,k)}}else jn(r,a,u,h);break;case 13:jn(r,a,u,h);break;case 23:break;case 22:m=a.stateNode,b=a.alternate,a.memoizedState!==null?m._visibility&2?jn(r,a,u,h):ea(r,a):m._visibility&2?jn(r,a,u,h):(m._visibility|=2,Tr(r,a,u,h,(a.subtreeFlags&10256)!==0)),g&2048&&Ch(b,a);break;case 24:jn(r,a,u,h),g&2048&&Rh(a.alternate,a);break;default:jn(r,a,u,h)}}function Tr(r,a,u,h,g){for(g=g&&(a.subtreeFlags&10256)!==0,a=a.child;a!==null;){var m=r,b=a,T=u,k=h,K=b.flags;switch(b.tag){case 0:case 11:case 15:Tr(m,b,T,k,g),Qo(8,b);break;case 23:break;case 22:var ie=b.stateNode;b.memoizedState!==null?ie._visibility&2?Tr(m,b,T,k,g):ea(m,b):(ie._visibility|=2,Tr(m,b,T,k,g)),g&&K&2048&&Ch(b.alternate,b);break;case 24:Tr(m,b,T,k,g),g&&K&2048&&Rh(b.alternate,b);break;default:Tr(m,b,T,k,g)}a=a.sibling}}function ea(r,a){if(a.subtreeFlags&10256)for(a=a.child;a!==null;){var u=r,h=a,g=h.flags;switch(h.tag){case 22:ea(u,h),g&2048&&Ch(h.alternate,h);break;case 24:ea(u,h),g&2048&&Rh(h.alternate,h);break;default:ea(u,h)}a=a.sibling}}var ta=8192;function wr(r){if(r.subtreeFlags&ta)for(r=r.child;r!==null;)J1(r),r=r.sibling}function J1(r){switch(r.tag){case 26:wr(r),r.flags&ta&&r.memoizedState!==null&&U9(Rn,r.memoizedState,r.memoizedProps);break;case 5:wr(r);break;case 3:case 4:var a=Rn;Rn=hc(r.stateNode.containerInfo),wr(r),Rn=a;break;case 22:r.memoizedState===null&&(a=r.alternate,a!==null&&a.memoizedState!==null?(a=ta,ta=16777216,wr(r),ta=a):wr(r));break;default:wr(r)}}function em(r){var a=r.alternate;if(a!==null&&(r=a.child,r!==null)){a.child=null;do a=r.sibling,r.sibling=null,r=a;while(r!==null)}}function na(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];Et=h,nm(h,r)}em(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)tm(r),r=r.sibling}function tm(r){switch(r.tag){case 0:case 11:case 15:na(r),r.flags&2048&&ki(9,r,r.return);break;case 3:na(r);break;case 12:na(r);break;case 22:var a=r.stateNode;r.memoizedState!==null&&a._visibility&2&&(r.return===null||r.return.tag!==13)?(a._visibility&=-3,ec(r)):na(r);break;default:na(r)}}function ec(r){var a=r.deletions;if((r.flags&16)!==0){if(a!==null)for(var u=0;u<a.length;u++){var h=a[u];Et=h,nm(h,r)}em(r)}for(r=r.child;r!==null;){switch(a=r,a.tag){case 0:case 11:case 15:ki(8,a,a.return),ec(a);break;case 22:u=a.stateNode,u._visibility&2&&(u._visibility&=-3,ec(a));break;default:ec(a)}r=r.sibling}}function nm(r,a){for(;Et!==null;){var u=Et;switch(u.tag){case 0:case 11:case 15:ki(8,u,a);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Uo(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Et=h;else e:for(u=r;Et!==null;){h=Et;var g=h.sibling,m=h.return;if(Y1(h),h===u){Et=null;break e}if(g!==null){g.return=m,Et=g;break e}Et=m}}}var e9={getCacheForType:function(r){var a=kt(yt),u=a.data.get(r);return u===void 0&&(u=r(),a.data.set(r,u)),u}},t9=typeof WeakMap=="function"?WeakMap:Map,Ye=0,nt=null,De=null,Ue=0,qe=0,sn=null,Bi=!1,Sr=!1,Mh=!1,ui=0,lt=0,Ui=0,Ss=0,Ph=0,bn=0,Ar=0,ia=null,Zt=null,Oh=!1,Ih=0,tc=1/0,nc=null,Fi=null,Ot=0,zi=null,Er=null,Cr=0,Nh=0,kh=null,im=null,sa=0,Dh=null;function rn(){if((Ye&2)!==0&&Ue!==0)return Ue&-Ue;if(w.T!==null){var r=pr;return r!==0?r:Vh()}return b2()}function sm(){bn===0&&(bn=(Ue&536870912)===0||He?g2():536870912);var r=yn.current;return r!==null&&(r.flags|=32),bn}function on(r,a,u){(r===nt&&(qe===2||qe===9)||r.cancelPendingCommit!==null)&&(Rr(r,0),ji(r,Ue,bn,!1)),To(r,u),((Ye&2)===0||r!==nt)&&(r===nt&&((Ye&2)===0&&(Ss|=u),lt===4&&ji(r,Ue,bn,!1)),Vn(r))}function rm(r,a,u){if((Ye&6)!==0)throw Error(i(327));var h=!u&&(a&124)===0&&(a&r.expiredLanes)===0||xo(r,a),g=h?s9(r,a):Uh(r,a,!0),m=h;do{if(g===0){Sr&&!h&&ji(r,a,0,!1);break}else{if(u=r.current.alternate,m&&!n9(u)){g=Uh(r,a,!1),m=!1;continue}if(g===2){if(m=a,r.errorRecoveryDisabledLanes&m)var b=0;else b=r.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){a=b;e:{var T=r;g=ia;var k=T.current.memoizedState.isDehydrated;if(k&&(Rr(T,b).flags|=256),b=Uh(T,b,!1),b!==2){if(Mh&&!k){T.errorRecoveryDisabledLanes|=m,Ss|=m,g=4;break e}m=Zt,Zt=g,m!==null&&(Zt===null?Zt=m:Zt.push.apply(Zt,m))}g=b}if(m=!1,g!==2)continue}}if(g===1){Rr(r,0),ji(r,a,0,!0);break}e:{switch(h=r,m=g,m){case 0:case 1:throw Error(i(345));case 4:if((a&4194048)!==a)break;case 6:ji(h,a,bn,!Bi);break e;case 2:Zt=null;break;case 3:case 5:break;default:throw Error(i(329))}if((a&62914560)===a&&(g=Ih+300-Bn(),10<g)){if(ji(h,a,bn,!Bi),dl(h,0,!0)!==0)break e;h.timeoutHandle=km(om.bind(null,h,u,Zt,nc,Oh,a,bn,Ss,Ar,Bi,m,2,-0,0),g);break e}om(h,u,Zt,nc,Oh,a,bn,Ss,Ar,Bi,m,0,-0,0)}}break}while(!0);Vn(r)}function om(r,a,u,h,g,m,b,T,k,K,ie,oe,J,te){if(r.timeoutHandle=-1,oe=a.subtreeFlags,(oe&8192||(oe&16785408)===16785408)&&(fa={stylesheets:null,count:0,unsuspend:B9},J1(a),oe=F9(),oe!==null)){r.cancelPendingCommit=oe(dm.bind(null,r,a,m,u,h,g,b,T,k,ie,1,J,te)),ji(r,m,b,!K);return}dm(r,a,m,u,h,g,b,T,k)}function n9(r){for(var a=r;;){var u=a.tag;if((u===0||u===11||u===15)&&a.flags&16384&&(u=a.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var g=u[h],m=g.getSnapshot;g=g.value;try{if(!Jt(m(),g))return!1}catch{return!1}}if(u=a.child,a.subtreeFlags&16384&&u!==null)u.return=a,a=u;else{if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function ji(r,a,u,h){a&=~Ph,a&=~Ss,r.suspendedLanes|=a,r.pingedLanes&=~a,h&&(r.warmLanes|=a),h=r.expirationTimes;for(var g=a;0<g;){var m=31-Qt(g),b=1<<m;h[m]=-1,g&=~b}u!==0&&_2(r,u,a)}function ic(){return(Ye&6)===0?(ra(0),!1):!0}function Lh(){if(De!==null){if(qe===0)var r=De.return;else r=De,ni=ys=null,Jf(r),vr=null,Zo=0,r=De;for(;r!==null;)F1(r.alternate,r),r=r.return;De=null}}function Rr(r,a){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,v9(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Lh(),nt=r,De=u=Jn(r.current,null),Ue=a,qe=0,sn=null,Bi=!1,Sr=xo(r,a),Mh=!1,Ar=bn=Ph=Ss=Ui=lt=0,Zt=ia=null,Oh=!1,(a&8)!==0&&(a|=a&32);var h=r.entangledLanes;if(h!==0)for(r=r.entanglements,h&=a;0<h;){var g=31-Qt(h),m=1<<g;a|=r[g],h&=~m}return ui=a,Al(),u}function am(r,a){Oe=null,w.H=$l,a===zo||a===kl?(a=S3(),qe=3):a===x3?(a=S3(),qe=4):qe=a===A1?8:a!==null&&typeof a=="object"&&typeof a.then=="function"?6:1,sn=a,De===null&&(lt=1,Zl(r,pn(a,r.current)))}function lm(){var r=w.H;return w.H=$l,r===null?$l:r}function cm(){var r=w.A;return w.A=e9,r}function Bh(){lt=4,Bi||(Ue&4194048)!==Ue&&yn.current!==null||(Sr=!0),(Ui&134217727)===0&&(Ss&134217727)===0||nt===null||ji(nt,Ue,bn,!1)}function Uh(r,a,u){var h=Ye;Ye|=2;var g=lm(),m=cm();(nt!==r||Ue!==a)&&(nc=null,Rr(r,a)),a=!1;var b=lt;e:do try{if(qe!==0&&De!==null){var T=De,k=sn;switch(qe){case 8:Lh(),b=6;break e;case 3:case 2:case 9:case 6:yn.current===null&&(a=!0);var K=qe;if(qe=0,sn=null,Mr(r,T,k,K),u&&Sr){b=0;break e}break;default:K=qe,qe=0,sn=null,Mr(r,T,k,K)}}i9(),b=lt;break}catch(ie){am(r,ie)}while(!0);return a&&r.shellSuspendCounter++,ni=ys=null,Ye=h,w.H=g,w.A=m,De===null&&(nt=null,Ue=0,Al()),b}function i9(){for(;De!==null;)um(De)}function s9(r,a){var u=Ye;Ye|=2;var h=lm(),g=cm();nt!==r||Ue!==a?(nc=null,tc=Bn()+500,Rr(r,a)):Sr=xo(r,a);e:do try{if(qe!==0&&De!==null){a=De;var m=sn;t:switch(qe){case 1:qe=0,sn=null,Mr(r,a,m,1);break;case 2:case 9:if(T3(m)){qe=0,sn=null,fm(a);break}a=function(){qe!==2&&qe!==9||nt!==r||(qe=7),Vn(r)},m.then(a,a);break e;case 3:qe=7;break e;case 4:qe=5;break e;case 7:T3(m)?(qe=0,sn=null,fm(a)):(qe=0,sn=null,Mr(r,a,m,7));break;case 5:var b=null;switch(De.tag){case 26:b=De.memoizedState;case 5:case 27:var T=De;if(!b||Xm(b)){qe=0,sn=null;var k=T.sibling;if(k!==null)De=k;else{var K=T.return;K!==null?(De=K,sc(K)):De=null}break t}}qe=0,sn=null,Mr(r,a,m,5);break;case 6:qe=0,sn=null,Mr(r,a,m,6);break;case 8:Lh(),lt=6;break e;default:throw Error(i(462))}}r9();break}catch(ie){am(r,ie)}while(!0);return ni=ys=null,w.H=h,w.A=g,Ye=u,De!==null?0:(nt=null,Ue=0,Al(),lt)}function r9(){for(;De!==null&&!ze();)um(De)}function um(r){var a=B1(r.alternate,r,ui);r.memoizedProps=r.pendingProps,a===null?sc(r):De=a}function fm(r){var a=r,u=a.alternate;switch(a.tag){case 15:case 0:a=O1(u,a,a.pendingProps,a.type,void 0,Ue);break;case 11:a=O1(u,a,a.pendingProps,a.type.render,a.ref,Ue);break;case 5:Jf(a);default:F1(u,a),a=De=h3(a,ui),a=B1(u,a,ui)}r.memoizedProps=r.pendingProps,a===null?sc(r):De=a}function Mr(r,a,u,h){ni=ys=null,Jf(a),vr=null,Zo=0;var g=a.return;try{if(q6(r,g,a,u,Ue)){lt=1,Zl(r,pn(u,r.current)),De=null;return}}catch(m){if(g!==null)throw De=g,m;lt=1,Zl(r,pn(u,r.current)),De=null;return}a.flags&32768?(He||h===1?r=!0:Sr||(Ue&536870912)!==0?r=!1:(Bi=r=!0,(h===2||h===9||h===3||h===6)&&(h=yn.current,h!==null&&h.tag===13&&(h.flags|=16384))),hm(a,r)):sc(a)}function sc(r){var a=r;do{if((a.flags&32768)!==0){hm(a,Bi);return}r=a.return;var u=K6(a.alternate,a,ui);if(u!==null){De=u;return}if(a=a.sibling,a!==null){De=a;return}De=a=r}while(a!==null);lt===0&&(lt=5)}function hm(r,a){do{var u=G6(r.alternate,r);if(u!==null){u.flags&=32767,De=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!a&&(r=r.sibling,r!==null)){De=r;return}De=r=u}while(r!==null);lt=6,De=null}function dm(r,a,u,h,g,m,b,T,k){r.cancelPendingCommit=null;do rc();while(Ot!==0);if((Ye&6)!==0)throw Error(i(327));if(a!==null){if(a===r.current)throw Error(i(177));if(m=a.lanes|a.childLanes,m|=Rf,Bv(r,u,m,b,T,k),r===nt&&(De=nt=null,Ue=0),Er=a,zi=r,Cr=u,Nh=m,kh=g,im=h,(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,c9(ul,function(){return ym(),null})):(r.callbackNode=null,r.callbackPriority=0),h=(a.flags&13878)!==0,(a.subtreeFlags&13878)!==0||h){h=w.T,w.T=null,g=N.p,N.p=2,b=Ye,Ye|=4;try{Q6(r,a,u)}finally{Ye=b,N.p=g,w.T=h}}Ot=1,pm(),gm(),mm()}}function pm(){if(Ot===1){Ot=0;var r=zi,a=Er,u=(a.flags&13878)!==0;if((a.subtreeFlags&13878)!==0||u){u=w.T,w.T=null;var h=N.p;N.p=2;var g=Ye;Ye|=4;try{K1(a,r);var m=Kh,b=n3(r.containerInfo),T=m.focusedElem,k=m.selectionRange;if(b!==T&&T&&T.ownerDocument&&t3(T.ownerDocument.documentElement,T)){if(k!==null&&wf(T)){var K=k.start,ie=k.end;if(ie===void 0&&(ie=K),"selectionStart"in T)T.selectionStart=K,T.selectionEnd=Math.min(ie,T.value.length);else{var oe=T.ownerDocument||document,J=oe&&oe.defaultView||window;if(J.getSelection){var te=J.getSelection(),Re=T.textContent.length,Ae=Math.min(k.start,Re),Ge=k.end===void 0?Ae:Math.min(k.end,Re);!te.extend&&Ae>Ge&&(b=Ge,Ge=Ae,Ae=b);var $=e3(T,Ae),z=e3(T,Ge);if($&&z&&(te.rangeCount!==1||te.anchorNode!==$.node||te.anchorOffset!==$.offset||te.focusNode!==z.node||te.focusOffset!==z.offset)){var q=oe.createRange();q.setStart($.node,$.offset),te.removeAllRanges(),Ae>Ge?(te.addRange(q),te.extend(z.node,z.offset)):(q.setEnd(z.node,z.offset),te.addRange(q))}}}}for(oe=[],te=T;te=te.parentNode;)te.nodeType===1&&oe.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<oe.length;T++){var se=oe[T];se.element.scrollLeft=se.left,se.element.scrollTop=se.top}}_c=!!Zh,Kh=Zh=null}finally{Ye=g,N.p=h,w.T=u}}r.current=a,Ot=2}}function gm(){if(Ot===2){Ot=0;var r=zi,a=Er,u=(a.flags&8772)!==0;if((a.subtreeFlags&8772)!==0||u){u=w.T,w.T=null;var h=N.p;N.p=2;var g=Ye;Ye|=4;try{X1(r,a.alternate,a)}finally{Ye=g,N.p=h,w.T=u}}Ot=3}}function mm(){if(Ot===4||Ot===3){Ot=0,je();var r=zi,a=Er,u=Cr,h=im;(a.subtreeFlags&10256)!==0||(a.flags&10256)!==0?Ot=5:(Ot=0,Er=zi=null,_m(r,r.pendingLanes));var g=r.pendingLanes;if(g===0&&(Fi=null),tf(u),a=a.stateNode,Gt&&typeof Gt.onCommitFiberRoot=="function")try{Gt.onCommitFiberRoot(vo,a,void 0,(a.current.flags&128)===128)}catch{}if(h!==null){a=w.T,g=N.p,N.p=2,w.T=null;try{for(var m=r.onRecoverableError,b=0;b<h.length;b++){var T=h[b];m(T.value,{componentStack:T.stack})}}finally{w.T=a,N.p=g}}(Cr&3)!==0&&rc(),Vn(r),g=r.pendingLanes,(u&4194090)!==0&&(g&42)!==0?r===Dh?sa++:(sa=0,Dh=r):sa=0,ra(0)}}function _m(r,a){(r.pooledCacheLanes&=a)===0&&(a=r.pooledCache,a!=null&&(r.pooledCache=null,Uo(a)))}function rc(r){return pm(),gm(),mm(),ym()}function ym(){if(Ot!==5)return!1;var r=zi,a=Nh;Nh=0;var u=tf(Cr),h=w.T,g=N.p;try{N.p=32>u?32:u,w.T=null,u=kh,kh=null;var m=zi,b=Cr;if(Ot=0,Er=zi=null,Cr=0,(Ye&6)!==0)throw Error(i(331));var T=Ye;if(Ye|=4,tm(m.current),Q1(m,m.current,b,u),Ye=T,ra(0,!1),Gt&&typeof Gt.onPostCommitFiberRoot=="function")try{Gt.onPostCommitFiberRoot(vo,m)}catch{}return!0}finally{N.p=g,w.T=h,_m(r,a)}}function bm(r,a,u){a=pn(u,a),a=dh(r.stateNode,a,2),r=Pi(r,a,2),r!==null&&(To(r,2),Vn(r))}function et(r,a,u){if(r.tag===3)bm(r,r,u);else for(;a!==null;){if(a.tag===3){bm(a,r,u);break}else if(a.tag===1){var h=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Fi===null||!Fi.has(h))){r=pn(u,r),u=w1(2),h=Pi(a,u,2),h!==null&&(S1(u,h,a,r),To(h,2),Vn(h));break}}a=a.return}}function Fh(r,a,u){var h=r.pingCache;if(h===null){h=r.pingCache=new t9;var g=new Set;h.set(a,g)}else g=h.get(a),g===void 0&&(g=new Set,h.set(a,g));g.has(u)||(Mh=!0,g.add(u),r=o9.bind(null,r,a,u),a.then(r,r))}function o9(r,a,u){var h=r.pingCache;h!==null&&h.delete(a),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,nt===r&&(Ue&u)===u&&(lt===4||lt===3&&(Ue&62914560)===Ue&&300>Bn()-Ih?(Ye&2)===0&&Rr(r,0):Ph|=u,Ar===Ue&&(Ar=0)),Vn(r)}function vm(r,a){a===0&&(a=m2()),r=ur(r,a),r!==null&&(To(r,a),Vn(r))}function a9(r){var a=r.memoizedState,u=0;a!==null&&(u=a.retryLane),vm(r,u)}function l9(r,a){var u=0;switch(r.tag){case 13:var h=r.stateNode,g=r.memoizedState;g!==null&&(u=g.retryLane);break;case 19:h=r.stateNode;break;case 22:h=r.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(a),vm(r,u)}function c9(r,a){return qs(r,a)}var oc=null,Pr=null,zh=!1,ac=!1,jh=!1,As=0;function Vn(r){r!==Pr&&r.next===null&&(Pr===null?oc=Pr=r:Pr=Pr.next=r),ac=!0,zh||(zh=!0,f9())}function ra(r,a){if(!jh&&ac){jh=!0;do for(var u=!1,h=oc;h!==null;){if(r!==0){var g=h.pendingLanes;if(g===0)var m=0;else{var b=h.suspendedLanes,T=h.pingedLanes;m=(1<<31-Qt(42|r)+1)-1,m&=g&~(b&~T),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(u=!0,Sm(h,m))}else m=Ue,m=dl(h,h===nt?m:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(m&3)===0||xo(h,m)||(u=!0,Sm(h,m));h=h.next}while(u);jh=!1}}function u9(){xm()}function xm(){ac=zh=!1;var r=0;As!==0&&(b9()&&(r=As),As=0);for(var a=Bn(),u=null,h=oc;h!==null;){var g=h.next,m=Tm(h,a);m===0?(h.next=null,u===null?oc=g:u.next=g,g===null&&(Pr=u)):(u=h,(r!==0||(m&3)!==0)&&(ac=!0)),h=g}ra(r)}function Tm(r,a){for(var u=r.suspendedLanes,h=r.pingedLanes,g=r.expirationTimes,m=r.pendingLanes&-62914561;0<m;){var b=31-Qt(m),T=1<<b,k=g[b];k===-1?((T&u)===0||(T&h)!==0)&&(g[b]=Lv(T,a)):k<=a&&(r.expiredLanes|=T),m&=~T}if(a=nt,u=Ue,u=dl(r,r===a?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h=r.callbackNode,u===0||r===a&&(qe===2||qe===9)||r.cancelPendingCommit!==null)return h!==null&&h!==null&&Zs(h),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||xo(r,u)){if(a=u&-u,a===r.callbackPriority)return a;switch(h!==null&&Zs(h),tf(u)){case 2:case 8:u=d2;break;case 32:u=ul;break;case 268435456:u=p2;break;default:u=ul}return h=wm.bind(null,r),u=qs(u,h),r.callbackPriority=a,r.callbackNode=u,a}return h!==null&&h!==null&&Zs(h),r.callbackPriority=2,r.callbackNode=null,2}function wm(r,a){if(Ot!==0&&Ot!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if(rc()&&r.callbackNode!==u)return null;var h=Ue;return h=dl(r,r===nt?h:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),h===0?null:(rm(r,h,a),Tm(r,Bn()),r.callbackNode!=null&&r.callbackNode===u?wm.bind(null,r):null)}function Sm(r,a){if(rc())return null;rm(r,a,!0)}function f9(){x9(function(){(Ye&6)!==0?qs(h2,u9):xm()})}function Vh(){return As===0&&(As=g2()),As}function Am(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yl(""+r)}function Em(r,a){var u=a.ownerDocument.createElement("input");return u.name=a.name,u.value=a.value,r.id&&u.setAttribute("form",r.id),a.parentNode.insertBefore(u,a),r=new FormData(r),u.parentNode.removeChild(u),r}function h9(r,a,u,h,g){if(a==="submit"&&u&&u.stateNode===g){var m=Am((g[Wt]||null).action),b=h.submitter;b&&(a=(a=b[Wt]||null)?Am(a.formAction):b.getAttribute("formAction"),a!==null&&(m=a,b=null));var T=new Tl("action","action",null,h,g);r.push({event:T,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(As!==0){var k=b?Em(g,b):new FormData(g);lh(u,{pending:!0,data:k,method:g.method,action:m},null,k)}}else typeof m=="function"&&(T.preventDefault(),k=b?Em(g,b):new FormData(g),lh(u,{pending:!0,data:k,method:g.method,action:m},m,k))},currentTarget:g}]})}}for(var Hh=0;Hh<Cf.length;Hh++){var $h=Cf[Hh],d9=$h.toLowerCase(),p9=$h[0].toUpperCase()+$h.slice(1);Cn(d9,"on"+p9)}Cn(r3,"onAnimationEnd"),Cn(o3,"onAnimationIteration"),Cn(a3,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(O6,"onTransitionRun"),Cn(I6,"onTransitionStart"),Cn(N6,"onTransitionCancel"),Cn(l3,"onTransitionEnd"),er("onMouseEnter",["mouseout","mouseover"]),er("onMouseLeave",["mouseout","mouseover"]),er("onPointerEnter",["pointerout","pointerover"]),er("onPointerLeave",["pointerout","pointerover"]),cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),cs("onBeforeInput",["compositionend","keypress","textInput","paste"]),cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g9=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(oa));function Cm(r,a){a=(a&4)!==0;for(var u=0;u<r.length;u++){var h=r[u],g=h.event;h=h.listeners;e:{var m=void 0;if(a)for(var b=h.length-1;0<=b;b--){var T=h[b],k=T.instance,K=T.currentTarget;if(T=T.listener,k!==m&&g.isPropagationStopped())break e;m=T,g.currentTarget=K;try{m(g)}catch(ie){ql(ie)}g.currentTarget=null,m=k}else for(b=0;b<h.length;b++){if(T=h[b],k=T.instance,K=T.currentTarget,T=T.listener,k!==m&&g.isPropagationStopped())break e;m=T,g.currentTarget=K;try{m(g)}catch(ie){ql(ie)}g.currentTarget=null,m=k}}}}function Le(r,a){var u=a[nf];u===void 0&&(u=a[nf]=new Set);var h=r+"__bubble";u.has(h)||(Rm(a,r,2,!1),u.add(h))}function Wh(r,a,u){var h=0;a&&(h|=4),Rm(u,r,h,a)}var lc="_reactListening"+Math.random().toString(36).slice(2);function Xh(r){if(!r[lc]){r[lc]=!0,x2.forEach(function(u){u!=="selectionchange"&&(g9.has(u)||Wh(u,!1,r),Wh(u,!0,r))});var a=r.nodeType===9?r:r.ownerDocument;a===null||a[lc]||(a[lc]=!0,Wh("selectionchange",!1,a))}}function Rm(r,a,u,h){switch(Qm(a)){case 2:var g=V9;break;case 8:g=H9;break;default:g=od}u=g.bind(null,a,u,r),g=void 0,!pf||a!=="touchstart"&&a!=="touchmove"&&a!=="wheel"||(g=!0),h?g!==void 0?r.addEventListener(a,u,{capture:!0,passive:g}):r.addEventListener(a,u,!0):g!==void 0?r.addEventListener(a,u,{passive:g}):r.addEventListener(a,u,!1)}function Yh(r,a,u,h,g){var m=h;if((a&1)===0&&(a&2)===0&&h!==null)e:for(;;){if(h===null)return;var b=h.tag;if(b===3||b===4){var T=h.stateNode.containerInfo;if(T===g)break;if(b===4)for(b=h.return;b!==null;){var k=b.tag;if((k===3||k===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;T!==null;){if(b=Gs(T),b===null)return;if(k=b.tag,k===5||k===6||k===26||k===27){h=m=b;continue e}T=T.parentNode}}h=h.return}D2(function(){var K=m,ie=hf(u),oe=[];e:{var J=c3.get(r);if(J!==void 0){var te=Tl,Re=r;switch(r){case"keypress":if(vl(u)===0)break e;case"keydown":case"keyup":te=c6;break;case"focusin":Re="focus",te=yf;break;case"focusout":Re="blur",te=yf;break;case"beforeblur":case"afterblur":te=yf;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=U2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Gv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=h6;break;case r3:case o3:case a3:te=e6;break;case l3:te=p6;break;case"scroll":case"scrollend":te=Zv;break;case"wheel":te=m6;break;case"copy":case"cut":case"paste":te=n6;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=z2;break;case"toggle":case"beforetoggle":te=y6}var Ae=(a&4)!==0,Ge=!Ae&&(r==="scroll"||r==="scrollend"),$=Ae?J!==null?J+"Capture":null:J;Ae=[];for(var z=K,q;z!==null;){var se=z;if(q=se.stateNode,se=se.tag,se!==5&&se!==26&&se!==27||q===null||$===null||(se=Ao(z,$),se!=null&&Ae.push(aa(z,se,q))),Ge)break;z=z.return}0<Ae.length&&(J=new te(J,Re,null,u,ie),oe.push({event:J,listeners:Ae}))}}if((a&7)===0){e:{if(J=r==="mouseover"||r==="pointerover",te=r==="mouseout"||r==="pointerout",J&&u!==ff&&(Re=u.relatedTarget||u.fromElement)&&(Gs(Re)||Re[Ks]))break e;if((te||J)&&(J=ie.window===ie?ie:(J=ie.ownerDocument)?J.defaultView||J.parentWindow:window,te?(Re=u.relatedTarget||u.toElement,te=K,Re=Re?Gs(Re):null,Re!==null&&(Ge=o(Re),Ae=Re.tag,Re!==Ge||Ae!==5&&Ae!==27&&Ae!==6)&&(Re=null)):(te=null,Re=K),te!==Re)){if(Ae=U2,se="onMouseLeave",$="onMouseEnter",z="mouse",(r==="pointerout"||r==="pointerover")&&(Ae=z2,se="onPointerLeave",$="onPointerEnter",z="pointer"),Ge=te==null?J:So(te),q=Re==null?J:So(Re),J=new Ae(se,z+"leave",te,u,ie),J.target=Ge,J.relatedTarget=q,se=null,Gs(ie)===K&&(Ae=new Ae($,z+"enter",Re,u,ie),Ae.target=q,Ae.relatedTarget=Ge,se=Ae),Ge=se,te&&Re)t:{for(Ae=te,$=Re,z=0,q=Ae;q;q=Or(q))z++;for(q=0,se=$;se;se=Or(se))q++;for(;0<z-q;)Ae=Or(Ae),z--;for(;0<q-z;)$=Or($),q--;for(;z--;){if(Ae===$||$!==null&&Ae===$.alternate)break t;Ae=Or(Ae),$=Or($)}Ae=null}else Ae=null;te!==null&&Mm(oe,J,te,Ae,!1),Re!==null&&Ge!==null&&Mm(oe,Ge,Re,Ae,!0)}}e:{if(J=K?So(K):window,te=J.nodeName&&J.nodeName.toLowerCase(),te==="select"||te==="input"&&J.type==="file")var ye=q2;else if(X2(J))if(Z2)ye=R6;else{ye=E6;var Ne=A6}else te=J.nodeName,!te||te.toLowerCase()!=="input"||J.type!=="checkbox"&&J.type!=="radio"?K&&uf(K.elementType)&&(ye=q2):ye=C6;if(ye&&(ye=ye(r,K))){Y2(oe,ye,u,ie);break e}Ne&&Ne(r,J,K),r==="focusout"&&K&&J.type==="number"&&K.memoizedProps.value!=null&&cf(J,"number",J.value)}switch(Ne=K?So(K):window,r){case"focusin":(X2(Ne)||Ne.contentEditable==="true")&&(ar=Ne,Sf=K,No=null);break;case"focusout":No=Sf=ar=null;break;case"mousedown":Af=!0;break;case"contextmenu":case"mouseup":case"dragend":Af=!1,i3(oe,u,ie);break;case"selectionchange":if(P6)break;case"keydown":case"keyup":i3(oe,u,ie)}var we;if(vf)e:{switch(r){case"compositionstart":var Ee="onCompositionStart";break e;case"compositionend":Ee="onCompositionEnd";break e;case"compositionupdate":Ee="onCompositionUpdate";break e}Ee=void 0}else or?$2(r,u)&&(Ee="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ee="onCompositionStart");Ee&&(j2&&u.locale!=="ko"&&(or||Ee!=="onCompositionStart"?Ee==="onCompositionEnd"&&or&&(we=L2()):(Ei=ie,gf="value"in Ei?Ei.value:Ei.textContent,or=!0)),Ne=cc(K,Ee),0<Ne.length&&(Ee=new F2(Ee,r,null,u,ie),oe.push({event:Ee,listeners:Ne}),we?Ee.data=we:(we=W2(u),we!==null&&(Ee.data=we)))),(we=v6?x6(r,u):T6(r,u))&&(Ee=cc(K,"onBeforeInput"),0<Ee.length&&(Ne=new F2("onBeforeInput","beforeinput",null,u,ie),oe.push({event:Ne,listeners:Ee}),Ne.data=we)),h9(oe,r,K,u,ie)}Cm(oe,a)})}function aa(r,a,u){return{instance:r,listener:a,currentTarget:u}}function cc(r,a){for(var u=a+"Capture",h=[];r!==null;){var g=r,m=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||m===null||(g=Ao(r,u),g!=null&&h.unshift(aa(r,g,m)),g=Ao(r,a),g!=null&&h.push(aa(r,g,m))),r.tag===3)return h;r=r.return}return[]}function Or(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Mm(r,a,u,h,g){for(var m=a._reactName,b=[];u!==null&&u!==h;){var T=u,k=T.alternate,K=T.stateNode;if(T=T.tag,k!==null&&k===h)break;T!==5&&T!==26&&T!==27||K===null||(k=K,g?(K=Ao(u,m),K!=null&&b.unshift(aa(u,K,k))):g||(K=Ao(u,m),K!=null&&b.push(aa(u,K,k)))),u=u.return}b.length!==0&&r.push({event:a,listeners:b})}var m9=/\r\n?/g,_9=/\u0000|\uFFFD/g;function Pm(r){return(typeof r=="string"?r:""+r).replace(m9,`
`).replace(_9,"")}function Om(r,a){return a=Pm(a),Pm(r)===a}function uc(){}function Ke(r,a,u,h,g,m){switch(u){case"children":typeof h=="string"?a==="body"||a==="textarea"&&h===""||ir(r,h):(typeof h=="number"||typeof h=="bigint")&&a!=="body"&&ir(r,""+h);break;case"className":gl(r,"class",h);break;case"tabIndex":gl(r,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":gl(r,u,h);break;case"style":N2(r,h,m);break;case"data":if(a!=="object"){gl(r,"data",h);break}case"src":case"href":if(h===""&&(a!=="a"||u!=="href")){r.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(u);break}h=yl(""+h),r.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(u==="formAction"?(a!=="input"&&Ke(r,a,"name",g.name,g,null),Ke(r,a,"formEncType",g.formEncType,g,null),Ke(r,a,"formMethod",g.formMethod,g,null),Ke(r,a,"formTarget",g.formTarget,g,null)):(Ke(r,a,"encType",g.encType,g,null),Ke(r,a,"method",g.method,g,null),Ke(r,a,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){r.removeAttribute(u);break}h=yl(""+h),r.setAttribute(u,h);break;case"onClick":h!=null&&(r.onclick=uc);break;case"onScroll":h!=null&&Le("scroll",r);break;case"onScrollEnd":h!=null&&Le("scrollend",r);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"multiple":r.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":r.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){r.removeAttribute("xlink:href");break}u=yl(""+h),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(u,""+h):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":h===!0?r.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?r.setAttribute(u,h):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?r.setAttribute(u,h):r.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?r.removeAttribute(u):r.setAttribute(u,h);break;case"popover":Le("beforetoggle",r),Le("toggle",r),pl(r,"popover",h);break;case"xlinkActuate":Gn(r,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Gn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Gn(r,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Gn(r,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Gn(r,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Gn(r,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Gn(r,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Gn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Gn(r,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":pl(r,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=Yv.get(u)||u,pl(r,u,h))}}function qh(r,a,u,h,g,m){switch(u){case"style":N2(r,h,m);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(i(60));r.innerHTML=u}}break;case"children":typeof h=="string"?ir(r,h):(typeof h=="number"||typeof h=="bigint")&&ir(r,""+h);break;case"onScroll":h!=null&&Le("scroll",r);break;case"onScrollEnd":h!=null&&Le("scrollend",r);break;case"onClick":h!=null&&(r.onclick=uc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!T2.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),a=u.slice(2,g?u.length-7:void 0),m=r[Wt]||null,m=m!=null?m[u]:null,typeof m=="function"&&r.removeEventListener(a,m,g),typeof h=="function")){typeof m!="function"&&m!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(a,h,g);break e}u in r?r[u]=h:h===!0?r.setAttribute(u,""):pl(r,u,h)}}}function It(r,a,u){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Le("error",r),Le("load",r);var h=!1,g=!1,m;for(m in u)if(u.hasOwnProperty(m)){var b=u[m];if(b!=null)switch(m){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ke(r,a,m,b,u,null)}}g&&Ke(r,a,"srcSet",u.srcSet,u,null),h&&Ke(r,a,"src",u.src,u,null);return;case"input":Le("invalid",r);var T=m=b=g=null,k=null,K=null;for(h in u)if(u.hasOwnProperty(h)){var ie=u[h];if(ie!=null)switch(h){case"name":g=ie;break;case"type":b=ie;break;case"checked":k=ie;break;case"defaultChecked":K=ie;break;case"value":m=ie;break;case"defaultValue":T=ie;break;case"children":case"dangerouslySetInnerHTML":if(ie!=null)throw Error(i(137,a));break;default:Ke(r,a,h,ie,u,null)}}M2(r,m,T,k,K,b,g,!1),ml(r);return;case"select":Le("invalid",r),h=b=m=null;for(g in u)if(u.hasOwnProperty(g)&&(T=u[g],T!=null))switch(g){case"value":m=T;break;case"defaultValue":b=T;break;case"multiple":h=T;default:Ke(r,a,g,T,u,null)}a=m,u=b,r.multiple=!!h,a!=null?nr(r,!!h,a,!1):u!=null&&nr(r,!!h,u,!0);return;case"textarea":Le("invalid",r),m=g=h=null;for(b in u)if(u.hasOwnProperty(b)&&(T=u[b],T!=null))switch(b){case"value":h=T;break;case"defaultValue":g=T;break;case"children":m=T;break;case"dangerouslySetInnerHTML":if(T!=null)throw Error(i(91));break;default:Ke(r,a,b,T,u,null)}O2(r,h,g,m),ml(r);return;case"option":for(k in u)if(u.hasOwnProperty(k)&&(h=u[k],h!=null))switch(k){case"selected":r.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ke(r,a,k,h,u,null)}return;case"dialog":Le("beforetoggle",r),Le("toggle",r),Le("cancel",r),Le("close",r);break;case"iframe":case"object":Le("load",r);break;case"video":case"audio":for(h=0;h<oa.length;h++)Le(oa[h],r);break;case"image":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"embed":case"source":case"link":Le("error",r),Le("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(K in u)if(u.hasOwnProperty(K)&&(h=u[K],h!=null))switch(K){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,a));default:Ke(r,a,K,h,u,null)}return;default:if(uf(a)){for(ie in u)u.hasOwnProperty(ie)&&(h=u[ie],h!==void 0&&qh(r,a,ie,h,u,void 0));return}}for(T in u)u.hasOwnProperty(T)&&(h=u[T],h!=null&&Ke(r,a,T,h,u,null))}function y9(r,a,u,h){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,m=null,b=null,T=null,k=null,K=null,ie=null;for(te in u){var oe=u[te];if(u.hasOwnProperty(te)&&oe!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":k=oe;default:h.hasOwnProperty(te)||Ke(r,a,te,null,h,oe)}}for(var J in h){var te=h[J];if(oe=u[J],h.hasOwnProperty(J)&&(te!=null||oe!=null))switch(J){case"type":m=te;break;case"name":g=te;break;case"checked":K=te;break;case"defaultChecked":ie=te;break;case"value":b=te;break;case"defaultValue":T=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(i(137,a));break;default:te!==oe&&Ke(r,a,J,te,h,oe)}}lf(r,b,T,k,K,ie,m,g);return;case"select":te=b=T=J=null;for(m in u)if(k=u[m],u.hasOwnProperty(m)&&k!=null)switch(m){case"value":break;case"multiple":te=k;default:h.hasOwnProperty(m)||Ke(r,a,m,null,h,k)}for(g in h)if(m=h[g],k=u[g],h.hasOwnProperty(g)&&(m!=null||k!=null))switch(g){case"value":J=m;break;case"defaultValue":T=m;break;case"multiple":b=m;default:m!==k&&Ke(r,a,g,m,h,k)}a=T,u=b,h=te,J!=null?nr(r,!!u,J,!1):!!h!=!!u&&(a!=null?nr(r,!!u,a,!0):nr(r,!!u,u?[]:"",!1));return;case"textarea":te=J=null;for(T in u)if(g=u[T],u.hasOwnProperty(T)&&g!=null&&!h.hasOwnProperty(T))switch(T){case"value":break;case"children":break;default:Ke(r,a,T,null,h,g)}for(b in h)if(g=h[b],m=u[b],h.hasOwnProperty(b)&&(g!=null||m!=null))switch(b){case"value":J=g;break;case"defaultValue":te=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==m&&Ke(r,a,b,g,h,m)}P2(r,J,te);return;case"option":for(var Re in u)if(J=u[Re],u.hasOwnProperty(Re)&&J!=null&&!h.hasOwnProperty(Re))switch(Re){case"selected":r.selected=!1;break;default:Ke(r,a,Re,null,h,J)}for(k in h)if(J=h[k],te=u[k],h.hasOwnProperty(k)&&J!==te&&(J!=null||te!=null))switch(k){case"selected":r.selected=J&&typeof J!="function"&&typeof J!="symbol";break;default:Ke(r,a,k,J,h,te)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ae in u)J=u[Ae],u.hasOwnProperty(Ae)&&J!=null&&!h.hasOwnProperty(Ae)&&Ke(r,a,Ae,null,h,J);for(K in h)if(J=h[K],te=u[K],h.hasOwnProperty(K)&&J!==te&&(J!=null||te!=null))switch(K){case"children":case"dangerouslySetInnerHTML":if(J!=null)throw Error(i(137,a));break;default:Ke(r,a,K,J,h,te)}return;default:if(uf(a)){for(var Ge in u)J=u[Ge],u.hasOwnProperty(Ge)&&J!==void 0&&!h.hasOwnProperty(Ge)&&qh(r,a,Ge,void 0,h,J);for(ie in h)J=h[ie],te=u[ie],!h.hasOwnProperty(ie)||J===te||J===void 0&&te===void 0||qh(r,a,ie,J,h,te);return}}for(var $ in u)J=u[$],u.hasOwnProperty($)&&J!=null&&!h.hasOwnProperty($)&&Ke(r,a,$,null,h,J);for(oe in h)J=h[oe],te=u[oe],!h.hasOwnProperty(oe)||J===te||J==null&&te==null||Ke(r,a,oe,J,h,te)}var Zh=null,Kh=null;function fc(r){return r.nodeType===9?r:r.ownerDocument}function Im(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Nm(r,a){if(r===0)switch(a){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&a==="foreignObject"?0:r}function Gh(r,a){return r==="textarea"||r==="noscript"||typeof a.children=="string"||typeof a.children=="number"||typeof a.children=="bigint"||typeof a.dangerouslySetInnerHTML=="object"&&a.dangerouslySetInnerHTML!==null&&a.dangerouslySetInnerHTML.__html!=null}var Qh=null;function b9(){var r=window.event;return r&&r.type==="popstate"?r===Qh?!1:(Qh=r,!0):(Qh=null,!1)}var km=typeof setTimeout=="function"?setTimeout:void 0,v9=typeof clearTimeout=="function"?clearTimeout:void 0,Dm=typeof Promise=="function"?Promise:void 0,x9=typeof queueMicrotask=="function"?queueMicrotask:typeof Dm<"u"?function(r){return Dm.resolve(null).then(r).catch(T9)}:km;function T9(r){setTimeout(function(){throw r})}function Vi(r){return r==="head"}function Lm(r,a){var u=a,h=0,g=0;do{var m=u.nextSibling;if(r.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(0<h&&8>h){u=h;var b=r.ownerDocument;if(u&1&&la(b.documentElement),u&2&&la(b.body),u&4)for(u=b.head,la(u),b=u.firstChild;b;){var T=b.nextSibling,k=b.nodeName;b[wo]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&b.rel.toLowerCase()==="stylesheet"||u.removeChild(b),b=T}}if(g===0){r.removeChild(m),ma(a);return}g--}else u==="$"||u==="$?"||u==="$!"?g++:h=u.charCodeAt(0)-48;else h=0;u=m}while(u);ma(a)}function Jh(r){var a=r.firstChild;for(a&&a.nodeType===10&&(a=a.nextSibling);a;){var u=a;switch(a=a.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Jh(u),sf(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function w9(r,a,u,h){for(;r.nodeType===1;){var g=u;if(r.nodeName.toLowerCase()!==a.toLowerCase()){if(!h&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(h){if(!r[wo])switch(a){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(m=r.getAttribute("rel"),m==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(m!==g.rel||r.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||r.getAttribute("title")!==(g.title==null?null:g.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(m=r.getAttribute("src"),(m!==(g.src==null?null:g.src)||r.getAttribute("type")!==(g.type==null?null:g.type)||r.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&m&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(a==="input"&&r.type==="hidden"){var m=g.name==null?null:""+g.name;if(g.type==="hidden"&&r.getAttribute("name")===m)return r}else return r;if(r=Mn(r.nextSibling),r===null)break}return null}function S9(r,a,u){if(a==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Mn(r.nextSibling),r===null))return null;return r}function ed(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function A9(r,a){var u=r.ownerDocument;if(r.data!=="$?"||u.readyState==="complete")a();else{var h=function(){a(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),r._reactRetry=h}}function Mn(r){for(;r!=null;r=r.nextSibling){var a=r.nodeType;if(a===1||a===3)break;if(a===8){if(a=r.data,a==="$"||a==="$!"||a==="$?"||a==="F!"||a==="F")break;if(a==="/$")return null}}return r}var td=null;function Bm(r){r=r.previousSibling;for(var a=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"){if(a===0)return r;a--}else u==="/$"&&a++}r=r.previousSibling}return null}function Um(r,a,u){switch(a=fc(u),r){case"html":if(r=a.documentElement,!r)throw Error(i(452));return r;case"head":if(r=a.head,!r)throw Error(i(453));return r;case"body":if(r=a.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function la(r){for(var a=r.attributes;a.length;)r.removeAttributeNode(a[0]);sf(r)}var vn=new Map,Fm=new Set;function hc(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var fi=N.d;N.d={f:E9,r:C9,D:R9,C:M9,L:P9,m:O9,X:N9,S:I9,M:k9};function E9(){var r=fi.f(),a=ic();return r||a}function C9(r){var a=Qs(r);a!==null&&a.tag===5&&a.type==="form"?r1(a):fi.r(r)}var Ir=typeof document>"u"?null:document;function zm(r,a,u){var h=Ir;if(h&&typeof a=="string"&&a){var g=dn(a);g='link[rel="'+r+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),Fm.has(g)||(Fm.add(g),r={rel:r,crossOrigin:u,href:a},h.querySelector(g)===null&&(a=h.createElement("link"),It(a,"link",r),St(a),h.head.appendChild(a)))}}function R9(r){fi.D(r),zm("dns-prefetch",r,null)}function M9(r,a){fi.C(r,a),zm("preconnect",r,a)}function P9(r,a,u){fi.L(r,a,u);var h=Ir;if(h&&r&&a){var g='link[rel="preload"][as="'+dn(a)+'"]';a==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+dn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+dn(u.imageSizes)+'"]')):g+='[href="'+dn(r)+'"]';var m=g;switch(a){case"style":m=Nr(r);break;case"script":m=kr(r)}vn.has(m)||(r=p({rel:"preload",href:a==="image"&&u&&u.imageSrcSet?void 0:r,as:a},u),vn.set(m,r),h.querySelector(g)!==null||a==="style"&&h.querySelector(ca(m))||a==="script"&&h.querySelector(ua(m))||(a=h.createElement("link"),It(a,"link",r),St(a),h.head.appendChild(a)))}}function O9(r,a){fi.m(r,a);var u=Ir;if(u&&r){var h=a&&typeof a.as=="string"?a.as:"script",g='link[rel="modulepreload"][as="'+dn(h)+'"][href="'+dn(r)+'"]',m=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=kr(r)}if(!vn.has(m)&&(r=p({rel:"modulepreload",href:r},a),vn.set(m,r),u.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(ua(m)))return}h=u.createElement("link"),It(h,"link",r),St(h),u.head.appendChild(h)}}}function I9(r,a,u){fi.S(r,a,u);var h=Ir;if(h&&r){var g=Js(h).hoistableStyles,m=Nr(r);a=a||"default";var b=g.get(m);if(!b){var T={loading:0,preload:null};if(b=h.querySelector(ca(m)))T.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":a},u),(u=vn.get(m))&&nd(r,u);var k=b=h.createElement("link");St(k),It(k,"link",r),k._p=new Promise(function(K,ie){k.onload=K,k.onerror=ie}),k.addEventListener("load",function(){T.loading|=1}),k.addEventListener("error",function(){T.loading|=2}),T.loading|=4,dc(b,a,h)}b={type:"stylesheet",instance:b,count:1,state:T},g.set(m,b)}}}function N9(r,a){fi.X(r,a);var u=Ir;if(u&&r){var h=Js(u).hoistableScripts,g=kr(r),m=h.get(g);m||(m=u.querySelector(ua(g)),m||(r=p({src:r,async:!0},a),(a=vn.get(g))&&id(r,a),m=u.createElement("script"),St(m),It(m,"link",r),u.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function k9(r,a){fi.M(r,a);var u=Ir;if(u&&r){var h=Js(u).hoistableScripts,g=kr(r),m=h.get(g);m||(m=u.querySelector(ua(g)),m||(r=p({src:r,async:!0,type:"module"},a),(a=vn.get(g))&&id(r,a),m=u.createElement("script"),St(m),It(m,"link",r),u.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function jm(r,a,u,h){var g=(g=me.current)?hc(g):null;if(!g)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(a=Nr(u.href),u=Js(g).hoistableStyles,h=u.get(a),h||(h={type:"style",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Nr(u.href);var m=Js(g).hoistableStyles,b=m.get(r);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(r,b),(m=g.querySelector(ca(r)))&&!m._p&&(b.instance=m,b.state.loading=5),vn.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},vn.set(r,u),m||D9(g,r,u,b.state))),a&&h===null)throw Error(i(528,""));return b}if(a&&h!==null)throw Error(i(529,""));return null;case"script":return a=u.async,u=u.src,typeof u=="string"&&a&&typeof a!="function"&&typeof a!="symbol"?(a=kr(u),u=Js(g).hoistableScripts,h=u.get(a),h||(h={type:"script",instance:null,count:0,state:null},u.set(a,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Nr(r){return'href="'+dn(r)+'"'}function ca(r){return'link[rel="stylesheet"]['+r+"]"}function Vm(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function D9(r,a,u,h){r.querySelector('link[rel="preload"][as="style"]['+a+"]")?h.loading=1:(a=r.createElement("link"),h.preload=a,a.addEventListener("load",function(){return h.loading|=1}),a.addEventListener("error",function(){return h.loading|=2}),It(a,"link",u),St(a),r.head.appendChild(a))}function kr(r){return'[src="'+dn(r)+'"]'}function ua(r){return"script[async]"+r}function Hm(r,a,u){if(a.count++,a.instance===null)switch(a.type){case"style":var h=r.querySelector('style[data-href~="'+dn(u.href)+'"]');if(h)return a.instance=h,St(h),h;var g=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(r.ownerDocument||r).createElement("style"),St(h),It(h,"style",g),dc(h,u.precedence,r),a.instance=h;case"stylesheet":g=Nr(u.href);var m=r.querySelector(ca(g));if(m)return a.state.loading|=4,a.instance=m,St(m),m;h=Vm(u),(g=vn.get(g))&&nd(h,g),m=(r.ownerDocument||r).createElement("link"),St(m);var b=m;return b._p=new Promise(function(T,k){b.onload=T,b.onerror=k}),It(m,"link",h),a.state.loading|=4,dc(m,u.precedence,r),a.instance=m;case"script":return m=kr(u.src),(g=r.querySelector(ua(m)))?(a.instance=g,St(g),g):(h=u,(g=vn.get(m))&&(h=p({},u),id(h,g)),r=r.ownerDocument||r,g=r.createElement("script"),St(g),It(g,"link",h),r.head.appendChild(g),a.instance=g);case"void":return null;default:throw Error(i(443,a.type))}else a.type==="stylesheet"&&(a.state.loading&4)===0&&(h=a.instance,a.state.loading|=4,dc(h,u.precedence,r));return a.instance}function dc(r,a,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,m=g,b=0;b<h.length;b++){var T=h[b];if(T.dataset.precedence===a)m=T;else if(m!==g)break}m?m.parentNode.insertBefore(r,m.nextSibling):(a=u.nodeType===9?u.head:u,a.insertBefore(r,a.firstChild))}function nd(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.title==null&&(r.title=a.title)}function id(r,a){r.crossOrigin==null&&(r.crossOrigin=a.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=a.referrerPolicy),r.integrity==null&&(r.integrity=a.integrity)}var pc=null;function $m(r,a,u){if(pc===null){var h=new Map,g=pc=new Map;g.set(u,h)}else g=pc,h=g.get(u),h||(h=new Map,g.set(u,h));if(h.has(r))return h;for(h.set(r,null),u=u.getElementsByTagName(r),g=0;g<u.length;g++){var m=u[g];if(!(m[wo]||m[Nt]||r==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var b=m.getAttribute(a)||"";b=r+b;var T=h.get(b);T?T.push(m):h.set(b,[m])}}return h}function Wm(r,a,u){r=r.ownerDocument||r,r.head.insertBefore(u,a==="title"?r.querySelector("head > title"):null)}function L9(r,a,u){if(u===1||a.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof a.precedence!="string"||typeof a.href!="string"||a.href==="")break;return!0;case"link":if(typeof a.rel!="string"||typeof a.href!="string"||a.href===""||a.onLoad||a.onError)break;switch(a.rel){case"stylesheet":return r=a.disabled,typeof a.precedence=="string"&&r==null;default:return!0}case"script":if(a.async&&typeof a.async!="function"&&typeof a.async!="symbol"&&!a.onLoad&&!a.onError&&a.src&&typeof a.src=="string")return!0}return!1}function Xm(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var fa=null;function B9(){}function U9(r,a,u){if(fa===null)throw Error(i(475));var h=fa;if(a.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(a.state.loading&4)===0){if(a.instance===null){var g=Nr(u.href),m=r.querySelector(ca(g));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(h.count++,h=gc.bind(h),r.then(h,h)),a.state.loading|=4,a.instance=m,St(m);return}m=r.ownerDocument||r,u=Vm(u),(g=vn.get(g))&&nd(u,g),m=m.createElement("link"),St(m);var b=m;b._p=new Promise(function(T,k){b.onload=T,b.onerror=k}),It(m,"link",u),a.instance=m}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(a,r),(r=a.state.preload)&&(a.state.loading&3)===0&&(h.count++,a=gc.bind(h),r.addEventListener("load",a),r.addEventListener("error",a))}}function F9(){if(fa===null)throw Error(i(475));var r=fa;return r.stylesheets&&r.count===0&&sd(r,r.stylesheets),0<r.count?function(a){var u=setTimeout(function(){if(r.stylesheets&&sd(r,r.stylesheets),r.unsuspend){var h=r.unsuspend;r.unsuspend=null,h()}},6e4);return r.unsuspend=a,function(){r.unsuspend=null,clearTimeout(u)}}:null}function gc(){if(this.count--,this.count===0){if(this.stylesheets)sd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var mc=null;function sd(r,a){r.stylesheets=null,r.unsuspend!==null&&(r.count++,mc=new Map,a.forEach(z9,r),mc=null,gc.call(r))}function z9(r,a){if(!(a.state.loading&4)){var u=mc.get(r);if(u)var h=u.get(null);else{u=new Map,mc.set(r,u);for(var g=r.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<g.length;m++){var b=g[m];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(u.set(b.dataset.precedence,b),h=b)}h&&u.set(null,h)}g=a.instance,b=g.getAttribute("data-precedence"),m=u.get(b)||h,m===h&&u.set(null,g),u.set(b,g),this.count++,h=gc.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),m?m.parentNode.insertBefore(g,m.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(g,r.firstChild)),a.state.loading|=4}}var ha={$$typeof:R,Provider:null,Consumer:null,_currentValue:O,_currentValue2:O,_threadCount:0};function j9(r,a,u,h,g,m,b,T){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ju(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ju(0),this.hiddenUpdates=Ju(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=m,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=T,this.incompleteTransitions=new Map}function Ym(r,a,u,h,g,m,b,T,k,K,ie,oe){return r=new j9(r,a,u,b,T,k,K,oe),a=1,m===!0&&(a|=24),m=en(3,null,null,a),r.current=m,m.stateNode=r,a=Ff(),a.refCount++,r.pooledCache=a,a.refCount++,m.memoizedState={element:h,isDehydrated:u,cache:a},Hf(m),r}function qm(r){return r?(r=fr,r):fr}function Zm(r,a,u,h,g,m){g=qm(g),h.context===null?h.context=g:h.pendingContext=g,h=Mi(a),h.payload={element:u},m=m===void 0?null:m,m!==null&&(h.callback=m),u=Pi(r,h,a),u!==null&&(on(u,r,a),Vo(u,r,a))}function Km(r,a){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<a?u:a}}function rd(r,a){Km(r,a),(r=r.alternate)&&Km(r,a)}function Gm(r){if(r.tag===13){var a=ur(r,67108864);a!==null&&on(a,r,67108864),rd(r,67108864)}}var _c=!0;function V9(r,a,u,h){var g=w.T;w.T=null;var m=N.p;try{N.p=2,od(r,a,u,h)}finally{N.p=m,w.T=g}}function H9(r,a,u,h){var g=w.T;w.T=null;var m=N.p;try{N.p=8,od(r,a,u,h)}finally{N.p=m,w.T=g}}function od(r,a,u,h){if(_c){var g=ad(h);if(g===null)Yh(r,a,h,yc,u),Jm(r,h);else if(W9(g,r,a,u,h))h.stopPropagation();else if(Jm(r,h),a&4&&-1<$9.indexOf(r)){for(;g!==null;){var m=Qs(g);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var b=ls(m.pendingLanes);if(b!==0){var T=m;for(T.pendingLanes|=2,T.entangledLanes|=2;b;){var k=1<<31-Qt(b);T.entanglements[1]|=k,b&=~k}Vn(m),(Ye&6)===0&&(tc=Bn()+500,ra(0))}}break;case 13:T=ur(m,2),T!==null&&on(T,m,2),ic(),rd(m,2)}if(m=ad(h),m===null&&Yh(r,a,h,yc,u),m===g)break;g=m}g!==null&&h.stopPropagation()}else Yh(r,a,h,null,u)}}function ad(r){return r=hf(r),ld(r)}var yc=null;function ld(r){if(yc=null,r=Gs(r),r!==null){var a=o(r);if(a===null)r=null;else{var u=a.tag;if(u===13){if(r=l(a),r!==null)return r;r=null}else if(u===3){if(a.stateNode.current.memoizedState.isDehydrated)return a.tag===3?a.stateNode.containerInfo:null;r=null}else a!==r&&(r=null)}}return yc=r,null}function Qm(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Mv()){case h2:return 2;case d2:return 8;case ul:case Pv:return 32;case p2:return 268435456;default:return 32}default:return 32}}var cd=!1,Hi=null,$i=null,Wi=null,da=new Map,pa=new Map,Xi=[],$9="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Jm(r,a){switch(r){case"focusin":case"focusout":Hi=null;break;case"dragenter":case"dragleave":$i=null;break;case"mouseover":case"mouseout":Wi=null;break;case"pointerover":case"pointerout":da.delete(a.pointerId);break;case"gotpointercapture":case"lostpointercapture":pa.delete(a.pointerId)}}function ga(r,a,u,h,g,m){return r===null||r.nativeEvent!==m?(r={blockedOn:a,domEventName:u,eventSystemFlags:h,nativeEvent:m,targetContainers:[g]},a!==null&&(a=Qs(a),a!==null&&Gm(a)),r):(r.eventSystemFlags|=h,a=r.targetContainers,g!==null&&a.indexOf(g)===-1&&a.push(g),r)}function W9(r,a,u,h,g){switch(a){case"focusin":return Hi=ga(Hi,r,a,u,h,g),!0;case"dragenter":return $i=ga($i,r,a,u,h,g),!0;case"mouseover":return Wi=ga(Wi,r,a,u,h,g),!0;case"pointerover":var m=g.pointerId;return da.set(m,ga(da.get(m)||null,r,a,u,h,g)),!0;case"gotpointercapture":return m=g.pointerId,pa.set(m,ga(pa.get(m)||null,r,a,u,h,g)),!0}return!1}function e0(r){var a=Gs(r.target);if(a!==null){var u=o(a);if(u!==null){if(a=u.tag,a===13){if(a=l(u),a!==null){r.blockedOn=a,Uv(r.priority,function(){if(u.tag===13){var h=rn();h=ef(h);var g=ur(u,h);g!==null&&on(g,u,h),rd(u,h)}});return}}else if(a===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function bc(r){if(r.blockedOn!==null)return!1;for(var a=r.targetContainers;0<a.length;){var u=ad(r.nativeEvent);if(u===null){u=r.nativeEvent;var h=new u.constructor(u.type,u);ff=h,u.target.dispatchEvent(h),ff=null}else return a=Qs(u),a!==null&&Gm(a),r.blockedOn=u,!1;a.shift()}return!0}function t0(r,a,u){bc(r)&&u.delete(a)}function X9(){cd=!1,Hi!==null&&bc(Hi)&&(Hi=null),$i!==null&&bc($i)&&($i=null),Wi!==null&&bc(Wi)&&(Wi=null),da.forEach(t0),pa.forEach(t0)}function vc(r,a){r.blockedOn===a&&(r.blockedOn=null,cd||(cd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,X9)))}var xc=null;function n0(r){xc!==r&&(xc=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){xc===r&&(xc=null);for(var a=0;a<r.length;a+=3){var u=r[a],h=r[a+1],g=r[a+2];if(typeof h!="function"){if(ld(h||u)===null)continue;break}var m=Qs(u);m!==null&&(r.splice(a,3),a-=3,lh(m,{pending:!0,data:g,method:u.method,action:h},h,g))}}))}function ma(r){function a(k){return vc(k,r)}Hi!==null&&vc(Hi,r),$i!==null&&vc($i,r),Wi!==null&&vc(Wi,r),da.forEach(a),pa.forEach(a);for(var u=0;u<Xi.length;u++){var h=Xi[u];h.blockedOn===r&&(h.blockedOn=null)}for(;0<Xi.length&&(u=Xi[0],u.blockedOn===null);)e0(u),u.blockedOn===null&&Xi.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var g=u[h],m=u[h+1],b=g[Wt]||null;if(typeof m=="function")b||n0(u);else if(b){var T=null;if(m&&m.hasAttribute("formAction")){if(g=m,b=m[Wt]||null)T=b.formAction;else if(ld(g)!==null)continue}else T=b.action;typeof T=="function"?u[h+1]=T:(u.splice(h,3),h-=3),n0(u)}}}function ud(r){this._internalRoot=r}Tc.prototype.render=ud.prototype.render=function(r){var a=this._internalRoot;if(a===null)throw Error(i(409));var u=a.current,h=rn();Zm(u,h,r,a,null,null)},Tc.prototype.unmount=ud.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var a=r.containerInfo;Zm(r.current,2,null,r,null,null),ic(),a[Ks]=null}};function Tc(r){this._internalRoot=r}Tc.prototype.unstable_scheduleHydration=function(r){if(r){var a=b2();r={blockedOn:null,target:r,priority:a};for(var u=0;u<Xi.length&&a!==0&&a<Xi[u].priority;u++);Xi.splice(u,0,r),u===0&&e0(r)}};var i0=e.version;if(i0!=="19.1.0")throw Error(i(527,i0,"19.1.0"));N.findDOMNode=function(r){var a=r._reactInternals;if(a===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=f(a),r=r!==null?d(r):null,r=r===null?null:r.stateNode,r};var Y9={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:w,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wc.isDisabled&&wc.supportsFiber)try{vo=wc.inject(Y9),Gt=wc}catch{}}return ya.createRoot=function(r,a){if(!s(r))throw Error(i(299));var u=!1,h="",g=b1,m=v1,b=x1,T=null;return a!=null&&(a.unstable_strictMode===!0&&(u=!0),a.identifierPrefix!==void 0&&(h=a.identifierPrefix),a.onUncaughtError!==void 0&&(g=a.onUncaughtError),a.onCaughtError!==void 0&&(m=a.onCaughtError),a.onRecoverableError!==void 0&&(b=a.onRecoverableError),a.unstable_transitionCallbacks!==void 0&&(T=a.unstable_transitionCallbacks)),a=Ym(r,1,!1,null,null,u,h,g,m,b,T,null),r[Ks]=a.current,Xh(r),new ud(a)},ya.hydrateRoot=function(r,a,u){if(!s(r))throw Error(i(299));var h=!1,g="",m=b1,b=v1,T=x1,k=null,K=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(m=u.onUncaughtError),u.onCaughtError!==void 0&&(b=u.onCaughtError),u.onRecoverableError!==void 0&&(T=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(k=u.unstable_transitionCallbacks),u.formState!==void 0&&(K=u.formState)),a=Ym(r,1,!0,a,u??null,h,g,m,b,T,k,K),a.context=qm(null),u=a.current,h=rn(),h=ef(h),g=Mi(h),g.callback=null,Pi(u,g,h),u=h,a.current.lanes=u,To(a,u),Vn(a),r[Ks]=a.current,Xh(r),new Tc(a)},ya.version="19.1.0",ya}var d0;function nx(){if(d0)return dd.exports;d0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),dd.exports=tx(),dd.exports}var ix=nx();/**
 * react-router v7.7.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var p0="popstate";function sx(n={}){function e(i,s){let{pathname:o,search:l,hash:c}=i.location;return hp("",{pathname:o,search:l,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(i,s){return typeof s=="string"?s:$a(s)}return ox(e,t,null,n)}function ot(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function qn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function rx(){return Math.random().toString(36).substring(2,10)}function g0(n,e){return{usr:n.state,key:n.key,idx:e}}function hp(n,e,t=null,i){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?ho(e):e,state:t,key:e&&e.key||i||rx()}}function $a({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function ho(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let i=n.indexOf("?");i>=0&&(e.search=n.substring(i),n=n.substring(0,i)),n&&(e.pathname=n)}return e}function ox(n,e,t,i={}){let{window:s=document.defaultView,v5Compat:o=!1}=i,l=s.history,c="POP",f=null,d=p();d==null&&(d=0,l.replaceState({...l.state,idx:d},""));function p(){return(l.state||{idx:null}).idx}function _(){c="POP";let M=p(),C=M==null?null:M-d;d=M,f&&f({action:c,location:S.location,delta:C})}function y(M,C){c="PUSH";let U=hp(S.location,M,C);d=p()+1;let R=g0(U,d),D=S.createHref(U);try{l.pushState(R,"",D)}catch(B){if(B instanceof DOMException&&B.name==="DataCloneError")throw B;s.location.assign(D)}o&&f&&f({action:c,location:S.location,delta:1})}function v(M,C){c="REPLACE";let U=hp(S.location,M,C);d=p();let R=g0(U,d),D=S.createHref(U);l.replaceState(R,"",D),o&&f&&f({action:c,location:S.location,delta:0})}function x(M){return ax(M)}let S={get action(){return c},get location(){return n(s,l)},listen(M){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(p0,_),f=M,()=>{s.removeEventListener(p0,_),f=null}},createHref(M){return e(s,M)},createURL:x,encodeLocation(M){let C=x(M);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:y,replace:v,go(M){return l.go(M)}};return S}function ax(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ot(t,"No window.location.(origin|href) available to create URL");let i=typeof n=="string"?n:$a(n);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=t+i),new URL(i,t)}function x4(n,e,t="/"){return lx(n,e,t,!1)}function lx(n,e,t,i){let s=typeof e=="string"?ho(e):e,o=bi(s.pathname||"/",t);if(o==null)return null;let l=T4(n);cx(l);let c=null;for(let f=0;c==null&&f<l.length;++f){let d=vx(o);c=yx(l[f],d,i)}return c}function T4(n,e=[],t=[],i=""){let s=(o,l,c)=>{let f={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};f.relativePath.startsWith("/")&&(ot(f.relativePath.startsWith(i),`Absolute route path "${f.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),f.relativePath=f.relativePath.slice(i.length));let d=yi([i,f.relativePath]),p=t.concat(f);o.children&&o.children.length>0&&(ot(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${d}".`),T4(o.children,e,p,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:mx(d,o.index),routesMeta:p})};return n.forEach((o,l)=>{if(o.path===""||!o.path?.includes("?"))s(o,l);else for(let c of w4(o.path))s(o,l,c)}),e}function w4(n){let e=n.split("/");if(e.length===0)return[];let[t,...i]=e,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(i.length===0)return s?[o,""]:[o];let l=w4(i.join("/")),c=[];return c.push(...l.map(f=>f===""?o:[o,f].join("/"))),s&&c.push(...l),c.map(f=>n.startsWith("/")&&f===""?"/":f)}function cx(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:_x(e.routesMeta.map(i=>i.childrenIndex),t.routesMeta.map(i=>i.childrenIndex)))}var ux=/^:[\w-]+$/,fx=3,hx=2,dx=1,px=10,gx=-2,m0=n=>n==="*";function mx(n,e){let t=n.split("/"),i=t.length;return t.some(m0)&&(i+=gx),e&&(i+=hx),t.filter(s=>!m0(s)).reduce((s,o)=>s+(ux.test(o)?fx:o===""?dx:px),i)}function _x(n,e){return n.length===e.length&&n.slice(0,-1).every((i,s)=>i===e[s])?n[n.length-1]-e[e.length-1]:0}function yx(n,e,t=!1){let{routesMeta:i}=n,s={},o="/",l=[];for(let c=0;c<i.length;++c){let f=i[c],d=c===i.length-1,p=o==="/"?e:e.slice(o.length)||"/",_=hu({path:f.relativePath,caseSensitive:f.caseSensitive,end:d},p),y=f.route;if(!_&&d&&t&&!i[i.length-1].route.index&&(_=hu({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},p)),!_)return null;Object.assign(s,_.params),l.push({params:s,pathname:yi([o,_.pathname]),pathnameBase:Sx(yi([o,_.pathnameBase])),route:y}),_.pathnameBase!=="/"&&(o=yi([o,_.pathnameBase]))}return l}function hu(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,i]=bx(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:i.reduce((d,{paramName:p,isOptional:_},y)=>{if(p==="*"){let x=c[y]||"";l=o.slice(0,o.length-x.length).replace(/(.)\/+$/,"$1")}const v=c[y];return _&&!v?d[p]=void 0:d[p]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:l,pattern:n}}function bx(n,e=!1,t=!0){qn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let i=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,f)=>(i.push({paramName:c,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(i.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),i]}function vx(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function bi(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,i=n.charAt(t);return i&&i!=="/"?null:n.slice(t)||"/"}function xx(n,e="/"){let{pathname:t,search:i="",hash:s=""}=typeof n=="string"?ho(n):n;return{pathname:t?t.startsWith("/")?t:Tx(t,e):e,search:Ax(i),hash:Ex(s)}}function Tx(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function _d(n,e,t,i){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wx(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function S4(n){let e=wx(n);return e.map((t,i)=>i===e.length-1?t.pathname:t.pathnameBase)}function A4(n,e,t,i=!1){let s;typeof n=="string"?s=ho(n):(s={...n},ot(!s.pathname||!s.pathname.includes("?"),_d("?","pathname","search",s)),ot(!s.pathname||!s.pathname.includes("#"),_d("#","pathname","hash",s)),ot(!s.search||!s.search.includes("#"),_d("#","search","hash",s)));let o=n===""||s.pathname==="",l=o?"/":s.pathname,c;if(l==null)c=t;else{let _=e.length-1;if(!i&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),_-=1;s.pathname=y.join("/")}c=_>=0?e[_]:"/"}let f=xx(s,c),d=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(d||p)&&(f.pathname+="/"),f}var yi=n=>n.join("/").replace(/\/\/+/g,"/"),Sx=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Ax=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Ex=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Cx(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var E4=["POST","PUT","PATCH","DELETE"];new Set(E4);var Rx=["GET",...E4];new Set(Rx);var po=L.createContext(null);po.displayName="DataRouter";var Uu=L.createContext(null);Uu.displayName="DataRouterState";L.createContext(!1);var C4=L.createContext({isTransitioning:!1});C4.displayName="ViewTransition";var Mx=L.createContext(new Map);Mx.displayName="Fetchers";var Px=L.createContext(null);Px.displayName="Await";var Kn=L.createContext(null);Kn.displayName="Navigation";var Ja=L.createContext(null);Ja.displayName="Location";var Ti=L.createContext({outlet:null,matches:[],isDataRoute:!1});Ti.displayName="Route";var ig=L.createContext(null);ig.displayName="RouteError";function Ox(n,{relative:e}={}){ot(el(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:i}=L.useContext(Kn),{hash:s,pathname:o,search:l}=tl(n,{relative:e}),c=o;return t!=="/"&&(c=o==="/"?t:yi([t,o])),i.createHref({pathname:c,search:l,hash:s})}function el(){return L.useContext(Ja)!=null}function Hs(){return ot(el(),"useLocation() may be used only in the context of a <Router> component."),L.useContext(Ja).location}var R4="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function M4(n){L.useContext(Kn).static||L.useLayoutEffect(n)}function Ix(){let{isDataRoute:n}=L.useContext(Ti);return n?Wx():Nx()}function Nx(){ot(el(),"useNavigate() may be used only in the context of a <Router> component.");let n=L.useContext(po),{basename:e,navigator:t}=L.useContext(Kn),{matches:i}=L.useContext(Ti),{pathname:s}=Hs(),o=JSON.stringify(S4(i)),l=L.useRef(!1);return M4(()=>{l.current=!0}),L.useCallback((f,d={})=>{if(qn(l.current,R4),!l.current)return;if(typeof f=="number"){t.go(f);return}let p=A4(f,JSON.parse(o),s,d.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:yi([e,p.pathname])),(d.replace?t.replace:t.push)(p,d.state,d)},[e,t,o,s,n])}L.createContext(null);function tl(n,{relative:e}={}){let{matches:t}=L.useContext(Ti),{pathname:i}=Hs(),s=JSON.stringify(S4(t));return L.useMemo(()=>A4(n,JSON.parse(s),i,e==="path"),[n,s,i,e])}function kx(n,e){return P4(n,e)}function P4(n,e,t,i){ot(el(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=L.useContext(Kn),{matches:o}=L.useContext(Ti),l=o[o.length-1],c=l?l.params:{},f=l?l.pathname:"/",d=l?l.pathnameBase:"/",p=l&&l.route;{let C=p&&p.path||"";O4(f,!p||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let _=Hs(),y;if(e){let C=typeof e=="string"?ho(e):e;ot(d==="/"||C.pathname?.startsWith(d),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${d}" but pathname "${C.pathname}" was given in the \`location\` prop.`),y=C}else y=_;let v=y.pathname||"/",x=v;if(d!=="/"){let C=d.replace(/^\//,"").split("/");x="/"+v.replace(/^\//,"").split("/").slice(C.length).join("/")}let S=x4(n,{pathname:x});qn(p||S!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),qn(S==null||S[S.length-1].route.element!==void 0||S[S.length-1].route.Component!==void 0||S[S.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=Fx(S&&S.map(C=>Object.assign({},C,{params:Object.assign({},c,C.params),pathname:yi([d,s.encodeLocation?s.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?d:yi([d,s.encodeLocation?s.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,t,i);return e&&M?L.createElement(Ja.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},M):M}function Dx(){let n=$x(),e=Cx(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,i="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:i},o={padding:"2px 4px",backgroundColor:i},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=L.createElement(L.Fragment,null,L.createElement("p",null," Hey developer "),L.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",L.createElement("code",{style:o},"ErrorBoundary")," or"," ",L.createElement("code",{style:o},"errorElement")," prop on your route.")),L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),t?L.createElement("pre",{style:s},t):null,l)}var Lx=L.createElement(Dx,null),Bx=class extends L.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?L.createElement(Ti.Provider,{value:this.props.routeContext},L.createElement(ig.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ux({routeContext:n,match:e,children:t}){let i=L.useContext(po);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),L.createElement(Ti.Provider,{value:n},t)}function Fx(n,e=[],t=null,i=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,o=t?.errors;if(o!=null){let f=s.findIndex(d=>d.route.id&&o?.[d.route.id]!==void 0);ot(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),s=s.slice(0,Math.min(s.length,f+1))}let l=!1,c=-1;if(t)for(let f=0;f<s.length;f++){let d=s[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:p,errors:_}=t,y=d.route.loader&&!p.hasOwnProperty(d.route.id)&&(!_||_[d.route.id]===void 0);if(d.route.lazy||y){l=!0,c>=0?s=s.slice(0,c+1):s=[s[0]];break}}}return s.reduceRight((f,d,p)=>{let _,y=!1,v=null,x=null;t&&(_=o&&d.route.id?o[d.route.id]:void 0,v=d.route.errorElement||Lx,l&&(c<0&&p===0?(O4("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,x=null):c===p&&(y=!0,x=d.route.hydrateFallbackElement||null)));let S=e.concat(s.slice(0,p+1)),M=()=>{let C;return _?C=v:y?C=x:d.route.Component?C=L.createElement(d.route.Component,null):d.route.element?C=d.route.element:C=f,L.createElement(Ux,{match:d,routeContext:{outlet:f,matches:S,isDataRoute:t!=null},children:C})};return t&&(d.route.ErrorBoundary||d.route.errorElement||p===0)?L.createElement(Bx,{location:t.location,revalidation:t.revalidation,component:v,error:_,children:M(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):M()},null)}function sg(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zx(n){let e=L.useContext(po);return ot(e,sg(n)),e}function jx(n){let e=L.useContext(Uu);return ot(e,sg(n)),e}function Vx(n){let e=L.useContext(Ti);return ot(e,sg(n)),e}function rg(n){let e=Vx(n),t=e.matches[e.matches.length-1];return ot(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Hx(){return rg("useRouteId")}function $x(){let n=L.useContext(ig),e=jx("useRouteError"),t=rg("useRouteError");return n!==void 0?n:e.errors?.[t]}function Wx(){let{router:n}=zx("useNavigate"),e=rg("useNavigate"),t=L.useRef(!1);return M4(()=>{t.current=!0}),L.useCallback(async(s,o={})=>{qn(t.current,R4),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...o}))},[n,e])}var _0={};function O4(n,e,t){!e&&!_0[n]&&(_0[n]=!0,qn(!1,t))}L.memo(Xx);function Xx({routes:n,future:e,state:t}){return P4(n,void 0,t,e)}function Zc(n){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Yx({basename:n="/",children:e=null,location:t,navigationType:i="POP",navigator:s,static:o=!1}){ot(!el(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),c=L.useMemo(()=>({basename:l,navigator:s,static:o,future:{}}),[l,s,o]);typeof t=="string"&&(t=ho(t));let{pathname:f="/",search:d="",hash:p="",state:_=null,key:y="default"}=t,v=L.useMemo(()=>{let x=bi(f,l);return x==null?null:{location:{pathname:x,search:d,hash:p,state:_,key:y},navigationType:i}},[l,f,d,p,_,y,i]);return qn(v!=null,`<Router basename="${l}"> is not able to match the URL "${f}${d}${p}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:L.createElement(Kn.Provider,{value:c},L.createElement(Ja.Provider,{children:e,value:v}))}function qx({children:n,location:e}){return kx(dp(n),e)}function dp(n,e=[]){let t=[];return L.Children.forEach(n,(i,s)=>{if(!L.isValidElement(i))return;let o=[...e,s];if(i.type===L.Fragment){t.push.apply(t,dp(i.props.children,o));return}ot(i.type===Zc,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!i.props.index||!i.props.children,"An index route cannot have child routes.");let l={id:i.props.id||o.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(l.children=dp(i.props.children,o)),t.push(l)}),t}var Kc="get",Gc="application/x-www-form-urlencoded";function Fu(n){return n!=null&&typeof n.tagName=="string"}function Zx(n){return Fu(n)&&n.tagName.toLowerCase()==="button"}function Kx(n){return Fu(n)&&n.tagName.toLowerCase()==="form"}function Gx(n){return Fu(n)&&n.tagName.toLowerCase()==="input"}function Qx(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Jx(n,e){return n.button===0&&(!e||e==="_self")&&!Qx(n)}var Sc=null;function eT(){if(Sc===null)try{new FormData(document.createElement("form"),0),Sc=!1}catch{Sc=!0}return Sc}var tT=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yd(n){return n!=null&&!tT.has(n)?(qn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gc}"`),null):n}function nT(n,e){let t,i,s,o,l;if(Kx(n)){let c=n.getAttribute("action");i=c?bi(c,e):null,t=n.getAttribute("method")||Kc,s=yd(n.getAttribute("enctype"))||Gc,o=new FormData(n)}else if(Zx(n)||Gx(n)&&(n.type==="submit"||n.type==="image")){let c=n.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||c.getAttribute("action");if(i=f?bi(f,e):null,t=n.getAttribute("formmethod")||c.getAttribute("method")||Kc,s=yd(n.getAttribute("formenctype"))||yd(c.getAttribute("enctype"))||Gc,o=new FormData(c,n),!eT()){let{name:d,type:p,value:_}=n;if(p==="image"){let y=d?`${d}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else d&&o.append(d,_)}}else{if(Fu(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Kc,i=null,s=Gc,l=n}return o&&s==="text/plain"&&(l=o,o=void 0),{action:i,method:t.toLowerCase(),encType:s,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function og(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function iT(n,e,t){let i=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return i.pathname==="/"?i.pathname=`_root.${t}`:e&&bi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${t}`,i}async function sT(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function rT(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function oT(n,e,t){let i=await Promise.all(n.map(async s=>{let o=e.routes[s.route.id];if(o){let l=await sT(o,t);return l.links?l.links():[]}return[]}));return uT(i.flat(1).filter(rT).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function y0(n,e,t,i,s,o){let l=(f,d)=>t[d]?f.route.id!==t[d].route.id:!0,c=(f,d)=>t[d].pathname!==f.pathname||t[d].route.path?.endsWith("*")&&t[d].params["*"]!==f.params["*"];return o==="assets"?e.filter((f,d)=>l(f,d)||c(f,d)):o==="data"?e.filter((f,d)=>{let p=i.routes[f.route.id];if(!p||!p.hasLoader)return!1;if(l(f,d)||c(f,d))return!0;if(f.route.shouldRevalidate){let _=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function aT(n,e,{includeHydrateFallback:t}={}){return lT(n.map(i=>{let s=e.routes[i.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function lT(n){return[...new Set(n)]}function cT(n){let e={},t=Object.keys(n).sort();for(let i of t)e[i]=n[i];return e}function uT(n,e){let t=new Set;return new Set(e),n.reduce((i,s)=>{let o=JSON.stringify(cT(s));return t.has(o)||(t.add(o),i.push({key:o,link:s})),i},[])}function I4(){let n=L.useContext(po);return og(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function fT(){let n=L.useContext(Uu);return og(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var ag=L.createContext(void 0);ag.displayName="FrameworkContext";function N4(){let n=L.useContext(ag);return og(n,"You must render this element inside a <HydratedRouter> element"),n}function hT(n,e){let t=L.useContext(ag),[i,s]=L.useState(!1),[o,l]=L.useState(!1),{onFocus:c,onBlur:f,onMouseEnter:d,onMouseLeave:p,onTouchStart:_}=e,y=L.useRef(null);L.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let S=C=>{C.forEach(U=>{l(U.isIntersecting)})},M=new IntersectionObserver(S,{threshold:.5});return y.current&&M.observe(y.current),()=>{M.disconnect()}}},[n]),L.useEffect(()=>{if(i){let S=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(S)}}},[i]);let v=()=>{s(!0)},x=()=>{s(!1),l(!1)};return t?n!=="intent"?[o,y,{}]:[o,y,{onFocus:ba(c,v),onBlur:ba(f,x),onMouseEnter:ba(d,v),onMouseLeave:ba(p,x),onTouchStart:ba(_,v)}]:[!1,y,{}]}function ba(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function dT({page:n,...e}){let{router:t}=I4(),i=L.useMemo(()=>x4(t.routes,n,t.basename),[t.routes,n,t.basename]);return i?L.createElement(gT,{page:n,matches:i,...e}):null}function pT(n){let{manifest:e,routeModules:t}=N4(),[i,s]=L.useState([]);return L.useEffect(()=>{let o=!1;return oT(n,e,t).then(l=>{o||s(l)}),()=>{o=!0}},[n,e,t]),i}function gT({page:n,matches:e,...t}){let i=Hs(),{manifest:s,routeModules:o}=N4(),{basename:l}=I4(),{loaderData:c,matches:f}=fT(),d=L.useMemo(()=>y0(n,e,f,s,i,"data"),[n,e,f,s,i]),p=L.useMemo(()=>y0(n,e,f,s,i,"assets"),[n,e,f,s,i]),_=L.useMemo(()=>{if(n===i.pathname+i.search+i.hash)return[];let x=new Set,S=!1;if(e.forEach(C=>{let U=s.routes[C.route.id];!U||!U.hasLoader||(!d.some(R=>R.route.id===C.route.id)&&C.route.id in c&&o[C.route.id]?.shouldRevalidate||U.hasClientLoader?S=!0:x.add(C.route.id))}),x.size===0)return[];let M=iT(n,l,"data");return S&&x.size>0&&M.searchParams.set("_routes",e.filter(C=>x.has(C.route.id)).map(C=>C.route.id).join(",")),[M.pathname+M.search]},[l,c,i,s,d,e,n,o]),y=L.useMemo(()=>aT(p,s),[p,s]),v=pT(p);return L.createElement(L.Fragment,null,_.map(x=>L.createElement("link",{key:x,rel:"prefetch",as:"fetch",href:x,...t})),y.map(x=>L.createElement("link",{key:x,rel:"modulepreload",href:x,...t})),v.map(({key:x,link:S})=>L.createElement("link",{key:x,...S})))}function mT(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var k4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{k4&&(window.__reactRouterVersion="7.7.0")}catch{}function _T({basename:n,children:e,window:t}){let i=L.useRef();i.current==null&&(i.current=sx({window:t,v5Compat:!0}));let s=i.current,[o,l]=L.useState({action:s.action,location:s.location}),c=L.useCallback(f=>{L.startTransition(()=>l(f))},[l]);return L.useLayoutEffect(()=>s.listen(c),[s,c]),L.createElement(Yx,{basename:n,children:e,location:o.location,navigationType:o.action,navigator:s})}var D4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lg=L.forwardRef(function({onClick:e,discover:t="render",prefetch:i="none",relative:s,reloadDocument:o,replace:l,state:c,target:f,to:d,preventScrollReset:p,viewTransition:_,...y},v){let{basename:x}=L.useContext(Kn),S=typeof d=="string"&&D4.test(d),M,C=!1;if(typeof d=="string"&&S&&(M=d,k4))try{let ee=new URL(window.location.href),he=d.startsWith("//")?new URL(ee.protocol+d):new URL(d),de=bi(he.pathname,x);he.origin===ee.origin&&de!=null?d=de+he.search+he.hash:C=!0}catch{qn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let U=Ox(d,{relative:s}),[R,D,B]=hT(i,y),Q=vT(d,{replace:l,state:c,target:f,preventScrollReset:p,relative:s,viewTransition:_});function ce(ee){e&&e(ee),ee.defaultPrevented||Q(ee)}let Z=L.createElement("a",{...y,...B,href:M||U,onClick:C||o?e:ce,ref:mT(v,D),target:f,"data-discover":!S&&t==="render"?"true":void 0});return R&&!S?L.createElement(L.Fragment,null,Z,L.createElement(dT,{page:U})):Z});lg.displayName="Link";var cg=L.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:i="",end:s=!1,style:o,to:l,viewTransition:c,children:f,...d},p){let _=tl(l,{relative:d.relative}),y=Hs(),v=L.useContext(Uu),{navigator:x,basename:S}=L.useContext(Kn),M=v!=null&&AT(_)&&c===!0,C=x.encodeLocation?x.encodeLocation(_).pathname:_.pathname,U=y.pathname,R=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;t||(U=U.toLowerCase(),R=R?R.toLowerCase():null,C=C.toLowerCase()),R&&S&&(R=bi(R,S)||R);const D=C!=="/"&&C.endsWith("/")?C.length-1:C.length;let B=U===C||!s&&U.startsWith(C)&&U.charAt(D)==="/",Q=R!=null&&(R===C||!s&&R.startsWith(C)&&R.charAt(C.length)==="/"),ce={isActive:B,isPending:Q,isTransitioning:M},Z=B?e:void 0,ee;typeof i=="function"?ee=i(ce):ee=[i,B?"active":null,Q?"pending":null,M?"transitioning":null].filter(Boolean).join(" ");let he=typeof o=="function"?o(ce):o;return L.createElement(lg,{...d,"aria-current":Z,className:ee,ref:p,style:he,to:l,viewTransition:c},typeof f=="function"?f(ce):f)});cg.displayName="NavLink";var yT=L.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:i,replace:s,state:o,method:l=Kc,action:c,onSubmit:f,relative:d,preventScrollReset:p,viewTransition:_,...y},v)=>{let x=wT(),S=ST(c,{relative:d}),M=l.toLowerCase()==="get"?"get":"post",C=typeof c=="string"&&D4.test(c),U=R=>{if(f&&f(R),R.defaultPrevented)return;R.preventDefault();let D=R.nativeEvent.submitter,B=D?.getAttribute("formmethod")||l;x(D||R.currentTarget,{fetcherKey:e,method:B,navigate:t,replace:s,state:o,relative:d,preventScrollReset:p,viewTransition:_})};return L.createElement("form",{ref:v,method:M,action:S,onSubmit:i?f:U,...y,"data-discover":!C&&n==="render"?"true":void 0})});yT.displayName="Form";function bT(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function L4(n){let e=L.useContext(po);return ot(e,bT(n)),e}function vT(n,{target:e,replace:t,state:i,preventScrollReset:s,relative:o,viewTransition:l}={}){let c=Ix(),f=Hs(),d=tl(n,{relative:o});return L.useCallback(p=>{if(Jx(p,e)){p.preventDefault();let _=t!==void 0?t:$a(f)===$a(d);c(n,{replace:_,state:i,preventScrollReset:s,relative:o,viewTransition:l})}},[f,c,d,t,i,e,n,s,o,l])}var xT=0,TT=()=>`__${String(++xT)}__`;function wT(){let{router:n}=L4("useSubmit"),{basename:e}=L.useContext(Kn),t=Hx();return L.useCallback(async(i,s={})=>{let{action:o,method:l,encType:c,formData:f,body:d}=nT(i,e);if(s.navigate===!1){let p=s.fetcherKey||TT();await n.fetch(p,t,s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||l,formEncType:s.encType||c,flushSync:s.flushSync})}else await n.navigate(s.action||o,{preventScrollReset:s.preventScrollReset,formData:f,body:d,formMethod:s.method||l,formEncType:s.encType||c,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function ST(n,{relative:e}={}){let{basename:t}=L.useContext(Kn),i=L.useContext(Ti);ot(i,"useFormAction must be used inside a RouteContext");let[s]=i.matches.slice(-1),o={...tl(n||".",{relative:e})},l=Hs();if(n==null){o.search=l.search;let c=new URLSearchParams(o.search),f=c.getAll("index");if(f.some(p=>p==="")){c.delete("index"),f.filter(_=>_).forEach(_=>c.append("index",_));let p=c.toString();o.search=p?`?${p}`:""}}return(!n||n===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:yi([t,o.pathname])),$a(o)}function AT(n,e={}){let t=L.useContext(C4);ot(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=L4("useViewTransitionState"),s=tl(n,{relative:e.relative});if(!t.isTransitioning)return!1;let o=bi(t.currentLocation.pathname,i)||t.currentLocation.pathname,l=bi(t.nextLocation.pathname,i)||t.nextLocation.pathname;return hu(s.pathname,l)!=null||hu(s.pathname,o)!=null}var B4=v4();/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CT=n=>n.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,i)=>i?i.toUpperCase():t.toLowerCase()),b0=n=>{const e=CT(n);return e.charAt(0).toUpperCase()+e.slice(1)},U4=(...n)=>n.filter((e,t,i)=>!!e&&e.trim()!==""&&i.indexOf(e)===t).join(" ").trim(),RT=n=>{for(const e in n)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var MT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PT=L.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:i,className:s="",children:o,iconNode:l,...c},f)=>L.createElement("svg",{ref:f,...MT,width:e,height:e,stroke:n,strokeWidth:i?Number(t)*24/Number(e):t,className:U4("lucide",s),...!o&&!RT(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,p])=>L.createElement(d,p)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=(n,e)=>{const t=L.forwardRef(({className:i,...s},o)=>L.createElement(PT,{ref:o,iconNode:e,className:U4(`lucide-${ET(b0(n))}`,`lucide-${n}`,i),...s}));return t.displayName=b0(n),t};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],IT=Vt("arrow-down",OT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NT=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],kT=Vt("chart-column",NT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],LT=Vt("clipboard-list",DT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]],UT=Vt("code",BT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]],zT=Vt("instagram",FT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],VT=Vt("linkedin",jT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],$T=Vt("mail",HT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],XT=Vt("map-pin",WT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],qT=Vt("menu",YT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]],KT=Vt("moon",ZT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],QT=Vt("phone",GT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],ew=Vt("send",JT);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tw=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],nw=Vt("sun",tw);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iw=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],sw=Vt("twitter",iw);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rw=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ow=Vt("x",rw);function F4(n){var e,t,i="";if(typeof n=="string"||typeof n=="number")i+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=F4(n[e]))&&(i&&(i+=" "),i+=t)}else for(t in n)n[t]&&(i&&(i+=" "),i+=t);return i}function aw(){for(var n,e,t=0,i="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=F4(n))&&(i&&(i+=" "),i+=e);return i}const ug="-",lw=n=>{const e=uw(n),{conflictingClassGroups:t,conflictingClassGroupModifiers:i}=n;return{getClassGroupId:l=>{const c=l.split(ug);return c[0]===""&&c.length!==1&&c.shift(),z4(c,e)||cw(l)},getConflictingClassGroupIds:(l,c)=>{const f=t[l]||[];return c&&i[l]?[...f,...i[l]]:f}}},z4=(n,e)=>{if(n.length===0)return e.classGroupId;const t=n[0],i=e.nextPart.get(t),s=i?z4(n.slice(1),i):void 0;if(s)return s;if(e.validators.length===0)return;const o=n.join(ug);return e.validators.find(({validator:l})=>l(o))?.classGroupId},v0=/^\[(.+)\]$/,cw=n=>{if(v0.test(n)){const e=v0.exec(n)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},uw=n=>{const{theme:e,classGroups:t}=n,i={nextPart:new Map,validators:[]};for(const s in t)pp(t[s],i,s,e);return i},pp=(n,e,t,i)=>{n.forEach(s=>{if(typeof s=="string"){const o=s===""?e:x0(e,s);o.classGroupId=t;return}if(typeof s=="function"){if(fw(s)){pp(s(i),e,t,i);return}e.validators.push({validator:s,classGroupId:t});return}Object.entries(s).forEach(([o,l])=>{pp(l,x0(e,o),t,i)})})},x0=(n,e)=>{let t=n;return e.split(ug).forEach(i=>{t.nextPart.has(i)||t.nextPart.set(i,{nextPart:new Map,validators:[]}),t=t.nextPart.get(i)}),t},fw=n=>n.isThemeGetter,hw=n=>{if(n<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,i=new Map;const s=(o,l)=>{t.set(o,l),e++,e>n&&(e=0,i=t,t=new Map)};return{get(o){let l=t.get(o);if(l!==void 0)return l;if((l=i.get(o))!==void 0)return s(o,l),l},set(o,l){t.has(o)?t.set(o,l):s(o,l)}}},gp="!",mp=":",dw=mp.length,pw=n=>{const{prefix:e,experimentalParseClassName:t}=n;let i=s=>{const o=[];let l=0,c=0,f=0,d;for(let x=0;x<s.length;x++){let S=s[x];if(l===0&&c===0){if(S===mp){o.push(s.slice(f,x)),f=x+dw;continue}if(S==="/"){d=x;continue}}S==="["?l++:S==="]"?l--:S==="("?c++:S===")"&&c--}const p=o.length===0?s:s.substring(f),_=gw(p),y=_!==p,v=d&&d>f?d-f:void 0;return{modifiers:o,hasImportantModifier:y,baseClassName:_,maybePostfixModifierPosition:v}};if(e){const s=e+mp,o=i;i=l=>l.startsWith(s)?o(l.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:l,maybePostfixModifierPosition:void 0}}if(t){const s=i;i=o=>t({className:o,parseClassName:s})}return i},gw=n=>n.endsWith(gp)?n.substring(0,n.length-1):n.startsWith(gp)?n.substring(1):n,mw=n=>{const e=Object.fromEntries(n.orderSensitiveModifiers.map(i=>[i,!0]));return i=>{if(i.length<=1)return i;const s=[];let o=[];return i.forEach(l=>{l[0]==="["||e[l]?(s.push(...o.sort(),l),o=[]):o.push(l)}),s.push(...o.sort()),s}},_w=n=>({cache:hw(n.cacheSize),parseClassName:pw(n),sortModifiers:mw(n),...lw(n)}),yw=/\s+/,bw=(n,e)=>{const{parseClassName:t,getClassGroupId:i,getConflictingClassGroupIds:s,sortModifiers:o}=e,l=[],c=n.trim().split(yw);let f="";for(let d=c.length-1;d>=0;d-=1){const p=c[d],{isExternal:_,modifiers:y,hasImportantModifier:v,baseClassName:x,maybePostfixModifierPosition:S}=t(p);if(_){f=p+(f.length>0?" "+f:f);continue}let M=!!S,C=i(M?x.substring(0,S):x);if(!C){if(!M){f=p+(f.length>0?" "+f:f);continue}if(C=i(x),!C){f=p+(f.length>0?" "+f:f);continue}M=!1}const U=o(y).join(":"),R=v?U+gp:U,D=R+C;if(l.includes(D))continue;l.push(D);const B=s(C,M);for(let Q=0;Q<B.length;++Q){const ce=B[Q];l.push(R+ce)}f=p+(f.length>0?" "+f:f)}return f};function vw(){let n=0,e,t,i="";for(;n<arguments.length;)(e=arguments[n++])&&(t=j4(e))&&(i&&(i+=" "),i+=t);return i}const j4=n=>{if(typeof n=="string")return n;let e,t="";for(let i=0;i<n.length;i++)n[i]&&(e=j4(n[i]))&&(t&&(t+=" "),t+=e);return t};function xw(n,...e){let t,i,s,o=l;function l(f){const d=e.reduce((p,_)=>_(p),n());return t=_w(d),i=t.cache.get,s=t.cache.set,o=c,c(f)}function c(f){const d=i(f);if(d)return d;const p=bw(f,t);return s(f,p),p}return function(){return o(vw.apply(null,arguments))}}const vt=n=>{const e=t=>t[n]||[];return e.isThemeGetter=!0,e},V4=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,H4=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Tw=/^\d+\/\d+$/,ww=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Sw=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Aw=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,Ew=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Cw=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Dr=n=>Tw.test(n),Ie=n=>!!n&&!Number.isNaN(Number(n)),qi=n=>!!n&&Number.isInteger(Number(n)),bd=n=>n.endsWith("%")&&Ie(n.slice(0,-1)),hi=n=>ww.test(n),Rw=()=>!0,Mw=n=>Sw.test(n)&&!Aw.test(n),$4=()=>!1,Pw=n=>Ew.test(n),Ow=n=>Cw.test(n),Iw=n=>!be(n)&&!ve(n),Nw=n=>go(n,Y4,$4),be=n=>V4.test(n),Es=n=>go(n,q4,Mw),vd=n=>go(n,Uw,Ie),T0=n=>go(n,W4,$4),kw=n=>go(n,X4,Ow),Ac=n=>go(n,Z4,Pw),ve=n=>H4.test(n),va=n=>mo(n,q4),Dw=n=>mo(n,Fw),w0=n=>mo(n,W4),Lw=n=>mo(n,Y4),Bw=n=>mo(n,X4),Ec=n=>mo(n,Z4,!0),go=(n,e,t)=>{const i=V4.exec(n);return i?i[1]?e(i[1]):t(i[2]):!1},mo=(n,e,t=!1)=>{const i=H4.exec(n);return i?i[1]?e(i[1]):t:!1},W4=n=>n==="position"||n==="percentage",X4=n=>n==="image"||n==="url",Y4=n=>n==="length"||n==="size"||n==="bg-size",q4=n=>n==="length",Uw=n=>n==="number",Fw=n=>n==="family-name",Z4=n=>n==="shadow",zw=()=>{const n=vt("color"),e=vt("font"),t=vt("text"),i=vt("font-weight"),s=vt("tracking"),o=vt("leading"),l=vt("breakpoint"),c=vt("container"),f=vt("spacing"),d=vt("radius"),p=vt("shadow"),_=vt("inset-shadow"),y=vt("text-shadow"),v=vt("drop-shadow"),x=vt("blur"),S=vt("perspective"),M=vt("aspect"),C=vt("ease"),U=vt("animate"),R=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],B=()=>[...D(),ve,be],Q=()=>["auto","hidden","clip","visible","scroll"],ce=()=>["auto","contain","none"],Z=()=>[ve,be,f],ee=()=>[Dr,"full","auto",...Z()],he=()=>[qi,"none","subgrid",ve,be],de=()=>["auto",{span:["full",qi,ve,be]},qi,ve,be],_e=()=>[qi,"auto",ve,be],ge=()=>["auto","min","max","fr",ve,be],ue=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],Se=()=>["start","end","center","stretch","center-safe","end-safe"],w=()=>["auto",...Z()],N=()=>[Dr,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...Z()],O=()=>[n,ve,be],ne=()=>[...D(),w0,T0,{position:[ve,be]}],A=()=>["no-repeat",{repeat:["","x","y","space","round"]}],F=()=>["auto","cover","contain",Lw,Nw,{size:[ve,be]}],X=()=>[bd,va,Es],G=()=>["","none","full",d,ve,be],ae=()=>["",Ie,va,Es],fe=()=>["solid","dashed","dotted","double"],me=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],xe=()=>[Ie,bd,w0,T0],Te=()=>["","none",x,ve,be],We=()=>["none",Ie,ve,be],Be=()=>["none",Ie,ve,be],Ht=()=>[Ie,ve,be],$t=()=>[Dr,"full",...Z()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[hi],breakpoint:[hi],color:[Rw],container:[hi],"drop-shadow":[hi],ease:["in","out","in-out"],font:[Iw],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[hi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[hi],shadow:[hi],spacing:["px",Ie],text:[hi],"text-shadow":[hi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",Dr,be,ve,M]}],container:["container"],columns:[{columns:[Ie,be,ve,c]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:B()}],overflow:[{overflow:Q()}],"overflow-x":[{"overflow-x":Q()}],"overflow-y":[{"overflow-y":Q()}],overscroll:[{overscroll:ce()}],"overscroll-x":[{"overscroll-x":ce()}],"overscroll-y":[{"overscroll-y":ce()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:ee()}],"inset-x":[{"inset-x":ee()}],"inset-y":[{"inset-y":ee()}],start:[{start:ee()}],end:[{end:ee()}],top:[{top:ee()}],right:[{right:ee()}],bottom:[{bottom:ee()}],left:[{left:ee()}],visibility:["visible","invisible","collapse"],z:[{z:[qi,"auto",ve,be]}],basis:[{basis:[Dr,"full","auto",c,...Z()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Ie,Dr,"auto","initial","none",be]}],grow:[{grow:["",Ie,ve,be]}],shrink:[{shrink:["",Ie,ve,be]}],order:[{order:[qi,"first","last","none",ve,be]}],"grid-cols":[{"grid-cols":he()}],"col-start-end":[{col:de()}],"col-start":[{"col-start":_e()}],"col-end":[{"col-end":_e()}],"grid-rows":[{"grid-rows":he()}],"row-start-end":[{row:de()}],"row-start":[{"row-start":_e()}],"row-end":[{"row-end":_e()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":ge()}],"auto-rows":[{"auto-rows":ge()}],gap:[{gap:Z()}],"gap-x":[{"gap-x":Z()}],"gap-y":[{"gap-y":Z()}],"justify-content":[{justify:[...ue(),"normal"]}],"justify-items":[{"justify-items":[...Se(),"normal"]}],"justify-self":[{"justify-self":["auto",...Se()]}],"align-content":[{content:["normal",...ue()]}],"align-items":[{items:[...Se(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...Se(),{baseline:["","last"]}]}],"place-content":[{"place-content":ue()}],"place-items":[{"place-items":[...Se(),"baseline"]}],"place-self":[{"place-self":["auto",...Se()]}],p:[{p:Z()}],px:[{px:Z()}],py:[{py:Z()}],ps:[{ps:Z()}],pe:[{pe:Z()}],pt:[{pt:Z()}],pr:[{pr:Z()}],pb:[{pb:Z()}],pl:[{pl:Z()}],m:[{m:w()}],mx:[{mx:w()}],my:[{my:w()}],ms:[{ms:w()}],me:[{me:w()}],mt:[{mt:w()}],mr:[{mr:w()}],mb:[{mb:w()}],ml:[{ml:w()}],"space-x":[{"space-x":Z()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":Z()}],"space-y-reverse":["space-y-reverse"],size:[{size:N()}],w:[{w:[c,"screen",...N()]}],"min-w":[{"min-w":[c,"screen","none",...N()]}],"max-w":[{"max-w":[c,"screen","none","prose",{screen:[l]},...N()]}],h:[{h:["screen","lh",...N()]}],"min-h":[{"min-h":["screen","lh","none",...N()]}],"max-h":[{"max-h":["screen","lh",...N()]}],"font-size":[{text:["base",t,va,Es]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,ve,vd]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",bd,be]}],"font-family":[{font:[Dw,be,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,ve,be]}],"line-clamp":[{"line-clamp":[Ie,"none",ve,vd]}],leading:[{leading:[o,...Z()]}],"list-image":[{"list-image":["none",ve,be]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",ve,be]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:O()}],"text-color":[{text:O()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...fe(),"wavy"]}],"text-decoration-thickness":[{decoration:[Ie,"from-font","auto",ve,Es]}],"text-decoration-color":[{decoration:O()}],"underline-offset":[{"underline-offset":[Ie,"auto",ve,be]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Z()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ve,be]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ve,be]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ne()}],"bg-repeat":[{bg:A()}],"bg-size":[{bg:F()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},qi,ve,be],radial:["",ve,be],conic:[qi,ve,be]},Bw,kw]}],"bg-color":[{bg:O()}],"gradient-from-pos":[{from:X()}],"gradient-via-pos":[{via:X()}],"gradient-to-pos":[{to:X()}],"gradient-from":[{from:O()}],"gradient-via":[{via:O()}],"gradient-to":[{to:O()}],rounded:[{rounded:G()}],"rounded-s":[{"rounded-s":G()}],"rounded-e":[{"rounded-e":G()}],"rounded-t":[{"rounded-t":G()}],"rounded-r":[{"rounded-r":G()}],"rounded-b":[{"rounded-b":G()}],"rounded-l":[{"rounded-l":G()}],"rounded-ss":[{"rounded-ss":G()}],"rounded-se":[{"rounded-se":G()}],"rounded-ee":[{"rounded-ee":G()}],"rounded-es":[{"rounded-es":G()}],"rounded-tl":[{"rounded-tl":G()}],"rounded-tr":[{"rounded-tr":G()}],"rounded-br":[{"rounded-br":G()}],"rounded-bl":[{"rounded-bl":G()}],"border-w":[{border:ae()}],"border-w-x":[{"border-x":ae()}],"border-w-y":[{"border-y":ae()}],"border-w-s":[{"border-s":ae()}],"border-w-e":[{"border-e":ae()}],"border-w-t":[{"border-t":ae()}],"border-w-r":[{"border-r":ae()}],"border-w-b":[{"border-b":ae()}],"border-w-l":[{"border-l":ae()}],"divide-x":[{"divide-x":ae()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":ae()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...fe(),"hidden","none"]}],"divide-style":[{divide:[...fe(),"hidden","none"]}],"border-color":[{border:O()}],"border-color-x":[{"border-x":O()}],"border-color-y":[{"border-y":O()}],"border-color-s":[{"border-s":O()}],"border-color-e":[{"border-e":O()}],"border-color-t":[{"border-t":O()}],"border-color-r":[{"border-r":O()}],"border-color-b":[{"border-b":O()}],"border-color-l":[{"border-l":O()}],"divide-color":[{divide:O()}],"outline-style":[{outline:[...fe(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Ie,ve,be]}],"outline-w":[{outline:["",Ie,va,Es]}],"outline-color":[{outline:O()}],shadow:[{shadow:["","none",p,Ec,Ac]}],"shadow-color":[{shadow:O()}],"inset-shadow":[{"inset-shadow":["none",_,Ec,Ac]}],"inset-shadow-color":[{"inset-shadow":O()}],"ring-w":[{ring:ae()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:O()}],"ring-offset-w":[{"ring-offset":[Ie,Es]}],"ring-offset-color":[{"ring-offset":O()}],"inset-ring-w":[{"inset-ring":ae()}],"inset-ring-color":[{"inset-ring":O()}],"text-shadow":[{"text-shadow":["none",y,Ec,Ac]}],"text-shadow-color":[{"text-shadow":O()}],opacity:[{opacity:[Ie,ve,be]}],"mix-blend":[{"mix-blend":[...me(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":me()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Ie]}],"mask-image-linear-from-pos":[{"mask-linear-from":xe()}],"mask-image-linear-to-pos":[{"mask-linear-to":xe()}],"mask-image-linear-from-color":[{"mask-linear-from":O()}],"mask-image-linear-to-color":[{"mask-linear-to":O()}],"mask-image-t-from-pos":[{"mask-t-from":xe()}],"mask-image-t-to-pos":[{"mask-t-to":xe()}],"mask-image-t-from-color":[{"mask-t-from":O()}],"mask-image-t-to-color":[{"mask-t-to":O()}],"mask-image-r-from-pos":[{"mask-r-from":xe()}],"mask-image-r-to-pos":[{"mask-r-to":xe()}],"mask-image-r-from-color":[{"mask-r-from":O()}],"mask-image-r-to-color":[{"mask-r-to":O()}],"mask-image-b-from-pos":[{"mask-b-from":xe()}],"mask-image-b-to-pos":[{"mask-b-to":xe()}],"mask-image-b-from-color":[{"mask-b-from":O()}],"mask-image-b-to-color":[{"mask-b-to":O()}],"mask-image-l-from-pos":[{"mask-l-from":xe()}],"mask-image-l-to-pos":[{"mask-l-to":xe()}],"mask-image-l-from-color":[{"mask-l-from":O()}],"mask-image-l-to-color":[{"mask-l-to":O()}],"mask-image-x-from-pos":[{"mask-x-from":xe()}],"mask-image-x-to-pos":[{"mask-x-to":xe()}],"mask-image-x-from-color":[{"mask-x-from":O()}],"mask-image-x-to-color":[{"mask-x-to":O()}],"mask-image-y-from-pos":[{"mask-y-from":xe()}],"mask-image-y-to-pos":[{"mask-y-to":xe()}],"mask-image-y-from-color":[{"mask-y-from":O()}],"mask-image-y-to-color":[{"mask-y-to":O()}],"mask-image-radial":[{"mask-radial":[ve,be]}],"mask-image-radial-from-pos":[{"mask-radial-from":xe()}],"mask-image-radial-to-pos":[{"mask-radial-to":xe()}],"mask-image-radial-from-color":[{"mask-radial-from":O()}],"mask-image-radial-to-color":[{"mask-radial-to":O()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":D()}],"mask-image-conic-pos":[{"mask-conic":[Ie]}],"mask-image-conic-from-pos":[{"mask-conic-from":xe()}],"mask-image-conic-to-pos":[{"mask-conic-to":xe()}],"mask-image-conic-from-color":[{"mask-conic-from":O()}],"mask-image-conic-to-color":[{"mask-conic-to":O()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ne()}],"mask-repeat":[{mask:A()}],"mask-size":[{mask:F()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",ve,be]}],filter:[{filter:["","none",ve,be]}],blur:[{blur:Te()}],brightness:[{brightness:[Ie,ve,be]}],contrast:[{contrast:[Ie,ve,be]}],"drop-shadow":[{"drop-shadow":["","none",v,Ec,Ac]}],"drop-shadow-color":[{"drop-shadow":O()}],grayscale:[{grayscale:["",Ie,ve,be]}],"hue-rotate":[{"hue-rotate":[Ie,ve,be]}],invert:[{invert:["",Ie,ve,be]}],saturate:[{saturate:[Ie,ve,be]}],sepia:[{sepia:["",Ie,ve,be]}],"backdrop-filter":[{"backdrop-filter":["","none",ve,be]}],"backdrop-blur":[{"backdrop-blur":Te()}],"backdrop-brightness":[{"backdrop-brightness":[Ie,ve,be]}],"backdrop-contrast":[{"backdrop-contrast":[Ie,ve,be]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Ie,ve,be]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Ie,ve,be]}],"backdrop-invert":[{"backdrop-invert":["",Ie,ve,be]}],"backdrop-opacity":[{"backdrop-opacity":[Ie,ve,be]}],"backdrop-saturate":[{"backdrop-saturate":[Ie,ve,be]}],"backdrop-sepia":[{"backdrop-sepia":["",Ie,ve,be]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":Z()}],"border-spacing-x":[{"border-spacing-x":Z()}],"border-spacing-y":[{"border-spacing-y":Z()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",ve,be]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Ie,"initial",ve,be]}],ease:[{ease:["linear","initial",C,ve,be]}],delay:[{delay:[Ie,ve,be]}],animate:[{animate:["none",U,ve,be]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[S,ve,be]}],"perspective-origin":[{"perspective-origin":B()}],rotate:[{rotate:We()}],"rotate-x":[{"rotate-x":We()}],"rotate-y":[{"rotate-y":We()}],"rotate-z":[{"rotate-z":We()}],scale:[{scale:Be()}],"scale-x":[{"scale-x":Be()}],"scale-y":[{"scale-y":Be()}],"scale-z":[{"scale-z":Be()}],"scale-3d":["scale-3d"],skew:[{skew:Ht()}],"skew-x":[{"skew-x":Ht()}],"skew-y":[{"skew-y":Ht()}],transform:[{transform:[ve,be,"","none","gpu","cpu"]}],"transform-origin":[{origin:B()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:$t()}],"translate-x":[{"translate-x":$t()}],"translate-y":[{"translate-y":$t()}],"translate-z":[{"translate-z":$t()}],"translate-none":["translate-none"],accent:[{accent:O()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:O()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ve,be]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Z()}],"scroll-mx":[{"scroll-mx":Z()}],"scroll-my":[{"scroll-my":Z()}],"scroll-ms":[{"scroll-ms":Z()}],"scroll-me":[{"scroll-me":Z()}],"scroll-mt":[{"scroll-mt":Z()}],"scroll-mr":[{"scroll-mr":Z()}],"scroll-mb":[{"scroll-mb":Z()}],"scroll-ml":[{"scroll-ml":Z()}],"scroll-p":[{"scroll-p":Z()}],"scroll-px":[{"scroll-px":Z()}],"scroll-py":[{"scroll-py":Z()}],"scroll-ps":[{"scroll-ps":Z()}],"scroll-pe":[{"scroll-pe":Z()}],"scroll-pt":[{"scroll-pt":Z()}],"scroll-pr":[{"scroll-pr":Z()}],"scroll-pb":[{"scroll-pb":Z()}],"scroll-pl":[{"scroll-pl":Z()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ve,be]}],fill:[{fill:["none",...O()]}],"stroke-w":[{stroke:[Ie,va,Es,vd]}],stroke:[{stroke:["none",...O()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},jw=xw(zw),Wa=(...n)=>jw(aw(n)),_p=()=>{const[n,e]=L.useState(!1);L.useEffect(()=>{localStorage.getItem("theme")==="dark"?(e(!0),document.documentElement.classList.add("dark")):(localStorage.setItem("theme","light"),e(!1))},[]);const t=()=>{n?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"),e(!1)):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark"),e(!0))};return P.jsx("button",{onClick:t,className:Wa("fixed max-sm:hidden top-[16px] right-4 z-50 p-2 rounded-full transition-colors duration-300","focus:outlin-hidden"),children:n?P.jsx(nw,{className:"h-5 w-5 text-yellow-300"}):P.jsx(KT,{className:"h-5 w-5 text-blue-900"})})},Vw=()=>{const[n,e]=L.useState([]),[t,i]=L.useState(!1);L.useEffect(()=>{const o=()=>{const c=document.documentElement.classList.contains("dark");i(c)};o();const l=new MutationObserver(o);return l.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>l.disconnect()},[]),L.useEffect(()=>{t&&s();const o=()=>{t&&s()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[t]);const s=()=>{const o=Math.floor(window.innerWidth*window.innerHeight/1e4),l=[];for(let c=0;c<o;c++)l.push({id:c,size:Math.random()*3+1,x:Math.random()*100,y:Math.random()*100,opacity:Math.random()*.5+.5,animationDuration:Math.random()*4+2});e(l)};return t?P.jsx("div",{id:"stars",className:"fixed inset-0 overflow-hidden pointer-events-none z-0",children:n.map(o=>P.jsx("div",{className:"star animate-pulse-subtle",style:{width:o.size+"px",height:o.size+"px",left:o.x+"%",top:o.y+"%",opacity:o.opacity,animationDuration:o.animationDuration+"s",backgroundColor:"white",borderRadius:"50%",position:"absolute"}},o.id))}):null};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var yp=function(){return yp=Object.assign||function(e){for(var t,i=1,s=arguments.length;i<s;i++){t=arguments[i];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},yp.apply(this,arguments)};function Hw(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(n);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(n,i[s])&&(t[i[s]]=n[i[s]]);return t}var Zr="",ka=null,Qc=null,K4=null;function fg(){Zr="",ka!==null&&ka.disconnect(),Qc!==null&&(window.clearTimeout(Qc),Qc=null)}function S0(n){var e=["BUTTON","INPUT","SELECT","TEXTAREA"],t=["A","AREA"];return e.includes(n.tagName)&&!n.hasAttribute("disabled")||t.includes(n.tagName)&&n.hasAttribute("href")}function A0(){var n=null;if(Zr==="#")n=document.body;else{var e=Zr.replace("#","");n=document.getElementById(e),n===null&&Zr==="#top"&&(n=document.body)}if(n!==null){K4(n);var t=n.getAttribute("tabindex");return t===null&&!S0(n)&&n.setAttribute("tabindex",-1),n.focus({preventScroll:!0}),t===null&&!S0(n)&&(n.blur(),n.removeAttribute("tabindex")),fg(),!0}return!1}function $w(n){window.setTimeout(function(){A0()===!1&&(ka===null&&(ka=new MutationObserver(A0)),ka.observe(document,{attributes:!0,childList:!0,subtree:!0}),Qc=window.setTimeout(function(){fg()},n||1e4))},0)}function G4(n){return fp.forwardRef(function(e,t){var i="";typeof e.to=="string"&&e.to.includes("#")?i="#"+e.to.split("#").slice(1).join("#"):typeof e.to=="object"&&typeof e.to.hash=="string"&&(i=e.to.hash);var s={};n===cg&&(s.isActive=function(c,f){return c&&c.isExact&&f.hash===i});function o(c){fg(),Zr=e.elementId?"#"+e.elementId:i,e.onClick&&e.onClick(c),Zr!==""&&!c.defaultPrevented&&c.button===0&&(!e.target||e.target==="_self")&&!(c.metaKey||c.altKey||c.ctrlKey||c.shiftKey)&&(K4=e.scroll||function(f){return e.smooth?f.scrollIntoView({behavior:"smooth"}):f.scrollIntoView()},$w(e.timeout))}var l=Hw(e,["scroll","smooth","timeout","elementId"]);return fp.createElement(n,yp({},s,l,{onClick:o,ref:t}),e.children)})}var xa=G4(lg);G4(cg);const E0=[{name:"Home",href:"/#hero"},{name:"About",href:"/#about"},{name:"Skills",href:"/#skills"},{name:"Projects",href:"/#projects"},{name:"Contact",href:"/#contact"}],Ww=()=>{const[n,e]=L.useState(!1),[t,i]=L.useState(!1);return L.useEffect(()=>{const s=()=>{e(window.scrollY>10)};return window.addEventListener("scroll",s),()=>window.removeEventListener("scroll",s)},[]),L.useEffect(()=>{const s=()=>{window.innerWidth>=768&&i(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),L.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),P.jsx("nav",{className:Wa("fixed w-full z-40 transition-all duration-300",n?"py-3 bg-background/80 backdrop-blur-md shadow-xs":"py-5"),children:P.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between",children:[P.jsx(xa,{smooth:!0,to:"/#hero",className:"text-xl font-bold text-primary flex items-center",children:P.jsxs("span",{className:"relative z-10",children:[P.jsx("span",{className:"text-glow text-foreground",children:"JD Franco"})," Portfolio"]})}),P.jsxs("div",{className:"hidden md:flex items-center space-x-8",children:[E0.map((s,o)=>s.href==="/game"?P.jsx(xa,{to:"/game",className:"text-foreground/80 hover:text-primary transition-colors duration-300",children:s.name},o):P.jsx(xa,{smooth:!0,to:s.href,className:"text-foreground/80 hover:text-primary transition-colors duration-300",children:s.name},o)),P.jsx(_p,{})]}),P.jsxs("div",{className:"md:hidden flex items-center gap-2",children:[P.jsx(_p,{}),P.jsx("button",{onClick:()=>i(s=>!s),className:"p-2 text-foreground z-50 relative","aria-label":t?"Close Menu":"Open Menu",children:t?P.jsx(ow,{size:24}):P.jsx(qT,{size:24})})]}),P.jsx("div",{className:Wa("fixed top-0 left-0 right-0 bottom-0","h-screen w-screen","bg-background/95 backdrop-blur-md z-40","flex flex-col items-center justify-center","transition-all duration-300 md:hidden",t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),children:P.jsx("div",{className:"flex flex-col space-y-8 text-xl items-center",children:E0.map((s,o)=>s.href==="/game"?P.jsx(xa,{to:"/game",className:"text-foreground/80 hover:text-primary transition-colors duration-300",onClick:()=>i(!1),children:s.name},o):P.jsx(xa,{smooth:!0,to:s.href,className:"text-foreground/80 hover:text-primary transition-colors duration-300",onClick:()=>i(!1),children:s.name},o))})})]})})},Q4=({children:n})=>P.jsxs("div",{className:"min-h-screen bg-background text-foreground overflow-x-hidden",children:[P.jsx(_p,{}),P.jsx(Vw,{}),P.jsx(Ww,{}),P.jsx("main",{children:n})]}),Xw=()=>P.jsxs("section",{id:"hero",className:"relative min-h-screen flex flex-col justify-center px-4",children:[P.jsxs("div",{className:"container mx-auto max-w-6xl z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[P.jsxs("div",{className:"flex-1 text-center md:text-left space-y-6",children:[P.jsxs("h1",{className:"text-4xl md:text-6xl font-bold tracking-tight",children:[P.jsx("span",{className:"opacity-0 animate-fade-in",children:"Hi! I'm"}),P.jsx("span",{className:"text-primary opacity-0 animate-fade-in-delay-1",children:" JD"}),P.jsx("span",{className:"text-gradient ml-2 opacity-0 animate-fade-in-delay-2",children:" Franco"})]}),P.jsx("p",{className:"text-primary  text-lg md:text-xl text-muted-foreground max-w-xl opacity-0 animate-fade-in-delay-3",children:"Software Engineer - Geospatial / GIS | Principal Consultant"}),P.jsx("p",{className:"text-lg md:text-xl text-muted-foreground max-w-xl opacity-0 animate-fade-in-delay-4",children:"I design and ship geospatial applications that turn complex spatial data into intuitive, interactive experiences for clients, from Databricks-backed pipelines to modern React frontends."})]}),P.jsx("div",{className:"flex-1 flex justify-center md:justify-end opacity-0 animate-fade-in-delay-3",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"200",height:"300",viewBox:"0 0 351 479",className:"text-primary max-w-[100px] md:max-w-[300px] w-full h-auto",fill:"currentColor",children:P.jsx("path",{d:"M0 0 C30.2009009 -2.0190705 52.95237773 -0.42322586 78.65377808 16.16299438 C79.92100375 16.96415041 81.18883755 17.76434525 82.45724487 18.56362915 C87.82748271 21.96777249 93.11053409 25.43156474 98.21627808 29.22549438 C101.98749951 32.01817731 105.82513494 34.54804669 109.84127808 36.97549438 C123.79397154 45.46699041 135.5205684 53.30571074 144.65377808 67.16299438 C146.30899039 68.84103722 147.97756055 70.50593363 149.65377808 72.16299438 C151.53130967 74.14173432 153.37496513 76.15057469 155.21627808 78.16299438 C155.68485229 78.67088501 156.15342651 79.17877563 156.63619995 79.70205688 C157.98841664 81.17720236 159.32146369 82.6698492 160.65377808 84.16299438 C161.4091687 84.9841272 162.16455933 85.80526001 162.94284058 86.65127563 C165.00964832 89.68542491 165.27176037 91.70894192 165.46627808 95.35049438 C165.53459839 96.39592407 165.6029187 97.44135376 165.67330933 98.51846313 C165.65377808 101.16299438 165.65377808 101.16299438 164.65377808 103.16299438 C162.39657548 104.64614429 160.02759977 105.86818255 157.65377808 107.16299438 C157.65377808 108.48299438 157.65377808 109.80299438 157.65377808 111.16299438 C158.37565308 111.38986938 159.09752808 111.61674438 159.84127808 111.85049438 C163.21490321 113.42485278 165.02428622 115.53350253 167.65377808 118.16299438 C169.75797644 119.53700451 171.89410553 120.8095388 174.07955933 122.04971313 C174.59905151 122.41709595 175.1185437 122.78447876 175.65377808 123.16299438 C175.65377808 123.82299438 175.65377808 124.48299438 175.65377808 125.16299438 C171.94536295 127.99884125 169.27294846 128.57358731 164.65377808 128.16299438 C163.99377808 127.83299438 163.33377808 127.50299438 162.65377808 127.16299438 C162.72234009 127.81058716 162.7909021 128.45817993 162.86154175 129.12539673 C164.72866095 147.943685 163.99110245 166.10085561 160.60299683 184.68643188 C159.60509568 190.1697153 159.11989018 195.527752 158.92721558 201.10049438 C158.8369812 201.78111938 158.74674683 202.46174438 158.65377808 203.16299438 C157.99377808 203.49299438 157.33377808 203.82299438 156.65377808 204.16299438 C156.32377808 203.17299438 155.99377808 202.18299438 155.65377808 201.16299438 C153.7476971 204.37481587 153.4311156 206.70182041 153.52877808 210.41299438 C153.54682495 211.30502563 153.56487183 212.19705688 153.58346558 213.11611938 C153.6066687 213.79158813 153.62987183 214.46705688 153.65377808 215.16299438 C154.64377808 215.16299438 155.63377808 215.16299438 156.65377808 215.16299438 C157.16525186 230.10939485 157.16525186 230.10939485 154.65377808 236.16299438 C152.57565308 237.44033813 152.57565308 237.44033813 150.65377808 238.16299438 C150.62799683 239.36053345 150.60221558 240.55807251 150.57565308 241.79190063 C150.27785879 251.28703215 149.36256287 259.86540312 146.59127808 268.96377563 C144.93286435 274.62311248 144.47802952 280.1012573 144.41549683 285.97549438 C144.40742508 286.70744019 144.39935333 287.43938599 144.39103699 288.19351196 C144.37727876 289.73312059 144.36652012 291.27275866 144.35861206 292.81240845 C144.3470554 294.37955731 144.32654558 295.94666571 144.29708862 297.51358032 C144.25432301 299.79282014 144.23823742 302.0709028 144.22799683 304.35049438 C144.2017347 305.39137207 144.2017347 305.39137207 144.17494202 306.45327759 C144.19731609 311.50758495 145.63590762 314.19476487 148.65377808 318.16299438 C149.11784058 319.43143188 149.11784058 319.43143188 149.59127808 320.72549438 C151.98400467 326.21469068 156.37253933 328.80329197 161.65377808 331.16299438 C162.98711141 331.82966105 164.32044474 332.49632772 165.65377808 333.16299438 C165.65377808 334.15299438 165.65377808 335.14299438 165.65377808 336.16299438 C166.64377808 336.49299438 167.63377808 336.82299438 168.65377808 337.16299438 C168.02220812 342.21555402 166.51918435 346.4589264 164.65377808 351.16299438 C163.8107312 350.66928345 162.96768433 350.17557251 162.09909058 349.66690063 C161.00338745 349.02623657 159.90768433 348.38557251 158.77877808 347.72549438 C157.6882312 347.08740845 156.59768433 346.44932251 155.47409058 345.79190063 C153.88923979 344.87655052 152.29075525 343.98148297 150.65377808 343.16299438 C154.61377808 346.46299438 158.57377808 349.76299438 162.65377808 353.16299438 C154.73603859 392.75169181 118.17007388 434.62116088 85.78366089 456.77529907 C69.31480489 467.50535151 69.31480489 467.50535151 61.65377808 469.16299438 C63.29944331 463.47796904 65.94410592 458.39617802 68.65377808 453.16299438 C67.99377808 453.16299438 67.33377808 453.16299438 66.65377808 453.16299438 C66.65377808 453.82299438 66.65377808 454.48299438 66.65377808 455.16299438 C64.68243822 456.53834777 62.67695886 457.86510483 60.65377808 459.16299438 C59.91127808 459.80236938 59.16877808 460.44174438 58.40377808 461.10049438 C44.4013172 471.60234005 24.78517483 475.56496498 7.65377808 474.16299438 C6.5956189 474.10063599 6.5956189 474.10063599 5.51608276 474.03701782 C-15.87035351 472.76345413 -32.68703974 465.88270409 -48.28762817 450.94815063 C-50.31357497 448.96131075 -50.31357497 448.96131075 -53.34622192 448.16299438 C-54.67044067 446.52627563 -54.67044067 446.52627563 -56.03372192 444.47549438 C-58.77192839 440.63926027 -61.69348543 438.16673549 -65.61184692 435.58486938 C-67.34622192 434.16299438 -67.34622192 434.16299438 -68.33059692 432.11611938 C-69.62735793 429.62234821 -70.85014153 429.37018963 -73.34622192 428.16299438 C-78.93814221 422.69307963 -83.81350043 416.52657986 -88.34622192 410.16299438 C-88.06133911 410.9428772 -87.7764563 411.72276001 -87.48294067 412.52627563 C-86.05812946 417.08469226 -85.09723161 421.67149842 -84.15872192 426.35049438 C-83.96858521 427.2521936 -83.77844849 428.15389282 -83.58255005 429.08291626 C-83.3205481 430.38132446 -83.3205481 430.38132446 -83.05325317 431.70596313 C-82.89316772 432.48995483 -82.73308228 433.27394653 -82.56814575 434.08169556 C-82.34622192 436.16299438 -82.34622192 436.16299438 -83.34622192 439.16299438 C-90.23571564 432.53239605 -96.45717032 425.70181577 -102.34622192 418.16299438 C-103.05262817 417.27354126 -103.75903442 416.38408813 -104.48684692 415.46768188 C-115.34405089 401.44704799 -124.62757348 386.11655705 -132.34622192 370.16299438 C-133.0647937 368.71159058 -133.0647937 368.71159058 -133.79788208 367.23086548 C-135.34340502 364.06271535 -136.82010171 360.86970656 -138.28372192 357.66299438 C-138.77630493 356.65986206 -139.26888794 355.65672974 -139.77639771 354.62319946 C-142.8615938 347.58916343 -142.8615938 347.58916343 -141.43045044 343.6288147 C-139.89875522 341.25693563 -138.2630543 339.23303716 -136.34622192 337.16299438 C-135.09518677 335.73213501 -135.09518677 335.73213501 -133.81887817 334.27236938 C-129.21589209 329.7663668 -124.70626829 325.73635863 -119.34622192 322.16299438 C-118.68622192 321.50299438 -118.02622192 320.84299438 -117.34622192 320.16299438 C-115.53942605 324.78668461 -115.1278311 328.58828092 -115.22122192 333.53799438 C-115.2392688 334.78322876 -115.25731567 336.02846313 -115.27590942 337.31143188 C-115.29911255 338.25244751 -115.32231567 339.19346313 -115.34622192 340.16299438 C-114.68622192 340.16299438 -114.02622192 340.16299438 -113.34622192 340.16299438 C-113.41389771 341.62672485 -113.41389771 341.62672485 -113.48294067 343.12002563 C-113.47732551 347.59081909 -112.40207097 351.58079445 -111.15872192 355.85049438 C-110.93241089 356.6406897 -110.70609985 357.43088501 -110.47293091 358.24502563 C-107.70098703 367.67750803 -104.13334889 376.22293994 -98.90481567 384.56143188 C-96.08402676 389.26981639 -93.73809936 394.22656648 -91.34622192 399.16299438 C-91.34622192 398.50299438 -91.34622192 397.84299438 -91.34622192 397.16299438 C-90.35622192 397.49299438 -89.36622192 397.82299438 -88.34622192 398.16299438 C-88.19153442 399.33861938 -88.19153442 399.33861938 -88.03372192 400.53799438 C-87.57027171 403.49344619 -87.57027171 403.49344619 -84.34622192 405.16299438 C-84.22247192 403.80174438 -84.22247192 403.80174438 -84.09622192 402.41299438 C-83.2537346 398.762216 -82.16740575 397.52914856 -79.34622192 395.16299438 C-79.94572488 398.84565541 -80.59381083 402.50842623 -81.34622192 406.16299438 C-80.35622192 406.49299438 -79.36622192 406.82299438 -78.34622192 407.16299438 C-77.68622192 407.82299438 -77.02622192 408.48299438 -76.34622192 409.16299438 C-75.02622192 408.17299438 -73.70622192 407.18299438 -72.34622192 406.16299438 C-73.33622192 404.67799438 -73.33622192 404.67799438 -74.34622192 403.16299438 C-75.33622192 403.49299438 -76.32622192 403.82299438 -77.34622192 404.16299438 C-76.14963022 399.77549146 -75.03527177 396.92978177 -71.34622192 394.16299438 C-68.09622192 393.41299438 -68.09622192 393.41299438 -65.34622192 393.16299438 C-65.01622192 391.51299438 -64.68622192 389.86299438 -64.34622192 388.16299438 C-63.35622192 387.83299438 -62.36622192 387.50299438 -61.34622192 387.16299438 C-60.85122192 388.64799438 -60.85122192 388.64799438 -60.34622192 390.16299438 C-59.02622192 389.50299438 -57.70622192 388.84299438 -56.34622192 388.16299438 C-56.6310456 389.58105269 -56.92440336 390.99739817 -57.22122192 392.41299438 C-57.3836438 393.20190063 -57.54606567 393.99080688 -57.71340942 394.80361938 C-58.33772267 397.13130582 -59.19460735 399.0533139 -60.34622192 401.16299438 C-58.36622192 400.83299438 -56.38622192 400.50299438 -54.34622192 400.16299438 C-54.22247192 400.80236938 -54.09872192 401.44174438 -53.97122192 402.10049438 C-53.76497192 402.78111938 -53.55872192 403.46174438 -53.34622192 404.16299438 C-52.68622192 404.49299438 -52.02622192 404.82299438 -51.34622192 405.16299438 C-51.67622192 406.15299438 -52.00622192 407.14299438 -52.34622192 408.16299438 C-55.05940237 409.04382061 -57.6350571 409.74175667 -60.40872192 410.35049438 C-61.16733521 410.52774048 -61.92594849 410.70498657 -62.70755005 410.88760376 C-64.5844389 411.32436406 -66.46502352 411.74518595 -68.34622192 412.16299438 C-68.34622192 411.17299438 -68.34622192 410.18299438 -68.34622192 409.16299438 C-69.00622192 410.81299438 -69.66622192 412.46299438 -70.34622192 414.16299438 C-69.35622192 414.82299438 -68.36622192 415.48299438 -67.34622192 416.16299438 C-67.18122192 415.54424438 -67.01622192 414.92549438 -66.84622192 414.28799438 C-64.86565516 411.48219147 -62.78887229 411.14561186 -59.51419067 410.47158813 C-55.67111451 409.92455567 -51.88451363 409.39384853 -48.34622192 411.16299438 C-48.67622192 412.15299438 -49.00622192 413.14299438 -49.34622192 414.16299438 C-50.33622192 414.16299438 -51.32622192 414.16299438 -52.34622192 414.16299438 C-52.34622192 415.48299438 -52.34622192 416.80299438 -52.34622192 418.16299438 C-50.69622192 417.50299438 -49.04622192 416.84299438 -47.34622192 416.16299438 C-46.54669055 419.44995672 -46.24963256 420.87322631 -47.34622192 424.16299438 C-46.68622192 424.16299438 -46.02622192 424.16299438 -45.34622192 424.16299438 C-45.34622192 424.82299438 -45.34622192 425.48299438 -45.34622192 426.16299438 C-44.68622192 426.16299438 -44.02622192 426.16299438 -43.34622192 426.16299438 C-43.84122192 424.67799438 -43.84122192 424.67799438 -44.34622192 423.16299438 C-43.35622192 422.83299438 -42.36622192 422.50299438 -41.34622192 422.16299438 C-41.34622192 424.14299438 -41.34622192 426.12299438 -41.34622192 428.16299438 C-37.83589063 429.84929558 -37.83589063 429.84929558 -34.03372192 429.78799438 C-33.19840942 429.47861938 -33.19840942 429.47861938 -32.34622192 429.16299438 C-32.34622192 430.15299438 -32.34622192 431.14299438 -32.34622192 432.16299438 C-31.41809692 430.67799438 -31.41809692 430.67799438 -30.47122192 429.16299438 C-29.76997192 428.17299438 -29.06872192 427.18299438 -28.34622192 426.16299438 C-27.68622192 426.16299438 -27.02622192 426.16299438 -26.34622192 426.16299438 C-27.02020334 430.34167916 -28.32729668 434.1952407 -29.72512817 438.17471313 C-30.44561133 440.1339936 -30.44561133 440.1339936 -30.34622192 442.16299438 C-31.00622192 442.82299438 -31.66622192 443.48299438 -32.34622192 444.16299438 C-31.35622192 444.16299438 -30.36622192 444.16299438 -29.34622192 444.16299438 C-29.42872192 443.44111938 -29.51122192 442.71924438 -29.59622192 441.97549438 C-29.13532267 436.79037781 -24.94434721 433.6326152 -21.34622192 430.16299438 C-21.34622192 431.48299438 -21.34622192 432.80299438 -21.34622192 434.16299438 C-19.69622192 433.50299438 -18.04622192 432.84299438 -16.34622192 432.16299438 C-14.34622192 434.16299438 -14.34622192 434.16299438 -14.22122192 436.78799438 C-14.26247192 437.57174438 -14.30372192 438.35549438 -14.34622192 439.16299438 C-11.70121823 438.24516315 -11.70121823 438.24516315 -9.34622192 436.16299438 C-8.87784293 433.36925146 -9.11197687 431.02078402 -9.34622192 428.16299438 C-8.35622192 428.16299438 -7.36622192 428.16299438 -6.34622192 428.16299438 C-6.28434692 429.11174438 -6.22247192 430.06049438 -6.15872192 431.03799438 C-5.75653442 432.58486938 -5.75653442 432.58486938 -5.34622192 434.16299438 C-2.88366508 435.61590712 -2.88366508 435.61590712 -0.34622192 436.16299438 C1.91263132 432.90901931 1.91263132 432.90901931 2.65377808 429.16299438 C1.99377808 429.16299438 1.33377808 429.16299438 0.65377808 429.16299438 C2.11763917 424.77141109 4.63209145 424.28352006 8.65377808 422.16299438 C5.21308184 419.86919689 3.93087507 419.16299438 -0.34622192 419.16299438 C-1.66622192 419.16299438 -2.98622192 419.16299438 -4.34622192 419.16299438 C-4.01622192 417.84299438 -3.68622192 416.52299438 -3.34622192 415.16299438 C-4.33622192 415.49299438 -5.32622192 415.82299438 -6.34622192 416.16299438 C-6.34622192 414.84299438 -6.34622192 413.52299438 -6.34622192 412.16299438 C-7.66622192 412.16299438 -8.98622192 412.16299438 -10.34622192 412.16299438 C-11.03372192 409.85049438 -11.03372192 409.85049438 -11.34622192 407.16299438 C-8.25478044 403.1588416 -4.12329389 402.7904307 0.65377808 402.16299438 C10.1365367 401.65724726 10.1365367 401.65724726 14.65377808 403.16299438 C15.31377808 402.83299438 15.97377808 402.50299438 16.65377808 402.16299438 C18.44919774 402.25134043 20.24168963 402.40645395 22.02877808 402.60049438 C28.40436992 403.3377062 28.40436992 403.3377062 34.65377808 402.16299438 C34.65377808 404.47299438 34.65377808 406.78299438 34.65377808 409.16299438 C33.99377808 409.16299438 33.33377808 409.16299438 32.65377808 409.16299438 C32.65377808 410.15299438 32.65377808 411.14299438 32.65377808 412.16299438 C31.87002808 412.26611938 31.08627808 412.36924438 30.27877808 412.47549438 C27.32332627 412.9389446 27.32332627 412.9389446 25.65377808 416.16299438 C24.64315308 416.49299438 23.63252808 416.82299438 22.59127808 417.16299438 C21.62190308 417.49299438 20.65252808 417.82299438 19.65377808 418.16299438 C19.32377808 419.15299438 18.99377808 420.14299438 18.65377808 421.16299438 C17.33377808 420.83299438 16.01377808 420.50299438 14.65377808 420.16299438 C14.65377808 423.13299438 14.65377808 426.10299438 14.65377808 429.16299438 C13.66377808 428.83299438 12.67377808 428.50299438 11.65377808 428.16299438 C11.65377808 429.15299438 11.65377808 430.14299438 11.65377808 431.16299438 C13.63377808 430.83299438 15.61377808 430.50299438 17.65377808 430.16299438 C17.98377808 428.51299438 18.31377808 426.86299438 18.65377808 425.16299438 C20.30377808 424.83299438 21.95377808 424.50299438 23.65377808 424.16299438 C23.32377808 425.48299438 22.99377808 426.80299438 22.65377808 428.16299438 C25.12877808 429.64799438 25.12877808 429.64799438 27.65377808 431.16299438 C27.98377808 430.50299438 28.31377808 429.84299438 28.65377808 429.16299438 C31.76575873 430.66135544 34.70723958 432.36233197 37.65377808 434.16299438 C37.32377808 432.18299438 36.99377808 430.20299438 36.65377808 428.16299438 C39.12054257 427.27962602 40.2923718 427.03175378 42.79440308 427.94033813 C43.49049683 428.3231897 44.18659058 428.70604126 44.90377808 429.10049438 C45.61018433 429.48076782 46.31659058 429.86104126 47.04440308 430.25283813 C47.57549683 430.5531897 48.10659058 430.85354126 48.65377808 431.16299438 C47.99377808 429.51299438 47.33377808 427.86299438 46.65377808 426.16299438 C47.64377808 425.83299438 48.63377808 425.50299438 49.65377808 425.16299438 C50.31377808 425.49299438 50.97377808 425.82299438 51.65377808 426.16299438 C51.65377808 423.85299438 51.65377808 421.54299438 51.65377808 419.16299438 C54.62377808 419.49299438 57.59377808 419.82299438 60.65377808 420.16299438 C59.66377808 418.67799438 59.66377808 418.67799438 58.65377808 417.16299438 C59.02877808 414.97549438 59.02877808 414.97549438 59.65377808 413.16299438 C60.64377808 413.49299438 61.63377808 413.82299438 62.65377808 414.16299438 C62.32377808 412.18299438 61.99377808 410.20299438 61.65377808 408.16299438 C65.94676734 408.63999319 67.9390646 410.96102464 70.65377808 414.16299438 C71.85369642 416.46283788 72.74485593 418.723256 73.65377808 421.16299438 C74.85254459 415.7140557 74.56738116 412.94130343 71.65377808 408.16299438 C71.32377808 408.82299438 70.99377808 409.48299438 70.65377808 410.16299438 C69.33377808 409.50299438 68.01377808 408.84299438 66.65377808 408.16299438 C66.65377808 407.50299438 66.65377808 406.84299438 66.65377808 406.16299438 C67.65377808 405.16299438 68.65377808 404.16299438 69.65377808 403.16299438 C70.82952519 401.06309786 70.82952519 401.06309786 71.65377808 399.16299438 C74.12877808 400.64799438 74.12877808 400.64799438 76.65377808 402.16299438 C78.57760548 400.23916698 77.87219146 396.9063778 77.90377808 394.35049438 C77.92955933 393.10654907 77.95534058 391.86260376 77.98190308 390.58096313 C77.63486253 386.96595746 76.99741151 385.80883318 74.65377808 383.16299438 C74.65377808 382.50299438 74.65377808 381.84299438 74.65377808 381.16299438 C75.64377808 380.83299438 76.63377808 380.50299438 77.65377808 380.16299438 C76.66377808 379.17299438 75.67377808 378.18299438 74.65377808 377.16299438 C74.98377808 376.50299438 75.31377808 375.84299438 75.65377808 375.16299438 C70.53040639 373.19246681 67.67828798 372.87278406 62.52877808 374.85049438 C56.60537525 377.08403227 50.83517354 378.03865153 44.59127808 378.85049438 C43.68168335 378.96932983 42.77208862 379.08816528 41.83493042 379.21060181 C33.06926611 380.3049311 24.31068524 381.32059554 15.46627808 381.22549438 C14.35897339 381.21647095 13.2516687 381.20744751 12.11080933 381.19815063 C11.29998901 381.18654907 10.4891687 381.17494751 9.65377808 381.16299438 C9.83940308 380.56486938 10.02502808 379.96674438 10.21627808 379.35049438 C10.87471495 376.99890677 10.87471495 376.99890677 9.65377808 374.16299438 C5.90562207 371.66422371 3.40979464 372.20091259 -0.84622192 372.66299438 C-7.94081652 373.43326466 -7.94081652 373.43326466 -11.34622192 371.16299438 C-13.97153716 370.99585869 -13.97153716 370.99585869 -16.34622192 371.16299438 C-16.34622192 369.84299438 -16.34622192 368.52299438 -16.34622192 367.16299438 C-18.47182629 367.47135671 -20.59669258 367.78481052 -22.72122192 368.10049438 C-23.9045813 368.27451782 -25.08794067 368.44854126 -26.30715942 368.62783813 C-29.25324573 368.99762225 -29.25324573 368.99762225 -31.34622192 370.16299438 C-31.84122192 368.67799438 -31.84122192 368.67799438 -32.34622192 367.16299438 C-33.33622192 367.49299438 -34.32622192 367.82299438 -35.34622192 368.16299438 C-37.01288859 368.16299438 -38.67955526 368.16299438 -40.34622192 368.16299438 C-40.67622192 368.49299438 -41.00622192 368.82299438 -41.34622192 369.16299438 C-40.35622192 369.76111938 -39.36622192 370.35924438 -38.34622192 370.97549438 C-37.35622192 371.69736938 -36.36622192 372.41924438 -35.34622192 373.16299438 C-35.34622192 374.15299438 -35.34622192 375.14299438 -35.34622192 376.16299438 C-39.96812867 376.34424563 -43.12447377 375.98861521 -47.34622192 374.16299438 C-51.45082507 373.69759429 -51.45082507 373.69759429 -53.84622192 376.60049438 C-54.67122192 377.44611938 -55.49622192 378.29174438 -56.34622192 379.16299438 C-58.65872192 379.97549438 -58.65872192 379.97549438 -60.34622192 380.16299438 C-60.34622192 378.18299438 -60.34622192 376.20299438 -60.34622192 374.16299438 C-60.96497192 374.05986938 -61.58372192 373.95674438 -62.22122192 373.85049438 C-64.34622192 373.16299438 -64.34622192 373.16299438 -66.34622192 370.16299438 C-66.34622192 369.17299438 -66.34622192 368.18299438 -66.34622192 367.16299438 C-67.66622192 367.49299438 -68.98622192 367.82299438 -70.34622192 368.16299438 C-71.83120026 362.40870332 -72.57779035 356.52760576 -69.78372192 351.16299438 C-66.67406601 348.61148184 -64.29897747 348.46131556 -60.34622192 348.16299438 C-60.01622192 347.83299438 -59.68622192 347.50299438 -59.34622192 347.16299438 C-57.66438245 346.9301243 -55.97498032 346.75035272 -54.28372192 346.60049438 C-52.90506958 346.47481079 -52.90506958 346.47481079 -51.49856567 346.34658813 C-50.78829224 346.2860022 -50.0780188 346.22541626 -49.34622192 346.16299438 C-49.01622192 347.48299438 -48.68622192 348.80299438 -48.34622192 350.16299438 C-46.69622192 350.16299438 -45.04622192 350.16299438 -43.34622192 350.16299438 C-42.68622192 351.48299438 -42.02622192 352.80299438 -41.34622192 354.16299438 C-39.03622192 353.83299438 -36.72622192 353.50299438 -34.34622192 353.16299438 C-34.34622192 354.48299438 -34.34622192 355.80299438 -34.34622192 357.16299438 C-33.68622192 357.49299438 -33.02622192 357.82299438 -32.34622192 358.16299438 C-32.01622192 357.83299438 -31.68622192 357.50299438 -31.34622192 357.16299438 C-30.56247192 357.03924438 -29.77872192 356.91549438 -28.97122192 356.78799438 C-24.82249625 355.80020256 -23.6624126 353.6372804 -21.34622192 350.16299438 C-22.66622192 349.50299438 -23.98622192 348.84299438 -25.34622192 348.16299438 C-23.72122192 345.72549438 -23.72122192 345.72549438 -21.34622192 343.16299438 C-19.35336255 342.78933325 -17.35258664 342.45558924 -15.34622192 342.16299438 C-14.72747192 341.46174438 -14.10872192 340.76049438 -13.47122192 340.03799438 C-11.34622192 338.16299438 -11.34622192 338.16299438 -7.78372192 338.28799438 C-5.40704181 338.6921618 -3.1277351 339.22340549 -0.80325317 339.86611938 C6.17300725 341.59760105 10.0867596 340.67172227 16.53268433 337.61221313 C23.79109859 334.24191064 31.57843082 331.41179929 39.65377808 332.16299438 C38.99377808 334.14299438 38.33377808 336.12299438 37.65377808 338.16299438 C44.9774836 342.7272115 50.7314739 346.05532624 59.60690308 345.31143188 C60.28237183 345.26244751 60.95784058 345.21346313 61.65377808 345.16299438 C61.98377808 345.49299438 62.31377808 345.82299438 62.65377808 346.16299438 C62.98377808 345.50299438 63.31377808 344.84299438 63.65377808 344.16299438 C66.49044253 344.73275177 69.32232662 345.31830082 72.15377808 345.91299438 C72.94526245 346.07026001 73.73674683 346.22752563 74.55221558 346.38955688 C81.69328419 347.91142397 88.99708562 350.20242804 93.65377808 356.16299438 C95.28960642 359.81214992 94.44627922 363.34457979 93.65377808 367.16299438 C92.99377808 367.49299438 92.33377808 367.82299438 91.65377808 368.16299438 C91.73627808 368.90549438 91.81877808 369.64799438 91.90377808 370.41299438 C91.58272623 373.94456465 90.30112191 374.92929803 87.65377808 377.16299438 C88.31377808 377.82299438 88.97377808 378.48299438 89.65377808 379.16299438 C90.21897811 381.81836811 90.39166006 384.45444151 90.65377808 387.16299438 C92.30377808 387.82299438 93.95377808 388.48299438 95.65377808 389.16299438 C95.65377808 393.12299438 95.65377808 397.08299438 95.65377808 401.16299438 C96.31377808 400.83299438 96.97377808 400.50299438 97.65377808 400.16299438 C97.32377808 398.84299438 96.99377808 397.52299438 96.65377808 396.16299438 C97.97377808 395.83299438 99.29377808 395.50299438 100.65377808 395.16299438 C100.15877808 394.72986938 99.66377808 394.29674438 99.15377808 393.85049438 C97.65377808 392.16299438 97.65377808 392.16299438 97.65377808 389.16299438 C98.97377808 389.49299438 100.29377808 389.82299438 101.65377808 390.16299438 C101.54936401 388.5175061 101.54936401 388.5175061 101.44284058 386.83877563 C101.38654255 385.38441 101.33194457 383.92997786 101.27877808 382.47549438 C101.22850464 381.75426392 101.1782312 381.03303345 101.12643433 380.28994751 C100.97960671 374.93073966 100.97960671 374.93073966 103.00289917 372.62661743 C104.5182454 371.42657616 106.08417668 370.29114539 107.65377808 369.16299438 C108.15756836 366.44993661 108.15756836 366.44993661 107.65377808 364.16299438 C108.31377808 364.16299438 108.97377808 364.16299438 109.65377808 364.16299438 C111.27877808 366.85049438 111.27877808 366.85049438 112.65377808 370.16299438 C111.84127808 372.91299438 111.84127808 372.91299438 110.65377808 375.16299438 C110.65377808 375.82299438 110.65377808 376.48299438 110.65377808 377.16299438 C111.64377808 377.16299438 112.63377808 377.16299438 113.65377808 377.16299438 C113.98377808 377.82299438 114.31377808 378.48299438 114.65377808 379.16299438 C115.33440308 377.92549438 115.33440308 377.92549438 116.02877808 376.66299438 C116.83315308 375.42549438 116.83315308 375.42549438 117.65377808 374.16299438 C118.31377808 374.16299438 118.97377808 374.16299438 119.65377808 374.16299438 C119.76721558 373.64221313 119.88065308 373.12143188 119.99752808 372.58486938 C120.84834995 369.4449315 122.01014317 366.45825476 123.15377808 363.41299438 C125.03804784 358.19876513 126.25335717 353.66878186 126.65377808 348.16299438 C126.96466175 346.49199462 127.2945814 344.82427902 127.65377808 343.16299438 C127.83940308 342.23486938 128.02502808 341.30674438 128.21627808 340.35049438 C128.36065308 339.62861938 128.50502808 338.90674438 128.65377808 338.16299438 C129.31377808 338.16299438 129.97377808 338.16299438 130.65377808 338.16299438 C130.62630493 337.13899536 130.59883179 336.11499634 130.57052612 335.05996704 C130.64889295 331.39166432 131.14984615 328.3699059 131.98580933 324.81143188 C134.17713791 314.70908256 135.02922917 304.43919252 136.0163269 294.16348267 C136.34271857 290.77303099 136.68196413 287.38404071 137.0229187 283.99502563 C137.23786484 281.81411018 137.45208332 279.63312285 137.66549683 277.45205688 C137.76545456 276.45187531 137.86541229 275.45169373 137.96839905 274.42120361 C138.51775016 268.63767472 138.74835021 262.97263907 138.65377808 257.16299438 C138.3875061 257.97341187 138.12123413 258.78382935 137.84689331 259.61880493 C136.82949786 262.69551212 135.80114492 265.76829754 134.76583862 268.83901978 C134.32441252 270.15530993 133.8870707 271.47297858 133.45431519 272.79214478 C129.0111262 286.31781065 124.22986576 300.77381309 110.79440308 307.62002563 C99.9986516 312.37399234 90.52413522 313.47047384 78.77877808 313.35049438 C76.9457312 313.34952759 76.9457312 313.34952759 75.07565308 313.34854126 C66.07632272 313.3038426 66.07632272 313.3038426 62.65377808 312.16299438 C62.32377808 312.82299438 61.99377808 313.48299438 61.65377808 314.16299438 C59.67377808 313.83299438 57.69377808 313.50299438 55.65377808 313.16299438 C55.65377808 312.50299438 55.65377808 311.84299438 55.65377808 311.16299438 C51.24152071 309.69224193 48.17096188 308.79415081 43.65377808 310.16299438 C43.98377808 310.82299438 44.31377808 311.48299438 44.65377808 312.16299438 C44.72411577 314.03679043 44.73808027 315.9130054 44.71627808 317.78799438 C44.70725464 318.79088501 44.6982312 319.79377563 44.68893433 320.82705688 C44.67153198 321.98334595 44.67153198 321.98334595 44.65377808 323.16299438 C43.99377808 322.83299438 43.33377808 322.50299438 42.65377808 322.16299438 C41.46768595 318.27524797 40.55896006 315.27710603 40.90377808 311.22549438 C40.43778382 305.51706478 36.21959356 301.25418217 32.87252808 296.78408813 C23.34717347 283.77028129 20.25928792 269.48508849 18.37643433 253.68643188 C17.47062027 250.52342714 16.20457123 249.20269965 13.65377808 247.16299438 C8.97047644 246.03553288 5.33829706 246.29866764 0.65377808 247.16299438 C0.52422729 248.38309204 0.52422729 248.38309204 0.39205933 249.62783813 C-1.2193897 262.77075723 -4.49367831 275.0064759 -10.34622192 286.91299438 C-10.66607056 287.56832153 -10.98591919 288.22364868 -11.31546021 288.89883423 C-13.45488643 293.03851069 -15.91326054 296.03567027 -19.34622192 299.16299438 C-19.89922974 299.71084595 -20.45223755 300.25869751 -21.02200317 300.82315063 C-32.54308133 310.69443239 -50.08355024 310.21395667 -64.34622192 309.16299438 C-78.82273355 307.68918085 -92.43760076 304.34463304 -102.28762817 292.90908813 C-112.85820972 278.68560583 -115.55364103 261.27770434 -118.34622192 244.16299438 C-118.3383667 245.68437012 -118.3383667 245.68437012 -118.33035278 247.23648071 C-118.31225385 250.99916705 -118.30077198 254.76184954 -118.29129028 258.52456665 C-118.28626128 260.15315396 -118.27943727 261.78173676 -118.27078247 263.41030884 C-118.25865423 265.75105911 -118.2529793 268.09174968 -118.24856567 270.43252563 C-118.24340439 271.16075027 -118.2382431 271.88897491 -118.23292542 272.63926697 C-118.23257913 275.75901727 -118.35166588 278.17932626 -119.34622192 281.16299438 C-120.00622192 281.16299438 -120.66622192 281.16299438 -121.34622192 281.16299438 C-123.25301984 273.90127233 -123.8433357 266.83428774 -124.23706055 259.34750366 C-124.34827948 257.24917516 -124.46987409 255.15167957 -124.59451294 253.05410767 C-124.76554638 250.17321518 -124.93446583 247.29221965 -125.10061646 244.41104126 C-125.18245249 242.99502376 -125.2643204 241.5790081 -125.34622192 240.16299438 C-125.38511536 239.49018433 -125.42400879 238.81737427 -125.46408081 238.12417603 C-125.71842945 233.76077899 -125.99662432 229.39934477 -126.28372192 225.03799438 C-126.34624146 223.92569458 -126.40876099 222.81339478 -126.47317505 221.66738892 C-126.85260335 216.07604294 -127.462941 212.07982356 -130.34622192 207.16299438 C-131.3496271 204.08562181 -132.21794121 200.9872429 -133.08840942 197.87002563 C-134.18118005 194.32455704 -134.18118005 194.32455704 -135.57791138 191.84146118 C-139.49005467 184.39191161 -140.03521909 177.69555254 -139.83328247 169.41812134 C-139.78336801 167.33572942 -139.77175819 165.25570004 -139.7661438 163.17276001 C-139.70251434 157.10001364 -139.42221427 151.93317778 -137.34622192 146.16299438 C-137.37876931 144.03135527 -137.37876931 144.03135527 -137.84622192 142.10049438 C-138.34289316 138.1892084 -138.15581812 136.56929311 -136.34622192 133.16299438 C-137.66622192 133.16299438 -138.98622192 133.16299438 -140.34622192 133.16299438 C-140.68494706 131.74760722 -141.01696816 130.33061476 -141.34622192 128.91299438 C-141.53184692 128.12408813 -141.71747192 127.33518188 -141.90872192 126.52236938 C-142.34622192 124.16299438 -142.34622192 124.16299438 -142.34622192 120.16299438 C-141.68622192 120.16299438 -141.02622192 120.16299438 -140.34622192 120.16299438 C-139.35622192 117.52299438 -138.36622192 114.88299438 -137.34622192 112.16299438 C-138.00622192 112.16299438 -138.66622192 112.16299438 -139.34622192 112.16299438 C-139.34622192 111.17299438 -139.34622192 110.18299438 -139.34622192 109.16299438 C-138.68622192 109.16299438 -138.02622192 109.16299438 -137.34622192 109.16299438 C-137.24309692 108.21424438 -137.13997192 107.26549438 -137.03372192 106.28799438 C-136.34622192 103.16299438 -136.34622192 103.16299438 -133.34622192 101.16299438 C-133.67622192 100.17299438 -134.00622192 99.18299438 -134.34622192 98.16299438 C-133.51616528 88.46085691 -127.19661689 78.85769856 -120.34622192 72.16299438 C-119.35622192 72.16299438 -118.36622192 72.16299438 -117.34622192 72.16299438 C-117.34622192 71.50299438 -117.34622192 70.84299438 -117.34622192 70.16299438 C-116.68622192 70.16299438 -116.02622192 70.16299438 -115.34622192 70.16299438 C-115.34622192 69.17299438 -115.34622192 68.18299438 -115.34622192 67.16299438 C-112.87122192 66.17299438 -112.87122192 66.17299438 -110.34622192 65.16299438 C-110.67622192 64.50299438 -111.00622192 63.84299438 -111.34622192 63.16299438 C-113.32622192 63.65799438 -113.32622192 63.65799438 -115.34622192 64.16299438 C-114.29300443 60.989392 -113.30673681 60.13861115 -110.40481567 58.34658813 C-109.20455822 57.75071327 -107.99705601 57.16926956 -106.78372192 56.60049438 C-106.15619019 56.29530884 -105.52865845 55.99012329 -104.8821106 55.6756897 C-100.71901156 53.69107443 -96.56839247 52.05803048 -92.11575317 50.86611938 C-89.88999486 49.98171211 -88.74472149 49.11269411 -87.34622192 47.16299438 C-87.65112402 44.38561345 -88.80304149 42.0233667 -89.90872192 39.47549438 C-91.60037899 35.01718636 -92.02402249 30.88902846 -91.34622192 26.16299438 C-90.15872192 23.60049438 -90.15872192 23.60049438 -88.34622192 22.16299438 C-85.73294067 22.07315063 -85.73294067 22.07315063 -83.34622192 22.16299438 C-83.33204224 22.80365845 -83.31786255 23.44432251 -83.30325317 24.10440063 C-82.93965312 30.69833682 -81.61671549 34.12600197 -77.34622192 39.16299438 C-72.30712411 37.11002861 -68.06311392 32.84208616 -65.34622192 28.16299438 C-65.56339544 25.9549891 -65.56339544 25.9549891 -66.34622192 24.16299438 C-61.59622192 20.16299438 -61.59622192 20.16299438 -59.34622192 20.16299438 C-59.34622192 20.82299438 -59.34622192 21.48299438 -59.34622192 22.16299438 C-58.35622192 21.83299438 -57.36622192 21.50299438 -56.34622192 21.16299438 C-56.34622192 22.48299438 -56.34622192 23.80299438 -56.34622192 25.16299438 C-55.91309692 24.33799438 -55.47997192 23.51299438 -55.03372192 22.66299438 C-54.47684692 21.83799438 -53.91997192 21.01299438 -53.34622192 20.16299438 C-52.35622192 20.16299438 -51.36622192 20.16299438 -50.34622192 20.16299438 C-50.84122192 17.19299438 -50.84122192 17.19299438 -51.34622192 14.16299438 C-50.76485474 14.39373657 -50.18348755 14.62447876 -49.58450317 14.86221313 C-47.2782428 15.42608717 -47.2782428 15.42608717 -45.45169067 13.87002563 C-44.81876099 13.24483032 -44.1858313 12.61963501 -43.53372192 11.97549438 C-37.5043946 6.07048309 -31.84184587 3.6283459 -23.65872192 2.47549438 C-22.93233521 2.35883423 -22.20594849 2.24217407 -21.45755005 2.12197876 C-14.33319083 1.02639963 -7.18645263 0.49925006 0 0 Z M-62.34622192 23.16299438 C-62.01622192 23.82299438 -61.68622192 24.48299438 -61.34622192 25.16299438 C-61.01622192 24.50299438 -60.68622192 23.84299438 -60.34622192 23.16299438 C-61.00622192 23.16299438 -61.66622192 23.16299438 -62.34622192 23.16299438 Z M-83.34622192 39.16299438 C-82.68622192 40.81299438 -82.02622192 42.46299438 -81.34622192 44.16299438 C-80.35622192 44.16299438 -79.36622192 44.16299438 -78.34622192 44.16299438 C-79.70155453 41.6262615 -79.70155453 41.6262615 -81.34622192 39.16299438 C-82.00622192 39.16299438 -82.66622192 39.16299438 -83.34622192 39.16299438 Z M-98.34622192 56.16299438 C-98.34622192 57.15299438 -98.34622192 58.14299438 -98.34622192 59.16299438 C-97.68622192 58.17299438 -97.02622192 57.18299438 -96.34622192 56.16299438 C-97.00622192 56.16299438 -97.66622192 56.16299438 -98.34622192 56.16299438 Z M-108.34622192 59.16299438 C-108.67622192 59.82299438 -109.00622192 60.48299438 -109.34622192 61.16299438 C-108.35622192 61.16299438 -107.36622192 61.16299438 -106.34622192 61.16299438 C-106.34622192 61.82299438 -106.34622192 62.48299438 -106.34622192 63.16299438 C-105.35622192 62.83299438 -104.36622192 62.50299438 -103.34622192 62.16299438 C-104.00622192 61.83299438 -104.66622192 61.50299438 -105.34622192 61.16299438 C-105.34622192 60.50299438 -105.34622192 59.84299438 -105.34622192 59.16299438 C-106.33622192 59.16299438 -107.32622192 59.16299438 -108.34622192 59.16299438 Z M-128.34622192 88.16299438 C-127.34622192 90.16299438 -127.34622192 90.16299438 -127.34622192 90.16299438 Z M-129.34622192 90.16299438 C-128.34622192 92.16299438 -128.34622192 92.16299438 -128.34622192 92.16299438 Z M-131.34622192 93.16299438 C-130.34622192 95.16299438 -130.34622192 95.16299438 -130.34622192 95.16299438 Z M-132.34622192 95.16299438 C-132.67622192 96.15299438 -133.00622192 97.14299438 -133.34622192 98.16299438 C-132.68622192 98.16299438 -132.02622192 98.16299438 -131.34622192 98.16299438 C-131.67622192 97.17299438 -132.00622192 96.18299438 -132.34622192 95.16299438 Z M32.90377808 111.28799438 C29.65377808 112.16299438 29.65377808 112.16299438 25.65377808 112.16299438 C24.66377808 111.17299438 24.66377808 111.17299438 23.65377808 110.16299438 C23.32377808 110.49299438 22.99377808 110.82299438 22.65377808 111.16299438 C20.32080374 111.20392376 17.98672583 111.20541162 15.65377808 111.16299438 C15.65377808 111.82299438 15.65377808 112.48299438 15.65377808 113.16299438 C14.33377808 113.49299438 13.01377808 113.82299438 11.65377808 114.16299438 C11.65377808 114.82299438 11.65377808 115.48299438 11.65377808 116.16299438 C11.07184692 115.95005737 10.48991577 115.73712036 9.89035034 115.51773071 C3.005064 113.20141991 -3.17991715 112.73633133 -10.40872192 112.85049438 C-11.43288208 112.84727173 -12.45704224 112.84404907 -13.51223755 112.84072876 C-21.78480086 112.89887457 -29.42872662 113.40947632 -36.47122192 118.10049438 C-43.13554716 122.30683547 -48.27900455 124.98338937 -56.34622192 124.16299438 C-57.00622192 123.17299438 -57.66622192 122.18299438 -58.34622192 121.16299438 C-60.30968494 120.60667986 -62.27931146 120.06177653 -64.27590942 119.63955688 C-66.34622192 119.16299438 -66.34622192 119.16299438 -69.22122192 117.97549438 C-73.78247308 116.78956908 -77.79638581 116.91487347 -82.34622192 118.16299438 C-84.36193962 119.4602791 -85.92838614 120.87025987 -87.62356567 122.56143188 C-89.47563128 124.28330694 -91.3153504 125.33688715 -93.53372192 126.53799438 C-98.0016136 129.27220609 -99.65438774 132.28556022 -101.34622192 137.16299438 C-101.62079224 137.93514282 -101.89536255 138.70729126 -102.17825317 139.50283813 C-104.55667611 147.48168551 -104.98279181 155.63825607 -105.57278442 163.8968811 C-106.04523727 170.28385302 -106.81929334 176.4911443 -107.97122192 182.78799438 C-109.84121674 193.21154687 -109.63868078 203.60897901 -109.34622192 214.16299438 C-110.13899536 214.46205688 -110.9317688 214.76111938 -111.74856567 215.06924438 C-114.35920431 216.16846065 -115.42957866 217.1630188 -117.34622192 219.16299438 C-119.53372192 220.35049438 -119.53372192 220.35049438 -121.34622192 221.16299438 C-117.74691789 222.3627624 -117.40976294 221.92712902 -114.09622192 220.41299438 C-104.68122473 216.73386387 -94.32262933 216.25457659 -84.34622192 215.16299438 C-87.72181618 212.91259821 -88.32597835 212.9868343 -92.15872192 213.47549438 C-93.03915161 213.58377563 -93.9195813 213.69205688 -94.82669067 213.80361938 C-97.67595822 214.21002654 -100.51555872 214.64155643 -103.34622192 215.16299438 C-102.10798427 209.38455198 -99.18611729 206.29769455 -94.34622192 203.16299438 C-90.22186426 201.80163414 -85.30195688 201.18512691 -81.34622192 203.16299438 C-79.89042605 203.25854855 -78.43014232 203.2928413 -76.97122192 203.28799438 C-76.20036255 203.29057251 -75.42950317 203.29315063 -74.63528442 203.29580688 C-72.41340302 203.16689226 -70.48003685 202.77683155 -68.34622192 202.16299438 C-68.34622192 203.15299438 -68.34622192 204.14299438 -68.34622192 205.16299438 C-67.22087036 205.15139282 -66.0955188 205.13979126 -64.93606567 205.12783813 C-50.14880033 205.01764262 -36.45595687 205.09362854 -22.34622192 210.16299438 C-20.86122192 210.65799438 -20.86122192 210.65799438 -19.34622192 211.16299438 C-16.13501702 213.83899848 -14.54075929 215.36988053 -13.53372192 219.47549438 C-13.47184692 220.36236938 -13.40997192 221.24924438 -13.34622192 222.16299438 C-14.33622192 222.65799438 -14.33622192 222.65799438 -15.34622192 223.16299438 C-3.55884352 230.2845355 11.29921272 231.43611189 24.65377808 229.16299438 C23.33377808 228.50299438 22.01377808 227.84299438 20.65377808 227.16299438 C21.87168195 225.70827587 23.09097038 224.25469021 24.31784058 222.80752563 C25.7746668 221.0733536 25.7746668 221.0733536 27.27877808 218.66299438 C37.6998001 207.69349752 54.8602182 206.6082674 69.02536011 204.37319946 C71.51944435 203.97697719 74.01028283 203.56353346 76.50143433 203.14932251 C103.49192106 198.77958401 103.49192106 198.77958401 115.65377808 205.16299438 C121.05666993 209.32772352 123.11786777 214.66381836 124.65377808 221.16299438 C121.90346221 221.02187556 119.1536239 220.87528273 116.40377808 220.72549438 C115.62647339 220.68617798 114.8491687 220.64686157 114.04830933 220.60635376 C113.29420776 220.56445923 112.5401062 220.5225647 111.76315308 220.47940063 C111.07189331 220.44274292 110.38063354 220.40608521 109.66842651 220.36831665 C107.65377808 220.16299438 107.65377808 220.16299438 105.66744995 219.64932251 C103.48034223 219.12110736 101.57316558 219.04928447 99.32565308 219.06533813 C98.12682495 219.07017212 98.12682495 219.07017212 96.90377808 219.07510376 C96.07877808 219.08348267 95.25377808 219.09186157 94.40377808 219.10049438 C93.56330933 219.1050061 92.72284058 219.10951782 91.85690308 219.11416626 C89.78916406 219.12591478 87.72146183 219.14384916 85.65377808 219.16299438 C85.65377808 219.49299438 85.65377808 219.82299438 85.65377808 220.16299438 C91.82809034 220.87868013 98.00281468 221.59065831 104.177948 222.29922485 C106.27799997 222.54072192 108.37793636 222.78322641 110.47775269 223.02676392 C113.49836785 223.37691803 116.51938205 223.72343079 119.54049683 224.06924438 C120.47713669 224.17861328 121.41377655 224.28798218 122.37879944 224.40066528 C123.25933487 224.50076904 124.1398703 224.6008728 125.04708862 224.70401001 C126.20291695 224.8372467 126.20291695 224.8372467 127.38209534 224.97317505 C129.8157269 225.17652665 132.21279345 225.19464934 134.65377808 225.16299438 C134.33916626 224.58526276 134.02455444 224.00753113 133.70040894 223.41229248 C132.6864344 221.23317558 132.24355035 219.53848378 131.90768433 217.17422485 C131.7941008 216.39666336 131.68051727 215.61910187 131.56349182 214.81797791 C131.39162102 213.56176888 131.39162102 213.56176888 131.21627808 212.28018188 C131.02875725 210.96155403 131.02875725 210.96155403 130.83744812 209.61628723 C130.43458766 206.75794573 130.04354308 203.89814881 129.65377808 201.03799438 C129.51894012 200.06780365 129.38410217 199.09761292 129.24517822 198.09802246 C127.49986766 185.51493621 125.93868351 172.97937242 125.32369995 160.28164673 C124.89750144 152.42880075 123.9348376 144.13372762 119.96627808 137.22549438 C117.28777175 134.83655631 114.47435054 133.04966553 111.36080933 131.27627563 C109.65377808 130.16299438 109.65377808 130.16299438 108.65377808 128.16299438 C107.33377808 128.16299438 106.01377808 128.16299438 104.65377808 128.16299438 C104.65377808 127.50299438 104.65377808 126.84299438 104.65377808 126.16299438 C103.43690308 126.10111938 102.22002808 126.03924438 100.96627808 125.97549438 C96.46632313 125.44983593 94.62753967 123.57407386 91.65377808 120.16299438 C90.99377808 120.16299438 90.33377808 120.16299438 89.65377808 120.16299438 C89.44237183 119.37151001 89.23096558 118.58002563 89.01315308 117.76455688 C87.89150037 114.92909755 87.89150037 114.92909755 85.04440308 114.12393188 C83.4897937 113.83389282 83.4897937 113.83389282 81.90377808 113.53799438 C78.41696242 112.81174639 75.84525385 112.26891715 72.71627808 110.53799438 C67.59307611 108.23778126 62.20774366 108.37855926 56.65377808 108.16299438 C55.66893433 108.09854126 54.68409058 108.03408813 53.66940308 107.96768188 C46.22464134 107.66586722 39.96891829 109.16845232 32.90377808 111.28799438 Z M159.65377808 124.16299438 C159.65377808 124.82299438 159.65377808 125.48299438 159.65377808 126.16299438 C160.31377808 125.83299438 160.97377808 125.50299438 161.65377808 125.16299438 C160.99377808 124.83299438 160.33377808 124.50299438 159.65377808 124.16299438 Z M134.65377808 225.16299438 C135.31377808 225.82299438 135.97377808 226.48299438 136.65377808 227.16299438 C136.65377808 226.50299438 136.65377808 225.84299438 136.65377808 225.16299438 C135.99377808 225.16299438 135.33377808 225.16299438 134.65377808 225.16299438 Z M-103.34622192 232.16299438 C-110.16613565 240.03212561 -110.04948081 250.13428859 -109.53274536 260.00137329 C-108.46245881 272.40492977 -102.56326635 284.57843777 -93.53372192 293.16299438 C-82.5186365 301.83307139 -69.52712243 303.55345139 -55.90872192 303.47549438 C-54.40257324 303.46921021 -54.40257324 303.46921021 -52.86599731 303.46279907 C-41.73602961 303.29319269 -32.43963447 302.01616486 -24.16653442 294.06924438 C-18.60418071 288.30628119 -15.05434173 282.68200939 -12.34622192 275.16299438 C-12.02782349 274.31221313 -11.70942505 273.46143188 -11.38137817 272.58486938 C-8.71521525 264.37751071 -7.29907182 253.76828633 -10.33059692 245.46768188 C-12.41138084 241.98686434 -14.81892188 239.25324626 -18.34622192 237.16299438 C-17.85122192 239.14299438 -17.85122192 239.14299438 -17.34622192 241.16299438 C-21.80122192 241.65799438 -21.80122192 241.65799438 -26.34622192 242.16299438 C-26.05747192 242.88486938 -25.76872192 243.60674438 -25.47122192 244.35049438 C-24.42955526 246.95466105 -23.38788859 249.55882772 -22.34622192 252.16299438 C-31.6361009 253.82472576 -40.73142985 254.55020667 -50.15872192 254.78799438 C-51.43553833 254.82666626 -52.71235474 254.86533813 -54.02786255 254.90518188 C-57.1338497 254.99824517 -60.23984878 255.08407589 -63.34622192 255.16299438 C-63.65382446 254.54134399 -63.961427 253.9196936 -64.27835083 253.27920532 C-64.95734266 251.93364035 -65.67205796 250.60508808 -66.43215942 249.30361938 C-67.63268739 246.49212654 -67.77276496 243.95600115 -67.97122192 240.91299438 C-68.04598755 239.83533813 -68.12075317 238.75768188 -68.19778442 237.64736938 C-68.2467688 236.82752563 -68.29575317 236.00768188 -68.34622192 235.16299438 C-73.92528403 236.38253811 -77.37322369 238.40240065 -81.59622192 242.28799438 C-86.96812275 247.16299438 -86.96812275 247.16299438 -90.34622192 247.16299438 C-90.19917532 242.31045661 -87.72018306 240.02837291 -84.38919067 236.86221313 C-81.78065495 234.69258973 -79.00295675 233.00618027 -76.08059692 231.29580688 C-73.95627266 229.90829779 -72.63603157 228.33954816 -71.34622192 226.16299438 C-81.57647832 226.00356182 -94.6511371 226.06644066 -103.34622192 232.16299438 Z M135.65377808 228.16299438 C138.84140173 230.28807682 140.9189003 230.66501068 144.65377808 231.16299438 C144.32377808 230.17299438 143.99377808 229.18299438 143.65377808 228.16299438 C141.01377808 228.16299438 138.37377808 228.16299438 135.65377808 228.16299438 Z M103.65377808 232.16299438 C104.97377808 234.14299438 106.29377808 236.12299438 107.65377808 238.16299438 C106.66377808 237.83299438 105.67377808 237.50299438 104.65377808 237.16299438 C104.88791782 242.1977788 104.88791782 242.1977788 107.71627808 246.10049438 C108.67534058 246.62643188 108.67534058 246.62643188 109.65377808 247.16299438 C108.65377808 250.16299438 108.65377808 250.16299438 106.96725464 251.22207642 C106.25021362 251.53515747 105.53317261 251.84823853 104.79440308 252.17080688 C104.00807495 252.5175647 103.22174683 252.86432251 102.41159058 253.22158813 C101.17022339 253.74945923 101.17022339 253.74945923 99.90377808 254.28799438 C99.0916687 254.64764282 98.27955933 255.00729126 97.44284058 255.37783813 C91.60973712 257.91438312 86.74786331 259.31091552 80.34127808 259.22549438 C79.45827026 259.21647095 78.57526245 259.20744751 77.66549683 259.19815063 C77.00162964 259.18654907 76.33776245 259.17494751 75.65377808 259.16299438 C75.65377808 259.82299438 75.65377808 260.48299438 75.65377808 261.16299438 C74.00377808 261.16299438 72.35377808 261.16299438 70.65377808 261.16299438 C71.14877808 262.64799438 71.14877808 262.64799438 71.65377808 264.16299438 C69.67377808 264.65799438 69.67377808 264.65799438 67.65377808 265.16299438 C68.31377808 265.82299438 68.97377808 266.48299438 69.65377808 267.16299438 C68.90805542 267.15775757 68.16233276 267.15252075 67.39401245 267.14712524 C63.98060973 267.126202 60.56722057 267.11328566 57.15377808 267.10049438 C55.9807312 267.09211548 54.80768433 267.08373657 53.59909058 267.07510376 C47.51582926 267.05801595 41.66623664 267.21796686 35.65377808 268.16299438 C35.40627808 267.17299438 35.15877808 266.18299438 34.90377808 265.16299438 C33.69565667 260.88204243 31.74556513 257.07240223 29.65377808 253.16299438 C28.99377808 253.16299438 28.33377808 253.16299438 27.65377808 253.16299438 C27.65377808 257.78299438 27.65377808 262.40299438 27.65377808 267.16299438 C28.64377808 267.16299438 29.63377808 267.16299438 30.65377808 267.16299438 C30.65377808 268.15299438 30.65377808 269.14299438 30.65377808 270.16299438 C29.66377808 270.65799438 29.66377808 270.65799438 28.65377808 271.16299438 C29.64377808 274.13299438 30.63377808 277.10299438 31.65377808 280.16299438 C32.31377808 278.84299438 32.97377808 277.52299438 33.65377808 276.16299438 C35.41840491 279.25109134 35.65377808 280.39611574 35.65377808 284.16299438 C37.27602347 285.87292872 38.94791232 287.53647123 40.65377808 289.16299438 C41.70665622 290.79677081 42.72647818 292.45481036 43.65377808 294.16299438 C42.66377808 294.65799438 42.66377808 294.65799438 41.65377808 295.16299438 C50.75598928 303.86945728 62.25886006 307.58277583 74.77877808 307.41299438 C75.88020142 307.40284302 75.88020142 307.40284302 77.00387573 307.39248657 C90.99652009 307.13241149 105.18351365 305.62993124 115.59127808 295.46377563 C123.94459264 286.1454001 126.81393254 276.05278154 129.65377808 264.16299438 C129.92315186 263.12888428 129.92315186 263.12888428 130.19796753 262.07388306 C131.75587963 255.54266826 131.40134853 248.69121688 127.95846558 242.87393188 C122.75298149 236.0475785 114.70451885 234.1104033 106.65377808 232.16299438 C105.66377808 232.16299438 104.67377808 232.16299438 103.65377808 232.16299438 Z M88.65377808 237.16299438 C88.12010136 239.18627424 87.6765406 241.23366793 87.27877808 243.28799438 C86.12446834 248.66885362 84.71824522 252.61912932 81.65377808 257.16299438 C89.73347234 255.71132355 98.22518555 253.77171572 103.65377808 247.16299438 C100.18937214 241.70393048 97.48885707 238.96832083 91.65377808 236.16299438 C90.43017128 236.08845879 90.43017128 236.08845879 88.65377808 237.16299438 Z M-62.34622192 239.16299438 C-62.01622192 240.15299438 -61.68622192 241.14299438 -61.34622192 242.16299438 C-57.88122192 241.66799438 -57.88122192 241.66799438 -54.34622192 241.16299438 C-57.43431888 239.39836755 -58.57934328 239.16299438 -62.34622192 239.16299438 Z M54.65377808 240.16299438 C50.88797861 244.11708382 49.05542929 246.53987739 48.65377808 252.16299438 C54.38668723 254.8714432 54.38668723 254.8714432 60.65377808 255.16299438 C60.4604187 254.58291626 60.26705933 254.00283813 60.06784058 253.40518188 C58.59648641 248.99111938 57.12513224 244.57705688 55.65377808 240.16299438 C55.32377808 240.16299438 54.99377808 240.16299438 54.65377808 240.16299438 Z M72.65377808 242.16299438 C72.65377808 242.49299438 72.65377808 242.82299438 72.65377808 243.16299438 C77.3043068 243.4323196 77.3043068 243.4323196 81.65377808 242.16299438 C81.65377808 241.50299438 81.65377808 240.84299438 81.65377808 240.16299438 C77.85819927 240.16299438 76.02475191 240.66478379 72.65377808 242.16299438 Z M-37.34622192 241.16299438 C-38.99622192 244.79299438 -40.64622192 248.42299438 -42.34622192 252.16299438 C-39.46903442 251.94643188 -39.46903442 251.94643188 -36.53372192 251.72549438 C-35.45477661 251.64428345 -34.3758313 251.56307251 -33.26419067 251.47940063 C-30.28632288 251.26086977 -30.28632288 251.26086977 -27.34622192 250.16299438 C-28.75551889 246.69167344 -30.25227275 245.28206164 -33.47122192 243.41299438 C-34.74997192 242.67049438 -36.02872192 241.92799438 -37.34622192 241.16299438 Z M57.65377808 259.16299438 C61.32724578 261.61197286 63.31734207 261.47837155 67.65377808 261.16299438 C68.31377808 260.50299438 68.97377808 259.84299438 69.65377808 259.16299438 C65.69377808 259.16299438 61.73377808 259.16299438 57.65377808 259.16299438 Z M32.65377808 280.16299438 C33.65377808 282.16299438 33.65377808 282.16299438 33.65377808 282.16299438 Z M34.65377808 284.16299438 C35.65377808 286.16299438 35.65377808 286.16299438 35.65377808 286.16299438 Z M-20.34622192 348.16299438 C-19.68622192 348.82299438 -19.02622192 349.48299438 -18.34622192 350.16299438 C-18.01622192 349.50299438 -17.68622192 348.84299438 -17.34622192 348.16299438 C-18.33622192 348.16299438 -19.32622192 348.16299438 -20.34622192 348.16299438 Z M-18.34622192 353.16299438 C-17.34622192 355.16299438 -17.34622192 355.16299438 -17.34622192 355.16299438 Z M107.65377808 381.16299438 C106.99377808 381.82299438 106.33377808 382.48299438 105.65377808 383.16299438 C105.97229578 385.27120235 105.97229578 385.27120235 106.65377808 387.16299438 C108.30377808 386.83299438 109.95377808 386.50299438 111.65377808 386.16299438 C111.98377808 384.84299438 112.31377808 383.52299438 112.65377808 382.16299438 C110.25658376 381.48340836 110.25658376 381.48340836 107.65377808 381.16299438 Z M-62.34622192 404.16299438 C-62.34622192 407.16299438 -62.34622192 407.16299438 -62.34622192 407.16299438 Z M-59.34622192 415.16299438 C-59.8493225 416.95379288 -60.34860821 418.74566349 -60.84622192 420.53799438 C-61.12465942 421.53572876 -61.40309692 422.53346313 -61.68997192 423.56143188 C-62.42775208 426.03902715 -62.42775208 426.03902715 -62.34622192 428.16299438 C-60.50921403 428.93541707 -60.50921403 428.93541707 -58.34622192 429.16299438 C-55.87866176 427.51795428 -55.39661893 426.36000086 -54.65872192 423.47549438 C-54.55559692 422.71236938 -54.45247192 421.94924438 -54.34622192 421.16299438 C-55.66622192 421.16299438 -56.98622192 421.16299438 -58.34622192 421.16299438 C-58.01622192 419.18299438 -57.68622192 417.20299438 -57.34622192 415.16299438 C-58.00622192 415.16299438 -58.66622192 415.16299438 -59.34622192 415.16299438 Z M-53.34622192 429.16299438 C-53.01622192 429.82299438 -52.68622192 430.48299438 -52.34622192 431.16299438 C-51.68622192 430.50299438 -51.02622192 429.84299438 -50.34622192 429.16299438 C-51.33622192 429.16299438 -52.32622192 429.16299438 -53.34622192 429.16299438 Z M53.65377808 430.16299438 C53.98377808 431.15299438 54.31377808 432.14299438 54.65377808 433.16299438 C54.65377808 432.17299438 54.65377808 431.18299438 54.65377808 430.16299438 C54.32377808 430.16299438 53.99377808 430.16299438 53.65377808 430.16299438 Z M7.65377808 432.16299438 C7.32377808 432.82299438 6.99377808 433.48299438 6.65377808 434.16299438 C7.31377808 434.16299438 7.97377808 434.16299438 8.65377808 434.16299438 C8.32377808 433.50299438 7.99377808 432.84299438 7.65377808 432.16299438 Z M9.65377808 435.16299438 C10.65377808 437.16299438 10.65377808 437.16299438 10.65377808 437.16299438 Z M-45.34622192 436.16299438 C-44.7476045 438.51470569 -44.07697841 440.84893219 -43.34622192 443.16299438 C-42.68622192 443.49299438 -42.02622192 443.82299438 -41.34622192 444.16299438 C-41.34622192 441.52299438 -41.34622192 438.88299438 -41.34622192 436.16299438 C-42.66622192 436.16299438 -43.98622192 436.16299438 -45.34622192 436.16299438 Z M16.65377808 439.16299438 C17.65377808 442.16299438 17.65377808 442.16299438 17.65377808 442.16299438 Z M-23.34622192 453.16299438 C-22.34622192 455.16299438 -22.34622192 455.16299438 -22.34622192 455.16299438 Z ",transform:"translate(163.34622192382813,-0.162994384765625)"})})})]}),P.jsx("div",{className:"mt-10 flex justify-center opacity-0 animate-fade-in-delay-4",children:P.jsx("a",{href:"#projects",className:"cosmic-button",children:"View My Work"})}),P.jsxs("div",{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 flex flex-col items-center animate-bounce",children:[P.jsx("span",{className:"text-sm text-muted-foreground mb-2",children:"Scroll"}),P.jsx(IT,{className:"h-5 w-5 text-primary"})]})]}),Yw=()=>P.jsx("section",{id:"about",className:"py-24 px-4 relative",children:P.jsxs("div",{className:"container mx-auto max-w-5xl",children:[P.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-12 text-center",children:["About ",P.jsx("span",{className:"text-primary",children:"Me"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12 items-center",children:[P.jsxs("div",{className:"space-y-6",children:[P.jsx("h3",{className:"text-2xl font-semibold",children:"Passionate problem solver"}),P.jsx("p",{className:"text-muted-foreground",children:"Hola! I'm JD Franco, a Spain-born, Northern Virginia-based Principal Consultant and Software Engineer specializing in geospatial analytics, Databricks, and modern web mapping applications."}),P.jsx("p",{className:"text-muted-foreground",children:"I design and ship end-to-end solutions, from cloud data pipelines and Databricks Apps to React frontends that turn complex spatial data into intuitive, interactive experiences for clients."}),P.jsx("p",{className:"text-md font-semibold",children:"Sports & Teamwork Values"}),P.jsx("p",{className:"text-muted-foreground",children:"From the age of seven, basketball has played a central role in my life, shaping my commitment to discipline and collaboration. Competing at various levels, sometimes as a leader, other times as the youngest player supporting my team, Ive learned the true power of teamwork. Caring for teammates, adapting to different roles, and striving towards collective goals on and off the court have instilled in me resilience, adaptability, and a drive for shared success. These experiences directly shape how I lead delivery teams today: adapting to roles, communicating clearly, and always keeping the team goal ahead of individual ego."}),P.jsx("p",{className:"text-md font-semibold",children:"Sociability & Community Focus"}),P.jsx("p",{className:"text-muted-foreground",children:"Growing up in Spain, social life was always at the heart of daily experience. I deeply value having trustworthy friends and reliable coworkers. I thrive on connecting with others, from building relationships in community activities to creating an inclusive environment in professional settings. Fostering meaningful connections remains a source of energy and inspiration in all that I do. In consulting, this translates into being approachable, empathetic, and intentional about building trust with both teammates and clients."}),P.jsx("p",{className:"text-md font-semibold",children:"Leadership Philosophy"}),P.jsx("p",{className:"text-muted-foreground",children:"My leadership style is rooted in leading by example and treating everyone with kindness. I believe a happy and collaborative team is the foundation for great results. If challenges arise, facing them together not only makes the burden lighter but also brings everyone closer to a solution. It's all about contribution, mutual respect, and finding joy, even in adversity. Whether Im guiding a migration to Databricks or architecting a new geospatial app, I focus on clarity, kindness, and shared ownership of outcomes."}),P.jsx("div",{className:"flex flex-col sm:flex-row gap-4 pt-4 justify-center",children:P.jsx("a",{href:"#contact",className:"cosmic-button",children:"Get In Touch"})})]}),P.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[P.jsx("div",{className:"gradient-border p-6 card-hover",children:P.jsxs("div",{className:"flex items-start gap-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx(UT,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{className:"text-left",children:[P.jsx("h4",{className:"font-semibold text-lg",children:"Web & App Engineering"}),P.jsx("p",{className:"muted-foreground",children:"Building interactive geospatial applications and dashboards using React, TypeScript, Mapbox, and modern UI libraries."}),P.jsx("p",{className:"muted-foreground mt-2",children:"Connecting Python/Flask or FastAPI backends and Databricks Apps to deliver fast, production-ready experiences."})]})]})}),P.jsx("div",{className:"gradient-border p-6 card-hover",children:P.jsxs("div",{className:"flex items-start gap-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx(kT,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{className:"text-left",children:[P.jsx("h4",{className:"font-semibold text-lg",children:"Data Visualization & Analytics"}),P.jsx("p",{className:"muted-foreground",children:"Designing and embedding Tableau dashboards and analytics tools for actionable business intelligence."}),P.jsx("p",{className:"muted-foreground mt-2",children:"Creating custom extensions and geospatial visualizations that help stakeholders explore complex spatial patterns intuitively."})]})]})}),P.jsx("div",{className:"gradient-border p-6 card-hover",children:P.jsxs("div",{className:"flex items-start gap-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx(LT,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{className:"text-left",children:[P.jsx("h4",{className:"font-semibold text-lg",children:"Technical Leadership & Solution Architecture"}),P.jsx("p",{className:"muted-foreground",children:"Leading multidisciplinary teams and managing end-to-end projects across GIS, data engineering, and application development."}),P.jsx("p",{className:"muted-foreground mt-2",children:"Architecting cloud-native solutions for Databricks PVC-to-E2 migrations, automation workflows, and geospatial integration at scale."})]})]})})]})]})]})}),qw=[{name:"HTML/CSS",level:95,category:"frontend"},{name:"JavaScript (ES6+)",level:90,category:"frontend"},{name:"React",level:85,category:"frontend"},{name:"TypeScript",level:85,category:"frontend"},{name:"Tailwind CSS",level:75,category:"frontend"},{name:"Streamlit",level:70,category:"frontend"},{name:"Mapbox GL JS",level:85,category:"frontend"},{name:"deck.gl",level:70,category:"frontend"},{name:"Python",level:85,category:"backend"},{name:"Flask",level:80,category:"backend"},{name:"FastAPI",level:70,category:"backend"},{name:"PostgreSQL",level:75,category:"backend"},{name:"PostGIS",level:70,category:"backend"},{name:"Git / GitHub",level:80,category:"tools"},{name:"GitLab / Azure DevOps",level:75,category:"tools"},{name:"Databricks",level:70,category:"tools"},{name:"Tableau",level:85,category:"tools"},{name:"ArcGIS / QGIS",level:90,category:"tools"},{name:"Figma",level:85,category:"tools"},{name:"VS Code",level:95,category:"tools"}],Zw=["all","frontend","backend","tools"],Kw=()=>{const[n,e]=L.useState("all"),[t,i]=L.useState(!1);L.useEffect(()=>{i(!1);const o=setTimeout(()=>i(!0),100);return()=>clearTimeout(o)},[n]);const s=qw.filter(o=>n==="all"||o.category===n);return P.jsx("section",{id:"skills",className:"py-24 px-4 relative bg-secondary/30",children:P.jsxs("div",{className:"container mx-auto max-w-5xl",children:[P.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-12 text-center",children:["My ",P.jsx("span",{className:"text-primary",children:"Skills"})]}),P.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-12",children:Zw.map(o=>P.jsx("button",{onClick:()=>e(o),className:Wa("px-5 py-2 rounded-full transition-colors duration-300 capitalize",n===o?"bg-primary text-primary-foreground":"bg-secondary/70 text-foreground hover:bg-secondary"),children:o},o))}),P.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map((o,l)=>P.jsxs("div",{className:"bg-card p-6 rounded-lg shadow-xs card-hover",children:[P.jsx("div",{className:"text-left mb-4",children:P.jsxs("h3",{className:"font-semibold text-lg",children:[" ",o.name," "]})}),P.jsx("div",{className:"w-full bg-secondary/50 h-2 rounded-full overflow-hidden",children:P.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-1000 ease-out",style:{width:t?`${o.level}%`:"0%"}})}),P.jsx("div",{className:"text-right mt-1",children:P.jsxs("span",{className:"text-sm text-muted-foreground",children:[o.level,"%"]})})]},l))})]})})},Gw=[{id:1,title:"The GC Wealth Project",description:"Website that embeds multiple Tableau dashboads and allow website elements to interact with the dashboards.",image:"/projects/cuny.png",tags:["Tableau","Front-End"],demoUrl:"https://wealthproject.gc.cuny.edu/"},{id:2,title:"PG&E Fire Detection App",description:"A web application that uses live data to track wildfirs in California.",image:"/projects/pge.png",tags:["Geospatial","Front-End"],demoUrl:"/projects/pge.png"},{id:3,title:"NYC Real Estate Neighborhood Guide.",description:"Mapbox map integrated in Wordpress displaying properties and neighborhood info",image:"/projects/repolus.png",tags:["Geospatial","Front-End"],demoUrl:"http://repolus.com/neighborhoods/"},{id:4,title:"Showme Caribbean",description:"Web application that displays touristic locations around Caribben Islands with 3D views.",image:"/projects/showmecaribbean.png",tags:["Geospatial","Front-End"],demoUrl:"https://maps.showmecaribbean.com/Curacaomap"},{id:5,title:"HOLC 'Redlining' Maps",description:"This publication was based on spatial analysis performed on ArcGIS' ArcMap. Comparing the old HOLC maps with current demographic data.",image:"/projects/holc.png",tags:["Geospatial","Publications"],demoUrl:"https://ncrc.org/holc/"},{id:6,title:"Elimination Game",description:"This is a web application game where the user needs to pick a country based on a prompt and if it is the same as the one selected by the machine then the game is over",image:"/projects/elimination_game.png",tags:["Geospatial","Front-End"],demoUrl:"/game"}],Qw=()=>P.jsx("section",{id:"projects",className:"py-24 px-4 relative",children:P.jsxs("div",{className:"container mx-auto max-w-5xl",children:[P.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4 text-center",children:["Featured ",P.jsx("span",{className:"text-primary",children:"Projects"})]}),P.jsx("p",{className:"text-center text-muted-foreground mb-12 max-w-2xl mx-auto",children:"Here are some of my recent projects. Each project was carefully crafted with attention to detail, performance, and user experience."}),P.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-8",children:Gw.map((n,e)=>P.jsx("div",{className:"inline-block w-full group bg-card rounded-lg overflow-hidden shadow-xs card-hover break-inside-avoid",children:P.jsxs("a",{href:n.demoUrl,target:"_blank",className:"text-foreground/80 hover:text-primary transition-colors duration-300",children:[P.jsx("div",{className:"h-48 overflow-hidden",children:P.jsx("img",{src:n.image,alt:n.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),P.jsxs("div",{className:"p-6",children:[P.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:n.tags.map(t=>P.jsx("span",{className:"px-2 py-1 text-xs font-medium border rounded-full bg-primary/20 text-secondary-foreground",children:t}))}),P.jsx("h3",{className:"text-xl font-semibold mb-1",children:n.title}),P.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:n.description}),P.jsx("div",{className:"flex justify-between items-center",children:P.jsx("div",{className:"flex space-x-3"})})]})]})},e))})]})}),Jw=()=>P.jsx("section",{id:"contact",className:"py-24 px-4 relative bg-secondary/30",children:P.jsxs("div",{className:"container mx-auto max-w-5xl",children:[P.jsxs("h2",{className:"text-3xl md:text-4xl font-bold mb-4 text-center",children:["Get in ",P.jsx("span",{className:"text-primary",children:"Touch"})]}),P.jsx("p",{className:"text-center text-muted-foreground mb-12 max-w-2xl mx-auto",children:"Have a project in mind or want to collaborate? Feel free to reach out. I'm always open to discussing new opportunities."}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-12",children:[P.jsxs("div",{className:"space-y-8",children:[P.jsx("h3",{className:"text-2xl font-semibold mb-6"}),P.jsxs("div",{className:"space-y-6 justify-center",children:[P.jsxs("div",{className:"flex items-start space-x-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx($T,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{children:[P.jsx("h4",{children:" Email"}),P.jsx("a",{href:"mailto:jd.franco.caballero@gmail.com",className:"text-muted-foreground hover:text-primary transition-colors",children:" jd.franco.caballero@gmail.com"})]})]}),P.jsxs("div",{className:"flex items-start space-x-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx(QT,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{children:[P.jsx("h4",{children:" Phone"}),P.jsx("a",{href:"tel:+17034011926",className:"text-muted-foreground hover:text-primary transition-colors",children:" +1 (703) 401-1926"})]})]}),P.jsxs("div",{className:"flex items-start space-x-4",children:[P.jsx("div",{className:"p-3 rounded-full bg-primary/10",children:P.jsx(XT,{className:"h-6 w-6 text-primary"})}),P.jsxs("div",{children:[P.jsx("h4",{children:" Location"}),P.jsx("a",{className:"text-muted-foreground hover:text-primary transition-colors",children:" Washington DC-Baltimore Area"})]})]})]}),P.jsxs("div",{className:"pt-8",children:[P.jsx("h4",{className:"font-medium mb-4",children:" Connect With Me"}),P.jsxs("div",{className:"flex space-x-4 justify-center",children:[P.jsx("a",{href:"https://x.com/jd_francoc",target:"_blank",children:P.jsx(sw,{})}),P.jsx("a",{href:"https://public.tableau.com/app/profile/jd.franco/vizzes",target:"_blank",children:P.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"23",height:"23",viewBox:"0 0 32 32",children:P.jsx("path",{fill:"currentColor",d:"M15.536.235v2.937h-2.624v.771h2.624V6.88h.933V3.943h2.624v-.771h-2.624V.235zm8.043 3.016v4.328h-3.943v1.233h3.943v4.251h1.391l.009-2.109l.032-2.099l1.953-.032l1.943-.011V7.579H24.97V3.251zm-16.543.077v4.256H3.052v1.228h3.984v4.256h1.313V8.812h4.015V7.579H8.349V3.328zm8.115 7.027v4.791h-4.405v1.584h4.405v4.797h1.709V16.73h4.411v-1.584H16.86v-4.791zm12.964 2.066v2.959h-2.688v1.084h2.688v3.015h1.183v-3.015h2.703V15.38h-2.703v-2.959zm-25.484.172v2.901H0v.828h2.631v2.928h.891v-2.928h2.667v-.828H3.48v-2.901zm20.948 6.027v4.339h-4.027v1.235h4.027v4.285h1.427v-4.285h3.979v-1.235h-3.979V18.62zm-16.62.011v4.328H3.016v1.235h3.943v4.255h1.468v-4.255h3.937v-1.235H8.427v-4.333h-.733zm8.421 6.104v2.937h-2.625v1.077h2.625v3.016h1.24l.016-1.489l.02-1.527h2.631v-1.077H16.62v-2.937z"})})}),P.jsx("a",{href:"https://www.instagram.com/jd.francoc/",target:"_blank",children:P.jsx(zT,{})}),P.jsx("a",{href:"https://www.linkedin.com/in/jdfranco/",target:"_blank",children:P.jsx(VT,{})})]})]})]}),P.jsxs("div",{className:"bg-card p-8 rounded-lg shadow-xs",children:[P.jsx("h3",{className:"text-2xl font-semibold mb-6",children:"Send a Message"}),P.jsxs("form",{action:"https://formspree.io/f/xvojpoaa",method:"POST",className:"space-y-6",children:[P.jsxs("div",{children:[P.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-2",children:" Your Name"}),P.jsx("input",{type:"text",id:"name",name:"name",required:!0,className:"w-full px-4 py-3 rounded-md border border-input bg-background focus:outline-hidden focus:ring-2 focus:ring-primary",placeholder:"John Doe..."})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"email",className:"block text-sm font-medium mb-2",children:" Your Email"}),P.jsx("input",{type:"email",id:"email",name:"email",required:!0,className:"w-full px-4 py-3 rounded-md border border-input bg-background focus:outline-hidden focus:ring-2 focus:ring-primary",placeholder:"John.Doe@domain.com"})]}),P.jsxs("div",{children:[P.jsx("label",{htmlFor:"message",className:"block text-sm font-medium mb-2",children:" Your Message"}),P.jsx("textarea",{id:"message",name:"message",required:!0,className:"w-full px-4 py-3 rounded-md border border-input bg-background focus:outline-hidden focus:ring-2 focus:ring-primary resize-none",placeholder:"Hello, I'd like to talk about..."})]}),P.jsxs("button",{type:"submit",className:Wa("cosmic-button w-full flex items-center justify-center gap-2"),children:["Send Message",P.jsx(ew,{size:16})]})]})]})]})]})}),eS=()=>P.jsxs(Q4,{children:[P.jsx(Xw,{}),P.jsx(Yw,{}),P.jsx(Kw,{}),P.jsx(Qw,{}),P.jsx(Jw,{})]}),tS=()=>P.jsx("div",{children:" Not Found"}),nS="modulepreload",iS=function(n){return"/"+n},C0={},du=function(e,t,i){let s=Promise.resolve();if(t&&t.length>0){let f=function(d){return Promise.all(d.map(p=>Promise.resolve(p).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=f(t.map(d=>{if(d=iS(d),d in C0)return;C0[d]=!0;const p=d.endsWith(".css"),_=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${_}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":nS,p||(y.as="script"),y.crossOrigin="",y.href=d,c&&y.setAttribute("nonce",c),document.head.appendChild(y),p)return new Promise((v,x)=>{y.addEventListener("load",v),y.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return s.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return e().catch(o)})},sS=L.createContext(null);function rS(n,e){const t=Array.isArray(n)?n[0]:n?n.x:0,i=Array.isArray(n)?n[1]:n?n.y:0,s=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return t===s&&i===o}function mi(n,e){if(n===e)return!0;if(!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!mi(n[t],e[t]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(const s of t)if(!e.hasOwnProperty(s)||!mi(n[s],e[s]))return!1;return!0}return!1}function oS(n){const e=n.clone();return e.pixelsToGLUnits=n.pixelsToGLUnits,e}function R0(n,e){if(!n.getProjection)return;const t=n.getProjection(),i=e.getProjection();mi(t,i)||e.setProjection(t)}function M0(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function P0(n,e){const t=e.viewState||e;let i=!1;if("zoom"in t){const s=n.zoom;n.zoom=t.zoom,i=i||s!==n.zoom}if("bearing"in t){const s=n.bearing;n.bearing=t.bearing,i=i||s!==n.bearing}if("pitch"in t){const s=n.pitch;n.pitch=t.pitch,i=i||s!==n.pitch}if(t.padding&&!n.isPaddingEqual(t.padding)&&(i=!0,n.padding=t.padding),"longitude"in t&&"latitude"in t){const s=n.center;n.center=new s.constructor(t.longitude,t.latitude),i=i||s!==n.center}return i}const aS=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function O0(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const e={};for(const i of n.layers)e[i.id]=i;const t=n.layers.map(i=>{let s=null;"interactive"in i&&(s=Object.assign({},i),delete s.interactive);const o=e[i.ref];if(o){s=s||Object.assign({},i),delete s.ref;for(const l of aS)l in o&&(s[l]=o[l])}return s||i});return{...n,layers:t}}var I0={};const N0={version:8,sources:{},layers:[]},k0={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},xd={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},D0={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},lS=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],cS=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class eo{constructor(e,t,i){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=s=>{const o=this.props[D0[s.type]];o?o(s):s.type==="error"&&console.error(s.error)},this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const o=this.props[k0[s.type]];o&&(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"&&(s.features=this._hoveredFeatures||this._queryRenderedFeatures(s.point)),o(s),delete s.features)},this._onCameraEvent=s=>{if(!this._internalUpdate){const o=this.props[xd[s.type]];o&&o(s)}s.type in this._deferredEvents&&(this._deferredEvents[s.type]=!1)},this._MapClass=e,this.props=t,this._initialize(i)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const i=this._updateSettings(e,t);i&&this._createShadowTransform(this._map);const s=this._updateSize(e),o=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(i||s||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const i=eo.savedMaps.pop();if(!i)return null;const s=i.map,o=s.getContainer();for(t.className=o.className;o.childNodes.length>0;)t.appendChild(o.childNodes[0]);s._container=t;const l=s._resizeObserver;l&&(l.disconnect(),l.observe(t)),i.setProps({...e,styleDiffing:!1}),s.resize();const{initialViewState:c}=e;return c&&(c.bounds?s.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):i._updateViewState(c,!1)),s.isStyleLoaded()?s.fire("load"):s.once("styledata",()=>s.fire("load")),s._update(),i}_initialize(e){const{props:t}=this,{mapStyle:i=N0}=t,s={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||uS()||null,container:e,style:O0(i)},o=s.initialViewState||s.viewState||s;if(Object.assign(s,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),t.gl){const p=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=p,t.gl)}const l=new this._MapClass(s);o.padding&&l.setPadding(o.padding),t.cursor&&(l.getCanvas().style.cursor=t.cursor),this._createShadowTransform(l);const c=l._render;l._render=p=>{this._inRender=!0,c.call(l,p),this._inRender=!1};const f=l._renderTaskQueue.run;l._renderTaskQueue.run=p=>{f.call(l._renderTaskQueue,p),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const d=l.fire;l.fire=this._fireEvent.bind(this,d),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>{this._updateStyleComponents(this.props,{}),R0(l.transform,this._renderTransform)}),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const p in k0)l.on(p,this._onPointerEvent);for(const p in xd)l.on(p,this._onCameraEvent);for(const p in D0)l.on(p,this._onEvent);this._map=l}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");t?.remove(),eo.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=oS(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const i=this._map;if(t.width!==i.transform.width||t.height!==i.transform.height)return i.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const i=this._map,s=this._renderTransform,{zoom:o,pitch:l,bearing:c}=s,f=i.isMoving();f&&(s.cameraElevationReference="sea");const d=P0(s,{...M0(i.transform),...e});if(f&&(s.cameraElevationReference="ground"),d&&t){const p=this._deferredEvents;p.move=!0,p.zoom||(p.zoom=o!==s.zoom),p.rotate||(p.rotate=c!==s.bearing),p.pitch||(p.pitch=l!==s.pitch)}return f||P0(i.transform,e),d}_updateSettings(e,t){const i=this._map;let s=!1;for(const o of lS)if(o in e&&!mi(e[o],t[o])){s=!0;const l=i[`set${o[0].toUpperCase()}${o.slice(1)}`];l?.call(i,e[o])}return s}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:i=N0,styleDiffing:s=!0}=e,o={diff:s};return"localIdeographFontFamily"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(O0(i),o),!0}return!1}_updateStyleComponents(e,t){const i=this._map;let s=!1;return i.isStyleLoaded()&&("light"in e&&i.setLight&&!mi(e.light,t.light)&&(s=!0,i.setLight(e.light)),"fog"in e&&i.setFog&&!mi(e.fog,t.fog)&&(s=!0,i.setFog(e.fog)),"terrain"in e&&i.setTerrain&&!mi(e.terrain,t.terrain)&&(!e.terrain||i.getSource(e.terrain.source))&&(s=!0,i.setTerrain(e.terrain))),s}_updateHandlers(e,t){var i,s;const o=this._map;let l=!1;for(const c of cS){const f=(i=e[c])!==null&&i!==void 0?i:!0,d=(s=t[c])!==null&&s!==void 0?s:!0;mi(f,d)||(l=!0,f?o[c].enable(f):o[c].disable())}return l}_queryRenderedFeatures(e){const t=this._map,i=t.transform,{interactiveLayerIds:s=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:s.filter(t.getLayer.bind(t))})}catch{return[]}finally{t.transform=i}}_updateHover(e){var t;const{props:i}=this;if(i.interactiveLayerIds&&(i.onMouseMove||i.onMouseEnter||i.onMouseLeave)){const o=e.type,l=((t=this._hoveredFeatures)===null||t===void 0?void 0:t.length)>0,c=this._queryRenderedFeatures(e.point),f=c.length>0;!f&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=c,f&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=o}else this._hoveredFeatures=null}_fireEvent(e,t,i){const s=this._map,o=s.transform,l=typeof t=="string"?t:t.type;return l==="move"&&this._updateViewState(this.props,!1),l in xd&&(typeof t=="object"&&(t.viewState=M0(o)),this._map.isMoving())?(s.transform=this._renderTransform,e.call(s,t,i),s.transform=o,s):(e.call(s,t,i),s)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const i in this._deferredEvents)this._deferredEvents[i]&&e.fire(i);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{R0(this._renderTransform,t),e.transform=t}}}eo.savedMaps=[];function uS(){let n=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);n=e&&e[1]}try{n=n||I0.MapboxAccessToken}catch{}try{n=n||I0.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const fS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function hS(n){if(!n)return null;const e=n.map,t={getMap:()=>e,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:i=>{const s=e.transform;e.transform=n.transform;const o=e.project(i);return e.transform=s,o},unproject:i=>{const s=e.transform;e.transform=n.transform;const o=e.unproject(i);return e.transform=s,o},queryTerrainElevation:(i,s)=>{const o=e.transform;e.transform=n.transform;const l=e.queryTerrainElevation(i,s);return e.transform=o,l},queryRenderedFeatures:(i,s)=>{const o=e.transform;e.transform=n.transform;const l=e.queryRenderedFeatures(i,s);return e.transform=o,l}};for(const i of dS(e))!(i in t)&&!fS.includes(i)&&(t[i]=e[i].bind(e));return t}function dS(n){const e=new Set;let t=n;for(;t;){for(const i of Object.getOwnPropertyNames(t))i[0]!=="_"&&typeof n[i]=="function"&&i!=="fire"&&i!=="setEventedParent"&&e.add(i);t=Object.getPrototypeOf(t)}return Array.from(e)}const pS=typeof document<"u"?L.useLayoutEffect:L.useEffect,gS=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function mS(n,e){for(const i of gS)i in e&&(n[i]=e[i]);const{RTLTextPlugin:t="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;t&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(t,i=>{i&&console.error(i)},!0)}const zu=L.createContext(null);function _S(n,e,t){const i=L.useContext(sS),[s,o]=L.useState(null),l=L.useRef(),{current:c}=L.useRef({mapLib:null,map:null});L.useEffect(()=>{const p=n.mapLib;let _=!0,y;return Promise.resolve(p||t).then(v=>{if(!_)return;if(!v)throw new Error("Invalid mapLib");const x="Map"in v?v:v.default;if(!x.Map)throw new Error("Invalid mapLib");if(mS(x,n),!x.supported||x.supported(n))n.reuseMaps&&(y=eo.reuse(n,l.current)),y||(y=new eo(x.Map,n,l.current)),c.map=hS(y),c.mapLib=x,o(y),i?.onMapMount(c.map,n.id);else throw new Error("Map is not supported by this browser")}).catch(v=>{const{onError:x}=n;x?x({type:"error",target:null,originalEvent:null,error:v}):console.error(v)}),()=>{_=!1,y&&(i?.onMapUnmount(n.id),n.reuseMaps?y.recycle():y.destroy())}},[]),pS(()=>{s&&s.setProps(n)}),L.useImperativeHandle(e,()=>c.map,[s]);const f=L.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),d={height:"100%"};return L.createElement("div",{id:n.id,ref:l,style:f},s&&L.createElement(zu.Provider,{value:c},L.createElement("div",{"mapboxgl-children":"",style:d},n.children)))}const yS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function $s(n,e){if(!n||!e)return;const t=n.style;for(const i in e){const s=e[i];Number.isFinite(s)&&!yS.test(i)?t[i]=`${s}px`:t[i]=s}}function bS(n,e){const{map:t,mapLib:i}=L.useContext(zu),s=L.useRef({props:n});s.current.props=n;const o=L.useMemo(()=>{let S=!1;L.Children.forEach(n.children,U=>{U&&(S=!0)});const M={...n,element:S?document.createElement("div"):null},C=new i.Marker(M);return C.setLngLat([n.longitude,n.latitude]),C.getElement().addEventListener("click",U=>{var R,D;(D=(R=s.current.props).onClick)===null||D===void 0||D.call(R,{type:"click",target:C,originalEvent:U})}),C.on("dragstart",U=>{var R,D;const B=U;B.lngLat=o.getLngLat(),(D=(R=s.current.props).onDragStart)===null||D===void 0||D.call(R,B)}),C.on("drag",U=>{var R,D;const B=U;B.lngLat=o.getLngLat(),(D=(R=s.current.props).onDrag)===null||D===void 0||D.call(R,B)}),C.on("dragend",U=>{var R,D;const B=U;B.lngLat=o.getLngLat(),(D=(R=s.current.props).onDragEnd)===null||D===void 0||D.call(R,B)}),C},[]);L.useEffect(()=>(o.addTo(t.getMap()),()=>{o.remove()}),[]);const{longitude:l,latitude:c,offset:f,style:d,draggable:p=!1,popup:_=null,rotation:y=0,rotationAlignment:v="auto",pitchAlignment:x="auto"}=n;return L.useEffect(()=>{$s(o.getElement(),d)},[d]),L.useImperativeHandle(e,()=>o,[]),(o.getLngLat().lng!==l||o.getLngLat().lat!==c)&&o.setLngLat([l,c]),f&&!rS(o.getOffset(),f)&&o.setOffset(f),o.isDraggable()!==p&&o.setDraggable(p),o.getRotation()!==y&&o.setRotation(y),o.getRotationAlignment()!==v&&o.setRotationAlignment(v),o.getPitchAlignment()!==x&&o.setPitchAlignment(x),o.getPopup()!==_&&o.setPopup(_),B4.createPortal(n.children,o.getElement())}L.memo(L.forwardRef(bS));function L0(n){return new Set(n?n.trim().split(/\s+/):[])}function vS(n,e){const{map:t,mapLib:i}=L.useContext(zu),s=L.useMemo(()=>document.createElement("div"),[]),o=L.useRef({props:n});o.current.props=n;const l=L.useMemo(()=>{const c={...n},f=new i.Popup(c);return f.setLngLat([n.longitude,n.latitude]),f.once("open",d=>{var p,_;(_=(p=o.current.props).onOpen)===null||_===void 0||_.call(p,d)}),f},[]);if(L.useEffect(()=>{const c=f=>{var d,p;(p=(d=o.current.props).onClose)===null||p===void 0||p.call(d,f)};return l.on("close",c),l.setDOMContent(s).addTo(t.getMap()),()=>{l.off("close",c),l.isOpen()&&l.remove()}},[]),L.useEffect(()=>{$s(l.getElement(),n.style)},[n.style]),L.useImperativeHandle(e,()=>l,[]),l.isOpen()&&((l.getLngLat().lng!==n.longitude||l.getLngLat().lat!==n.latitude)&&l.setLngLat([n.longitude,n.latitude]),n.offset&&!mi(l.options.offset,n.offset)&&l.setOffset(n.offset),(l.options.anchor!==n.anchor||l.options.maxWidth!==n.maxWidth)&&(l.options.anchor=n.anchor,l.setMaxWidth(n.maxWidth)),l.options.className!==n.className)){const c=L0(l.options.className),f=L0(n.className);for(const d of c)f.has(d)||l.removeClassName(d);for(const d of f)c.has(d)||l.addClassName(d);l.options.className=n.className}return B4.createPortal(n.children,s)}L.memo(L.forwardRef(vS));function nl(n,e,t,i){const s=L.useContext(zu),o=L.useMemo(()=>n(s),[]);return L.useEffect(()=>{const l=e,c=null,f=typeof e=="function"?e:null,{map:d}=s;return d.hasControl(o)||(d.addControl(o,l?.position),c&&c(s)),()=>{f&&f(s),d.hasControl(o)&&d.removeControl(o)}},[]),o}function xS(n){const e=nl(({mapLib:t})=>new t.AttributionControl(n),{position:n.position});return L.useEffect(()=>{$s(e._container,n.style)},[n.style]),null}L.memo(xS);function TS(n){const e=nl(({mapLib:t})=>new t.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return L.useEffect(()=>{$s(e._controlContainer,n.style)},[n.style]),null}L.memo(TS);function wS(n,e){const t=L.useRef({props:n}),i=nl(({mapLib:s})=>{const o=new s.GeolocateControl(n),l=o._setupUI;return o._setupUI=c=>{o._container.hasChildNodes()||l(c)},o.on("geolocate",c=>{var f,d;(d=(f=t.current.props).onGeolocate)===null||d===void 0||d.call(f,c)}),o.on("error",c=>{var f,d;(d=(f=t.current.props).onError)===null||d===void 0||d.call(f,c)}),o.on("outofmaxbounds",c=>{var f,d;(d=(f=t.current.props).onOutOfMaxBounds)===null||d===void 0||d.call(f,c)}),o.on("trackuserlocationstart",c=>{var f,d;(d=(f=t.current.props).onTrackUserLocationStart)===null||d===void 0||d.call(f,c)}),o.on("trackuserlocationend",c=>{var f,d;(d=(f=t.current.props).onTrackUserLocationEnd)===null||d===void 0||d.call(f,c)}),o},{position:n.position});return t.current.props=n,L.useImperativeHandle(e,()=>i,[]),L.useEffect(()=>{$s(i._container,n.style)},[n.style]),null}L.memo(L.forwardRef(wS));function SS(n){const e=nl(({mapLib:t})=>new t.NavigationControl(n),{position:n.position});return L.useEffect(()=>{$s(e._container,n.style)},[n.style]),null}L.memo(SS);function AS(n){const e=nl(({mapLib:o})=>new o.ScaleControl(n),{position:n.position}),t=L.useRef(n),i=t.current;t.current=n;const{style:s}=n;return n.maxWidth!==void 0&&n.maxWidth!==i.maxWidth&&(e.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==i.unit&&e.setUnit(n.unit),L.useEffect(()=>{$s(e._container,s)},[s]),null}L.memo(AS);const ES=du(()=>import("./maplibre-gl-BiRpjiGI.js").then(n=>n.m),[]),CS=L.forwardRef(function(e,t){return _S(e,t,ES)});function pu(n,e){if(!n)throw new Error(e||"loader assertion failed.")}const hg=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),B0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);B0&&parseFloat(B0[1]);const U0=globalThis,F0=globalThis.process||{},RS=globalThis.navigator||{};function J4(n){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;const t=typeof navigator<"u"&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}function Ws(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||J4()}function MS(n){return Ws()?J4()?"Electron":(RS.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const eb="4.1.0";function PS(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class OS{constructor(e,t,i="sessionStorage"){this.storage=PS(i),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function IS(n){let e;return n<10?e=`${n.toFixed(2)}ms`:n<100?e=`${n.toFixed(1)}ms`:n<1e3?e=`${n.toFixed(0)}ms`:e=`${(n/1e3).toFixed(2)}s`,e}function NS(n,e=8){const t=Math.max(e-n.length,0);return`${" ".repeat(t)}${n}`}var gu;(function(n){n[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(gu||(gu={}));const kS=10;function z0(n){return typeof n!="string"?n:(n=n.toUpperCase(),gu[n]||gu.WHITE)}function DS(n,e,t){return!Ws&&typeof n=="string"&&(e&&(n=`\x1B[${z0(e)}m${n}\x1B[39m`),t&&(n=`\x1B[${z0(t)+kS}m${n}\x1B[49m`)),n}function LS(n,e=["constructor"]){const t=Object.getPrototypeOf(n),i=Object.getOwnPropertyNames(t),s=n;for(const o of i){const l=s[o];typeof l=="function"&&(e.find(c=>o===c)||(s[o]=l.bind(n)))}}function dg(n,e){if(!n)throw new Error("Assertion failed")}function Lr(){let n;if(Ws()&&U0.performance)n=U0?.performance?.now?.();else if("hrtime"in F0){const e=F0?.hrtime?.();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}const Br={debug:Ws()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},BS={enabled:!0,level:0};function Ur(){}const j0={},V0={once:!0};class il{constructor({id:e}={id:""}){this.VERSION=eb,this._startTs=Lr(),this._deltaTs=Lr(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new OS(`__probe-${this.id}__`,BS),this.timeStamp(`${this.id} started`),LS(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Lr()-this._startTs).toPrecision(10))}getDelta(){return Number((Lr()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,Br.warn,arguments,V0)}error(e){return this._getLogFunction(0,e,Br.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,Br.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,Br.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,Br.debug||Br.info,arguments,V0)}table(e,t,i){return t?this._getLogFunction(e,t,console.table||Ur,i&&[i],{tag:FS(t)}):Ur}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||Ur)}group(e,t,i={collapsed:!1}){const s=H0({logLevel:e,message:t,opts:i}),{collapsed:o}=i;return s.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(e,t,i={}){return this.group(e,t,Object.assign({},i,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||Ur)}withGroup(e,t,i){this.group(e,t)();try{i()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=tb(e)}_getLogFunction(e,t,i,s,o){if(this._shouldLog(e)){o=H0({logLevel:e,message:t,args:s,opts:o}),i=i||o.method,dg(i),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=Lr();const l=o.tag||o.message;if(o.once&&l)if(!j0[l])j0[l]=Lr();else return Ur;return t=US(this.id,o.message,o),i.bind(console,t,...o.args)}return Ur}}il.VERSION=eb;function tb(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return dg(Number.isFinite(e)&&e>=0),e}function H0(n){const{logLevel:e,message:t}=n;n.logLevel=tb(e);const i=n.args?Array.from(n.args):[];for(;i.length&&i.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&i.unshift(t),n.message=e;break;case"object":Object.assign(n,e);break}typeof n.message=="function"&&(n.message=n.message());const s=typeof n.message;return dg(s==="string"||s==="object"),Object.assign(n,{args:i},n.opts)}function US(n,e,t){if(typeof e=="string"){const i=t.time?NS(IS(t.total)):"";e=t.time?`${n}: ${i}  ${e}`:`${n}: ${e}`,e=DS(e,t.color,t.background)}return e}function FS(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}const Td="4.3.3",zS=Td[0]>="0"&&Td[0]<="9"?`v${Td}`:"";function jS(){const n=new il({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=n,globalThis.loaders.version=zS,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=n,n}const VS=jS();function HS(n,e){return nb(n||{},e)}function nb(n,e,t=0){if(t>3)return e;const i={...n};for(const[s,o]of Object.entries(e))o&&typeof o=="object"&&!Array.isArray(o)?i[s]=nb(i[s]||{},e[s],t+1):i[s]=e[s];return i}const $S="latest";function WS(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.3"),globalThis._loadersgl_.version}const XS=WS();function as(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const Ns=typeof process!="object"||String(process)!=="[object process]"||process.browser,YS=typeof window<"u"&&typeof window.orientation<"u",$0=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);$0&&parseFloat($0[1]);class qS{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(e,t){this.name=e,this.workerThread=t,this.result=new Promise((i,s)=>{this._resolve=i,this._reject=s})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){as(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){as(this.isRunning),this.isRunning=!1,this._reject(e)}}class wd{terminate(){}}const Sd=new Map;function ZS(n){as(n.source&&!n.url||!n.source&&n.url);let e=Sd.get(n.source||n.url);return e||(n.url&&(e=KS(n.url),Sd.set(n.url,e)),n.source&&(e=ib(n.source),Sd.set(n.source,e))),as(e),e}function KS(n){if(!n.startsWith("http"))return n;const e=GS(n);return ib(e)}function ib(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function GS(n){return`try {
  importScripts('${n}');
} catch (error) {
  console.error(error);
  throw error;
}`}function sb(n,e=!0,t){const i=t||new Set;if(n){if(W0(n))i.add(n);else if(W0(n.buffer))i.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(e&&typeof n=="object")for(const s in n)sb(n[s],e,i)}}return t===void 0?Array.from(i):[]}function W0(n){return n?n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas:!1}const Ad=()=>{};class bp{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&Ns||typeof wd<"u"&&!Ns}constructor(e){const{name:t,source:i,url:s}=e;as(i||s),this.name=t,this.source=i,this.url=s,this.onMessage=Ad,this.onError=o=>console.log(o),this.worker=Ns?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Ad,this.onError=Ad,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||sb(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=ZS({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const i=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new wd(i,{eval:!1})}else if(this.source)e=new wd(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class QS{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return bp.isSupported()}constructor(e){this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(s,o,l)=>s.done(l),i=(s,o)=>s.error(o)){const s=new Promise(o=>(this.jobQueue.push({name:e,onMessage:t,onError:i,onStart:o}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const i=new qS(t.name,e);e.onMessage=s=>t.onMessage(i,s.type,s.payload),e.onError=s=>t.onError(i,s),t.onStart(i);try{await i.result}catch(s){console.error(`Worker exception: ${s}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!Ns||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new bp({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return YS?this.maxMobileConcurrency:this.maxConcurrency}}const JS={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Ji{props;workerPools=new Map;static _workerFarm;static isSupported(){return bp.isSupported()}static getWorkerFarm(e={}){return Ji._workerFarm=Ji._workerFarm||new Ji({}),Ji._workerFarm.setProps(e),Ji._workerFarm}constructor(e){this.props={...JS},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:i,url:s}=e;let o=this.workerPools.get(t);return o||(o=new QS({name:t,source:i,url:s}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}function e7(n,e={}){const t=e[n.id]||{},i=Ns?`${n.id}-worker.js`:`${n.id}-worker-node.js`;let s=t.workerUrl;if(!s&&n.id==="compression"&&(s=e.workerUrl),e._workerType==="test"&&(Ns?s=`modules/${n.module}/dist/${i}`:s=`modules/${n.module}/src/workers/${n.id}-worker-node.ts`),!s){let o=n.version;o==="latest"&&(o=$S);const l=o?`@${o}`:"";s=`https://unpkg.com/@loaders.gl/${n.module}${l}/dist/${i}`}return as(s),s}function t7(n,e=XS){as(n,"no worker provided");const t=n.version;return!(!e||!t)}function n7(n,e){return!Ji.isSupported()||!Ns&&!e?._nodeWorkers?!1:n.worker&&e?.worker}async function i7(n,e,t,i,s){const o=n.id,l=e7(n,t),f=Ji.getWorkerFarm(t).getWorkerPool({name:o,url:l});t=JSON.parse(JSON.stringify(t)),i=JSON.parse(JSON.stringify(i||{}));const d=await f.startJob("process-on-worker",s7.bind(null,s));return d.postMessage("process",{input:e,options:t,context:i}),await(await d.result).result}async function s7(n,e,t,i){switch(t){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:s,input:o,options:l}=i;try{const c=await n(o,l);e.postMessage("done",{id:s,result:c})}catch(c){const f=c instanceof Error?c.message:"unknown error";e.postMessage("error",{id:s,error:f})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function r7(n,e,t){if(t=t||n.byteLength,n.byteLength<t||e.byteLength<t)return!1;const i=new Uint8Array(n),s=new Uint8Array(e);for(let o=0;o<i.length;++o)if(i[o]!==s[o])return!1;return!0}function o7(...n){return a7(n)}function a7(n){const e=n.map(o=>o instanceof ArrayBuffer?new Uint8Array(o):o),t=e.reduce((o,l)=>o+l.byteLength,0),i=new Uint8Array(t);let s=0;for(const o of e)i.set(o,s),s+=o.byteLength;return i.buffer}async function l7(n){const e=[];for await(const t of n)e.push(t);return o7(...e)}function X0(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}class Y0{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=X0(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(X0()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class ju{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:i}=e;let s=this.stats[t];return s||(e instanceof Y0?s=e:s=new Y0(t,i),this.stats[t]=s),s}}let c7="";const q0={};function u7(n){for(const e in q0)if(n.startsWith(e)){const t=q0[e];n=n.replace(e,t)}return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${c7}${n}`),n}function f7(n){return n&&typeof n=="object"&&n.isBuffer}function rb(n){if(f7(n))return n;if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if(typeof n=="string"){const e=n;return new TextEncoder().encode(e).buffer}if(n&&typeof n=="object"&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function ob(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(e+1):""}function h7(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(0,e):""}const d7=n=>typeof n=="boolean",Da=n=>typeof n=="function",sl=n=>n!==null&&typeof n=="object",Z0=n=>sl(n)&&n.constructor==={}.constructor,p7=n=>!!n&&typeof n[Symbol.iterator]=="function",g7=n=>n&&typeof n[Symbol.asyncIterator]=="function",Xs=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,Ys=n=>typeof Blob<"u"&&n instanceof Blob,m7=n=>n&&typeof n=="object"&&n.isBuffer,_7=n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||sl(n)&&Da(n.tee)&&Da(n.cancel)&&Da(n.getReader),y7=n=>sl(n)&&Da(n.read)&&Da(n.pipe)&&d7(n.readable),ab=n=>_7(n)||y7(n);class b7 extends Error{constructor(e,t){super(e),this.reason=t.reason,this.url=t.url,this.response=t.response}reason;url;response}const v7=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,x7=/^([-\w.]+\/[-\w.+]+)/;function K0(n,e){return n.toLowerCase()===e.toLowerCase()}function T7(n){const e=x7.exec(n);return e?e[1]:n}function G0(n){const e=v7.exec(n);return e?e[1]:""}const lb=/\?.*/;function w7(n){const e=n.match(lb);return e&&e[0]}function pg(n){return n.replace(lb,"")}function S7(n){if(n.length<50)return n;const e=n.slice(n.length-15);return`${n.substr(0,32)}...${e}`}function Vu(n){return Xs(n)?n.url:Ys(n)?n.name||"":typeof n=="string"?n:""}function gg(n){if(Xs(n)){const e=n,t=e.headers.get("content-type")||"",i=pg(e.url);return T7(t)||G0(i)}return Ys(n)?n.type||"":typeof n=="string"?G0(n):""}function A7(n){return Xs(n)?n.headers["content-length"]||-1:Ys(n)?n.size:typeof n=="string"?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}async function cb(n){if(Xs(n))return n;const e={},t=A7(n);t>=0&&(e["content-length"]=String(t));const i=Vu(n),s=gg(n);s&&(e["content-type"]=s);const o=await R7(n);o&&(e["x-first-bytes"]=o),typeof n=="string"&&(n=new TextEncoder().encode(n));const l=new Response(n,{headers:e});return Object.defineProperty(l,"url",{value:i}),l}async function E7(n){if(!n.ok)throw await C7(n)}async function C7(n){const e=S7(n.url);let t=`Failed to fetch resource (${n.status}) ${n.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const i={reason:n.statusText,url:n.url,response:n};try{const s=n.headers.get("Content-Type");i.reason=!n.bodyUsed&&s?.includes("application/json")?await n.json():await n.text()}catch{}return new b7(t,i)}async function R7(n){if(typeof n=="string")return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return await new Promise(i=>{const s=new FileReader;s.onload=o=>i(o?.target?.result),s.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const t=n.slice(0,5);return`data:base64,${M7(t)}`}return null}function M7(n){let e="";const t=new Uint8Array(n);for(let i=0;i<t.byteLength;i++)e+=String.fromCharCode(t[i]);return btoa(e)}function P7(n){return!O7(n)&&!I7(n)}function O7(n){return n.startsWith("http:")||n.startsWith("https:")}function I7(n){return n.startsWith("data:")}async function Q0(n,e){if(typeof n=="string"){const t=u7(n);return P7(t)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(t,e):await fetch(t,e)}return await cb(n)}const J0=new il({id:"loaders.gl"});class N7{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class k7{console;constructor(){this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const ub={fetch:null,mimeType:void 0,nothrow:!1,log:new k7,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:hg,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},D7={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function fb(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state||(n._state={}),n._state}function hb(){const n=fb();return n.globalOptions=n.globalOptions||{...ub},n.globalOptions}function L7(n,e,t,i){return t=t||[],t=Array.isArray(t)?t:[t],B7(n,t),F7(e,n,i)}function B7(n,e){e_(n,null,ub,D7,e);for(const t of e){const i=n&&n[t.id]||{},s=t.options&&t.options[t.id]||{},o=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};e_(i,t.id,s,o,e)}}function e_(n,e,t,i,s){const o=e||"Top level",l=e?`${e}.`:"";for(const c in n){const f=!e&&sl(n[c]),d=c==="baseUri"&&!e,p=c==="workerUrl"&&e;if(!(c in t)&&!d&&!p){if(c in i)J0.warn(`${o} loader option '${l}${c}' no longer supported, use '${i[c]}'`)();else if(!f){const _=U7(c,s);J0.warn(`${o} loader option '${l}${c}' not recognized. ${_}`)()}}}}function U7(n,e){const t=n.toLowerCase();let i="";for(const s of e)for(const o in s.options){if(n===o)return`Did you mean '${s.id}.${o}'?`;const l=o.toLowerCase();(t.startsWith(l)||l.startsWith(t))&&(i=i||`Did you mean '${s.id}.${o}'?`)}return i}function F7(n,e,t){const s={...n.options||{}};return z7(s,t),s.log===null&&(s.log=new N7),t_(s,hb()),t_(s,e),s}function t_(n,e){for(const t in e)if(t in e){const i=e[t];Z0(i)&&Z0(n[t])?n[t]={...n[t],...e[t]}:n[t]=e[t]}}function z7(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}function mg(n){return n?(Array.isArray(n)&&(n=n[0]),Array.isArray(n?.extensions)):!1}function _g(n){pu(n,"null loader"),pu(mg(n),"invalid loader");let e;return Array.isArray(n)&&(e=n[1],n=n[0],n={...n,options:{...n.options,...e}}),(n?.parseTextSync||n?.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const db=()=>{const n=fb();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function j7(n){const e=db();n=Array.isArray(n)?n:[n];for(const t of n){const i=_g(t);e.find(s=>i===s)||e.unshift(i)}}function V7(){return db()}const H7=/\.([^.]+)$/;async function $7(n,e=[],t,i){if(!pb(n))return null;let s=n_(n,e,{...t,nothrow:!0},i);if(s)return s;if(Ys(n)&&(n=await n.slice(0,10).arrayBuffer(),s=n_(n,e,t,i)),!s&&!t?.nothrow)throw new Error(gb(n));return s}function n_(n,e=[],t,i){if(!pb(n))return null;if(e&&!Array.isArray(e))return _g(e);let s=[];e&&(s=s.concat(e)),t?.ignoreRegisteredLoaders||s.push(...V7()),X7(s);const o=W7(n,s,t,i);if(!o&&!t?.nothrow)throw new Error(gb(n));return o}function W7(n,e,t,i){const s=Vu(n),o=gg(n),l=pg(s)||i?.url;let c=null,f="";return t?.mimeType&&(c=Ed(e,t?.mimeType),f=`match forced by supplied MIME type ${t?.mimeType}`),c=c||Y7(e,l),f=f||(c?`matched url ${l}`:""),c=c||Ed(e,o),f=f||(c?`matched MIME type ${o}`:""),c=c||Z7(e,n),f=f||(c?`matched initial data ${mb(n)}`:""),t?.fallbackMimeType&&(c=c||Ed(e,t?.fallbackMimeType),f=f||(c?`matched fallback MIME type ${o}`:"")),f&&VS.log(1,`selectLoader selected ${c?.name}: ${f}.`),c}function pb(n){return!(n instanceof Response&&n.status===204)}function gb(n){const e=Vu(n),t=gg(n);let i="No valid loader found (";i+=e?`${ob(e)}, `:"no url provided, ",i+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const s=n?mb(n):"";return i+=s?` first bytes: "${s}"`:"first bytes: not available",i+=")",i}function X7(n){for(const e of n)_g(e)}function Y7(n,e){const t=e&&H7.exec(e),i=t&&t[1];return i?q7(n,i):null}function q7(n,e){e=e.toLowerCase();for(const t of n)for(const i of t.extensions)if(i.toLowerCase()===e)return t;return null}function Ed(n,e){for(const t of n)if(t.mimeTypes?.some(i=>K0(e,i))||K0(e,`application/x.${t.id}`))return t;return null}function Z7(n,e){if(!e)return null;for(const t of n)if(typeof e=="string"){if(K7(e,t))return t}else if(ArrayBuffer.isView(e)){if(i_(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&i_(e,0,t))return t;return null}function K7(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(i=>n.startsWith(i))}function i_(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(s=>G7(n,e,t,s))}function G7(n,e,t,i){if(i instanceof ArrayBuffer)return r7(i,n,i.byteLength);switch(typeof i){case"function":return i(n);case"string":const s=vp(n,e,i.length);return i===s;default:return!1}}function mb(n,e=5){return typeof n=="string"?n.slice(0,e):ArrayBuffer.isView(n)?vp(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?vp(n,0,e):""}function vp(n,e,t){if(n.byteLength<e+t)return"";const i=new DataView(n);let s="";for(let o=0;o<t;o++)s+=String.fromCharCode(i.getUint8(e+o));return s}const Q7=256*1024;function*J7(n,e){const t=e?.chunkSize||Q7;let i=0;const s=new TextEncoder;for(;i<n.length;){const o=Math.min(n.length-i,t),l=n.slice(i,i+o);i+=o,yield s.encode(l)}}const eA=256*1024;function*tA(n,e={}){const{chunkSize:t=eA}=e;let i=0;for(;i<n.byteLength;){const s=Math.min(n.byteLength-i,t),o=new ArrayBuffer(s),l=new Uint8Array(n,i,s);new Uint8Array(o).set(l),i+=s,yield o}}const nA=1024*1024;async function*iA(n,e){const t=e?.chunkSize||nA;let i=0;for(;i<n.size;){const s=i+t,o=await n.slice(i,s).arrayBuffer();i=s,yield o}}function s_(n,e){return hg?sA(n,e):rA(n)}async function*sA(n,e){const t=n.getReader();let i;try{for(;;){const s=i||t.read();e?._streamReadAhead&&(i=t.read());const{done:o,value:l}=await s;if(o)return;yield rb(l)}}catch{t.releaseLock()}}async function*rA(n,e){for await(const t of n)yield rb(t)}function oA(n,e){if(typeof n=="string")return J7(n,e);if(n instanceof ArrayBuffer)return tA(n,e);if(Ys(n))return iA(n,e);if(ab(n))return s_(n,e);if(Xs(n))return s_(n.body,e);throw new Error("makeIterator")}const _b="Cannot convert supplied data type";function aA(n,e,t){if(e.text&&typeof n=="string")return n;if(m7(n)&&(n=n.buffer),n instanceof ArrayBuffer){const i=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let i=n.buffer;const s=n.byteLength||n.length;return(n.byteOffset!==0||s!==i.byteLength)&&(i=i.slice(n.byteOffset,n.byteOffset+s)),i}throw new Error(_b)}async function lA(n,e,t){const i=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if(typeof n=="string"||i)return aA(n,e);if(Ys(n)&&(n=await cb(n)),Xs(n)){const s=n;return await E7(s),e.binary?await s.arrayBuffer():await s.text()}if(ab(n)&&(n=oA(n,t)),p7(n)||g7(n))return l7(n);throw new Error(_b)}function yb(n,e){const t=hb(),i=n||t;return typeof i.fetch=="function"?i.fetch:sl(i.fetch)?s=>Q0(s,i.fetch):e?.fetch?e?.fetch:Q0}function cA(n,e,t){if(t)return t;const i={fetch:yb(e,n),...n};if(i.url){const s=pg(i.url);i.baseUrl=s,i.queryString=w7(i.url),i.filename=ob(s),i.baseUrl=h7(s)}return Array.isArray(i.loaders)||(i.loaders=null),i}function uA(n,e){if(n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const i=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...i]:i}return t&&t.length?t:void 0}async function mu(n,e,t,i){e&&!Array.isArray(e)&&!mg(e)&&(i=void 0,t=e,e=void 0),n=await n,t=t||{};const s=Vu(n),l=uA(e,i),c=await $7(n,l,t);return c?(t=L7(t,c,l,s),i=cA({url:s,_parse:mu,loaders:l},t,i||null),await fA(c,n,t,i)):null}async function fA(n,e,t,i){if(t7(n),t=HS(n.options,t),Xs(e)){const o=e,{ok:l,redirected:c,status:f,statusText:d,type:p,url:_}=o,y=Object.fromEntries(o.headers.entries());i.response={headers:y,ok:l,redirected:c,status:f,statusText:d,type:p,url:_}}e=await lA(e,n,t);const s=n;if(s.parseTextSync&&typeof e=="string")return s.parseTextSync(e,t,i);if(n7(n,t))return await i7(n,e,t,i,mu);if(s.parseText&&typeof e=="string")return await s.parseText(e,t,i);if(s.parse)return await s.parse(e,t,i);throw as(!s.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)}async function _u(n,e,t,i){let s,o;!Array.isArray(e)&&!mg(e)?(s=[],o=e):(s=e,o=t);const l=yb(o);let c=n;return typeof n=="string"&&(c=await l(n)),Ys(n)&&(c=await l(n)),Array.isArray(s)?await mu(c,s,o):await mu(c,s,o)}const hA="4.3.3",dA=globalThis.loaders?.parseImageNode,xp=typeof Image<"u",Tp=typeof ImageBitmap<"u",pA=!!dA,wp=hg?!0:pA;function gA(n){switch(n){case"auto":return Tp||xp||wp;case"imagebitmap":return Tp;case"image":return xp;case"data":return wp;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}function mA(){if(Tp)return"imagebitmap";if(xp)return"image";if(wp)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function _A(n){const e=bA(n);if(!e)throw new Error("Not an image");return e}function yA(n){switch(_A(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}function bA(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&typeof n=="object"&&n.data&&n.width&&n.height?"data":null}const vA=/^data:image\/svg\+xml/,xA=/\.svg((\?|#).*)?$/;function yg(n){return n&&(vA.test(n)||xA.test(n))}function TA(n,e){if(yg(e)){let i=new TextDecoder().decode(n);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(o){throw new Error(o.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return bb(n,e)}function bb(n,e){if(yg(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}async function vb(n,e,t){const i=TA(n,t),s=self.URL||self.webkitURL,o=typeof i!="string"&&s.createObjectURL(i);try{return await wA(o||i,e)}finally{o&&s.revokeObjectURL(o)}}async function wA(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((i,s)=>{try{t.onload=()=>i(t),t.onerror=o=>{const l=o instanceof Error?o.message:"error";s(new Error(l))}}catch(o){s(o)}})}const SA={};let r_=!0;async function AA(n,e,t){let i;yg(t)?i=await vb(n,e,t):i=bb(n,t);const s=e&&e.imagebitmap;return await EA(i,s)}async function EA(n,e=null){if((CA(e)||!r_)&&(e=null),e)try{return await createImageBitmap(n,e)}catch(t){console.warn(t),r_=!1}return await createImageBitmap(n)}function CA(n){for(const e in n||SA)return!1;return!0}function RA(n){return!IA(n,"ftyp",4)||(n[8]&96)===0?null:MA(n)}function MA(n){switch(PA(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function PA(n,e,t){return String.fromCharCode(...n.slice(e,t))}function OA(n){return[...n].map(e=>e.charCodeAt(0))}function IA(n,e,t=0){const i=OA(e);for(let s=0;s<i.length;++s)if(i[s]!==n[s+t])return!1;return!0}const Xn=!1,La=!0;function xb(n){const e=rl(n);return kA(e)||BA(e)||DA(e)||LA(e)||NA(e)}function NA(n){const e=new Uint8Array(n instanceof DataView?n.buffer:n),t=RA(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function kA(n){const e=rl(n);return e.byteLength>=24&&e.getUint32(0,Xn)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Xn),height:e.getUint32(20,Xn)}:null}function DA(n){const e=rl(n);return e.byteLength>=10&&e.getUint32(0,Xn)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,La),height:e.getUint16(8,La)}:null}function LA(n){const e=rl(n);return e.byteLength>=14&&e.getUint16(0,Xn)===16973&&e.getUint32(2,La)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,La),height:e.getUint32(22,La)}:null}function BA(n){const e=rl(n);if(!(e.byteLength>=3&&e.getUint16(0,Xn)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:i,sofMarkers:s}=UA();let o=2;for(;o+9<e.byteLength;){const l=e.getUint16(o,Xn);if(s.has(l))return{mimeType:"image/jpeg",height:e.getUint16(o+5,Xn),width:e.getUint16(o+7,Xn)};if(!i.has(l))return null;o+=2,o+=e.getUint16(o,Xn)}return null}function UA(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function rl(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}async function FA(n,e){const{mimeType:t}=xb(n)||{},i=globalThis.loaders?.parseImageNode;return pu(i),await i(n,t)}async function zA(n,e,t){e=e||{};const s=(e.image||{}).type||"auto",{url:o}=t||{},l=jA(s);let c;switch(l){case"imagebitmap":c=await AA(n,e,o);break;case"image":c=await vb(n,e,o);break;case"data":c=await FA(n);break;default:pu(!1)}return s==="data"&&(c=yA(c)),c}function jA(n){switch(n){case"auto":case"data":return mA();default:return gA(n),n}}const VA=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],HA=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],$A={image:{type:"auto",decode:!0}},WA={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:hA,mimeTypes:HA,extensions:VA,parse:zA,tests:[n=>!!xb(new DataView(n))],options:$A},ke=new il({id:"deck"});let Sp={};function XA(n){Sp=n}function Ft(n,e,t,i){ke.level>0&&Sp[n]&&Sp[n].call(null,e,t,i)}function YA(n){const e=n[0],t=n[n.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const qA={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:YA,parseTextSync:JSON.parse};function ZA(){const n="9.2.7",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==n)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${n}`);return e||(ke.log(1,`deck.gl ${n}`)(),globalThis.deck={...globalThis.deck,VERSION:n,version:n,log:ke,_registerLoggers:XA},j7([qA,[WA,{imagebitmap:{premultiplyAlpha:"none"}}]])),n}const KA=ZA();function bg(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const Cd={number:{type:"number",validate(n,e){return Number.isFinite(n)&&typeof e=="object"&&(e.max===void 0||n<=e.max)&&(e.min===void 0||n>=e.min)}},array:{type:"array",validate(n,e){return Array.isArray(n)||ArrayBuffer.isView(n)}}};function GA(n){const e={};for(const[t,i]of Object.entries(n))e[t]=QA(i);return e}function QA(n){let e=o_(n);if(e!=="object")return{value:n,...Cd[e],type:e};if(typeof n=="object")return n?n.type!==void 0?{...n,...Cd[n.type],type:n.type}:n.value===void 0?{type:"object",value:n}:(e=o_(n.value),{...n,...Cd[e],type:e}):{type:"object",value:null};throw new Error("props")}function o_(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}const JA=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,eE=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,tE={vertex:JA,fragment:eE},a_=/void\s+main\s*\([^)]*\)\s*\{\n?/,l_=/}\n?[^{}]*$/,Rd=[],Jc="__LUMA_INJECT_DECLARATIONS__";function nE(n){const e={vertex:{},fragment:{}};for(const t in n){let i=n[t];const s=iE(t);typeof i=="string"&&(i={order:0,injection:i}),e[s][t]=i}return e}function iE(n){const e=n.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function yu(n,e,t,i=!1){const s=e==="vertex";for(const o in t){const l=t[o];l.sort((f,d)=>f.order-d.order),Rd.length=l.length;for(let f=0,d=l.length;f<d;++f)Rd[f]=l[f].injection;const c=`${Rd.join(`
`)}
`;switch(o){case"vs:#decl":s&&(n=n.replace(Jc,c));break;case"vs:#main-start":s&&(n=n.replace(a_,f=>f+c));break;case"vs:#main-end":s&&(n=n.replace(l_,f=>c+f));break;case"fs:#decl":s||(n=n.replace(Jc,c));break;case"fs:#main-start":s||(n=n.replace(a_,f=>f+c));break;case"fs:#main-end":s||(n=n.replace(l_,f=>c+f));break;default:n=n.replace(o,f=>f+c)}}return n=n.replace(Jc,""),i&&(n=n.replace(/\}\s*$/,o=>o+tE[e])),n}function bu(n){n.map(e=>sE(e))}function sE(n){if(n.instance)return;bu(n.dependencies||[]);const{propTypes:e={},deprecations:t=[],inject:i={}}=n,s={normalizedInjections:nE(i),parsedDeprecations:rE(t)};e&&(s.propValidators=GA(e)),n.instance=s;let o={};e&&(o=Object.entries(e).reduce((l,[c,f])=>{const d=f?.value;return d&&(l[c]=d),l},{})),n.defaultUniforms={...n.defaultUniforms,...o}}function Tb(n,e,t){n.deprecations?.forEach(i=>{i.regex?.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}function rE(n){return n.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),n}function vg(n){bu(n);const e={},t={};wb({modules:n,level:0,moduleMap:e,moduleDepth:t});const i=Object.keys(t).sort((s,o)=>t[o]-t[s]).map(s=>e[s]);return bu(i),i}function wb(n){const{modules:e,level:t,moduleMap:i,moduleDepth:s}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)i[o.name]=o,(s[o.name]===void 0||s[o.name]<t)&&(s[o.name]=t);for(const o of e)o.dependencies&&wb({modules:o.dependencies,level:t+1,moduleMap:i,moduleDepth:s})}function oE(n){switch(n?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function aE(n,e){if(Number(n.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return n=c_(n,lE),n;case"fragment":return n=c_(n,cE),n;default:throw new Error(e)}}const Sb=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],lE=[...Sb,[Ap("attribute"),"in $1"],[Ap("varying"),"out $1"]],cE=[...Sb,[Ap("varying"),"in $1"]];function c_(n,e){for(const[t,i]of e)n=n.replace(t,i);return n}function Ap(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function Ab(n,e){let t="";for(const i in n){const s=n[i];if(t+=`void ${s.signature} {
`,s.header&&(t+=`  ${s.header}`),e[i]){const o=e[i];o.sort((l,c)=>l.order-c.order);for(const l of o)t+=`  ${l.injection}
`}s.footer&&(t+=`  ${s.footer}`),t+=`}
`}return t}function Eb(n){const e={vertex:{},fragment:{}};for(const t of n){let i,s;typeof t!="string"?(i=t,s=i.hook):(i={},s=t),s=s.trim();const[o,l]=s.split(":"),c=s.replace(/\(.+/,""),f=Object.assign(i,{signature:l});switch(o){case"vs":e.vertex[c]=f;break;case"fs":e.fragment[c]=f;break;default:throw new Error(o)}}return e}function uE(n,e){return{name:fE(n,e),language:"glsl",version:hE(n)}}function fE(n,e="unnamed"){const i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(n);return i?i[1]:e}function hE(n){let e=100;const t=n.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const i=parseInt(t[1],10);Number.isFinite(i)&&(e=i)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const Cb=`

${Jc}
`,dE=`precision highp float;
`;function pE(n){const e=vg(n.modules||[]);return{source:mE(n.platformInfo,{...n,source:n.source,stage:"vertex",modules:e}),getUniforms:Rb(e)}}function gE(n){const{vs:e,fs:t}=n,i=vg(n.modules||[]);return{vs:u_(n.platformInfo,{...n,source:e,stage:"vertex",modules:i}),fs:u_(n.platformInfo,{...n,source:t,stage:"fragment",modules:i}),getUniforms:Rb(i)}}function mE(n,e){const{source:t,stage:i,modules:s,hookFunctions:o=[],inject:l={},log:c}=e;bg(typeof t=="string","shader source must be a string");const f=t;let d="";const p=Eb(o),_={},y={},v={};for(const S in l){const M=typeof l[S]=="string"?{injection:l[S],order:0}:l[S],C=/^(v|f)s:(#)?([\w-]+)$/.exec(S);if(C){const U=C[2],R=C[3];U?R==="decl"?y[S]=[M]:v[S]=[M]:_[S]=[M]}else v[S]=[M]}const x=s;for(const S of x){c&&Tb(S,f,c);const M=Mb(S,"wgsl");d+=M;const C=S.injections?.[i]||{};for(const U in C){const R=/^(v|f)s:#([\w-]+)$/.exec(U);if(R){const B=R[2]==="decl"?y:v;B[U]=B[U]||[],B[U].push(C[U])}else _[U]=_[U]||[],_[U].push(C[U])}}return d+=Cb,d=yu(d,i,y),d+=Ab(p[i],_),d+=f,d=yu(d,i,v),d}function u_(n,e){const{source:t,stage:i,language:s="glsl",modules:o,defines:l={},hookFunctions:c=[],inject:f={},prologue:d=!0,log:p}=e;bg(typeof t=="string","shader source must be a string");const _=s==="glsl"?uE(t).version:-1,y=n.shaderLanguageVersion,v=_===100?"#version 100":"#version 300 es",S=t.split(`
`).slice(1).join(`
`),M={};o.forEach(Q=>{Object.assign(M,Q.defines)}),Object.assign(M,l);let C="";switch(s){case"wgsl":break;case"glsl":C=d?`${v}

// ----- PROLOGUE -------------------------
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${oE(n)}
${i==="fragment"?dE:""}

// ----- APPLICATION DEFINES -------------------------

${_E(M)}

`:`${v}
`;break}const U=Eb(c),R={},D={},B={};for(const Q in f){const ce=typeof f[Q]=="string"?{injection:f[Q],order:0}:f[Q],Z=/^(v|f)s:(#)?([\w-]+)$/.exec(Q);if(Z){const ee=Z[2],he=Z[3];ee?he==="decl"?D[Q]=[ce]:B[Q]=[ce]:R[Q]=[ce]}else B[Q]=[ce]}for(const Q of o){p&&Tb(Q,S,p);const ce=Mb(Q,i);C+=ce;const Z=Q.instance?.normalizedInjections[i]||{};for(const ee in Z){const he=/^(v|f)s:#([\w-]+)$/.exec(ee);if(he){const _e=he[2]==="decl"?D:B;_e[ee]=_e[ee]||[],_e[ee].push(Z[ee])}else R[ee]=R[ee]||[],R[ee].push(Z[ee])}}return C+="// ----- MAIN SHADER SOURCE -------------------------",C+=Cb,C=yu(C,i,D),C+=Ab(U[i],R),C+=S,C=yu(C,i,B),s==="glsl"&&_!==y&&(C=aE(C,i)),C.trim()}function Rb(n){return function(t){const i={};for(const s of n){const o=s.getUniforms?.(t,i);Object.assign(i,o)}return i}}function _E(n={}){let e="";for(const t in n){const i=n[t];(i||Number.isFinite(i))&&(e+=`#define ${t.toUpperCase()} ${n[t]}
`)}return e}function Mb(n,e){let t;switch(e){case"vertex":t=n.vs||"";break;case"fragment":t=n.fs||"";break;case"wgsl":t=n.source||"";break;default:bg(!1)}if(!n.name)throw new Error("Shader module must have a name");const i=n.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let s=`// ----- MODULE ${n.name} ---------------

`;return e!=="wgsl"&&(s+=`#define MODULE_${i}
`),s+=`${t}
`,s}const yE=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,bE=/^\s*\#\s*endif\s*$/;function vE(n,e){const t=n.split(`
`),i=[];let s=!0,o=null;for(const l of t){const c=l.match(yE),f=l.match(bE);c?(o=c[1],s=!!e?.defines?.[o]):f?s=!0:s&&i.push(l)}return i.join(`
`)}class Ps{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return Ps.defaultShaderAssembler=Ps.defaultShaderAssembler||new Ps,Ps.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),i=this._hookFunctions,{source:s,getUniforms:o}=pE({...e,source:e.source,modules:t,hookFunctions:i});return{source:e.platformInfo.shaderLanguage==="wgsl"?vE(s):s,getUniforms:o,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),i=this._hookFunctions;return{...gE({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:i}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),i={};let s=0;for(let o=0,l=this._defaultModules.length;o<l;++o){const c=this._defaultModules[o],f=c.name;t[s++]=c,i[f]=!0}for(let o=0,l=e.length;o<l;++o){const c=e[o],f=c.name;i[f]||(t[s++]=c,i[f]=!0)}return t.length=s,bu(t),t}}const xE=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,TE=`#version 300 es
${xE}`;function wE(n){const{input:e,inputChannels:t,output:i}={};if(!e)return TE;if(!t)throw new Error("inputChannels");const s=SE(t),o=AE(e,t);return`#version 300 es
in ${s} ${e};
out vec4 ${i};
void main() {
  ${i} = ${o};
}`}function SE(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${n}`)}}function AE(n,e){switch(e){case 1:return`vec4(${n}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${n}, 0.0, 1.0)`;case 3:return`vec4(${n}, 1.0)`;case 4:return n;default:throw new Error(`invalid channels: ${e}`)}}class EE{stats=new Map;getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new ju({id:e})),this.stats.get(e)}}const Pb=new EE,le=new il({id:"luma.gl"}),Md={};function Hu(n="id"){Md[n]=Md[n]||1;const e=Md[n]++;return`${n}-${e}`}let Je=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(e,t,i){if(!e)throw new Error("no device");this._device=e,this.props=CE(t,i);const s=this.props.id!=="undefined"?this.props.id:Hu(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(e),i.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}};function CE(n,e){const t={...e};for(const i in n)n[i]!==void 0&&(t[i]=n[i]);return t}class tt extends Je{static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(e,t){const i={...t};(t.usage||0)&tt.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?i.indexType="uint32":t.data instanceof Uint16Array?i.indexType="uint16":t.data instanceof Uint8Array&&(i.indexType="uint8")),delete i.data,super(e,i,tt.defaultProps),this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=e.incrementTimestamp()}clone(e){return this.device.createBuffer({...this.props,...e})}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(e,t,i){const s=ArrayBuffer.isView(e)?e.buffer:e,o=Math.min(e?e.byteLength:i,tt.DEBUG_DATA_MAX_LENGTH);s===null?this.debugData=new ArrayBuffer(o):t===0&&i===s.byteLength?this.debugData=s.slice(0,o):this.debugData=s.slice(t,t+o)}static defaultProps={...Je.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",onMapped:void 0}}function Ob(n){const[e,t,i]=wg[n],s=n.includes("norm"),o=!s&&!n.startsWith("float"),l=n.startsWith("s");return{signedType:e,primitiveType:t,byteLength:i,normalized:s,integer:o,signed:l}}function RE(n){const e=n;switch(e){case"uint8":return"unorm8";case"sint8":return"snorm8";case"uint16":return"unorm16";case"sint16":return"snorm16";default:return e}}function ME(n,e){switch(e){case 1:return n;case 2:return n+n%2;default:return n+(4-n%4)%4}}function xg(n){const e=ArrayBuffer.isView(n)?n.constructor:n;if(e===Uint8ClampedArray)return"uint8";const t=Object.values(wg).find(i=>e===i[4]);if(!t)throw new Error(e.name);return t[0]}function Tg(n){const[,,,,e]=wg[n];return e}const wg={uint8:["uint8","u32",1,!1,Uint8Array],sint8:["sint8","i32",1,!1,Int8Array],unorm8:["uint8","f32",1,!0,Uint8Array],snorm8:["sint8","f32",1,!0,Int8Array],uint16:["uint16","u32",2,!1,Uint16Array],sint16:["sint16","i32",2,!1,Int16Array],unorm16:["uint16","u32",2,!0,Uint16Array],snorm16:["sint16","i32",2,!0,Int16Array],float16:["float16","f16",2,!1,Uint16Array],float32:["float32","f32",4,!1,Float32Array],uint32:["uint32","u32",4,!1,Uint32Array],sint32:["sint32","i32",4,!1,Int32Array]};function Sg(n){let e;n.endsWith("-webgl")&&(n.replace("-webgl",""),e=!0);const[t,i]=n.split("x"),s=t,o=i?parseInt(i):1,l=Ob(s),c={type:s,components:o,byteLength:l.byteLength*o,integer:l.integer,signed:l.signed,normalized:l.normalized};return e&&(c.webglOnly=!0),c}function PE(n,e,t){const i=t?RE(n):n;switch(i){case"unorm8":return e===1?"unorm8":e===3?"unorm8x3-webgl":`${i}x${e}`;case"snorm8":case"uint8":case"sint8":case"uint16":case"sint16":case"unorm16":case"snorm16":case"float16":if(e===1||e===3)throw new Error(`size: ${e}`);return`${i}x${e}`;default:return e===1?i:`${i}x${e}`}}function OE(n,e,t){if(!e||e>4)throw new Error(`size ${e}`);const i=e,s=xg(n);return PE(s,i,t)}function IE(n){let e;switch(n.primitiveType){case"f32":e="float32";break;case"i32":e="sint32";break;case"u32":e="uint32";break;case"f16":return n.components<=2?"float16x2":"float16x4"}return n.components===1?e:`${e}x${n.components}`}const Lt="texture-compression-bc",Qe="texture-compression-astc",Hn="texture-compression-etc2",NE="texture-compression-etc1-webgl",Cc="texture-compression-pvrtc-webgl",Pd="texture-compression-atc-webgl",Rc="float32-renderable-webgl",Od="float16-renderable-webgl",kE="rgb9e5ufloat-renderable-webgl",Id="snorm8-renderable-webgl",Ta="norm16-renderable-webgl",Nd="snorm16-renderable-webgl",Mc="float32-filterable",f_="float16-filterable-webgl";function Ib(n){const e=BE[n];if(!e)throw new Error(`Unsupported texture format ${n}`);return e}const DE={r8unorm:{},rg8unorm:{},"rgb8unorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},r8snorm:{render:Id},rg8snorm:{render:Id},"rgb8snorm-webgl":{},rgba8snorm:{render:Id},r8uint:{},rg8uint:{},rgba8uint:{},r8sint:{},rg8sint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},r16unorm:{f:Ta},rg16unorm:{render:Ta},"rgb16unorm-webgl":{f:Ta},rgba16unorm:{render:Ta},r16snorm:{f:Nd},rg16snorm:{render:Nd},"rgb16snorm-webgl":{f:Ta},rgba16snorm:{render:Nd},r16uint:{},rg16uint:{},rgba16uint:{},r16sint:{},rg16sint:{},rgba16sint:{},r16float:{render:Od,filter:"float16-filterable-webgl"},rg16float:{render:Od,filter:f_},rgba16float:{render:Od,filter:f_},r32uint:{},rg32uint:{},rgba32uint:{},r32sint:{},rg32sint:{},rgba32sint:{},r32float:{render:Rc,filter:Mc},rg32float:{render:!1,filter:Mc},"rgb32float-webgl":{render:Rc,filter:Mc},rgba32float:{render:Rc,filter:Mc},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},rgb9e5ufloat:{channels:"rgb",packed:!0,render:kE},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:Rc},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},rgb10a2uint:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0}},LE={"bc1-rgb-unorm-webgl":{f:Lt},"bc1-rgb-unorm-srgb-webgl":{f:Lt},"bc1-rgba-unorm":{f:Lt},"bc1-rgba-unorm-srgb":{f:Lt},"bc2-rgba-unorm":{f:Lt},"bc2-rgba-unorm-srgb":{f:Lt},"bc3-rgba-unorm":{f:Lt},"bc3-rgba-unorm-srgb":{f:Lt},"bc4-r-unorm":{f:Lt},"bc4-r-snorm":{f:Lt},"bc5-rg-unorm":{f:Lt},"bc5-rg-snorm":{f:Lt},"bc6h-rgb-ufloat":{f:Lt},"bc6h-rgb-float":{f:Lt},"bc7-rgba-unorm":{f:Lt},"bc7-rgba-unorm-srgb":{f:Lt},"etc2-rgb8unorm":{f:Hn},"etc2-rgb8unorm-srgb":{f:Hn},"etc2-rgb8a1unorm":{f:Hn},"etc2-rgb8a1unorm-srgb":{f:Hn},"etc2-rgba8unorm":{f:Hn},"etc2-rgba8unorm-srgb":{f:Hn},"eac-r11unorm":{f:Hn},"eac-r11snorm":{f:Hn},"eac-rg11unorm":{f:Hn},"eac-rg11snorm":{f:Hn},"astc-4x4-unorm":{f:Qe},"astc-4x4-unorm-srgb":{f:Qe},"astc-5x4-unorm":{f:Qe},"astc-5x4-unorm-srgb":{f:Qe},"astc-5x5-unorm":{f:Qe},"astc-5x5-unorm-srgb":{f:Qe},"astc-6x5-unorm":{f:Qe},"astc-6x5-unorm-srgb":{f:Qe},"astc-6x6-unorm":{f:Qe},"astc-6x6-unorm-srgb":{f:Qe},"astc-8x5-unorm":{f:Qe},"astc-8x5-unorm-srgb":{f:Qe},"astc-8x6-unorm":{f:Qe},"astc-8x6-unorm-srgb":{f:Qe},"astc-8x8-unorm":{f:Qe},"astc-8x8-unorm-srgb":{f:Qe},"astc-10x5-unorm":{f:Qe},"astc-10x5-unorm-srgb":{f:Qe},"astc-10x6-unorm":{f:Qe},"astc-10x6-unorm-srgb":{f:Qe},"astc-10x8-unorm":{f:Qe},"astc-10x8-unorm-srgb":{f:Qe},"astc-10x10-unorm":{f:Qe},"astc-10x10-unorm-srgb":{f:Qe},"astc-12x10-unorm":{f:Qe},"astc-12x10-unorm-srgb":{f:Qe},"astc-12x12-unorm":{f:Qe},"astc-12x12-unorm-srgb":{f:Qe},"pvrtc-rgb4unorm-webgl":{f:Cc},"pvrtc-rgba4unorm-webgl":{f:Cc},"pvrtc-rbg2unorm-webgl":{f:Cc},"pvrtc-rgba2unorm-webgl":{f:Cc},"etc1-rbg-unorm-webgl":{f:NE},"atc-rgb-unorm-webgl":{f:Pd},"atc-rgba-unorm-webgl":{f:Pd},"atc-rgbai-unorm-webgl":{f:Pd}},BE={...DE,...LE},UE=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],FE=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;class zE{getInfo(e){return h_(e)}isColor(e){return e.startsWith("rgba")||e.startsWith("bgra")||e.startsWith("rgb")}isDepthStencil(e){return e.startsWith("depth")||e.startsWith("stencil")}isCompressed(e){return UE.some(t=>e.startsWith(t))}getCapabilities(e){const t=Ib(e),i={format:e,create:t.f??!0,render:t.render??!0,filter:t.filter??!0,blend:t.blend??!0,store:t.store??!0},s=h_(e),o=e.startsWith("depth")||e.startsWith("stencil"),l=s?.signed,c=s?.integer,f=s?.webgl;return i.render&&=!l,i.filter&&=!o&&!l&&!c&&!f,i}}const Kr=new zE;function h_(n){let e=jE(n);if(Kr.isCompressed(n)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const i=VE(n);i&&(e.blockWidth=i.blockWidth,e.blockHeight=i.blockHeight)}const t=FE.exec(n);if(t){const[,i,s,o,l,c]=t,f=`${o}${s}`,d=Ob(f),p=d.byteLength*8,_=i.length,y=[p,_>=2?p:0,_>=3?p:0,_>=4?p:0];e={format:n,attachment:e.attachment,dataType:d.signedType,components:_,channels:i,integer:d.integer,signed:d.signed,normalized:d.normalized,bitsPerChannel:y,bytesPerPixel:d.byteLength*i.length,packed:e.packed,srgb:e.srgb},c==="-webgl"&&(e.webgl=!0),l==="-srgb"&&(e.srgb=!0)}return n.endsWith("-webgl")&&(e.webgl=!0),n.endsWith("-srgb")&&(e.srgb=!0),e}function jE(n){const e=Ib(n),t=e.bytesPerPixel||1,i=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:n,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||e.channels?.length||1,bytesPerPixel:t,bitsPerChannel:i,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function VE(n){const t=/.*-(\d+)x(\d+)-.*/.exec(n);if(t){const[,i,s]=t;return{blockWidth:Number(i),blockHeight:Number(s)}}return null}function HE(n){return typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement||typeof VideoFrame<"u"&&n instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas}function $E(n){if(typeof ImageData<"u"&&n instanceof ImageData||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height};if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)return{width:n.naturalWidth,height:n.naturalHeight};if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)return{width:n.videoWidth,height:n.videoHeight};if(typeof VideoFrame<"u"&&n instanceof VideoFrame)return{width:n.displayWidth,height:n.displayHeight};throw new Error("Unknown image type")}class WE{}class XE{features;disabledFeatures;constructor(e=[],t){this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){return!this.disabledFeatures?.[e]&&this.features.has(e)}}class Us{static defaultProps={id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,webgl:{},onError:(e,t)=>{},onResize:(e,t)=>{const[i,s]=e.getDevicePixelSize();le.log(1,`${e} resized => ${i}x${s}px`)()},onPositionChange:(e,t)=>{const[i,s]=e.getPosition();le.log(1,`${e} repositioned => ${i},${s}`)()},onVisibilityChange:e=>le.log(1,`${e} Visibility changed ${e.isVisible}`)(),onDevicePixelRatioChange:(e,t)=>le.log(1,`${e} DPR changed ${t.oldRatio} => ${e.devicePixelRatio}`)(),debug:le.get("debug")||void 0,debugShaders:le.get("debug-shaders")||void 0,debugFramebuffers:!!le.get("debug-framebuffers"),debugFactories:!!le.get("debug-factories"),debugWebGL:!!le.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_reuseDevices:!1,_requestMaxLimits:!0,_cacheShaders:!1,_cachePipelines:!1,_cacheDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_handle:void 0};get[Symbol.toStringTag](){return"Device"}toString(){return`Device(${this.id})`}id;props;userData={};statsManager=Pb;timestamp=0;_reused=!1;_lumaData={};_textureCaps={};constructor(e){this.props={...Us.defaultProps,...e},this.id=this.props.id||Hu(this[Symbol.toStringTag].toLowerCase())}getVertexFormatInfo(e){return Sg(e)}isVertexFormatSupported(e){return!0}getTextureFormatInfo(e){return Kr.getInfo(e)}getTextureFormatCapabilities(e){let t=this._textureCaps[e];if(!t){const i=this._getDeviceTextureFormatCapabilities(e);t=this._getDeviceSpecificTextureFormatCapabilities(i),this._textureCaps[e]=t}return t}getMipLevelCount(e,t,i=1){const s=Math.max(e,t,i);return 1+Math.floor(Math.log2(s))}isExternalImage(e){return HE(e)}getExternalImageSize(e){return $E(e)}isTextureFormatSupported(e){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return Kr.isCompressed(e)}pushDebugGroup(e){this.commandEncoder.pushDebugGroup(e)}popDebugGroup(){this.commandEncoder?.popDebugGroup()}insertDebugMarker(e){this.commandEncoder?.insertDebugMarker(e)}loseDevice(){return!1}incrementTimestamp(){return this.timestamp++}reportError(e,t,...i){return this.props.onError(e,t)?()=>{}:le.error(e.message,t,...i)}debug(){if(this.props.debug)debugger;else le.once(0,`'Type luma.log.set({debug: true}) in console to enable debug breakpoints',
or create a device with the 'debug: true' prop.`)()}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}beginRenderPass(e){return this.commandEncoder.beginRenderPass(e)}beginComputePass(e){return this.commandEncoder.beginComputePass(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_getDeviceTextureFormatCapabilities(e){const t=Kr.getCapabilities(e),i=o=>(typeof o=="string"?this.features.has(o):o)??!0,s=i(t.create);return{format:e,create:s,render:s&&i(t.render),filter:s&&i(t.filter),blend:s&&i(t.blend),store:s&&i(t.store)}}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};if((e.usage||0)&tt.INDEX&&(e.indexType||(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":e.data instanceof Uint8Array&&(t.data=new Uint16Array(e.data),t.indexType="uint16")),!t.indexType))throw new Error("indices buffer content must be of type uint16 or uint32");return t}}const YE="set luma.log.level=1 (or higher) to trace rendering",d_="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class vu{static defaultProps={...Us.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=Pb;log=le;VERSION="9.2.6";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw le.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),le.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");le.error("This version of luma.gl has already been initialized")()}le.log(1,`${this.VERSION} - ${YE}`)(),globalThis.luma=this}async createDevice(e={}){const t={...vu.defaultProps,...e},i=this.selectAdapter(t.type,t.adapters);if(!i)throw new Error(d_);return t.waitForPageLoad&&await i.pageLoaded,await i.create(t)}async attachDevice(e,t){const i=this._getTypeFromHandle(e,t.adapters),s=i&&this.selectAdapter(i,t.adapters);if(!s)throw new Error(d_);return await s?.attach?.(e,t)}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,i])=>i).filter(i=>i.isSupported?.()).map(i=>i.type)}getBestAvailableAdapterType(e=[]){const t=["webgpu","webgl","null"],i=this._getAdapterMap(e);for(const s of t)if(i.get(s)?.isSupported?.())return s;return null}selectAdapter(e,t=[]){let i=e;e==="best-available"&&(i=this.getBestAvailableAdapterType(t));const s=this._getAdapterMap(t);return i&&s.get(i)||null}enforceWebGL2(e=!0,t=[]){const s=this._getAdapterMap(t).get("webgl");s||le.warn("enforceWebGL2: webgl adapter not found")(),s?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(vu.defaultProps,e)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const i of e)t.set(i.type,i);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?le.warn("WebGL1 is not supported",e)():le.warn("Unknown handle type",e)(),null)}}const Ep=new vu;class qE{get pageLoaded(){return GE()}}const ZE=Ws()&&typeof document<"u",KE=()=>ZE&&document.readyState==="complete";let Pc=null;function GE(){return Pc||(KE()||typeof window>"u"?Pc=Promise.resolve():Pc=new Promise(n=>window.addEventListener("load",()=>n()))),Pc}function QE(){let n,e;return{promise:new Promise((i,s)=>{n=i,e=s}),resolve:n,reject:e}}class Os{static isHTMLCanvas(e){return typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement}static isOffscreenCanvas(e){return typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas}static defaultProps={id:void 0,canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb",trackPosition:!1};id;props;canvas;htmlCanvas;offscreenCanvas;type;initialized;isInitialized=!1;isVisible=!0;cssWidth;cssHeight;devicePixelRatio;devicePixelWidth;devicePixelHeight;drawingBufferWidth;drawingBufferHeight;_initializedResolvers=QE();_resizeObserver;_intersectionObserver;_position;destroyed=!1;toString(){return`${this[Symbol.toStringTag]}(${this.id})`}constructor(e){if(this.props={...Os.defaultProps,...e},e=this.props,this.initialized=this._initializedResolvers.promise,Ws()?e.canvas?typeof e.canvas=="string"?this.canvas=eC(e.canvas):this.canvas=e.canvas:this.canvas=tC(e):this.canvas={width:e.width||1,height:e.height||1},Os.isHTMLCanvas(this.canvas)?(this.id=e.id||this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):Os.isOffscreenCanvas(this.canvas)?(this.id=e.id||"offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas):(this.id=e.id||"node-canvas-context",this.type="node"),this.cssWidth=this.htmlCanvas?.clientWidth||this.canvas.width,this.cssHeight=this.htmlCanvas?.clientHeight||this.canvas.height,this.devicePixelWidth=this.canvas.width,this.devicePixelHeight=this.canvas.height,this.drawingBufferWidth=this.canvas.width,this.drawingBufferHeight=this.canvas.height,this.devicePixelRatio=globalThis.devicePixelRatio||1,this._position=[0,0],Os.isHTMLCanvas(this.canvas)){this._intersectionObserver=new IntersectionObserver(t=>this._handleIntersection(t)),this._intersectionObserver.observe(this.canvas),this._resizeObserver=new ResizeObserver(t=>this._handleResize(t));try{this._resizeObserver.observe(this.canvas,{box:"device-pixel-content-box"})}catch{this._resizeObserver.observe(this.canvas,{box:"content-box"})}setTimeout(()=>this._observeDevicePixelRatio(),0),this.props.trackPosition&&this._trackPosition()}}destroy(){this.destroyed=!0}setProps(e){return"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1,this._updateDrawingBufferSize()),this}getCSSSize(){return[this.cssWidth,this.cssHeight]}getPosition(){return this._position}getDevicePixelSize(){return[this.devicePixelWidth,this.devicePixelHeight]}getDrawingBufferSize(){return[this.drawingBufferWidth,this.drawingBufferHeight]}getMaxDrawingBufferSize(){const e=this.device.limits.maxTextureDimension2D;return[e,e]}setDrawingBufferSize(e,t){this.canvas.width=e,this.canvas.height=t,this.drawingBufferWidth=e,this.drawingBufferHeight=t}getDevicePixelRatio(){return typeof window<"u"&&window.devicePixelRatio||1}cssToDevicePixels(e,t=!0){const i=this.cssToDeviceRatio(),[s,o]=this.getDrawingBufferSize();return nC(e,i,s,o,t)}getPixelSize(){return this.getDevicePixelSize()}getAspect(){const[e,t]=this.getDevicePixelSize();return e/t}cssToDeviceRatio(){try{const[e]=this.getDrawingBufferSize(),[t]=this.getCSSSize();return t?e/t:1}catch{return 1}}resize(e){this.setDrawingBufferSize(e.width,e.height)}_setAutoCreatedCanvasId(e){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}_handleIntersection(e){const t=e.find(s=>s.target===this.canvas);if(!t)return;const i=t.isIntersecting;this.isVisible!==i&&(this.isVisible=i,this.device.props.onVisibilityChange(this))}_handleResize(e){const t=e.find(f=>f.target===this.canvas);if(!t)return;this.cssWidth=t.contentBoxSize[0].inlineSize,this.cssHeight=t.contentBoxSize[0].blockSize;const i=this.getDevicePixelSize(),s=t.devicePixelContentBoxSize?.[0].inlineSize||t.contentBoxSize[0].inlineSize*devicePixelRatio,o=t.devicePixelContentBoxSize?.[0].blockSize||t.contentBoxSize[0].blockSize*devicePixelRatio,[l,c]=this.getMaxDrawingBufferSize();this.devicePixelWidth=Math.max(1,Math.min(s,l)),this.devicePixelHeight=Math.max(1,Math.min(o,c)),this._updateDrawingBufferSize(),this.device.props.onResize(this,{oldPixelSize:i})}_updateDrawingBufferSize(){if(this.props.autoResize){if(typeof this.props.useDevicePixels=="number"){const e=this.props.useDevicePixels;this.setDrawingBufferSize(this.cssWidth*e,this.cssHeight*e)}else this.props.useDevicePixels?this.setDrawingBufferSize(this.devicePixelWidth,this.devicePixelHeight):this.setDrawingBufferSize(this.cssWidth,this.cssHeight);this._updateDevice()}this._initializedResolvers.resolve(),this.isInitialized=!0,this.updatePosition()}_observeDevicePixelRatio(){const e=this.devicePixelRatio;this.devicePixelRatio=window.devicePixelRatio,this.updatePosition(),this.device.props.onDevicePixelRatioChange(this,{oldRatio:e}),matchMedia(`(resolution: ${this.devicePixelRatio}dppx)`).addEventListener("change",()=>this._observeDevicePixelRatio(),{once:!0})}_trackPosition(e=100){const t=setInterval(()=>{this.destroyed?clearInterval(t):this.updatePosition()},e)}updatePosition(){const e=this.htmlCanvas?.getBoundingClientRect();if(e){const t=[e.left,e.top];if(this._position??=t,t[0]!==this._position[0]||t[1]!==this._position[1]){const s=this._position;this._position=t,this.device.props.onPositionChange?.(this,{oldPosition:s})}}}}function JE(n){if(typeof n=="string"){const e=document.getElementById(n);if(!e)throw new Error(`${n} is not an HTML element`);return e}return n||document.body}function eC(n){const e=document.getElementById(n);if(!Os.isHTMLCanvas(e))throw new Error("Object is not a canvas element");return e}function tC(n){const{width:e,height:t}=n,i=document.createElement("canvas");i.id=Hu("lumagl-auto-created-canvas"),i.width=e||1,i.height=t||1,i.style.width=Number.isFinite(e)?`${e}px`:"100%",i.style.height=Number.isFinite(t)?`${t}px`:"100%",n?.visible||(i.style.visibility="hidden");const s=JE(n?.container||null);return s.insertBefore(i,s.firstChild),i}function nC(n,e,t,i,s){const o=n,l=p_(o[0],e,t);let c=g_(o[1],e,i,s),f=p_(o[0]+1,e,t);const d=f===t-1?f:f-1;f=g_(o[1]+1,e,i,s);let p;return s?(f=f===0?f:f+1,p=c,c=f):p=f===i-1?f:f-1,{x:l,y:c,width:Math.max(d-l+1,1),height:Math.max(p-c+1,1)}}function p_(n,e,t){return Math.min(Math.round(n*e),t-1)}function g_(n,e,t,i){return i?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}class Fs extends Je{static defaultProps={...Je.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){t=Fs.normalizeProps(e,t),super(e,t,Fs.defaultProps)}static normalizeProps(e,t){return t}}const iC={"1d":"1d","2d":"2d","2d-array":"2d",cube:"2d","cube-array":"2d","3d":"3d"};class wt extends Je{static SAMPLE=4;static STORAGE=8;static RENDER=16;static COPY_SRC=1;static COPY_DST=2;static TEXTURE=4;static RENDER_ATTACHMENT=16;dimension;baseDimension;format;width;height;depth;mipLevels;updateTimestamp;get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}constructor(e,t){if(t=wt.normalizeProps(e,t),super(e,t,wt.defaultProps),this.dimension=this.props.dimension,this.baseDimension=iC[this.dimension],this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.mipLevels=this.props.mipLevels,this.props.width===void 0||this.props.height===void 0)if(e.isExternalImage(t.data)){const i=e.getExternalImageSize(t.data);this.width=i?.width||1,this.height=i?.height||1}else this.width=1,this.height=1,(this.props.width===void 0||this.props.height===void 0)&&le.warn(`${this} created with undefined width or height. This is deprecated. Use AsyncTexture instead.`)();this.updateTimestamp=e.incrementTimestamp()}setSampler(e){this.sampler=e instanceof Fs?e:this.device.createSampler(e)}clone(e){return this.device.createTexture({...this.props,...e})}static normalizeProps(e,t){const i={...t},{width:s,height:o}=i;return typeof s=="number"&&(i.width=Math.max(1,Math.ceil(s))),typeof o=="number"&&(i.height=Math.max(1,Math.ceil(o))),i}_initializeData(e){this.device.isExternalImage(e)?this.copyExternalImage({image:e,width:this.width,height:this.height,depth:this.depth,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}):e&&this.copyImageData({data:e,mipLevel:0,x:0,y:0,z:0,aspect:"all"})}_normalizeCopyImageDataOptions(e){const{width:t,height:i,depth:s}=this,o={...wt.defaultCopyDataOptions,width:t,height:i,depth:s,...e},l=this.device.getTextureFormatInfo(this.format);if(!e.bytesPerRow&&!l.bytesPerPixel)throw new Error(`bytesPerRow must be provided for texture format ${this.format}`);return o.bytesPerRow=e.bytesPerRow||t*(l.bytesPerPixel||4),o.rowsPerImage=e.rowsPerImage||i,o}_normalizeCopyExternalImageOptions(e){const t=this.device.getExternalImageSize(e.image),i={...wt.defaultCopyExternalImageOptions,...t,...e};return i.width=Math.min(i.width,this.width-i.x),i.height=Math.min(i.height,this.height-i.y),i}static defaultProps={...Je.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",usage:wt.TEXTURE|wt.RENDER_ATTACHMENT|wt.COPY_DST,width:void 0,height:void 0,depth:1,mipLevels:1,samples:void 0,sampler:{},view:void 0};static defaultCopyDataOptions={data:void 0,byteOffset:0,bytesPerRow:void 0,rowsPerImage:void 0,mipLevel:0,x:0,y:0,z:0,aspect:"all"};static defaultCopyExternalImageOptions={image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1}}class $u extends Je{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,$u.defaultProps)}static defaultProps={...Je.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0}}function sC(n,e,t){let i="";const s=e.split(/\r?\n/),o=n.slice().sort((l,c)=>l.lineNum-c.lineNum);switch(t?.showSourceCode||"no"){case"all":let l=0;for(let c=1;c<=s.length;c++)for(i+=Nb(s[c-1],c,t);o.length>l&&o[l].lineNum===c;){const f=o[l++];i+=kd(f,s,f.lineNum,{...t,inlineSource:!1})}for(;o.length>l;){const c=o[l++];i+=kd(c,[],0,{...t,inlineSource:!1})}return i;case"issues":case"no":for(const c of n)i+=kd(c,s,c.lineNum,{inlineSource:t?.showSourceCode!=="no"});return i}}function kd(n,e,t,i){if(i?.inlineSource){const o=rC(e,t),l=n.linePos>0?`${" ".repeat(n.linePos+5)}^^^
`:"";return`
${o}${l}${n.type.toUpperCase()}: ${n.message}

`}const s=n.type==="error"?"red":"#8B4000";return i?.html?`<div class='luma-compiler-log-error' style="color:${s};"><b> ${n.type.toUpperCase()}: ${n.message}</b></div>`:`${n.type.toUpperCase()}: ${n.message}`}function rC(n,e,t){let i="";for(let s=e-2;s<=e;s++){const o=n[s-1];o!==void 0&&(i+=Nb(o,e,t))}return i}function Nb(n,e,t){const i=t?.html?aC(n):n;return`${oC(String(e),4)}: ${i}${t?.html?"<br/>":`
`}`}function oC(n,e){let t="";for(let i=n.length;i<e;++i)t+=" ";return t+n}function aC(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}class Wu extends Je{get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(e,t){t={...t,debugShaders:t.debugShaders||e.props.debugShaders||"errors"},super(e,{id:lC(t),...t},Wu.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const e=this.props.debugShaders;switch(e){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const t=await this.getCompilationInfo();e==="warnings"&&t?.length===0||this._displayShaderLog(t,this.id)}_displayShaderLog(e,t){if(typeof document>"u"||!document?.createElement)return;const i=t,s=`${this.stage} shader "${i}"`;let o=sC(e,this.source,{showSourceCode:"all",html:!0});const l=this.getTranslatedSource();l&&(o+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${l}</pre></code>`);const c=document.createElement("Button");c.innerHTML=`
<h1>Compilation error in ${s}</h1><br /><br />
<code style="user-select:text;"><pre>
${o}
</pre></code>`,c.style.top="10px",c.style.left="10px",c.style.position="absolute",c.style.zIndex="9999",c.style.width="100%",c.style.textAlign="left",document.body.appendChild(c),document.getElementsByClassName("luma-compiler-log-error")[0]?.scrollIntoView(),c.onclick=()=>{const d=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(d)}}static defaultProps={...Je.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0}}function lC(n){return cC(n.source)||n.id||Hu(`unnamed ${n.stage}-shader`)}function cC(n,e="unnamed"){const i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(n);return i?i[1]:e}class Xu extends Je{get[Symbol.toStringTag](){return"Framebuffer"}width;height;constructor(e,t={}){super(e,t,Xu.defaultProps),this.width=this.props.width,this.height=this.props.height}clone(e){const t=this.colorAttachments.map(s=>s.texture.clone(e)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(e);return this.device.createFramebuffer({...this.props,colorAttachments:t,depthStencilAttachment:i})}resize(e){let t=!e;if(e){const[i,s]=Array.isArray(e)?e:[e.width,e.height];t=t||s!==this.height||i!==this.width,this.width=i,this.height=s}t&&(le.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((t,i)=>{if(typeof t=="string"){const s=this.createColorTexture(t,i);return this.attachResource(s),s.view}return t instanceof wt?t.view:t});const e=this.props.depthStencilAttachment;if(e)if(typeof e=="string"){const t=this.createDepthStencilTexture(e);this.attachResource(t),this.depthStencilAttachment=t.view}else e instanceof wt?this.depthStencilAttachment=e.view:this.depthStencilAttachment=e}createColorTexture(e,t){return this.device.createTexture({id:`${this.id}-color-attachment-${t}`,usage:wt.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(e){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:wt.RENDER_ATTACHMENT,format:e,width:this.width,height:this.height})}resizeAttachments(e,t){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const s=this.colorAttachments[i].texture.clone({width:e,height:t});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:e,height:t});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}static defaultProps={...Je.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null}}class ks extends Je{get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(e,t){super(e,t,ks.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}static defaultProps={...Je.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",colorAttachmentFormats:void 0,depthStencilAttachmentFormat:void 0,parameters:{},bindings:{},uniforms:{}}}class Ms extends Je{static defaultClearColor=[0,0,0,1];static defaultClearDepth=1;static defaultClearStencil=0;get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){t=Ms.normalizeProps(e,t),super(e,t,Ms.defaultProps)}static normalizeProps(e,t){return t}static defaultProps={...Je.defaultProps,framebuffer:null,parameters:void 0,clearColor:Ms.defaultClearColor,clearColors:void 0,clearDepth:Ms.defaultClearDepth,clearStencil:Ms.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0}}class xu extends Je{get[Symbol.toStringTag](){return"ComputePipeline"}hash="";shaderLayout;constructor(e,t){super(e,t,xu.defaultProps),this.shaderLayout=t.shaderLayout}static defaultProps={...Je.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0}}class Ag extends Je{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Ag.defaultProps)}static defaultProps={...Je.defaultProps,measureExecutionTime:void 0}}class Eg extends Je{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,Eg.defaultProps)}static defaultProps={...Je.defaultProps}}function kb(n){return dC[n]}function uC(n){const[e,t]=hC[n],i=e==="i32"||e==="u32",s=e!=="u32",o=fC[e]*t;return{primitiveType:e,components:t,byteLength:o,integer:i,signed:s}}const fC={f32:4,f16:2,i32:4,u32:4},hC={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},dC={f32:{type:"f32",components:1},f16:{type:"f16",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<f16>":{type:"f16",components:2},"vec3<f16>":{type:"f16",components:3},"vec4<f16>":{type:"f16",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16},"mat2x2<f16>":{type:"f16",components:4},"mat2x3<f16>":{type:"f16",components:6},"mat2x4<f16>":{type:"f16",components:8},"mat3x2<f16>":{type:"f16",components:6},"mat3x3<f16>":{type:"f16",components:9},"mat3x4<f16>":{type:"f16",components:12},"mat4x2<f16>":{type:"f16",components:8},"mat4x3<f16>":{type:"f16",components:12},"mat4x4<f16>":{type:"f16",components:16},"mat2x2<i32>":{type:"i32",components:4},"mat2x3<i32>":{type:"i32",components:6},"mat2x4<i32>":{type:"i32",components:8},"mat3x2<i32>":{type:"i32",components:6},"mat3x3<i32>":{type:"i32",components:9},"mat3x4<i32>":{type:"i32",components:12},"mat4x2<i32>":{type:"i32",components:8},"mat4x3<i32>":{type:"i32",components:12},"mat4x4<i32>":{type:"i32",components:16},"mat2x2<u32>":{type:"u32",components:4},"mat2x3<u32>":{type:"u32",components:6},"mat2x4<u32>":{type:"u32",components:8},"mat3x2<u32>":{type:"u32",components:6},"mat3x3<u32>":{type:"u32",components:9},"mat3x4<u32>":{type:"u32",components:12},"mat4x2<u32>":{type:"u32",components:8},"mat4x3<u32>":{type:"u32",components:12},"mat4x4<u32>":{type:"u32",components:16}};function Db(n,e){const t={};for(const i of n.attributes){const s=gC(n,e,i.name);s&&(t[i.name]=s)}return t}function pC(n,e,t=16){const i=Db(n,e),s=new Array(t).fill(null);for(const o of Object.values(i))s[o.location]=o;return s}function gC(n,e,t){const i=mC(n,t),s=_C(e,t);if(!i)return null;const o=uC(i.type),l=IE(o),c=s?.vertexFormat||l,f=Sg(c);return{attributeName:s?.attributeName||i.name,bufferName:s?.bufferName||i.name,location:i.location,shaderType:i.type,primitiveType:o.primitiveType,shaderComponents:o.components,vertexFormat:c,bufferDataType:f.type,bufferComponents:f.components,normalized:f.normalized,integer:o.integer,stepMode:s?.stepMode||i.stepMode||"vertex",byteOffset:s?.byteOffset||0,byteStride:s?.byteStride||0}}function mC(n,e){const t=n.attributes.find(i=>i.name===e);return t||le.warn(`shader layout attribute "${e}" not present in shader`),t||null}function _C(n,e){yC(n);let t=bC(n,e);return t||(t=vC(n,e),t)?t:(le.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function yC(n){for(const e of n)(e.attributes&&e.format||!e.attributes&&!e.format)&&le.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function bC(n,e){for(const t of n)if(t.format&&t.name===e)return{attributeName:t.name,bufferName:e,stepMode:t.stepMode,vertexFormat:t.format,byteOffset:0,byteStride:t.byteStride||0};return null}function vC(n,e){for(const t of n){let i=t.byteStride;if(typeof t.byteStride!="number")for(const o of t.attributes||[]){const l=Sg(o.format);i+=l.byteLength}const s=t.attributes?.find(o=>o.attribute===e);if(s)return{attributeName:s.attribute,bufferName:t.name,stepMode:t.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}class Cg extends Je{static defaultProps={...Je.defaultProps,shaderLayout:void 0,bufferLayout:[]};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(e,t){super(e,t,Cg.defaultProps),this.maxVertexAttributes=e.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=pC(t.shaderLayout,t.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(e,t){this.device.reportError(new Error("constant attributes not supported"),this)()}}class Rg extends Je{static defaultProps={...Je.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,Rg.defaultProps)}}class Mg extends Je{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,Mg.defaultProps)}static defaultProps={...Je.defaultProps,type:void 0,count:void 0}}let Oc;function Lb(n){return(!Oc||Oc.byteLength<n)&&(Oc=new ArrayBuffer(n)),Oc}function xC(n,e){const t=Lb(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}function TC(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Tu(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":TC(n)}const wC=1024;class SC{layout={};byteLength;constructor(e,t={}){let i=0;for(const[o,l]of Object.entries(e)){const c=kb(l),{type:f,components:d}=c,p=d*(t?.[o]??1);i=ME(i,p);const _=i;i+=p,this.layout[o]={type:f,size:p,offset:_}}i+=(4-i%4)%4;const s=i*4;this.byteLength=Math.max(s,wC)}getData(e){const t=Lb(this.byteLength),i={i32:new Int32Array(t),u32:new Uint32Array(t),f32:new Float32Array(t),f16:new Uint16Array(t)};for(const[s,o]of Object.entries(e)){const l=this.layout[s];if(!l){le.warn(`Supplied uniform value ${s} not present in uniform block layout`)();continue}const{type:c,size:f,offset:d}=l,p=i[c];if(f===1){if(typeof o!="number"&&typeof o!="boolean"){le.warn(`Supplied value for single component uniform ${s} is not a number: ${o}`)();continue}p[d]=Number(o)}else{if(!Tu(o)){le.warn(`Supplied value for multi component / array uniform ${s} is not a numeric array: ${o}`)();continue}p.set(o,d)}}return new Uint8Array(t,0,this.byteLength)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function AC(n,e,t=16){if(n!==e)return!1;const i=n,s=e;if(!Tu(i))return!1;if(Tu(s)&&i.length===s.length){for(let o=0;o<i.length;++o)if(s[o]!==i[o])return!1}return!0}function EC(n){return Tu(n)?n.slice():n}class CC{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(e){if(this.name=e?.name||"unnamed",e?.name&&e?.shaderLayout){const t=e?.shaderLayout.bindings?.find(s=>s.type==="uniform"&&s.name===e?.name);if(!t)throw new Error(e?.name);const i=t;for(const s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(e){for(const[t,i]of Object.entries(e))this._setUniform(t,i),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${i}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){AC(this.uniforms[e],t)||(this.uniforms[e]=EC(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}class RC{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(e){for(const[t,i]of Object.entries(e)){const s=t,o=new SC(i.uniformTypes??{},i.uniformSizes??{});this.uniformBufferLayouts.set(s,o);const l=new CC({name:t});l.setUniforms(i.defaultUniforms||{}),this.uniformBlocks.set(s,l)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){for(const[t,i]of Object.entries(e))this.uniformBlocks.get(t)?.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){return this.uniformBufferLayouts.get(e)?.byteLength||0}getUniformBufferData(e){const t=this.uniformBlocks.get(e)?.getAllUniforms()||{};return this.uniformBufferLayouts.get(e)?.getData(t)}createUniformBuffer(e,t,i){i&&this.setUniforms(i);const s=this.getUniformBufferByteLength(t),o=e.createBuffer({usage:tt.UNIFORM|tt.COPY_DST,byteLength:s}),l=this.getUniformBufferData(t);return o.write(l),o}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const i=this.getUniformBufferByteLength(t),s=e.createBuffer({usage:tt.UNIFORM|tt.COPY_DST,byteLength:i});this.uniformBuffers.set(t,s)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const i=this.updateUniformBuffer(t);e||=i}return e&&le.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){const t=this.uniformBlocks.get(e);let i=this.uniformBuffers.get(e),s=!1;if(i&&t?.needsRedraw){s||=t.needsRedraw;const o=this.getUniformBufferData(e);i=this.uniformBuffers.get(e),i?.write(o);const l=this.uniformBlocks.get(e)?.getAllUniforms();le.log(4,`Writing to uniform buffer ${String(e)}`,o,l)()}return s}}class Tn{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}get isPointer(){return!1}getTypeName(){return this.name}}class m_{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class es extends Tn{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class rs extends Tn{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}getTypeName(){return`array<${this.format.getTypeName()}, ${this.count}>`}}class Cp extends Tn{constructor(e,t,i){super(e,i),this.format=t}get isPointer(){return!0}getTypeName(){return`&${this.format.getTypeName()}`}}class zs extends Tn{constructor(e,t,i,s){super(e,i),this.format=t,this.access=s}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var Qi;(n=>{n[n.Uniform=0]="Uniform",n[n.Storage=1]="Storage",n[n.Texture=2]="Texture",n[n.Sampler=3]="Sampler",n[n.StorageTexture=4]="StorageTexture"})(Qi||(Qi={}));class Ic{constructor(e,t,i,s,o,l,c){this.name=e,this.type=t,this.group=i,this.binding=s,this.attributes=o,this.resourceType=l,this.access=c}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class MC{constructor(e,t){this.name=e,this.type=t}}class PC{constructor(e,t,i,s){this.name=e,this.type=t,this.locationType=i,this.location=s,this.interpolation=null}}class __{constructor(e,t,i,s){this.name=e,this.type=t,this.locationType=i,this.location=s}}class OC{constructor(e,t,i,s){this.name=e,this.type=t,this.attributes=i,this.id=s}}class IC{constructor(e,t,i){this.name=e,this.type=t,this.attributes=i}}class NC{constructor(e,t=null,i){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=i}}class kC{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}function DC(n){var e=(32768&n)>>15,t=(31744&n)>>10,i=1023&n;return t==0?(e?-1:1)*Math.pow(2,-14)*(i/Math.pow(2,10)):t==31?i?NaN:1/0*(e?-1:1):(e?-1:1)*Math.pow(2,t-15)*(1+i/Math.pow(2,10))}const Bb=new Float32Array(1),LC=new Int32Array(Bb.buffer),Bt=new Uint16Array(1);function BC(n){Bb[0]=n;const e=LC[0],t=e>>31&1;let i=e>>23&255,s=8388607&e;if(i===255)return Bt[0]=t<<15|31744|(s!==0?512:0),Bt[0];if(i===0){if(s===0)return Bt[0]=t<<15,Bt[0];s|=8388608;let o=113;for(;!(8388608&s);)s<<=1,o--;return i=127-o,s&=8388607,i>0?(s=(s>>126-i)+(s>>127-i&1),Bt[0]=t<<15|i<<10|s>>13,Bt[0]):(Bt[0]=t<<15,Bt[0])}return i=i-127+15,i>=31?(Bt[0]=t<<15|31744,Bt[0]):i<=0?i<-10?(Bt[0]=t<<15,Bt[0]):(s=(8388608|s)>>1-i,Bt[0]=t<<15|s>>13,Bt[0]):(s>>=13,Bt[0]=t<<15|i<<10|s,Bt[0])}const Pg=new Uint32Array(1),Ub=new Float32Array(Pg.buffer,0,1);function y_(n){const e=112+(n>>6&31)<<23|(63&n)<<17;return Pg[0]=e,Ub[0]}function UC(n,e,t,i,s,o,l,c,f){const d=i*(l>>=s)*(o>>=s)+t*l+e*c;switch(f){case"r8unorm":return[$e(n,d,"8unorm",1)[0]];case"r8snorm":return[$e(n,d,"8snorm",1)[0]];case"r8uint":return[$e(n,d,"8uint",1)[0]];case"r8sint":return[$e(n,d,"8sint",1)[0]];case"rg8unorm":{const p=$e(n,d,"8unorm",2);return[p[0],p[1]]}case"rg8snorm":{const p=$e(n,d,"8snorm",2);return[p[0],p[1]]}case"rg8uint":{const p=$e(n,d,"8uint",2);return[p[0],p[1]]}case"rg8sint":{const p=$e(n,d,"8sint",2);return[p[0],p[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const p=$e(n,d,"8unorm",4);return[p[0],p[1],p[2],p[3]]}case"rgba8snorm":{const p=$e(n,d,"8snorm",4);return[p[0],p[1],p[2],p[3]]}case"rgba8uint":{const p=$e(n,d,"8uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba8sint":{const p=$e(n,d,"8sint",4);return[p[0],p[1],p[2],p[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const p=$e(n,d,"8unorm",4);return[p[2],p[1],p[0],p[3]]}case"r16uint":return[$e(n,d,"16uint",1)[0]];case"r16sint":return[$e(n,d,"16sint",1)[0]];case"r16float":return[$e(n,d,"16float",1)[0]];case"rg16uint":{const p=$e(n,d,"16uint",2);return[p[0],p[1]]}case"rg16sint":{const p=$e(n,d,"16sint",2);return[p[0],p[1]]}case"rg16float":{const p=$e(n,d,"16float",2);return[p[0],p[1]]}case"rgba16uint":{const p=$e(n,d,"16uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba16sint":{const p=$e(n,d,"16sint",4);return[p[0],p[1],p[2],p[3]]}case"rgba16float":{const p=$e(n,d,"16float",4);return[p[0],p[1],p[2],p[3]]}case"r32uint":return[$e(n,d,"32uint",1)[0]];case"r32sint":return[$e(n,d,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[$e(n,d,"32float",1)[0]];case"rg32uint":{const p=$e(n,d,"32uint",2);return[p[0],p[1]]}case"rg32sint":{const p=$e(n,d,"32sint",2);return[p[0],p[1]]}case"rg32float":{const p=$e(n,d,"32float",2);return[p[0],p[1]]}case"rgba32uint":{const p=$e(n,d,"32uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba32sint":{const p=$e(n,d,"32sint",4);return[p[0],p[1],p[2],p[3]]}case"rgba32float":{const p=$e(n,d,"32float",4);return[p[0],p[1],p[2],p[3]]}case"rg11b10ufloat":{const p=new Uint32Array(n.buffer,d,1)[0],_=(4192256&p)>>11,y=(4290772992&p)>>22;return[y_(2047&p),y_(_),function(v){const x=112+(v>>5&31)<<23|(31&v)<<18;return Pg[0]=x,Ub[0]}(y),1]}}return null}function $e(n,e,t,i){const s=[0,0,0,0];for(let o=0;o<i;++o)switch(t){case"8unorm":s[o]=n[e]/255,e++;break;case"8snorm":s[o]=n[e]/255*2-1,e++;break;case"8uint":s[o]=n[e],e++;break;case"8sint":s[o]=n[e]-127,e++;break;case"16uint":s[o]=n[e]|n[e+1]<<8,e+=2;break;case"16sint":s[o]=(n[e]|n[e+1]<<8)-32768,e+=2;break;case"16float":s[o]=DC(n[e]|n[e+1]<<8),e+=2;break;case"32uint":case"32sint":s[o]=n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24,e+=4;break;case"32float":s[o]=new Float32Array(n.buffer,e,1)[0],e+=4}return s}function Xe(n,e,t,i,s){for(let o=0;o<i;++o)switch(t){case"8unorm":n[e]=255*s[o],e++;break;case"8snorm":n[e]=.5*(s[o]+1)*255,e++;break;case"8uint":n[e]=s[o],e++;break;case"8sint":n[e]=s[o]+127,e++;break;case"16uint":new Uint16Array(n.buffer,e,1)[0]=s[o],e+=2;break;case"16sint":new Int16Array(n.buffer,e,1)[0]=s[o],e+=2;break;case"16float":{const l=BC(s[o]);new Uint16Array(n.buffer,e,1)[0]=l,e+=2;break}case"32uint":new Uint32Array(n.buffer,e,1)[0]=s[o],e+=4;break;case"32sint":new Int32Array(n.buffer,e,1)[0]=s[o],e+=4;break;case"32float":new Float32Array(n.buffer,e,1)[0]=s[o],e+=4}return s}const Dd={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class En{constructor(){this.id=En._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(wu.instance);for(const i of e)i instanceof Array?this.searchBlock(i,t):i.search(t);t(Su.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}En._id=0;class wu extends En{}wu.instance=new wu;class Su extends En{}Su.instance=new Su;const Fb=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class st extends En{constructor(){super()}}class Xa extends st{constructor(e,t,i,s,o,l){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=i,this.body=s,this.startLine=o,this.endLine=l}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class FC extends st{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class zb extends st{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Rp extends st{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class jb extends st{constructor(e,t,i,s){super(),this.init=e,this.condition=t,this.increment=i,this.body=s}get astNodeType(){return"for"}search(e){var t,i,s;(t=this.init)===null||t===void 0||t.search(e),(i=this.condition)===null||i===void 0||i.search(e),(s=this.increment)===null||s===void 0||s.search(e),this.searchBlock(this.body,e)}}class _i extends st{constructor(e,t,i,s,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=s,this.value=o}get astNodeType(){return"var"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class Og extends st{constructor(e,t,i){super(),this.attributes=null,this.name=e,this.type=t,this.value=i}get astNodeType(){return"override"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class Ba extends st{constructor(e,t,i,s,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=s,this.value=o}get astNodeType(){return"let"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class eu extends st{constructor(e,t,i,s,o){super(),this.attributes=null,this.name=e,this.type=t,this.storage=i,this.access=s,this.value=o}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}var Hr,Ra,Y,V;(n=>{n.increment="++",n.decrement="--"})(Hr||(Hr={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for IncrementOperator");return n[t]}})(Hr||(Hr={}));class Vb extends st{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(n=>{n.assign="=",n.addAssign="+=",n.subtractAssin="-=",n.multiplyAssign="*=",n.divideAssign="/=",n.moduloAssign="%=",n.andAssign="&=",n.orAssign="|=",n.xorAssign="^=",n.shiftLeftAssign="<<=",n.shiftRightAssign=">>="})(Ra||(Ra={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for AssignOperator");return t}})(Ra||(Ra={}));class Hb extends st{constructor(e,t,i){super(),this.operator=e,this.variable=t,this.value=i}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class Ig extends st{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return Fb.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class $b extends st{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}search(e){var t;this.searchBlock(this.body,e),(t=this.continuing)===null||t===void 0||t.search(e)}}class Wb extends st{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}search(e){e(this);for(const t of this.cases)t.search(e)}}class Xb extends st{constructor(e,t,i,s){super(),this.condition=e,this.body=t,this.elseif=i,this.else=s}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Yb extends st{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class zC extends st{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class jC extends st{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class qb extends st{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class Ng extends st{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class VC extends st{constructor(){super()}get astNodeType(){return"discard"}}class Zb extends st{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Kb extends st{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class re extends st{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if(t.name==="f32")return t;for(let i=1;i<e.length;++i){const s=re._priority.get(t.name);re._priority.get(e[i].name)<s&&(t=e[i])}return t.name==="x32"?re.i32:t}getTypeName(){return this.name}}re.x32=new re("x32"),re.f32=new re("f32"),re.i32=new re("i32"),re.u32=new re("u32"),re.f16=new re("f16"),re.bool=new re("bool"),re.void=new re("void"),re._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class b_ extends re{constructor(e){super(e)}}class pi extends re{constructor(e,t,i,s){super(e),this.members=t,this.startLine=i,this.endLine=s}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class W extends re{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}W.vec2f=new W("vec2",re.f32,null),W.vec3f=new W("vec3",re.f32,null),W.vec4f=new W("vec4",re.f32,null),W.vec2i=new W("vec2",re.i32,null),W.vec3i=new W("vec3",re.i32,null),W.vec4i=new W("vec4",re.i32,null),W.vec2u=new W("vec2",re.u32,null),W.vec3u=new W("vec3",re.u32,null),W.vec4u=new W("vec4",re.u32,null),W.vec2h=new W("vec2",re.f16,null),W.vec3h=new W("vec3",re.f16,null),W.vec4h=new W("vec4",re.f16,null),W.vec2b=new W("vec2",re.bool,null),W.vec3b=new W("vec3",re.bool,null),W.vec4b=new W("vec4",re.bool,null),W.mat2x2f=new W("mat2x2",re.f32,null),W.mat2x3f=new W("mat2x3",re.f32,null),W.mat2x4f=new W("mat2x4",re.f32,null),W.mat3x2f=new W("mat3x2",re.f32,null),W.mat3x3f=new W("mat3x3",re.f32,null),W.mat3x4f=new W("mat3x4",re.f32,null),W.mat4x2f=new W("mat4x2",re.f32,null),W.mat4x3f=new W("mat4x3",re.f32,null),W.mat4x4f=new W("mat4x4",re.f32,null),W.mat2x2h=new W("mat2x2",re.f16,null),W.mat2x3h=new W("mat2x3",re.f16,null),W.mat2x4h=new W("mat2x4",re.f16,null),W.mat3x2h=new W("mat3x2",re.f16,null),W.mat3x3h=new W("mat3x3",re.f16,null),W.mat3x4h=new W("mat3x4",re.f16,null),W.mat4x2h=new W("mat4x2",re.f16,null),W.mat4x3h=new W("mat4x3",re.f16,null),W.mat4x4h=new W("mat4x4",re.f16,null),W.mat2x2i=new W("mat2x2",re.i32,null),W.mat2x3i=new W("mat2x3",re.i32,null),W.mat2x4i=new W("mat2x4",re.i32,null),W.mat3x2i=new W("mat3x2",re.i32,null),W.mat3x3i=new W("mat3x3",re.i32,null),W.mat3x4i=new W("mat3x4",re.i32,null),W.mat4x2i=new W("mat4x2",re.i32,null),W.mat4x3i=new W("mat4x3",re.i32,null),W.mat4x4i=new W("mat4x4",re.i32,null),W.mat2x2u=new W("mat2x2",re.u32,null),W.mat2x3u=new W("mat2x3",re.u32,null),W.mat2x4u=new W("mat2x4",re.u32,null),W.mat3x2u=new W("mat3x2",re.u32,null),W.mat3x3u=new W("mat3x3",re.u32,null),W.mat3x4u=new W("mat3x4",re.u32,null),W.mat4x2u=new W("mat4x2",re.u32,null),W.mat4x3u=new W("mat4x3",re.u32,null),W.mat4x4u=new W("mat4x4",re.u32,null);class tu extends re{constructor(e,t,i,s){super(e),this.storage=t,this.type=i,this.access=s}get astNodeType(){return"pointer"}}class Ua extends re{constructor(e,t,i,s){super(e),this.attributes=t,this.format=i,this.count=s}get astNodeType(){return"array"}get isArray(){return!0}}class Ma extends re{constructor(e,t,i){super(e),this.format=t,this.access=i}get astNodeType(){return"sampler"}}class Ln extends En{constructor(){super(),this.postfix=null}}class js extends Ln{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Wn extends Ln{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class kg extends Ln{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Fb.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class un extends Ln{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class Gb extends Ln{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const i=e.evalExpression(this.initializer,e.context);return i!==null&&this.postfix?i.getSubData(e,this.postfix,e.context):i}return null}search(e){this.initializer.search(e)}}class xt extends Ln{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return t!==void 0&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof j}get isVector(){return this.value instanceof I||this.value instanceof Ce}get scalarValue(){return this.value instanceof j?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof I||this.value instanceof Ce?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Qb extends Ln{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class to extends Ln{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Jb extends Ln{constructor(){super()}}class mt extends Jb{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class On extends Jb{constructor(e,t,i){super(),this.operator=e,this.left=t,this.right=i}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:e.name==="f32"||t.name==="f32"?re.f32:e.name==="u32"||t.name==="u32"?re.u32:re.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class e8 extends En{constructor(e){super(),this.body=e}search(e){e(this),this.searchBlock(this.body,e)}}class nu extends Ln{constructor(){super()}get astNodeType(){return"default"}}class t8 extends e8{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class n8 extends e8{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class v_ extends En{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"argument"}}class HC extends En{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class x_ extends En{constructor(e,t,i){super(),this.name=e,this.type=t,this.attributes=i}get astNodeType(){return"member"}}class i8 extends En{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class An{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=An._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,i,s){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,i){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.getTypeName()}>`}}An._id=0;class Mp extends An{constructor(){super(new Tn("void",null),null)}toString(){return"void"}}Mp.void=new Mp;class Fr extends An{constructor(e){super(new Cp("pointer",e.typeInfo,null),null),this.reference=e}clone(){return this}setDataValue(e,t,i,s){this.reference.setDataValue(e,t,i,s)}getSubData(e,t,i){return t?this.reference.getSubData(e,t,i):this}toString(){return`&${this.reference.toString()}`}}class j extends An{constructor(e,t,i=null){super(t,i),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!==0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new j(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new j(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new j(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,i,s){if(i)return void console.error("SetDataValue: Scalar data does not support postfix",i);if(!(t instanceof j))return void console.error("SetDataValue: Invalid value",t);let o=t.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?o=Math.floor(o):this.typeInfo.name==="bool"&&(o=o?1:0),this.data[0]=o}getSubData(e,t,i){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}}function $C(n,e,t){const i=e.length;return i===2?t==="f32"?new I(new Float32Array(e),n.getTypeInfo("vec2f")):t==="i32"||t==="bool"?new I(new Int32Array(e),n.getTypeInfo("vec2i")):t==="u32"?new I(new Uint32Array(e),n.getTypeInfo("vec2u")):t==="f16"?new I(new Float32Array(e),n.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${t}`),null):i===3?t==="f32"?new I(new Float32Array(e),n.getTypeInfo("vec3f")):t==="i32"||t==="bool"?new I(new Int32Array(e),n.getTypeInfo("vec3i")):t==="u32"?new I(new Uint32Array(e),n.getTypeInfo("vec3u")):t==="f16"?new I(new Float32Array(e),n.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${t}`),null):i===4?t==="f32"?new I(new Float32Array(e),n.getTypeInfo("vec4f")):t==="i32"||t==="bool"?new I(new Int32Array(e),n.getTypeInfo("vec4i")):t==="u32"?new I(new Uint32Array(e),n.getTypeInfo("vec4u")):t==="f16"?new I(new Float32Array(e),n.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${t}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class I extends An{constructor(e,t,i=null){if(super(t,i),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const s=this.typeInfo.name;s==="vec2f"||s==="vec3f"||s==="vec4f"?this.data=new Float32Array(e):s==="vec2i"||s==="vec3i"||s==="vec4i"?this.data=new Int32Array(e):s==="vec2u"||s==="vec3u"||s==="vec4u"?this.data=new Uint32Array(e):s==="vec2h"||s==="vec3h"||s==="vec4h"?this.data=new Float32Array(e):s==="vec2b"||s==="vec3b"||s==="vec4b"?this.data=new Int32Array(e):s==="vec2"||s==="vec3"||s==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${s}`)}}clone(){if(this.data instanceof Float32Array)return new I(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new I(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new I(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,i,s){i instanceof js?console.error("TODO: Set vector postfix"):t instanceof I?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(t===null)return this;let s=e.getTypeInfo("f32");if(this.typeInfo instanceof zs)s=this.typeInfo.format||s;else{const l=this.typeInfo.name;l==="vec2f"||l==="vec3f"||l==="vec4f"?s=e.getTypeInfo("f32"):l==="vec2i"||l==="vec3i"||l==="vec4i"?s=e.getTypeInfo("i32"):l==="vec2b"||l==="vec3b"||l==="vec4b"?s=e.getTypeInfo("bool"):l==="vec2u"||l==="vec3u"||l==="vec4u"?s=e.getTypeInfo("u32"):l==="vec2h"||l==="vec3h"||l==="vec4h"?s=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${l}`)}let o=this;for(;t!==null&&o!==null;){if(t instanceof to){const l=t.index;let c=-1;if(l instanceof xt){if(!(l.value instanceof j))return console.error(`GetSubData: Invalid array index ${l.value}`),null;c=l.value.value}else{const f=e.evalExpression(l,i);if(!(f instanceof j))return console.error("GetSubData: Unknown index type",l),null;c=f.value}if(c<0||c>=o.data.length)return console.error("GetSubData: Index out of range",c),null;if(o.data instanceof Float32Array){const f=new Float32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new j(f,s)}if(o.data instanceof Int32Array){const f=new Int32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new j(f,s)}if(o.data instanceof Uint32Array){const f=new Uint32Array(o.data.buffer,o.data.byteOffset+4*c,1);return new j(f,s)}throw"GetSubData: Invalid data type"}if(!(t instanceof js))return console.error("GetSubData: Unknown postfix",t),null;{const l=t.value.toLowerCase();if(l.length===1){let f=0;if(l==="x"||l==="r")f=0;else if(l==="y"||l==="g")f=1;else if(l==="z"||l==="b")f=2;else{if(l!=="w"&&l!=="a")return console.error(`GetSubData: Unknown member ${l}`),null;f=3}if(this.data instanceof Float32Array){let d=new Float32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new j(d,s,this)}if(this.data instanceof Int32Array){let d=new Int32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new j(d,s,this)}if(this.data instanceof Uint32Array){let d=new Uint32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new j(d,s,this)}}const c=[];for(const f of l)f==="x"||f==="r"?c.push(this.data[0]):f==="y"||f==="g"?c.push(this.data[1]):f==="z"||f==="b"?c.push(this.data[2]):f==="w"||f==="a"?c.push(this.data[3]):console.error(`GetDataValue: Unknown member ${f}`);o=$C(e,c,s.name)}t=t.postfix}return o}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class Ce extends An{constructor(e,t,i=null){super(t,i),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new Ce(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,i,s){i instanceof js?console.error("TODO: Set matrix postfix"):t instanceof Ce?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,i){if(t===null)return this;const s=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof zs)this.typeInfo.format;else if(s.endsWith("f"))e.getTypeInfo("f32");else if(s.endsWith("i"))e.getTypeInfo("i32");else if(s.endsWith("u"))e.getTypeInfo("u32");else{if(!s.endsWith("h"))return console.error(`GetDataValue: Unknown type ${s}`),null;e.getTypeInfo("f16")}if(t instanceof to){const o=t.index;let l=-1;if(o instanceof xt){if(!(o.value instanceof j))return console.error(`GetDataValue: Invalid array index ${o.value}`),null;l=o.value.value}else{const d=e.evalExpression(o,i);if(!(d instanceof j))return console.error("GetDataValue: Unknown index type",o),null;l=d.value}if(l<0||l>=this.data.length)return console.error("GetDataValue: Index out of range",l),null;const c=s.endsWith("h")?"h":"f";let f;if(s==="mat2x2"||s==="mat2x2f"||s==="mat2x2h"||s==="mat3x2"||s==="mat3x2f"||s==="mat3x2h"||s==="mat4x2"||s==="mat4x2f"||s==="mat4x2h")f=new I(new Float32Array(this.data.buffer,this.data.byteOffset+2*l*4,2),e.getTypeInfo(`vec2${c}`));else if(s==="mat2x3"||s==="mat2x3f"||s==="mat2x3h"||s==="mat3x3"||s==="mat3x3f"||s==="mat3x3h"||s==="mat4x3"||s==="mat4x3f"||s==="mat4x3h")f=new I(new Float32Array(this.data.buffer,this.data.byteOffset+3*l*4,3),e.getTypeInfo(`vec3${c}`));else{if(s!=="mat2x4"&&s!=="mat2x4f"&&s!=="mat2x4h"&&s!=="mat3x4"&&s!=="mat3x4f"&&s!=="mat3x4h"&&s!=="mat4x4"&&s!=="mat4x4f"&&s!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${s}`),null;f=new I(new Float32Array(this.data.buffer,this.data.byteOffset+4*l*4,4),e.getTypeInfo(`vec4${c}`))}return t.postfix?f.getSubData(e,t.postfix,i):f}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class ut extends An{constructor(e,t,i=0,s=null){super(t,s),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=i}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ut(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,i,s){if(t===null)return void console.log("setDataValue: NULL data.");let o=this.offset,l=this.typeInfo;for(;i;){if(i instanceof to)if(l instanceof rs){const c=i.index;if(c instanceof xt){if(!(c.value instanceof j))return void console.error(`SetDataValue: Invalid index type ${c.value}`);o+=c.value.value*l.stride}else{const f=e.evalExpression(c,s);if(!(f instanceof j))return void console.error("SetDataValue: Unknown index type",c);o+=f.value*l.stride}l=l.format}else console.error(`SetDataValue: Type ${l.getTypeName()} is not an array`);else{if(!(i instanceof js))return void console.error("SetDataValue: Unknown postfix type",i);{const c=i.value;if(l instanceof es){let f=!1;for(const d of l.members)if(d.name===c){o+=d.offset,l=d.type,f=!0;break}if(!f)return void console.error(`SetDataValue: Member ${c} not found`)}else if(l instanceof Tn){const f=l.getTypeName();let d=0;if(c==="x"||c==="r")d=0;else if(c==="y"||c==="g")d=1;else if(c==="z"||c==="b")d=2;else{if(c!=="w"&&c!=="a")return void console.error(`SetDataValue: Unknown member ${c}`);d=3}if(!(t instanceof j))return void console.error("SetDataValue: Invalid value",t);const p=t.value;return f==="vec2f"?void(new Float32Array(this.buffer,o,2)[d]=p):f==="vec3f"?void(new Float32Array(this.buffer,o,3)[d]=p):f==="vec4f"?void(new Float32Array(this.buffer,o,4)[d]=p):f==="vec2i"?void(new Int32Array(this.buffer,o,2)[d]=p):f==="vec3i"?void(new Int32Array(this.buffer,o,3)[d]=p):f==="vec4i"?void(new Int32Array(this.buffer,o,4)[d]=p):f==="vec2u"?void(new Uint32Array(this.buffer,o,2)[d]=p):f==="vec3u"?void(new Uint32Array(this.buffer,o,3)[d]=p):f==="vec4u"?void(new Uint32Array(this.buffer,o,4)[d]=p):void console.error(`SetDataValue: Type ${f} is not a struct`)}}}i=i.postfix}this.setData(e,t,l,o,s)}setData(e,t,i,s,o){const l=i.getTypeName();if(l!=="f32"&&l!=="f16")if(l!=="i32"&&l!=="atomic<i32>"&&l!=="x32")if(l!=="u32"&&l!=="atomic<u32>")if(l!=="bool"){if(l==="vec2f"||l==="vec2h"){const c=new Float32Array(this.buffer,s,2);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1]))}if(l==="vec3f"||l==="vec3h"){const c=new Float32Array(this.buffer,s,3);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2]))}if(l==="vec4f"||l==="vec4h"){const c=new Float32Array(this.buffer,s,4);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3]))}if(l==="vec2i"){const c=new Int32Array(this.buffer,s,2);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1]))}if(l==="vec3i"){const c=new Int32Array(this.buffer,s,3);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2]))}if(l==="vec4i"){const c=new Int32Array(this.buffer,s,4);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3]))}if(l==="vec2u"){const c=new Uint32Array(this.buffer,s,2);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1]))}if(l==="vec3u"){const c=new Uint32Array(this.buffer,s,3);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2]))}if(l==="vec4u"){const c=new Uint32Array(this.buffer,s,4);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3]))}if(l==="vec2b"){const c=new Uint32Array(this.buffer,s,2);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1]))}if(l==="vec3b"){const c=new Uint32Array(this.buffer,s,3);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2]))}if(l==="vec4b"){const c=new Uint32Array(this.buffer,s,4);return void(t instanceof I?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3]))}if(l==="mat2x2f"||l==="mat2x2h"){const c=new Float32Array(this.buffer,s,4);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3]))}if(l==="mat2x3f"||l==="mat2x3h"){const c=new Float32Array(this.buffer,s,6);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5]))}if(l==="mat2x4f"||l==="mat2x4h"){const c=new Float32Array(this.buffer,s,8);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7]))}if(l==="mat3x2f"||l==="mat3x2h"){const c=new Float32Array(this.buffer,s,6);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5]))}if(l==="mat3x3f"||l==="mat3x3h"){const c=new Float32Array(this.buffer,s,9);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8]))}if(l==="mat3x4f"||l==="mat3x4h"){const c=new Float32Array(this.buffer,s,12);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11]))}if(l==="mat4x2f"||l==="mat4x2h"){const c=new Float32Array(this.buffer,s,8);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7]))}if(l==="mat4x3f"||l==="mat4x3h"){const c=new Float32Array(this.buffer,s,12);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11]))}if(l==="mat4x4f"||l==="mat4x4h"){const c=new Float32Array(this.buffer,s,16);return void(t instanceof Ce?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11],c[12]=t.data[12],c[13]=t.data[13],c[14]=t.data[14],c[15]=t.data[15]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15]))}if(t instanceof ut){if(i===t.typeInfo)return void new Uint8Array(this.buffer,s,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",l,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${l}`)}else t instanceof j&&(new Int32Array(this.buffer,s,1)[0]=t.value);else t instanceof j&&(new Uint32Array(this.buffer,s,1)[0]=t.value);else t instanceof j&&(new Int32Array(this.buffer,s,1)[0]=t.value);else t instanceof j&&(new Float32Array(this.buffer,s,1)[0]=t.value)}getSubData(e,t,i){var s,o,l;if(t===null)return this;let c=this.offset,f=this.typeInfo;for(;t;){if(t instanceof to){const p=t.index,_=p instanceof Ln?e.evalExpression(p,i):p;let y=0;if(_ instanceof j?y=_.value:typeof _=="number"?y=_:console.error("GetDataValue: Invalid index type",p),f instanceof rs)c+=y*f.stride,f=f.format;else{const v=f.getTypeName();v==="mat4x4"||v==="mat4x4f"||v==="mat4x4h"?(c+=16*y,f=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${f.getTypeName()} is not an array`)}}else{if(!(t instanceof js))return console.error("GetDataValue: Unknown postfix type",t),null;{const p=t.value;if(f instanceof es){let _=!1;for(const y of f.members)if(y.name===p){c+=y.offset,f=y.type,_=!0;break}if(!_)return console.error(`GetDataValue: Member ${p} not found`),null}else if(f instanceof Tn){const _=f.getTypeName();if(_==="vec2f"||_==="vec3f"||_==="vec4f"||_==="vec2i"||_==="vec3i"||_==="vec4i"||_==="vec2u"||_==="vec3u"||_==="vec4u"||_==="vec2b"||_==="vec3b"||_==="vec4b"||_==="vec2h"||_==="vec3h"||_==="vec4h"||_==="vec2"||_==="vec3"||_==="vec4"){if(p.length>0&&p.length<5){let y="f";const v=[];for(let x=0;x<p.length;++x){const S=p[x].toLowerCase();let M=0;if(S==="x"||S==="r")M=0;else if(S==="y"||S==="g")M=1;else if(S==="z"||S==="b")M=2;else{if(S!=="w"&&S!=="a")return console.error(`Unknown member ${p}`),null;M=3}if(p.length===1){if(_.endsWith("f"))return this.buffer.byteLength<c+4*M+4?(console.log("Insufficient buffer data"),null):new j(new Float32Array(this.buffer,c+4*M,1),e.getTypeInfo("f32"),this);if(_.endsWith("h"))return new j(new Float32Array(this.buffer,c+4*M,1),e.getTypeInfo("f16"),this);if(_.endsWith("i"))return new j(new Int32Array(this.buffer,c+4*M,1),e.getTypeInfo("i32"),this);if(_.endsWith("b"))return new j(new Int32Array(this.buffer,c+4*M,1),e.getTypeInfo("bool"),this);if(_.endsWith("u"))return new j(new Uint32Array(this.buffer,c+4*M,1),e.getTypeInfo("i32"),this)}if(_==="vec2f")v.push(new Float32Array(this.buffer,c,2)[M]);else if(_==="vec3f"){if(c+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const C=new Float32Array(this.buffer,c,3);v.push(C[M])}else if(_==="vec4f")v.push(new Float32Array(this.buffer,c,4)[M]);else if(_==="vec2i")y="i",v.push(new Int32Array(this.buffer,c,2)[M]);else if(_==="vec3i")y="i",v.push(new Int32Array(this.buffer,c,3)[M]);else if(_==="vec4i")y="i",v.push(new Int32Array(this.buffer,c,4)[M]);else if(_==="vec2u"){y="u";const C=new Uint32Array(this.buffer,c,2);v.push(C[M])}else _==="vec3u"?(y="u",v.push(new Uint32Array(this.buffer,c,3)[M])):_==="vec4u"&&(y="u",v.push(new Uint32Array(this.buffer,c,4)[M]))}return v.length===2?f=e.getTypeInfo(`vec2${y}`):v.length===3?f=e.getTypeInfo(`vec3${y}`):v.length===4?f=e.getTypeInfo(`vec4${y}`):console.error(`GetDataValue: Invalid vector length ${v.length}`),new I(v,f,null)}return console.error(`GetDataValue: Unknown member ${p}`),null}return console.error(`GetDataValue: Type ${_} is not a struct`),null}}}t=t.postfix}const d=f.getTypeName();return d==="f32"?new j(new Float32Array(this.buffer,c,1),f,this):d==="i32"?new j(new Int32Array(this.buffer,c,1),f,this):d==="u32"?new j(new Uint32Array(this.buffer,c,1),f,this):d==="vec2f"?new I(new Float32Array(this.buffer,c,2),f,this):d==="vec3f"?new I(new Float32Array(this.buffer,c,3),f,this):d==="vec4f"?new I(new Float32Array(this.buffer,c,4),f,this):d==="vec2i"?new I(new Int32Array(this.buffer,c,2),f,this):d==="vec3i"?new I(new Int32Array(this.buffer,c,3),f,this):d==="vec4i"?new I(new Int32Array(this.buffer,c,4),f,this):d==="vec2u"?new I(new Uint32Array(this.buffer,c,2),f,this):d==="vec3u"?new I(new Uint32Array(this.buffer,c,3),f,this):d==="vec4u"?new I(new Uint32Array(this.buffer,c,4),f,this):f instanceof zs&&f.name==="atomic"?((s=f.format)===null||s===void 0?void 0:s.name)==="u32"?new j(new Uint32Array(this.buffer,c,1)[0],f.format,this):((o=f.format)===null||o===void 0?void 0:o.name)==="i32"?new j(new Int32Array(this.buffer,c,1)[0],f.format,this):(console.error(`GetDataValue: Invalid atomic format ${(l=f.format)===null||l===void 0?void 0:l.name}`),null):new ut(this.buffer,f,c,this)}toString(){let e="";if(this.typeInfo instanceof rs)if(this.typeInfo.format.name==="f32"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="i32"){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="u32"){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let i=1;i<t.length;++i)e+=`, ${t[i]}`}else if(this.typeInfo.format.name==="vec2f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let i=1;i<t.length/2;++i)e+=`, [${t[2*i]}, ${t[2*i+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let i=4;i<t.length;i+=4)e+=`, [${t[i]}, ${t[i+1]}, ${t[i+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let i=4;i<t.length;i+=4)e+=`, [${t[i]}, ${t[i+1]}, ${t[i+2]}, ${t[i+3]}]`}else e="[...]";else this.typeInfo instanceof es?e+="{...}":e="[...]";return e}}class gi extends An{constructor(e,t,i,s){super(t,null),this.data=e,this.descriptor=i,this.view=s}clone(){return new gi(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>0?(e=i[0])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.width)!==null&&t!==void 0?t:0}get height(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>1?(e=i[1])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.height)!==null&&t!==void 0?t:0}get depthOrArrayLayers(){var e,t;const i=this.descriptor.size;return i instanceof Array&&i.length>2?(e=i[2])!==null&&e!==void 0?e:0:i instanceof Object&&(t=i.depthOrArrayLayers)!==null&&t!==void 0?t:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let i=0;i<t.length;++i)t[i]=Math.max(1,t[i]>>e);return t}get texelByteSize(){const e=this.format,t=Dd[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=Dd[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=Dd[e],i=this.width;if(!e||i<=0||!t)return-1;const s=this.height,o=this.depthOrArrayLayers,l=this.dimension;return i/t.blockWidth*(l==="1d"?1:s/t.blockHeight)*t.bytesPerBlock*o}getPixel(e,t,i=0,s=0){const o=this.texelByteSize,l=this.bytesPerRow,c=this.height,f=this.data[s];return UC(new Uint8Array(f),e,t,i,s,c,l,o,this.format)}setPixel(e,t,i,s,o){const l=this.texelByteSize,c=this.bytesPerRow,f=this.height,d=this.data[s];(function(p,_,y,v,x,S,M,C,U,R){const D=v*(M>>=x)*(S>>=x)+y*M+_*C;switch(U){case"r8unorm":return void Xe(p,D,"8unorm",1,R);case"r8snorm":return void Xe(p,D,"8snorm",1,R);case"r8uint":return void Xe(p,D,"8uint",1,R);case"r8sint":return void Xe(p,D,"8sint",1,R);case"rg8unorm":return void Xe(p,D,"8unorm",2,R);case"rg8snorm":return void Xe(p,D,"8snorm",2,R);case"rg8uint":return void Xe(p,D,"8uint",2,R);case"rg8sint":return void Xe(p,D,"8sint",2,R);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void Xe(p,D,"8unorm",4,R);case"rgba8snorm":return void Xe(p,D,"8snorm",4,R);case"rgba8uint":return void Xe(p,D,"8uint",4,R);case"rgba8sint":return void Xe(p,D,"8sint",4,R);case"r16uint":return void Xe(p,D,"16uint",1,R);case"r16sint":return void Xe(p,D,"16sint",1,R);case"r16float":return void Xe(p,D,"16float",1,R);case"rg16uint":return void Xe(p,D,"16uint",2,R);case"rg16sint":return void Xe(p,D,"16sint",2,R);case"rg16float":return void Xe(p,D,"16float",2,R);case"rgba16uint":return void Xe(p,D,"16uint",4,R);case"rgba16sint":return void Xe(p,D,"16sint",4,R);case"rgba16float":return void Xe(p,D,"16float",4,R);case"r32uint":return void Xe(p,D,"32uint",1,R);case"r32sint":return void Xe(p,D,"32sint",1,R);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void Xe(p,D,"32float",1,R);case"rg32uint":return void Xe(p,D,"32uint",2,R);case"rg32sint":return void Xe(p,D,"32sint",2,R);case"rg32float":return void Xe(p,D,"32float",2,R);case"rgba32uint":return void Xe(p,D,"32uint",4,R);case"rgba32sint":return void Xe(p,D,"32sint",4,R);case"rgba32float":return void Xe(p,D,"32float",4,R);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(d),e,t,i,s,f,c,l,this.format,o)}}(n=>{n[n.token=0]="token",n[n.keyword=1]="keyword",n[n.reserved=2]="reserved"})(V||(V={}));class H{constructor(e,t,i){this.name=e,this.type=t,this.rule=i}toString(){return this.name}}class E{}Y=E,E.none=new H("",V.reserved,""),E.eof=new H("EOF",V.token,""),E.reserved={asm:new H("asm",V.reserved,"asm"),bf16:new H("bf16",V.reserved,"bf16"),do:new H("do",V.reserved,"do"),enum:new H("enum",V.reserved,"enum"),f16:new H("f16",V.reserved,"f16"),f64:new H("f64",V.reserved,"f64"),handle:new H("handle",V.reserved,"handle"),i8:new H("i8",V.reserved,"i8"),i16:new H("i16",V.reserved,"i16"),i64:new H("i64",V.reserved,"i64"),mat:new H("mat",V.reserved,"mat"),premerge:new H("premerge",V.reserved,"premerge"),regardless:new H("regardless",V.reserved,"regardless"),typedef:new H("typedef",V.reserved,"typedef"),u8:new H("u8",V.reserved,"u8"),u16:new H("u16",V.reserved,"u16"),u64:new H("u64",V.reserved,"u64"),unless:new H("unless",V.reserved,"unless"),using:new H("using",V.reserved,"using"),vec:new H("vec",V.reserved,"vec"),void:new H("void",V.reserved,"void")},E.keywords={array:new H("array",V.keyword,"array"),atomic:new H("atomic",V.keyword,"atomic"),bool:new H("bool",V.keyword,"bool"),f32:new H("f32",V.keyword,"f32"),i32:new H("i32",V.keyword,"i32"),mat2x2:new H("mat2x2",V.keyword,"mat2x2"),mat2x3:new H("mat2x3",V.keyword,"mat2x3"),mat2x4:new H("mat2x4",V.keyword,"mat2x4"),mat3x2:new H("mat3x2",V.keyword,"mat3x2"),mat3x3:new H("mat3x3",V.keyword,"mat3x3"),mat3x4:new H("mat3x4",V.keyword,"mat3x4"),mat4x2:new H("mat4x2",V.keyword,"mat4x2"),mat4x3:new H("mat4x3",V.keyword,"mat4x3"),mat4x4:new H("mat4x4",V.keyword,"mat4x4"),ptr:new H("ptr",V.keyword,"ptr"),sampler:new H("sampler",V.keyword,"sampler"),sampler_comparison:new H("sampler_comparison",V.keyword,"sampler_comparison"),struct:new H("struct",V.keyword,"struct"),texture_1d:new H("texture_1d",V.keyword,"texture_1d"),texture_2d:new H("texture_2d",V.keyword,"texture_2d"),texture_2d_array:new H("texture_2d_array",V.keyword,"texture_2d_array"),texture_3d:new H("texture_3d",V.keyword,"texture_3d"),texture_cube:new H("texture_cube",V.keyword,"texture_cube"),texture_cube_array:new H("texture_cube_array",V.keyword,"texture_cube_array"),texture_multisampled_2d:new H("texture_multisampled_2d",V.keyword,"texture_multisampled_2d"),texture_storage_1d:new H("texture_storage_1d",V.keyword,"texture_storage_1d"),texture_storage_2d:new H("texture_storage_2d",V.keyword,"texture_storage_2d"),texture_storage_2d_array:new H("texture_storage_2d_array",V.keyword,"texture_storage_2d_array"),texture_storage_3d:new H("texture_storage_3d",V.keyword,"texture_storage_3d"),texture_depth_2d:new H("texture_depth_2d",V.keyword,"texture_depth_2d"),texture_depth_2d_array:new H("texture_depth_2d_array",V.keyword,"texture_depth_2d_array"),texture_depth_cube:new H("texture_depth_cube",V.keyword,"texture_depth_cube"),texture_depth_cube_array:new H("texture_depth_cube_array",V.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new H("texture_depth_multisampled_2d",V.keyword,"texture_depth_multisampled_2d"),texture_external:new H("texture_external",V.keyword,"texture_external"),u32:new H("u32",V.keyword,"u32"),vec2:new H("vec2",V.keyword,"vec2"),vec3:new H("vec3",V.keyword,"vec3"),vec4:new H("vec4",V.keyword,"vec4"),bitcast:new H("bitcast",V.keyword,"bitcast"),block:new H("block",V.keyword,"block"),break:new H("break",V.keyword,"break"),case:new H("case",V.keyword,"case"),continue:new H("continue",V.keyword,"continue"),continuing:new H("continuing",V.keyword,"continuing"),default:new H("default",V.keyword,"default"),diagnostic:new H("diagnostic",V.keyword,"diagnostic"),discard:new H("discard",V.keyword,"discard"),else:new H("else",V.keyword,"else"),enable:new H("enable",V.keyword,"enable"),fallthrough:new H("fallthrough",V.keyword,"fallthrough"),false:new H("false",V.keyword,"false"),fn:new H("fn",V.keyword,"fn"),for:new H("for",V.keyword,"for"),function:new H("function",V.keyword,"function"),if:new H("if",V.keyword,"if"),let:new H("let",V.keyword,"let"),const:new H("const",V.keyword,"const"),loop:new H("loop",V.keyword,"loop"),while:new H("while",V.keyword,"while"),private:new H("private",V.keyword,"private"),read:new H("read",V.keyword,"read"),read_write:new H("read_write",V.keyword,"read_write"),return:new H("return",V.keyword,"return"),requires:new H("requires",V.keyword,"requires"),storage:new H("storage",V.keyword,"storage"),switch:new H("switch",V.keyword,"switch"),true:new H("true",V.keyword,"true"),alias:new H("alias",V.keyword,"alias"),type:new H("type",V.keyword,"type"),uniform:new H("uniform",V.keyword,"uniform"),var:new H("var",V.keyword,"var"),override:new H("override",V.keyword,"override"),workgroup:new H("workgroup",V.keyword,"workgroup"),write:new H("write",V.keyword,"write"),r8unorm:new H("r8unorm",V.keyword,"r8unorm"),r8snorm:new H("r8snorm",V.keyword,"r8snorm"),r8uint:new H("r8uint",V.keyword,"r8uint"),r8sint:new H("r8sint",V.keyword,"r8sint"),r16uint:new H("r16uint",V.keyword,"r16uint"),r16sint:new H("r16sint",V.keyword,"r16sint"),r16float:new H("r16float",V.keyword,"r16float"),rg8unorm:new H("rg8unorm",V.keyword,"rg8unorm"),rg8snorm:new H("rg8snorm",V.keyword,"rg8snorm"),rg8uint:new H("rg8uint",V.keyword,"rg8uint"),rg8sint:new H("rg8sint",V.keyword,"rg8sint"),r32uint:new H("r32uint",V.keyword,"r32uint"),r32sint:new H("r32sint",V.keyword,"r32sint"),r32float:new H("r32float",V.keyword,"r32float"),rg16uint:new H("rg16uint",V.keyword,"rg16uint"),rg16sint:new H("rg16sint",V.keyword,"rg16sint"),rg16float:new H("rg16float",V.keyword,"rg16float"),rgba8unorm:new H("rgba8unorm",V.keyword,"rgba8unorm"),rgba8unorm_srgb:new H("rgba8unorm_srgb",V.keyword,"rgba8unorm_srgb"),rgba8snorm:new H("rgba8snorm",V.keyword,"rgba8snorm"),rgba8uint:new H("rgba8uint",V.keyword,"rgba8uint"),rgba8sint:new H("rgba8sint",V.keyword,"rgba8sint"),bgra8unorm:new H("bgra8unorm",V.keyword,"bgra8unorm"),bgra8unorm_srgb:new H("bgra8unorm_srgb",V.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new H("rgb10a2unorm",V.keyword,"rgb10a2unorm"),rg11b10float:new H("rg11b10float",V.keyword,"rg11b10float"),rg32uint:new H("rg32uint",V.keyword,"rg32uint"),rg32sint:new H("rg32sint",V.keyword,"rg32sint"),rg32float:new H("rg32float",V.keyword,"rg32float"),rgba16uint:new H("rgba16uint",V.keyword,"rgba16uint"),rgba16sint:new H("rgba16sint",V.keyword,"rgba16sint"),rgba16float:new H("rgba16float",V.keyword,"rgba16float"),rgba32uint:new H("rgba32uint",V.keyword,"rgba32uint"),rgba32sint:new H("rgba32sint",V.keyword,"rgba32sint"),rgba32float:new H("rgba32float",V.keyword,"rgba32float"),static_assert:new H("static_assert",V.keyword,"static_assert")},E.tokens={decimal_float_literal:new H("decimal_float_literal",V.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new H("hex_float_literal",V.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new H("int_literal",V.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new H("uint_literal",V.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new H("name",V.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new H("ident",V.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new H("and",V.token,"&"),and_and:new H("and_and",V.token,"&&"),arrow:new H("arrow ",V.token,"->"),attr:new H("attr",V.token,"@"),forward_slash:new H("forward_slash",V.token,"/"),bang:new H("bang",V.token,"!"),bracket_left:new H("bracket_left",V.token,"["),bracket_right:new H("bracket_right",V.token,"]"),brace_left:new H("brace_left",V.token,"{"),brace_right:new H("brace_right",V.token,"}"),colon:new H("colon",V.token,":"),comma:new H("comma",V.token,","),equal:new H("equal",V.token,"="),equal_equal:new H("equal_equal",V.token,"=="),not_equal:new H("not_equal",V.token,"!="),greater_than:new H("greater_than",V.token,">"),greater_than_equal:new H("greater_than_equal",V.token,">="),shift_right:new H("shift_right",V.token,">>"),less_than:new H("less_than",V.token,"<"),less_than_equal:new H("less_than_equal",V.token,"<="),shift_left:new H("shift_left",V.token,"<<"),modulo:new H("modulo",V.token,"%"),minus:new H("minus",V.token,"-"),minus_minus:new H("minus_minus",V.token,"--"),period:new H("period",V.token,"."),plus:new H("plus",V.token,"+"),plus_plus:new H("plus_plus",V.token,"++"),or:new H("or",V.token,"|"),or_or:new H("or_or",V.token,"||"),paren_left:new H("paren_left",V.token,"("),paren_right:new H("paren_right",V.token,")"),semicolon:new H("semicolon",V.token,";"),star:new H("star",V.token,"*"),tilde:new H("tilde",V.token,"~"),underscore:new H("underscore",V.token,"_"),xor:new H("xor",V.token,"^"),plus_equal:new H("plus_equal",V.token,"+="),minus_equal:new H("minus_equal",V.token,"-="),times_equal:new H("times_equal",V.token,"*="),division_equal:new H("division_equal",V.token,"/="),modulo_equal:new H("modulo_equal",V.token,"%="),and_equal:new H("and_equal",V.token,"&="),or_equal:new H("or_equal",V.token,"|="),xor_equal:new H("xor_equal",V.token,"^="),shift_right_equal:new H("shift_right_equal",V.token,">>="),shift_left_equal:new H("shift_left_equal",V.token,"<<=")},E.simpleTokens={"@":Y.tokens.attr,"{":Y.tokens.brace_left,"}":Y.tokens.brace_right,":":Y.tokens.colon,",":Y.tokens.comma,"(":Y.tokens.paren_left,")":Y.tokens.paren_right,";":Y.tokens.semicolon},E.literalTokens={"&":Y.tokens.and,"&&":Y.tokens.and_and,"->":Y.tokens.arrow,"/":Y.tokens.forward_slash,"!":Y.tokens.bang,"[":Y.tokens.bracket_left,"]":Y.tokens.bracket_right,"=":Y.tokens.equal,"==":Y.tokens.equal_equal,"!=":Y.tokens.not_equal,">":Y.tokens.greater_than,">=":Y.tokens.greater_than_equal,">>":Y.tokens.shift_right,"<":Y.tokens.less_than,"<=":Y.tokens.less_than_equal,"<<":Y.tokens.shift_left,"%":Y.tokens.modulo,"-":Y.tokens.minus,"--":Y.tokens.minus_minus,".":Y.tokens.period,"+":Y.tokens.plus,"++":Y.tokens.plus_plus,"|":Y.tokens.or,"||":Y.tokens.or_or,"*":Y.tokens.star,"~":Y.tokens.tilde,_:Y.tokens.underscore,"^":Y.tokens.xor,"+=":Y.tokens.plus_equal,"-=":Y.tokens.minus_equal,"*=":Y.tokens.times_equal,"/=":Y.tokens.division_equal,"%=":Y.tokens.modulo_equal,"&=":Y.tokens.and_equal,"|=":Y.tokens.or_equal,"^=":Y.tokens.xor_equal,">>=":Y.tokens.shift_right_equal,"<<=":Y.tokens.shift_left_equal},E.regexTokens={decimal_float_literal:Y.tokens.decimal_float_literal,hex_float_literal:Y.tokens.hex_float_literal,int_literal:Y.tokens.int_literal,uint_literal:Y.tokens.uint_literal,ident:Y.tokens.ident},E.storage_class=[Y.keywords.function,Y.keywords.private,Y.keywords.workgroup,Y.keywords.uniform,Y.keywords.storage],E.access_mode=[Y.keywords.read,Y.keywords.write,Y.keywords.read_write],E.sampler_type=[Y.keywords.sampler,Y.keywords.sampler_comparison],E.sampled_texture_type=[Y.keywords.texture_1d,Y.keywords.texture_2d,Y.keywords.texture_2d_array,Y.keywords.texture_3d,Y.keywords.texture_cube,Y.keywords.texture_cube_array],E.multisampled_texture_type=[Y.keywords.texture_multisampled_2d],E.storage_texture_type=[Y.keywords.texture_storage_1d,Y.keywords.texture_storage_2d,Y.keywords.texture_storage_2d_array,Y.keywords.texture_storage_3d],E.depth_texture_type=[Y.keywords.texture_depth_2d,Y.keywords.texture_depth_2d_array,Y.keywords.texture_depth_cube,Y.keywords.texture_depth_cube_array,Y.keywords.texture_depth_multisampled_2d],E.texture_external_type=[Y.keywords.texture_external],E.any_texture_type=[...Y.sampled_texture_type,...Y.multisampled_texture_type,...Y.storage_texture_type,...Y.depth_texture_type,...Y.texture_external_type],E.texel_format=[Y.keywords.r8unorm,Y.keywords.r8snorm,Y.keywords.r8uint,Y.keywords.r8sint,Y.keywords.r16uint,Y.keywords.r16sint,Y.keywords.r16float,Y.keywords.rg8unorm,Y.keywords.rg8snorm,Y.keywords.rg8uint,Y.keywords.rg8sint,Y.keywords.r32uint,Y.keywords.r32sint,Y.keywords.r32float,Y.keywords.rg16uint,Y.keywords.rg16sint,Y.keywords.rg16float,Y.keywords.rgba8unorm,Y.keywords.rgba8unorm_srgb,Y.keywords.rgba8snorm,Y.keywords.rgba8uint,Y.keywords.rgba8sint,Y.keywords.bgra8unorm,Y.keywords.bgra8unorm_srgb,Y.keywords.rgb10a2unorm,Y.keywords.rg11b10float,Y.keywords.rg32uint,Y.keywords.rg32sint,Y.keywords.rg32float,Y.keywords.rgba16uint,Y.keywords.rgba16sint,Y.keywords.rgba16float,Y.keywords.rgba32uint,Y.keywords.rgba32sint,Y.keywords.rgba32float],E.const_literal=[Y.tokens.int_literal,Y.tokens.uint_literal,Y.tokens.decimal_float_literal,Y.tokens.hex_float_literal,Y.keywords.true,Y.keywords.false],E.literal_or_ident=[Y.tokens.ident,Y.tokens.int_literal,Y.tokens.uint_literal,Y.tokens.decimal_float_literal,Y.tokens.hex_float_literal,Y.tokens.name],E.element_count_expression=[Y.tokens.int_literal,Y.tokens.uint_literal,Y.tokens.ident],E.template_types=[Y.keywords.vec2,Y.keywords.vec3,Y.keywords.vec4,Y.keywords.mat2x2,Y.keywords.mat2x3,Y.keywords.mat2x4,Y.keywords.mat3x2,Y.keywords.mat3x3,Y.keywords.mat3x4,Y.keywords.mat4x2,Y.keywords.mat4x3,Y.keywords.mat4x4,Y.keywords.atomic,Y.keywords.bitcast,...Y.any_texture_type],E.attribute_name=[Y.tokens.ident,Y.keywords.block,Y.keywords.diagnostic],E.assignment_operators=[Y.tokens.equal,Y.tokens.plus_equal,Y.tokens.minus_equal,Y.tokens.times_equal,Y.tokens.division_equal,Y.tokens.modulo_equal,Y.tokens.and_equal,Y.tokens.or_equal,Y.tokens.xor_equal,Y.tokens.shift_right_equal,Y.tokens.shift_left_equal],E.increment_operators=[Y.tokens.plus_plus,Y.tokens.minus_minus];class T_{constructor(e,t,i,s,o){this.type=e,this.lexeme=t,this.line=i,this.start=s,this.end=o}toString(){return this.lexeme}isTemplateType(){return E.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==E.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class WC{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new T_(E.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let l=1;for(;l>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),l--,l==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),l++)}return!0}}const t=E.simpleTokens[e];if(t)return this._addToken(t),!0;let i=E.none;const s=this._isAlpha(e),o=e==="_";if(this._isAlphaNumeric(e)){let l=this._peekAhead();for(;this._isAlphaNumeric(l);)e+=this._advance(),l=this._peekAhead()}if(s){const l=E.keywords[e];if(l)return this._addToken(l),!0}if(s||o)return this._addToken(E.tokens.ident),!0;for(;;){let l=this._findType(e);const c=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(c=="=")return this._current++,e+=c,this._addToken(E.tokens.minus_equal),!0;if(c=="-")return this._current++,e+=c,this._addToken(E.tokens.minus_minus),!0;const f=this._tokens.length-1;if((E.literal_or_ident.indexOf(this._tokens[f].type)!=-1||this._tokens[f].type==E.tokens.paren_right)&&c!=">")return this._addToken(l),!0}if(e==">"&&(c==">"||c=="=")){let f=!1,d=this._tokens.length-1;for(let p=0;p<5&&d>=0&&E.assignment_operators.indexOf(this._tokens[d].type)===-1;++p,--d)if(this._tokens[d].type===E.tokens.less_than){d>0&&this._tokens[d-1].isArrayOrTemplateType()&&(f=!0);break}if(f)return this._addToken(l),!0}if(l===E.none){let f=e,d=0;const p=2;for(let _=0;_<p;++_)if(f+=this._peekAhead(_),l=this._findType(f),l!==E.none){d=_;break}if(l===E.none)return i!==E.none&&(this._current--,this._addToken(i),!0);e=f,this._current+=d+1}if(i=l,this._isAtEnd())break;e+=this._advance()}return i!==E.none&&(this._addToken(i),!0)}_findType(e){for(const i in E.regexTokens){const s=E.regexTokens[i];if(this._match(e,s.rule))return s}return E.literalTokens[e]||E.none}_match(e,t){const i=t.exec(e);return i&&i.index==0&&i[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new T_(e,t,this._line,this._start,this._current))}}function pe(n){return Array.isArray(n)||n?.buffer instanceof ArrayBuffer}const Au=new Float32Array(1),XC=new Uint32Array(Au.buffer),YC=new Uint32Array(Au.buffer),Eu=new Int32Array(1),qC=new Float32Array(Eu.buffer),ZC=new Uint32Array(Eu.buffer),Cu=new Uint32Array(1),KC=new Float32Array(Cu.buffer),GC=new Int32Array(Cu.buffer);function w_(n,e,t){if(e===t)return n;if(e==="f32"){if(t==="i32"||t==="x32")return Au[0]=n,XC[0];if(t==="u32")return Au[0]=n,YC[0]}else if(e==="i32"||e==="x32"){if(t==="f32")return Eu[0]=n,qC[0];if(t==="u32")return Eu[0]=n,ZC[0]}else if(e==="u32"){if(t==="f32")return Cu[0]=n,KC[0];if(t==="i32"||t==="x32")return Cu[0]=n,GC[0]}return console.error(`Unsupported cast from ${e} to ${t}`),n}class QC{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class Nc{constructor(e,t){this.align=e,this.size=t}}class Yn{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new kC,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const t of e)t instanceof Xa&&this._functions.set(t.name,new QC(t));for(const t of e)if(t instanceof pi){const i=this.getTypeInfo(t,null);i instanceof es&&this.structs.push(i)}for(const t of e)if(t instanceof Ng)this.aliases.push(this._getAliasInfo(t));else{if(t instanceof Og){const i=t,s=this._getAttributeNum(i.attributes,"id",0),o=i.type!=null?this.getTypeInfo(i.type,i.attributes):null;this.overrides.push(new OC(i.name,o,i.attributes,s));continue}if(this._isUniformVar(t)){const i=t,s=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),l=this.getTypeInfo(i.type,i.attributes),c=new Ic(i.name,l,s,o,i.attributes,Qi.Uniform,i.access);c.access||(c.access="read"),this.uniforms.push(c);continue}if(this._isStorageVar(t)){const i=t,s=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),l=this.getTypeInfo(i.type,i.attributes),c=this._isStorageTexture(l),f=new Ic(i.name,l,s,o,i.attributes,c?Qi.StorageTexture:Qi.Storage,i.access);f.access||(f.access="read"),this.storage.push(f);continue}if(this._isTextureVar(t)){const i=t,s=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),l=this.getTypeInfo(i.type,i.attributes),c=this._isStorageTexture(l),f=new Ic(i.name,l,s,o,i.attributes,c?Qi.StorageTexture:Qi.Texture,i.access);f.access||(f.access="read"),c?this.storage.push(f):this.textures.push(f);continue}if(this._isSamplerVar(t)){const i=t,s=this._getAttributeNum(i.attributes,"group",0),o=this._getAttributeNum(i.attributes,"binding",0),l=this.getTypeInfo(i.type,i.attributes),c=new Ic(i.name,l,s,o,i.attributes,Qi.Sampler,i.access);this.samplers.push(c);continue}}for(const t of e)if(t instanceof Xa){const i=this._getAttribute(t,"vertex"),s=this._getAttribute(t,"fragment"),o=this._getAttribute(t,"compute"),l=i||s||o,c=new NC(t.name,l?.name,t.attributes);c.attributes=t.attributes,c.startLine=t.startLine,c.endLine=t.endLine,this.functions.push(c),this._functions.get(t.name).info=c,l&&(this._functions.get(t.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(t,!!l),c.inputs=this._getInputs(t.args),c.outputs=this._getOutputs(t.returnType),this.entry[l.name].push(c)),c.arguments=t.args.map(f=>new IC(f.name,this.getTypeInfo(f.type,f.attributes),f.attributes)),c.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null;continue}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(i=>{var s,o,l;if(i instanceof i8){if(i.value)if(pe(i.value))for(const c of i.value)for(const f of this.overrides)c===f.name&&((s=t.info)===null||s===void 0||s.overrides.push(f));else for(const c of this.overrides)i.value===c.name&&((o=t.info)===null||o===void 0||o.overrides.push(c))}else if(i instanceof un)for(const c of this.overrides)i.name===c.name&&((l=t.info)===null||l===void 0||l.overrides.push(c))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getFunctionInfo(e){for(const t of this.functions)if(t.name==e)return t;return null}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var i;for(const s of e.calls){const o=(i=this._functions.get(s.name))===null||i===void 0?void 0:i.info;o&&t.add(o)}}findResource(e,t,i){if(i){for(const s of this.entry.compute)if(s.name===i){for(const o of s.resources)if(o.group==e&&o.binding==t)return o}for(const s of this.entry.vertex)if(s.name===i){for(const o of s.resources)if(o.group==e&&o.binding==t)return o}for(const s of this.entry.fragment)if(s.name===i){for(const o of s.resources)if(o.group==e&&o.binding==t)return o}}for(const s of this.uniforms)if(s.group==e&&s.binding==t)return s;for(const s of this.storage)if(s.group==e&&s.binding==t)return s;for(const s of this.textures)if(s.group==e&&s.binding==t)return s;for(const s of this.samplers)if(s.group==e&&s.binding==t)return s;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const i=[],s=this,o=[];return e.search(l=>{if(l instanceof wu)o.push({});else if(l instanceof Su)o.pop();else if(l instanceof _i){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(l instanceof Wn){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type)}else if(l instanceof Ba){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type),o.length>0&&(o[o.length-1][c.name]=c)}else if(l instanceof un){const c=l;if(o.length>0&&o[o.length-1][c.name])return;const f=s._findResource(c.name);f&&i.push(f)}else if(l instanceof kg){const c=l,f=s._functions.get(c.name);f&&(t&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=s._findResources(f.node,t)),i.push(...f.resources))}else if(l instanceof Ig){const c=l,f=s._functions.get(c.name);f&&(t&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=s._findResources(f.node,t)),i.push(...f.resources))}}),[...new Map(i.map(l=>[l.name,l])).values()]}getBindGroups(){const e=[];function t(i,s){i>=e.length&&(e.length=i+1),e[i]===void 0&&(e[i]=[]),s>=e[i].length&&(e[i].length=s+1)}for(const i of this.uniforms)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.storage)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.textures)t(i.group,i.binding),e[i.group][i.binding]=i;for(const i of this.samplers)t(i.group,i.binding),e[i.group][i.binding]=i;return e}_getOutputs(e,t=void 0){if(t===void 0&&(t=[]),e instanceof pi)this._getStructOutputs(e,t);else{const i=this._getOutputInfo(e);i!==null&&t.push(i)}return t}_getStructOutputs(e,t){for(const i of e.members)if(i.type instanceof pi)this._getStructOutputs(i.type,t);else{const s=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(s!==null){const o=this.getTypeInfo(i.type,i.type.attributes),l=this._parseInt(s.value),c=new __(i.name,o,s.name,l);t.push(c)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const i=this.getTypeInfo(e,e.attributes),s=this._parseInt(t.value);return new __("",i,t.name,s)}return null}_getInputs(e,t=void 0){t===void 0&&(t=[]);for(const i of e)if(i.type instanceof pi)this._getStructInputs(i.type,t);else{const s=this._getInputInfo(i);s!==null&&t.push(s)}return t}_getStructInputs(e,t){for(const i of e.members)if(i.type instanceof pi)this._getStructInputs(i.type,t);else{const s=this._getInputInfo(i);s!==null&&t.push(s)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const i=this._getAttribute(e,"interpolation"),s=this.getTypeInfo(e.type,e.attributes),o=this._parseInt(t.value),l=new PC(e.name,s,t.name,o);return i!==null&&(l.interpolation=this._parseString(i.value)),l}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new MC(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof tu){const s=e.type?this.getTypeInfo(e.type,e.attributes):null,o=new Cp(e.name,s,t);return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ua){const s=e,o=s.format?this.getTypeInfo(s.format,s.attributes):null,l=new rs(s.name,t);return l.format=o,l.count=s.count,this._types.set(e,l),this._updateTypeInfo(l),l}if(e instanceof pi){const s=e,o=new es(s.name,t);o.startLine=s.startLine,o.endLine=s.endLine;for(const l of s.members){const c=this.getTypeInfo(l.type,l.attributes);o.members.push(new m_(l.name,c,l.attributes))}return this._types.set(e,o),this._updateTypeInfo(o),o}if(e instanceof Ma){const s=e,o=s.format instanceof re,l=s.format?o?this.getTypeInfo(s.format,null):new Tn(s.format,null):null,c=new zs(s.name,l,t,s.access);return this._types.set(e,c),this._updateTypeInfo(c),c}if(e instanceof W){const s=e,o=s.format?this.getTypeInfo(s.format,null):null,l=new zs(s.name,o,t,s.access);return this._types.set(e,l),this._updateTypeInfo(l),l}const i=new Tn(e.name,t);return this._types.set(e,i),this._updateTypeInfo(i),i}_updateTypeInfo(e){var t,i,s;const o=this._getTypeSize(e);if(e.size=(t=o?.size)!==null&&t!==void 0?t:0,e instanceof rs&&e.format){const l=this._getTypeSize(e.format);e.stride=Math.max((i=l?.size)!==null&&i!==void 0?i:0,(s=l?.align)!==null&&s!==void 0?s:0),this._updateTypeInfo(e.format)}e instanceof Cp&&this._updateTypeInfo(e.format),e instanceof es&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let i=0,s=0,o=0,l=0;for(let c=0,f=e.members.length;c<f;++c){const d=e.members[c],p=this._getTypeSize(d);if(!p)continue;(t=this._getAlias(d.type.name))!==null&&t!==void 0||d.type;const _=p.align,y=p.size;i=this._roundUp(_,i+s),s=y,o=i,l=Math.max(l,_),d.offset=i,d.size=y,this._updateTypeInfo(d.type)}e.size=this._roundUp(l,o+s),e.align=l}_getTypeSize(e){var t,i;if(e==null)return null;const s=this._getAttributeNum(e.attributes,"size",0),o=this._getAttributeNum(e.attributes,"align",0);if(e instanceof m_&&(e=e.type),e instanceof Tn){const l=this._getAlias(e.name);l!==null&&(e=l)}{const l=Yn._typeInfo[e.name];if(l!==void 0){const c=((t=e.format)===null||t===void 0?void 0:t.name)==="f16"?2:1;return new Nc(Math.max(o,l.align/c),Math.max(s,l.size/c))}}{const l=Yn._typeInfo[e.name.substring(0,e.name.length-1)];if(l){const c=e.name[e.name.length-1]==="h"?2:1;return new Nc(Math.max(o,l.align/c),Math.max(s,l.size/c))}}if(e instanceof rs){let l=e,c=8,f=8;const d=this._getTypeSize(l.format);return d!==null&&(f=d.size,c=d.align),f=l.count*this._getAttributeNum((i=e?.attributes)!==null&&i!==void 0?i:null,"stride",this._roundUp(c,f)),s&&(f=s),new Nc(Math.max(o,c),Math.max(s,f))}if(e instanceof es){let l=0,c=0,f=0,d=0,p=0;for(const _ of e.members){const y=this._getTypeSize(_.type);y!==null&&(l=Math.max(y.align,l),f=this._roundUp(y.align,f+d),d=y.size,p=f)}return c=this._roundUp(l,p+d),new Nc(Math.max(o,l),Math.max(s,c))}return null}_isUniformVar(e){return e instanceof _i&&e.storage=="uniform"}_isStorageVar(e){return e instanceof _i&&e.storage=="storage"}_isTextureVar(e){return e instanceof _i&&e.type!==null&&Yn._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof _i&&e.type!==null&&Yn._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,t){const i=e;if(!i||!i.attributes)return null;const s=i.attributes;for(let o of s)if(o.name==t)return o;return null}_getAttributeNum(e,t,i){if(e===null)return i;for(let s of e)if(s.name==t){let o=s!==null&&s.value!==null?s.value:i;return o instanceof Array&&(o=o[0]),typeof o=="number"?o:typeof o=="string"?parseInt(o):i}return i}_roundUp(e,t){return Math.ceil(t/e)*e}}Yn._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},Yn._textureTypes=E.any_texture_type.map(n=>n.name),Yn._samplerTypes=E.sampler_type.map(n=>n.name);let Dg=0;class Lg{constructor(e,t,i){this.id=Dg++,this.name=e,this.value=t,this.node=i}clone(){return new Lg(this.name,this.value,this.node)}}class Bg{constructor(e){this.id=Dg++,this.name=e.name,this.node=e}clone(){return new Bg(this.node)}}class Ug{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",this.id=Dg++,e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?(t=this.variables.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?(t=this.functions.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,i){this.variables.set(e,new Lg(e,t,i??null))}setVariable(e,t,i){const s=this.getVariable(e);s!==null?s.value=t:this.createVariable(e,t,i)}getVariableValue(e){var t;const i=this.getVariable(e);return(t=i?.value)!==null&&t!==void 0?t:null}clone(){return new Ug(this)}}class JC{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class e5{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const i=this.exec.evalExpression(e.args[0],t);let s=!0;if(i instanceof I)return i.data.forEach(o=>{o||(s=!1)}),new j(s?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I){const s=i.data.some(o=>o);return new j(s?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const i=this.exec.evalExpression(e.args[2],t);if(!(i instanceof j))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return i.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.evalExpression(i,t);if(s instanceof ut&&s.typeInfo.size===0){const o=s.typeInfo,l=s.buffer.byteLength/o.stride;return new j(l,this.getTypeInfo("u32"))}return new j(s.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.abs(o)),i.typeInfo);const s=i;return new j(Math.abs(s.value),s.typeInfo)}Acos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.acos(o)),i.typeInfo);const s=i;return new j(Math.acos(s.value),i.typeInfo)}Acosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.acosh(o)),i.typeInfo);const s=i;return new j(Math.acosh(s.value),i.typeInfo)}Asin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.asin(o)),i.typeInfo);const s=i;return new j(Math.asin(s.value),i.typeInfo)}Asinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.asinh(o)),i.typeInfo);const s=i;return new j(Math.asinh(s.value),i.typeInfo)}Atan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.atan(o)),i.typeInfo);const s=i;return new j(Math.atan(s.value),i.typeInfo)}Atanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.atanh(o)),i.typeInfo);const s=i;return new j(Math.atanh(s.value),i.typeInfo)}Atan2(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I)return new I(i.data.map((c,f)=>Math.atan2(c,s.data[f])),i.typeInfo);const o=i,l=s;return new j(Math.atan2(o.value,l.value),i.typeInfo)}Ceil(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.ceil(o)),i.typeInfo);const s=i;return new j(Math.ceil(s.value),i.typeInfo)}_clamp(e,t,i){return Math.min(Math.max(e,t),i)}Clamp(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(i instanceof I&&s instanceof I&&o instanceof I)return new I(i.data.map((d,p)=>this._clamp(d,s.data[p],o.data[p])),i.typeInfo);const l=i,c=s,f=o;return new j(this._clamp(l.value,c.value,f.value),i.typeInfo)}Cos(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.cos(o)),i.typeInfo);const s=i;return new j(Math.cos(s.value),i.typeInfo)}Cosh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.cosh(o)),i.typeInfo);const s=i;return new j(Math.cos(s.value),i.typeInfo)}CountLeadingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.clz32(o)),i.typeInfo);const s=i;return new j(Math.clz32(s.value),i.typeInfo)}_countOneBits(e){let t=0;for(;e!==0;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>this._countOneBits(o)),i.typeInfo);const s=i;return new j(this._countOneBits(s.value),i.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>this._countTrailingZeros(o)),i.typeInfo);const s=i;return new j(this._countTrailingZeros(s.value),i.typeInfo)}Cross(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I){if(i.data.length!==3||s.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const o=i.data,l=s.data;return new I([o[1]*l[2]-l[1]*o[2],o[2]*l[0]-l[2]*o[0],o[0]*l[1]-l[0]*o[1]],i.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const i=this.exec.evalExpression(e.args[0],t),s=180/Math.PI;return i instanceof I?new I(i.data.map(o=>o*s),i.typeInfo):new j(i.value*s,this.getTypeInfo("f32"))}Determinant(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof Ce){const s=i.data,o=i.typeInfo.getTypeName(),l=o.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(o==="mat2x2"||o==="mat2x2f"||o==="mat2x2h")return new j(s[0]*s[3]-s[1]*s[2],l);if(o==="mat2x3"||o==="mat2x3f"||o==="mat2x3h")return new j(s[0]*(s[4]*s[8]-s[5]*s[7])-s[1]*(s[3]*s[8]-s[5]*s[6])+s[2]*(s[3]*s[7]-s[4]*s[6]),l);if(o==="mat2x4"||o==="mat2x4f"||o==="mat2x4h")console.error(`TODO: Determinant for ${o}`);else if(o==="mat3x2"||o==="mat3x2f"||o==="mat3x2h")console.error(`TODO: Determinant for ${o}`);else{if(o==="mat3x3"||o==="mat3x3f"||o==="mat3x3h")return new j(s[0]*(s[4]*s[8]-s[5]*s[7])-s[1]*(s[3]*s[8]-s[5]*s[6])+s[2]*(s[3]*s[7]-s[4]*s[6]),l);o==="mat3x4"||o==="mat3x4f"||o==="mat3x4h"||o==="mat4x2"||o==="mat4x2f"||o==="mat4x2h"||o==="mat4x3"||o==="mat4x3f"||o==="mat4x3h"?console.error(`TODO: Determinant for ${o}`):o!=="mat4x4"&&o!=="mat4x4f"&&o!=="mat4x4h"||console.error(`TODO: Determinant for ${o}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I){let c=0;for(let f=0;f<i.data.length;++f)c+=(i.data[f]-s.data[f])*(i.data[f]-s.data[f]);return new j(Math.sqrt(c),this.getTypeInfo("f32"))}const o=i,l=s;return new j(Math.abs(o.value-l.value),i.typeInfo)}_dot(e,t){let i=0;for(let s=0;s<e.length;++s)i+=t[s]*e[s];return i}Dot(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);return i instanceof I&&s instanceof I?new j(this._dot(i.data,s.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.exp(o)),i.typeInfo);const s=i;return new j(Math.exp(s.value),i.typeInfo)}Exp2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.pow(2,o)),i.typeInfo);const s=i;return new j(Math.pow(2,s.value),i.typeInfo)}ExtractBits(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(s.typeInfo.name!=="u32"&&s.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(o.typeInfo.name!=="u32"&&o.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const l=s.value,c=o.value;if(i instanceof I)return new I(i.data.map(d=>d>>l&(1<<c)-1),i.typeInfo);if(i.typeInfo.name!=="i32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const f=i.value;return new j(f>>l&(1<<c)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(i instanceof I&&s instanceof I&&o instanceof I){const l=this._dot(s.data,o.data);return new I(l<0?Array.from(i.data):i.data.map(c=>-c),i.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>this._firstLeadingBit(o)),i.typeInfo);const s=i;return new j(this._firstLeadingBit(s.value),i.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>this._firstTrailingBit(o)),i.typeInfo);const s=i;return new j(this._firstTrailingBit(s.value),i.typeInfo)}Floor(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.floor(o)),i.typeInfo);const s=i;return new j(Math.floor(s.value),i.typeInfo)}Fma(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(i instanceof I&&s instanceof I&&o instanceof I)return i.data.length!==s.data.length||i.data.length!==o.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new I(i.data.map((d,p)=>d*s.data[p]+o.data[p]),i.typeInfo);const l=i,c=s,f=o;return new j(l.value*c.value+f.value,l.typeInfo)}Fract(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>o-Math.floor(o)),i.typeInfo);const s=i;return new j(s.value-Math.floor(s.value),i.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t),l=this.exec.evalExpression(e.args[3],t);if(o.typeInfo.name!=="u32"&&o.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const c=o.value,f=(1<<l.value)-1<<c,d=~f;if(i instanceof I&&s instanceof I)return new I(i.data.map((y,v)=>y&d|s.data[v]<<c&f),i.typeInfo);const p=i.value,_=s.value;return new j(p&d|_<<c&f,i.typeInfo)}InverseSqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>1/Math.sqrt(o)),i.typeInfo);const s=i;return new j(1/Math.sqrt(s.value),i.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I){let o=0;return i.data.forEach(l=>{o+=l*l}),new j(Math.sqrt(o),this.getTypeInfo("f32"))}const s=i;return new j(Math.abs(s.value),i.typeInfo)}Log(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.log(o)),i.typeInfo);const s=i;return new j(Math.log(s.value),i.typeInfo)}Log2(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.log2(o)),i.typeInfo);const s=i;return new j(Math.log2(s.value),i.typeInfo)}Max(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I)return new I(i.data.map((c,f)=>Math.max(c,s.data[f])),i.typeInfo);const o=i,l=s;return new j(Math.max(o.value,l.value),i.typeInfo)}Min(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I)return new I(i.data.map((c,f)=>Math.min(c,s.data[f])),i.typeInfo);const o=i,l=s;return new j(Math.min(o.value,l.value),i.typeInfo)}Mix(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(i instanceof I&&s instanceof I&&o instanceof I)return new I(i.data.map((f,d)=>i.data[d]*(1-o.data[d])+s.data[d]*o.data[d]),i.typeInfo);const l=s,c=o;return new j(i.value*(1-c.value)+l.value*c.value,i.typeInfo)}Modf(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I)return new I(i.data.map((l,c)=>l%s.data[c]),i.typeInfo);const o=s;return new j(i.value%o.value,i.typeInfo)}Normalize(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I){const s=this.Length(e,t).value;return new I(i.data.map(o=>o/s),i.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I)return new I(i.data.map((c,f)=>Math.pow(c,s.data[f])),i.typeInfo);const o=i,l=s;return new j(Math.pow(o.value,l.value),i.typeInfo)}QuantizeToF16(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof I?new I(i.data.map(s=>s),i.typeInfo):new j(i.value,i.typeInfo)}Radians(e,t){const i=this.exec.evalExpression(e.args[0],t);return i instanceof I?new I(i.data.map(s=>s*Math.PI/180),i.typeInfo):new j(i.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(i instanceof I&&s instanceof I){const o=this._dot(i.data,s.data);return new I(i.data.map((l,c)=>l-2*o*s.data[c]),i.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(i instanceof I&&s instanceof I&&o instanceof j){const l=this._dot(s.data,i.data);return new I(i.data.map((c,f)=>{const d=1-o.value*o.value*(1-l*l);if(d<0)return 0;const p=Math.sqrt(d);return o.value*c-(o.value*l+p)*s.data[f]}),i.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.round(o)),i.typeInfo);const s=i;return new j(Math.round(s.value),i.typeInfo)}Saturate(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.min(Math.max(o,0),1)),i.typeInfo);const s=i;return new j(Math.min(Math.max(s.value,0),1),i.typeInfo)}Sign(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.sign(o)),i.typeInfo);const s=i;return new j(Math.sign(s.value),i.typeInfo)}Sin(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.sin(o)),i.typeInfo);const s=i;return new j(Math.sin(s.value),i.typeInfo)}Sinh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.sinh(o)),i.typeInfo);const s=i;return new j(Math.sinh(s.value),i.typeInfo)}_smoothstep(e,t,i){const s=Math.min(Math.max((i-e)/(t-e),0),1);return s*s*(3-2*s)}SmoothStep(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t),o=this.exec.evalExpression(e.args[2],t);if(o instanceof I&&i instanceof I&&s instanceof I)return new I(o.data.map((d,p)=>this._smoothstep(i.data[p],s.data[p],d)),o.typeInfo);const l=i,c=s,f=o;return new j(this._smoothstep(l.value,c.value,f.value),o.typeInfo)}Sqrt(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.sqrt(o)),i.typeInfo);const s=i;return new j(Math.sqrt(s.value),i.typeInfo)}Step(e,t){const i=this.exec.evalExpression(e.args[0],t),s=this.exec.evalExpression(e.args[1],t);if(s instanceof I&&i instanceof I)return new I(s.data.map((l,c)=>l<i.data[c]?0:1),s.typeInfo);const o=i;return new j(s.value<o.value?0:1,o.typeInfo)}Tan(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.tan(o)),i.typeInfo);const s=i;return new j(Math.tan(s.value),i.typeInfo)}Tanh(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.tanh(o)),i.typeInfo);const s=i;return new j(Math.tanh(s.value),i.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return t==="mat2x2f"||t==="mat2x2h"?e:t==="mat2x3f"?this.getTypeInfo("mat3x2f"):t==="mat2x3h"?this.getTypeInfo("mat3x2h"):t==="mat2x4f"?this.getTypeInfo("mat4x2f"):t==="mat2x4h"?this.getTypeInfo("mat4x2h"):t==="mat3x2f"?this.getTypeInfo("mat2x3f"):t==="mat3x2h"?this.getTypeInfo("mat2x3h"):t==="mat3x3f"||t==="mat3x3h"?e:t==="mat3x4f"?this.getTypeInfo("mat4x3f"):t==="mat3x4h"?this.getTypeInfo("mat4x3h"):t==="mat4x2f"?this.getTypeInfo("mat2x4f"):t==="mat4x2h"?this.getTypeInfo("mat2x4h"):t==="mat4x3f"?this.getTypeInfo("mat3x4f"):t==="mat4x3h"?this.getTypeInfo("mat3x4h"):(t==="mat4x4f"||t==="mat4x4h"||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const i=this.exec.evalExpression(e.args[0],t);if(!(i instanceof Ce))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const s=this._getTransposeType(i.typeInfo);if(i.typeInfo.name==="mat2x2"||i.typeInfo.name==="mat2x2f"||i.typeInfo.name==="mat2x2h"){const o=i.data;return new Ce([o[0],o[2],o[1],o[3]],s)}if(i.typeInfo.name==="mat2x3"||i.typeInfo.name==="mat2x3f"||i.typeInfo.name==="mat2x3h"){const o=i.data;return new Ce([o[0],o[3],o[6],o[1],o[4],o[7]],s)}if(i.typeInfo.name==="mat2x4"||i.typeInfo.name==="mat2x4f"||i.typeInfo.name==="mat2x4h"){const o=i.data;return new Ce([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13]],s)}if(i.typeInfo.name==="mat3x2"||i.typeInfo.name==="mat3x2f"||i.typeInfo.name==="mat3x2h"){const o=i.data;return new Ce([o[0],o[3],o[1],o[4],o[2],o[5]],s)}if(i.typeInfo.name==="mat3x3"||i.typeInfo.name==="mat3x3f"||i.typeInfo.name==="mat3x3h"){const o=i.data;return new Ce([o[0],o[3],o[6],o[1],o[4],o[7],o[2],o[5],o[8]],s)}if(i.typeInfo.name==="mat3x4"||i.typeInfo.name==="mat3x4f"||i.typeInfo.name==="mat3x4h"){const o=i.data;return new Ce([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14]],s)}if(i.typeInfo.name==="mat4x2"||i.typeInfo.name==="mat4x2f"||i.typeInfo.name==="mat4x2h"){const o=i.data;return new Ce([o[0],o[4],o[1],o[5],o[2],o[6]],s)}if(i.typeInfo.name==="mat4x3"||i.typeInfo.name==="mat4x3f"||i.typeInfo.name==="mat4x3h"){const o=i.data;return new Ce([o[0],o[4],o[8],o[1],o[5],o[9],o[2],o[6],o[10]],s)}if(i.typeInfo.name==="mat4x4"||i.typeInfo.name==="mat4x4f"||i.typeInfo.name==="mat4x4h"){const o=i.data;return new Ce([o[0],o[4],o[8],o[12],o[1],o[5],o[9],o[13],o[2],o[6],o[10],o[14],o[3],o[7],o[11],o[15]],s)}return console.error(`Invalid matrix type ${i.typeInfo.name}`),null}Trunc(e,t){const i=this.exec.evalExpression(e.args[0],t);if(i instanceof I)return new I(i.data.map(o=>Math.trunc(o)),i.typeInfo);const s=i;return new j(Math.trunc(s.value),i.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const i=e.args[0],s=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(i instanceof un){const o=i.name,l=t.getVariableValue(o);if(l instanceof gi){if(s<0||s>=l.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const c=l.getMipLevelSize(s),f=l.dimension;return f==="1d"?new j(c[0],this.getTypeInfo("u32")):f==="3d"?new I(c,this.getTypeInfo("vec3u")):f==="2d"?new I(c.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${f} not found. Line ${e.line}`),null)}return console.error(`Texture ${o} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const i=e.args[0],s=this.exec.evalExpression(e.args[1],t),o=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(s instanceof I)||s.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(i instanceof un){const l=i.name,c=t.getVariableValue(l);if(c instanceof gi){const f=Math.floor(s.data[0]),d=Math.floor(s.data[1]);if(f<0||f>=c.width||d<0||d>=c.height)return console.error(`Texture ${l} out of bounds. Line ${e.line}`),null;const p=c.getPixel(f,d,0,o);return p===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new I(p,this.getTypeInfo("vec4f"))}return console.error(`Texture ${l} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const i=e.args[0];if(i instanceof un){const s=i.name,o=t.getVariableValue(s);return o instanceof gi?new j(o.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const i=e.args[0];if(i instanceof un){const s=i.name,o=t.getVariableValue(s);return o instanceof gi?new j(o.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const i=e.args[0];if(i instanceof un){const s=i.name,o=t.getVariableValue(s);return o instanceof gi?new j(o.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${s} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const i=e.args[0],s=this.exec.evalExpression(e.args[1],t),o=e.args.length===4?this.exec.evalExpression(e.args[2],t).value:0,l=e.args.length===4?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(l.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(s instanceof I)||s.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(i instanceof un){const c=i.name,f=t.getVariableValue(c);if(f instanceof gi){const d=f.getMipLevelSize(0),p=Math.floor(s.data[0]),_=Math.floor(s.data[1]);return p<0||p>=d[0]||_<0||_>=d[1]?(console.error(`Texture ${c} out of bounds. Line ${e.line}`),null):(f.setPixel(p,_,0,o,Array.from(l)),null)}return console.error(`Texture ${c} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t);return t.getVariable(s).value.getSubData(this.exec,i.postfix,t)}AtomicStore(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t);return f instanceof j&&c instanceof j&&(f.value=c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),null}AtomicAdd(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value+=c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicSub(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value-=c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicMax(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=Math.max(f.value,c.value)),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicMin(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=Math.min(f.value,c.value)),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicAnd(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=f.value&c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicOr(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=f.value|c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicXor(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=f.value^c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicExchange(e,t){let i=e.args[0];i instanceof mt&&(i=i.right);const s=this.exec.getVariableName(i,t),o=t.getVariable(s);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=o.value.getSubData(this.exec,i.postfix,t),d=new j(f.value,f.typeInfo);return f instanceof j&&c instanceof j&&(f.value=c.value),o.value instanceof ut&&o.value.setDataValue(this.exec,f,i.postfix,t),d}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const Ld={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},jt={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class Ut extends JC{constructor(e,t){var i;super(),this.ast=e??[],this.reflection=new Yn,this.reflection.updateAST(this.ast),this.context=(i=t?.clone())!==null&&i!==void 0?i:new Ug,this.builtins=new e5(this),this.typeInfo={bool:this.getTypeInfo(re.bool),i32:this.getTypeInfo(re.i32),u32:this.getTypeInfo(re.u32),f32:this.getTypeInfo(re.f32),f16:this.getTypeInfo(re.f16),vec2f:this.getTypeInfo(W.vec2f),vec2u:this.getTypeInfo(W.vec2u),vec2i:this.getTypeInfo(W.vec2i),vec2h:this.getTypeInfo(W.vec2h),vec3f:this.getTypeInfo(W.vec3f),vec3u:this.getTypeInfo(W.vec3u),vec3i:this.getTypeInfo(W.vec3i),vec3h:this.getTypeInfo(W.vec3h),vec4f:this.getTypeInfo(W.vec4f),vec4u:this.getTypeInfo(W.vec4u),vec4i:this.getTypeInfo(W.vec4i),vec4h:this.getTypeInfo(W.vec4h),mat2x2f:this.getTypeInfo(W.mat2x2f),mat2x3f:this.getTypeInfo(W.mat2x3f),mat2x4f:this.getTypeInfo(W.mat2x4f),mat3x2f:this.getTypeInfo(W.mat3x2f),mat3x3f:this.getTypeInfo(W.mat3x3f),mat3x4f:this.getTypeInfo(W.mat3x4f),mat4x2f:this.getTypeInfo(W.mat4x2f),mat4x3f:this.getTypeInfo(W.mat4x3f),mat4x4f:this.getTypeInfo(W.mat4x4f)}}getVariableValue(e){var t,i;const s=(i=(t=this.context.getVariable(e))===null||t===void 0?void 0:t.value)!==null&&i!==void 0?i:null;if(s===null)return null;if(s instanceof j)return s.value;if(s instanceof I||s instanceof Ce)return Array.from(s.data);if(s instanceof ut&&s.typeInfo instanceof rs){if(s.typeInfo.format.name==="u32")return Array.from(new Uint32Array(s.buffer,s.offset,s.typeInfo.count));if(s.typeInfo.format.name==="i32")return Array.from(new Int32Array(s.buffer,s.offset,s.typeInfo.count));if(s.typeInfo.format.name==="f32")return Array.from(new Float32Array(s.buffer,s.offset,s.typeInfo.count))}return console.error(`Unsupported return variable type ${s.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,i,s){const o=this.context.clone();(s=s??{}).constants&&this._setOverrides(s.constants,o),this._execStatements(this.ast,o);const l=o.getFunction(e);if(!l)return void console.error(`Function ${e} not found`);if(typeof t=="number")t=[t,1,1];else{if(t.length===0)return void console.error("Invalid dispatch count");t.length===1?t=[t[0],1,1]:t.length===2?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const c=t[0],f=t[1],d=t[2],p=this.getTypeInfo("vec3u");o.setVariable("@num_workgroups",new I(t,p));const _=this.reflection.getFunctionInfo(e);_===null&&console.error(`Function ${e} not found in reflection data`);for(const y in i)for(const v in i[y]){const x=i[y][v];o.variables.forEach(S=>{var M;const C=S.node;if(C?.attributes){let U=null,R=null;for(const D of C.attributes)D.name==="binding"?U=D.value:D.name==="group"&&(R=D.value);if(v==U&&y==R){let D=!1;for(const B of _.resources)if(B.name===S.name&&B.group===parseInt(y)&&B.binding===parseInt(v)){D=!0;break}if(D)if(x.texture!==void 0&&x.descriptor!==void 0){const B=new gi(x.texture,this.getTypeInfo(C.type),x.descriptor,(M=x.texture.view)!==null&&M!==void 0?M:null);S.value=B}else x.uniform!==void 0?S.value=new ut(x.uniform,this.getTypeInfo(C.type)):S.value=new ut(x,this.getTypeInfo(C.type))}}})}for(let y=0;y<d;++y)for(let v=0;v<f;++v)for(let x=0;x<c;++x)o.setVariable("@workgroup_id",new I([x,v,y],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(l,[x,v,y],o)}execStatement(e,t){if(e instanceof Yb)return this.evalExpression(e.value,t);if(e instanceof Zb){if(e.condition){const i=this.evalExpression(e.condition,t);if(!(i instanceof j))throw new Error("Invalid break-if condition");if(!i.value)return null}return Ut._breakObj}if(e instanceof Kb)return Ut._continueObj;if(e instanceof Ba)this._let(e,t);else if(e instanceof _i)this._var(e,t);else if(e instanceof eu)this._const(e,t);else if(e instanceof Xa)this._function(e,t);else{if(e instanceof Xb)return this._if(e,t);if(e instanceof Wb)return this._switch(e,t);if(e instanceof jb)return this._for(e,t);if(e instanceof zb)return this._while(e,t);if(e instanceof $b)return this._loop(e,t);if(e instanceof Rp){const i=t.clone();return i.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,i)}if(e instanceof Hb)this._assign(e,t);else if(e instanceof Vb)this._increment(e,t);else{if(e instanceof pi)return null;if(e instanceof Og){const i=e.name;t.getVariable(i)===null&&t.setVariable(i,new j(0,this.getTypeInfo("u32")))}else if(e instanceof Ig)this._call(e,t);else{if(e instanceof qb||e instanceof Ng)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof On?this._evalBinaryOp(e,t):e instanceof xt?this._evalLiteral(e,t):e instanceof un?this._evalVariable(e,t):e instanceof kg?this._evalCall(e,t):e instanceof Wn?this._evalCreate(e,t):e instanceof Gb?this._evalConst(e,t):e instanceof Qb?this._evalBitcast(e,t):e instanceof mt?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof re){const s=this.reflection.getTypeInfo(e);if(s!==null)return s}let i=(t=this.typeInfo[e])!==null&&t!==void 0?t:null;return i!==null||(i=this.reflection.getTypeInfoByName(e)),i}_setOverrides(e,t){for(const i in e){const s=e[i],o=this.reflection.getOverrideInfo(i);o!==null?(o.type===null&&(o.type=this.getTypeInfo("u32")),o.type.name==="u32"||o.type.name==="i32"||o.type.name==="f32"||o.type.name==="f16"?t.setVariable(i,new j(s,o.type)):o.type.name==="bool"?t.setVariable(i,new j(s?1:0,o.type)):o.type.name==="vec2"||o.type.name==="vec3"||o.type.name==="vec4"||o.type.name==="vec2f"||o.type.name==="vec3f"||o.type.name==="vec4f"||o.type.name==="vec2i"||o.type.name==="vec3i"||o.type.name==="vec4i"||o.type.name==="vec2u"||o.type.name==="vec3u"||o.type.name==="vec4u"||o.type.name==="vec2h"||o.type.name==="vec3h"||o.type.name==="vec4h"?t.setVariable(i,new I(s,o.type)):console.error(`Invalid constant type for ${i}`)):console.error(`Override ${i} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,i){const s=[1,1,1];for(const p of e.node.attributes)if(p.name==="workgroup_size"){if(p.value.length>0){const _=i.getVariableValue(p.value[0]);s[0]=_ instanceof j?_.value:parseInt(p.value[0])}if(p.value.length>1){const _=i.getVariableValue(p.value[1]);s[1]=_ instanceof j?_.value:parseInt(p.value[1])}if(p.value.length>2){const _=i.getVariableValue(p.value[2]);s[2]=_ instanceof j?_.value:parseInt(p.value[2])}}const o=this.getTypeInfo("vec3u"),l=this.getTypeInfo("u32");i.setVariable("@workgroup_size",new I(s,o));const c=s[0],f=s[1],d=s[2];for(let p=0,_=0;p<d;++p)for(let y=0;y<f;++y)for(let v=0;v<c;++v,++_){const x=[v,y,p],S=[v+t[0]*s[0],y+t[1]*s[1],p+t[2]*s[2]];i.setVariable("@local_invocation_id",new I(x,o)),i.setVariable("@global_invocation_id",new I(S,o)),i.setVariable("@local_invocation_index",new j(_,l)),this._dispatchExec(e,i)}}_dispatchExec(e,t){for(const i of e.node.args)for(const s of i.attributes)if(s.name==="builtin"){const o=`@${s.value}`,l=t.getVariable(o);l!==void 0&&t.variables.set(i.name,l)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof mt;)e=e.right;return e instanceof un?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const i of e){if(i instanceof Array){const o=t.clone(),l=this._execStatements(i,o);if(l)return l;continue}const s=this.execStatement(i,t);if(s)return s}return null}_call(e,t){const i=t.clone();i.currentFunctionName=e.name;const s=t.getFunction(e.name);if(s){for(let o=0;o<s.node.args.length;++o){const l=s.node.args[o],c=this.evalExpression(e.args[o],i);i.setVariable(l.name,c,l)}this._execStatements(s.node.body,i)}else e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const i=this.getVariableName(e.variable,t),s=t.getVariable(i);s?e.operator==="++"?s.value instanceof j?s.value.value++:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):e.operator==="--"?s.value instanceof j?s.value.value--:console.error(`Variable ${i} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${i} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof un){const i=this.getVariableName(e,t),s=t.getVariable(i);return s===null?(console.error(`Variable ${i} not found. Line ${e.line}`),null):s.value.getSubData(this,e.postfix,t)}if(e instanceof mt){if(e.operator==="*"){const i=this._getVariableData(e.right,t);return i instanceof Fr?i.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const i=this._getVariableData(e.right,t);return new Fr(i)}}return null}_assign(e,t){let i=null,s="<var>",o=null;if(e.variable instanceof mt){const f=this._getVariableData(e.variable,t),d=this.evalExpression(e.value,t),p=e.operator;if(p==="="){if(f instanceof j||f instanceof I||f instanceof Ce){if(d instanceof j||d instanceof I||d instanceof Ce&&f.data.length===d.data.length)return void f.data.set(d.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(f instanceof ut&&d instanceof ut&&f.buffer.byteLength-f.offset>=d.buffer.byteLength-d.offset)return void(f.buffer.byteLength%4==0?new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4).set(new Uint32Array(d.buffer,d.offset,d.typeInfo.size/4)):new Uint8Array(f.buffer,f.offset,f.typeInfo.size).set(new Uint8Array(d.buffer,d.offset,d.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(p==="+=")return f instanceof j||f instanceof I||f instanceof Ce?d instanceof j||d instanceof I||d instanceof Ce?void f.data.set(d.data.map((_,y)=>f.data[y]+_)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(p==="-=")return(f instanceof j||f instanceof I||f instanceof Ce)&&(d instanceof j||d instanceof I||d instanceof Ce)?void f.data.set(d.data.map((_,y)=>f.data[y]-_)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof mt){if(e.variable.operator==="*"){s=this.getVariableName(e.variable.right,t);const f=t.getVariable(s);if(!(f&&f.value instanceof Fr))return void console.error(`Variable ${s} is not a pointer. Line ${e.line}`);i=f.value.reference;let d=e.variable.postfix;if(!d){let p=e.variable.right;for(;p instanceof mt;){if(p.postfix){d=p.postfix;break}p=p.right}}d&&(i=i.getSubData(this,d,t))}}else{o=e.variable.postfix,s=this.getVariableName(e.variable,t);const f=t.getVariable(s);if(f===null)return void console.error(`Variable ${s} not found. Line ${e.line}`);i=f.value}if(i instanceof Fr&&(i=i.reference),i===null)return void console.error(`Variable ${s} not found. Line ${e.line}`);const l=this.evalExpression(e.value,t),c=e.operator;if(c!=="="){const f=i.getSubData(this,o,t);if(f instanceof I&&l instanceof j){const d=f.data,p=l.value;if(c==="+=")for(let _=0;_<d.length;++_)d[_]+=p;else if(c==="-=")for(let _=0;_<d.length;++_)d[_]-=p;else if(c==="*=")for(let _=0;_<d.length;++_)d[_]*=p;else if(c==="/=")for(let _=0;_<d.length;++_)d[_]/=p;else if(c==="%=")for(let _=0;_<d.length;++_)d[_]%=p;else if(c==="&=")for(let _=0;_<d.length;++_)d[_]&=p;else if(c==="|=")for(let _=0;_<d.length;++_)d[_]|=p;else if(c==="^=")for(let _=0;_<d.length;++_)d[_]^=p;else if(c==="<<=")for(let _=0;_<d.length;++_)d[_]<<=p;else if(c===">>=")for(let _=0;_<d.length;++_)d[_]>>=p;else console.error(`Invalid operator ${c}. Line ${e.line}`)}else if(f instanceof I&&l instanceof I){const d=f.data,p=l.data;if(d.length!==p.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(c==="+=")for(let _=0;_<d.length;++_)d[_]+=p[_];else if(c==="-=")for(let _=0;_<d.length;++_)d[_]-=p[_];else if(c==="*=")for(let _=0;_<d.length;++_)d[_]*=p[_];else if(c==="/=")for(let _=0;_<d.length;++_)d[_]/=p[_];else if(c==="%=")for(let _=0;_<d.length;++_)d[_]%=p[_];else if(c==="&=")for(let _=0;_<d.length;++_)d[_]&=p[_];else if(c==="|=")for(let _=0;_<d.length;++_)d[_]|=p[_];else if(c==="^=")for(let _=0;_<d.length;++_)d[_]^=p[_];else if(c==="<<=")for(let _=0;_<d.length;++_)d[_]<<=p[_];else if(c===">>=")for(let _=0;_<d.length;++_)d[_]>>=p[_];else console.error(`Invalid operator ${c}. Line ${e.line}`)}else{if(!(f instanceof j&&l instanceof j))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);c==="+="?f.value+=l.value:c==="-="?f.value-=l.value:c==="*="?f.value*=l.value:c==="/="?f.value/=l.value:c==="%="?f.value%=l.value:c==="&="?f.value&=l.value:c==="|="?f.value|=l.value:c==="^="?f.value^=l.value:c==="<<="?f.value<<=l.value:c===">>="?f.value>>=l.value:console.error(`Invalid operator ${c}. Line ${e.line}`)}return void(i instanceof ut&&i.setDataValue(this,f,o,t))}if(i instanceof ut)i.setDataValue(this,l,o,t);else if(o){if(!(i instanceof I||i instanceof Ce))return void console.error(`Variable ${s} is not a vector or matrix. Line ${e.line}`);if(o instanceof to){const f=this.evalExpression(o.index,t).value;if(i instanceof I){if(!(l instanceof j))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[f]=l.value}else{if(!(i instanceof Ce))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);{const d=this.evalExpression(o.index,t).value;if(d<0)return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(!(l instanceof I))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);{const p=i.typeInfo.getTypeName();if(p==="mat2x2"||p==="mat2x2f"||p==="mat2x2h"){if(!(d<2&&l.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[2*d]=l.data[0],i.data[2*d+1]=l.data[1]}else if(p==="mat2x3"||p==="mat2x3f"||p==="mat2x3h"){if(!(d<2&&l.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[3*d]=l.data[0],i.data[3*d+1]=l.data[1],i.data[3*d+2]=l.data[2]}else if(p==="mat2x4"||p==="mat2x4f"||p==="mat2x4h"){if(!(d<2&&l.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[4*d]=l.data[0],i.data[4*d+1]=l.data[1],i.data[4*d+2]=l.data[2],i.data[4*d+3]=l.data[3]}else if(p==="mat3x2"||p==="mat3x2f"||p==="mat3x2h"){if(!(d<3&&l.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[2*d]=l.data[0],i.data[2*d+1]=l.data[1]}else if(p==="mat3x3"||p==="mat3x3f"||p==="mat3x3h"){if(!(d<3&&l.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[3*d]=l.data[0],i.data[3*d+1]=l.data[1],i.data[3*d+2]=l.data[2]}else if(p==="mat3x4"||p==="mat3x4f"||p==="mat3x4h"){if(!(d<3&&l.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[4*d]=l.data[0],i.data[4*d+1]=l.data[1],i.data[4*d+2]=l.data[2],i.data[4*d+3]=l.data[3]}else if(p==="mat4x2"||p==="mat4x2f"||p==="mat4x2h"){if(!(d<4&&l.data.length===2))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[2*d]=l.data[0],i.data[2*d+1]=l.data[1]}else if(p==="mat4x3"||p==="mat4x3f"||p==="mat4x3h"){if(!(d<4&&l.data.length===3))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[3*d]=l.data[0],i.data[3*d+1]=l.data[1],i.data[3*d+2]=l.data[2]}else{if(p!=="mat4x4"&&p!=="mat4x4f"&&p!=="mat4x4h")return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(!(d<4&&l.data.length===4))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);i.data[4*d]=l.data[0],i.data[4*d+1]=l.data[1],i.data[4*d+2]=l.data[2],i.data[4*d+3]=l.data[3]}}}}}else if(o instanceof js){const f=o.value;if(!(i instanceof I))return void console.error(`Invalid assignment to ${f}. Variable ${s} is not a vector. Line ${e.line}`);if(l instanceof j){if(f.length>1)return void console.error(`Invalid assignment to ${f} for variable ${s}. Line ${e.line}`);if(f==="x")i.data[0]=l.value;else if(f==="y"){if(i.data.length<2)return void console.error(`Invalid assignment to ${f} for variable ${s}. Line ${e.line}`);i.data[1]=l.value}else if(f==="z"){if(i.data.length<3)return void console.error(`Invalid assignment to ${f} for variable ${s}. Line ${e.line}`);i.data[2]=l.value}else if(f==="w"){if(i.data.length<4)return void console.error(`Invalid assignment to ${f} for variable ${s}. Line ${e.line}`);i.data[3]=l.value}}else{if(!(l instanceof I))return void console.error(`Invalid assignment to ${s}. Line ${e.line}`);if(f.length!==l.data.length)return void console.error(`Invalid assignment to ${f} for variable ${s}. Line ${e.line}`);for(let d=0;d<f.length;++d){const p=f[d];if(p==="x"||p==="r")i.data[0]=l.data[d];else if(p==="y"||p==="g"){if(l.data.length<2)return void console.error(`Invalid assignment to ${p} for variable ${s}. Line ${e.line}`);i.data[1]=l.data[d]}else if(p==="z"||p==="b"){if(l.data.length<3)return void console.error(`Invalid assignment to ${p} for variable ${s}. Line ${e.line}`);i.data[2]=l.data[d]}else{if(p!=="w"&&p!=="a")return void console.error(`Invalid assignment to ${p} for variable ${s}. Line ${e.line}`);if(l.data.length<4)return void console.error(`Invalid assignment to ${p} for variable ${s}. Line ${e.line}`);i.data[3]=l.data[d]}}}}}else i instanceof j&&l instanceof j?i.value=l.value:i instanceof I&&l instanceof I||i instanceof Ce&&l instanceof Ce?i.data.set(l.data):console.error(`Invalid assignment to ${s}. Line ${e.line}`)}_function(e,t){const i=new Bg(e);t.functions.set(e.name,i)}_const(e,t){let i=null;e.value!==null&&(i=this.evalExpression(e.value,t)),t.createVariable(e.name,i,e)}_let(e,t){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,t),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof mt||(i=i.clone())}else{const s=e.type.name;if(s==="f32"||s==="i32"||s==="u32"||s==="bool"||s==="f16"||s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2b"||s==="vec3b"||s==="vec4b"||s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"||s==="array"){const o=new Wn(e.type,[]);i=this._evalCreate(o,t)}}t.createVariable(e.name,i,e)}_var(e,t){let i=null;if(e.value!==null){if(i=this.evalExpression(e.value,t),i===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof mt||(i=i.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const s=e.type.name;if(s==="f32"||s==="i32"||s==="u32"||s==="bool"||s==="f16"||s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2b"||s==="vec3b"||s==="vec4b"||s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"||e.type instanceof Ua||e.type instanceof pi||e.type instanceof W){const o=new Wn(e.type,[]);i=this._evalCreate(o,t)}}t.createVariable(e.name,i,e)}_switch(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;let s=null;for(const o of e.cases)if(o instanceof t8)for(const l of o.selectors){if(l instanceof nu){s=o;continue}const c=this.evalExpression(l,t);if(!(c instanceof j))return console.error(`Invalid case selector. Line ${e.line}`),null;if(c.value===i.value)return this._execStatements(o.body,t)}else o instanceof n8&&(s=o);return s?this._execStatements(s.body,t):null}_if(e,t){t=t.clone();const i=this.evalExpression(e.condition,t);if(!(i instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;if(i.value)return this._execStatements(e.body,t);for(const s of e.elseif){const o=this.evalExpression(s.condition,t);if(!(o instanceof j))return console.error(`Invalid if condition. Line ${e.line}`),null;if(o.value)return this._execStatements(s.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof j?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===Ut._breakObj)break;if(i!==null&&i!==Ut._continueObj)return i;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const i=this._execStatements(e.body,t);if(i===Ut._breakObj)break;if(i===Ut._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===Ut._breakObj)break}else if(i!==null)return i}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const i=this._execStatements(e.body,t);if(i===Ut._breakObj)break;if(i!==Ut._continueObj&&i!==null)return i}return null}_evalBitcast(e,t){const i=this.evalExpression(e.value,t),s=e.type;if(i instanceof j){const o=w_(i.value,i.typeInfo.name,s.name);return new j(o,this.getTypeInfo(s))}if(i instanceof I){const o=i.typeInfo.getTypeName();let l="";if(o.endsWith("f"))l="f32";else if(o.endsWith("i"))l="i32";else if(o.endsWith("u"))l="u32";else if(o.endsWith("b"))l="bool";else{if(!o.endsWith("h"))return console.error(`Unknown vector type ${o}. Line ${e.line}`),null;l="f16"}const c=s.getTypeName();let f="";if(c.endsWith("f"))f="f32";else if(c.endsWith("i"))f="i32";else if(c.endsWith("u"))f="u32";else if(c.endsWith("b"))f="bool";else{if(!c.endsWith("h"))return console.error(`Unknown vector type ${f}. Line ${e.line}`),null;f="f16"}const d=function(p,_,y){if(_===y)return p;const v=new Array(p.length);for(let x=0;x<p.length;x++)v[x]=w_(p[x],_,y);return v}(Array.from(i.data),l,f);return new I(d,this.getTypeInfo(s))}return console.error(`TODO: bitcast for ${i.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var i;if(e instanceof Wn){if(e.type===null)return Mp.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const s=e instanceof Wn?e.type.name:e.name,o=e instanceof Wn?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(o===null)return console.error(`Unknown type ${s}. Line ${e.line}`),null;if(o.size===0)return null;const l=new ut(new ArrayBuffer(o.size),o,0);if(o instanceof es){if(e.args)for(let c=0;c<e.args.length;++c){const f=o.members[c],d=e.args[c],p=this.evalExpression(d,t);l.setData(this,p,f.type,f.offset,t)}}else if(o instanceof rs){let c=0;if(e.args)for(let f=0;f<e.args.length;++f){const d=e.args[f],p=this.evalExpression(d,t);o.format===null&&(((i=p.typeInfo)===null||i===void 0?void 0:i.name)==="x32"?o.format=this.getTypeInfo("i32"):o.format=p.typeInfo),l.setData(this,p,o.format,c,t),c+=o.stride}}else console.error(`Unknown type "${s}". Line ${e.line}`);return e instanceof Wn?l.getSubData(this,e.postfix,t):l}_evalLiteral(e,t){const i=this.getTypeInfo(e.type),s=i.name;return s==="x32"||s==="u32"||s==="f32"||s==="f16"||s==="i32"||s==="bool"?new j(e.scalarValue,i):s==="vec2"||s==="vec3"||s==="vec4"||s==="vec2f"||s==="vec3f"||s==="vec4f"||s==="vec2h"||s==="vec3h"||s==="vec4h"||s==="vec2i"||s==="vec3i"||s==="vec4i"||s==="vec2u"||s==="vec3u"||s==="vec4u"?this._callConstructorVec(e,t):s==="mat2x2"||s==="mat2x3"||s==="mat2x4"||s==="mat3x2"||s==="mat3x3"||s==="mat3x4"||s==="mat4x2"||s==="mat4x3"||s==="mat4x4"||s==="mat2x2f"||s==="mat2x3f"||s==="mat2x4f"||s==="mat3x2f"||s==="mat3x3f"||s==="mat3x4f"||s==="mat4x2f"||s==="mat4x3f"||s==="mat4x4f"||s==="mat2x2h"||s==="mat2x3h"||s==="mat2x4h"||s==="mat3x2h"||s==="mat3x3h"||s==="mat3x4h"||s==="mat4x2h"||s==="mat4x3h"||s==="mat4x4h"?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const i=t.getVariableValue(e.name);return i===null?i:i.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if(t.name==="f32")return t;for(let i=1;i<e.length;++i){const s=Ut._priority.get(t.name);Ut._priority.get(e[i].name)<s&&(t=e[i])}return t.name==="x32"?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const i=this.evalExpression(e.right,t);if(e.operator==="&")return new Fr(i);if(e.operator==="*")return i instanceof Fr?i.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const s=i instanceof j?i.value:i instanceof I?Array.from(i.data):null;switch(e.operator){case"+":{if(pe(s)){const c=s.map((f,d)=>+f);return new I(c,i.typeInfo)}const o=s,l=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new j(+o,l)}case"-":{if(pe(s)){const c=s.map((f,d)=>-f);return new I(c,i.typeInfo)}const o=s,l=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new j(-o,l)}case"!":{if(pe(s)){const c=s.map((f,d)=>f?0:1);return new I(c,i.typeInfo)}const o=s,l=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new j(o?0:1,l)}case"~":{if(pe(s)){const c=s.map((f,d)=>~f);return new I(c,i.typeInfo)}const o=s,l=this._maxFormatTypeInfo([i.typeInfo,i.typeInfo]);return new j(~o,l)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const i=this.evalExpression(e.left,t),s=this.evalExpression(e.right,t),o=i instanceof j?i.value:i instanceof I||i instanceof Ce?Array.from(i.data):null,l=s instanceof j?s.value:s instanceof I||s instanceof Ce?Array.from(s.data):null;switch(e.operator){case"+":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v+_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y+p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p+y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c+f,d)}case"-":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v-_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y-p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p-y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c-f,d)}case"*":{if(pe(o)&&pe(l)){const p=o,_=l;if(i instanceof Ce&&s instanceof Ce){const y=function(M,C,U,R){if(jt[C.name]===void 0||jt[R.name]===void 0)return null;const D=jt[C.name][0],B=jt[C.name][1],Q=jt[R.name][0];if(D!==jt[R.name][1])return null;const ce=new Array(Q*B);for(let Z=0;Z<B;Z++)for(let ee=0;ee<Q;ee++){let he=0;for(let de=0;de<D;de++)he+=M[de*B+Z]*U[ee*D+de];ce[Z*Q+ee]=he}return ce}(p,i.typeInfo,_,s.typeInfo);if(y===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const v=jt[s.typeInfo.name][0],x=jt[i.typeInfo.name][1],S=this.getTypeInfo(`mat${v}x${x}f`);return new Ce(y,S)}if(i instanceof Ce&&s instanceof I){const y=function(v,x,S,M){if(jt[x.name]===void 0||Ld[M.name]===void 0)return null;const C=jt[x.name][0],U=jt[x.name][1];if(C!==S.length)return null;const R=new Array(U);for(let D=0;D<U;D++){let B=0;for(let Q=0;Q<C;Q++)B+=v[Q*U+D]*S[Q];R[D]=B}return R}(p,i.typeInfo,_,s.typeInfo);return y===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new I(y,s.typeInfo)}if(i instanceof I&&s instanceof Ce){const y=function(v,x,S,M){if(Ld[x.name]===void 0||jt[M.name]===void 0)return null;const C=jt[M.name][0],U=jt[M.name][1];if(U!==v.length)return null;const R=[];for(let D=0;D<C;D++){let B=0;for(let Q=0;Q<U;Q++)B+=v[Q]*S[Q*C+D];R[D]=B}return R}(p,i.typeInfo,_,s.typeInfo);return y===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new I(y,i.typeInfo)}{if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v*_[x]);return new I(y,i.typeInfo)}}if(pe(o)){const p=l,_=o.map((y,v)=>y*p);return i instanceof Ce?new Ce(_,i.typeInfo):new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p*y);return s instanceof Ce?new Ce(_,s.typeInfo):new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c*f,d)}case"%":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v%_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y%p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p%y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c%f,d)}case"/":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v/_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y/p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p/y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c/f,d)}case"&":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v&_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y&p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p&y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c&f,d)}case"|":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v|_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y|p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p|y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c|f,d)}case"^":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v^_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y^p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p^y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c^f,d)}case"<<":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v<<_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y<<p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p<<y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c<<f,d)}case">>":{if(pe(o)&&pe(l)){const p=o,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((v,x)=>v>>_[x]);return new I(y,i.typeInfo)}if(pe(o)){const p=l,_=o.map((y,v)=>y>>p);return new I(_,i.typeInfo)}if(pe(l)){const p=o,_=l.map((y,v)=>p>>y);return new I(_,s.typeInfo)}const c=o,f=l,d=this._maxFormatTypeInfo([i.typeInfo,s.typeInfo]);return new j(c>>f,d)}case">":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p>f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d>c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c>d?1:0);return new I(f,s.typeInfo)}return new j(o>l?1:0,this.getTypeInfo("bool"));case"<":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p<f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d<c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c<d?1:0);return new I(f,s.typeInfo)}return new j(o<l?1:0,this.getTypeInfo("bool"));case"==":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p===f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d==c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c==d?1:0);return new I(f,s.typeInfo)}return new j(o===l?1:0,this.getTypeInfo("bool"));case"!=":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p!==f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d!==c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c!==d?1:0);return new I(f,s.typeInfo)}return new j(o!==l?1:0,this.getTypeInfo("bool"));case">=":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p>=f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d>=c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c>=d?1:0);return new I(f,s.typeInfo)}return new j(o>=l?1:0,this.getTypeInfo("bool"));case"<=":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p<=f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d<=c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c<=d?1:0);return new I(f,s.typeInfo)}return new j(o<=l?1:0,this.getTypeInfo("bool"));case"&&":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p&&f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d&&c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c&&d?1:0);return new I(f,s.typeInfo)}return new j(o&&l?1:0,this.getTypeInfo("bool"));case"||":if(pe(o)&&pe(l)){const c=o,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p||f[_]?1:0);return new I(d,i.typeInfo)}if(pe(o)){const c=l,f=o.map((d,p)=>d||c?1:0);return new I(f,i.typeInfo)}if(pe(l)){const c=o,f=l.map((d,p)=>c||d?1:0);return new I(f,s.typeInfo)}return new j(o||l?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const i=t.clone();i.currentFunctionName=e.name;const s=t.getFunction(e.name);if(!s)return e.isBuiltin?this._callBuiltinFunction(e,i):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let o=0;o<s.node.args.length;++o){const l=s.node.args[o],c=this.evalExpression(e.args[o],i);i.createVariable(l.name,c,l)}return this._execStatements(s.node.body,i)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothstep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const i=t.getFunction(e.name);if(i){const s=t.clone();for(let o=0;o<i.node.args.length;++o){const l=i.node.args[o],c=this.evalExpression(e.args[o],s);s.setVariable(l.name,c,l)}return this._execStatements(i.node.body,s)}return null}_callConstructorValue(e,t){if(!e.args||e.args.length===0)return new j(0,this.getTypeInfo(e.type));const i=this.evalExpression(e.args[0],t);return i.typeInfo=this.getTypeInfo(e.type),i.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const i=this.getTypeInfo(e.type),s=e.type.getTypeName(),o=Ld[s];if(o===void 0)return console.error(`Invalid vec constructor ${s}. Line ${e.line}`),null;const l=[];if(e instanceof xt)if(e.isVector){const c=e.vectorValue;for(const f of c)l.push(f)}else l.push(e.scalarValue);else if(e.args)for(const c of e.args){const f=this.evalExpression(c,t);if(f instanceof I){const d=f.data;for(let p=0;p<d.length;++p){let _=d[p];l.push(_)}}else if(f instanceof j){let d=f.value;l.push(d)}}if(e.type instanceof W&&e.type.format===null&&(e.type.format=W.f32),l.length===0){const c=new Array(o).fill(0);return new I(c,i).getSubData(this,e.postfix,t)}if(l.length===1)for(;l.length<o;)l.push(l[0]);return l.length<o?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new I(l.length>o?l.slice(0,o):l,i).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const i=this.getTypeInfo(e.type),s=e.type.getTypeName(),o=jt[s];if(o===void 0)return console.error(`Invalid matrix constructor ${s}. Line ${e.line}`),null;const l=[];if(e instanceof xt)if(e.isVector){const c=e.vectorValue;for(const f of c)l.push(f)}else l.push(e.scalarValue);else if(e.args)for(const c of e.args){const f=this.evalExpression(c,t);f instanceof I?l.push(...f.data):f instanceof j?l.push(f.value):f instanceof Ce&&l.push(...f.data)}if(i instanceof zs&&i.format===null&&(i.format=this.getTypeInfo("f32")),l.length===0){const c=new Array(o[2]).fill(0);return new Ce(c,i).getSubData(this,e.postfix,t)}return l.length!==o[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new Ce(l,i).getSubData(this,e.postfix,t)}}Ut._breakObj=new An(new Tn("BREAK",null),null),Ut._continueObj=new An(new Tn("CONTINUE",null),null),Ut._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class t5{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class n5{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new t5,this._exec=new Ut,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const i=this._global_decl_or_directive();if(!i)break;t.push(i)}if(this._deferArrayCountEval.length>0){for(const i of this._deferArrayCountEval){const s=i.arrayType,o=i.countNode;if(o instanceof un){const l=o.name,c=this._context.constants.get(l);if(c)try{const f=c.constEvaluate(this._exec);s.count=f}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const i of t)i.search(s=>{s instanceof x_||s instanceof tu?s.type=this._forwardType(s.type):s instanceof Ua?s.format=this._forwardType(s.format):s instanceof _i||s instanceof Ba||s instanceof eu?s.type=this._forwardType(s.type):s instanceof Xa?s.returnType=this._forwardType(s.returnType):s instanceof v_&&(s.type=this._forwardType(s.type))});return t}_forwardType(e){if(e instanceof b_){const t=this._getType(e.name);if(t)return t}else e instanceof tu?e.type=this._forwardType(e.type):e instanceof Ua&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const t=new WC(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==E.eof}_match(e){if(e instanceof H)return!!this._check(e)&&(this._advance(),!0);for(let t=0,i=e.length;t<i;++t){const s=e[t];if(this._check(s))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const i=t.type;let s=!1;for(const o of e){if(i===o)return!0;o===E.tokens.name&&(s=!0)}if(s){const o=E.tokens.name.rule.exec(t.lexeme);if(o&&o.index==0&&o[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===E.tokens.name){const i=E.tokens.name.rule.exec(t.lexeme);return i&&i.index==0&&i[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=(t=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&t!==void 0?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._match(E.keywords.alias)){const t=this._type_alias();return this._consume(E.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(E.keywords.diagnostic)){const t=this._diagnostic();return this._consume(E.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(E.keywords.requires)){const t=this._requires_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(E.keywords.enable)){const t=this._enable_directive();return this._consume(E.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}const e=this._attribute();if(this._check(E.keywords.var)){const t=this._global_variable_decl();return t!=null&&(t.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(E.keywords.override)){const t=this._override_variable_decl();return t!=null&&(t.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(E.keywords.let)){const t=this._global_let_decl();return t!=null&&(t.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(E.keywords.const)){const t=this._global_const_decl();return t!=null&&(t.attributes=e),this._consume(E.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(E.keywords.struct)){const t=this._struct_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(E.keywords.fn)){const t=this._function_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(E.keywords.fn))return null;const e=this._currentLine,t=this._consume(E.tokens.ident,"Expected function name.").toString();this._consume(E.tokens.paren_left,"Expected '(' for function arguments.");const i=[];if(!this._check(E.tokens.paren_right))do{if(this._check(E.tokens.paren_right))break;const c=this._attribute(),f=this._consume(E.tokens.name,"Expected argument name.").toString();this._consume(E.tokens.colon,"Expected ':' for argument type.");const d=this._attribute(),p=this._type_decl();p!=null&&(p.attributes=d,i.push(this._updateNode(new v_(f,p,c))))}while(this._match(E.tokens.comma));this._consume(E.tokens.paren_right,"Expected ')' after function arguments.");let s=null;if(this._match(E.tokens.arrow)){const c=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=c)}const o=this._compound_statement(),l=this._currentLine;return this._updateNode(new Xa(t,i,s,o,e,l),e)}_compound_statement(){const e=[];for(this._consume(E.tokens.brace_left,"Expected '{' for block.");!this._check(E.tokens.brace_right);){const t=this._statement();t!==null&&e.push(t)}return this._consume(E.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(E.tokens.semicolon)&&!this._isAtEnd(););if(this._check(E.tokens.attr)&&this._attribute(),this._check(E.keywords.if))return this._if_statement();if(this._check(E.keywords.switch))return this._switch_statement();if(this._check(E.keywords.loop))return this._loop_statement();if(this._check(E.keywords.for))return this._for_statement();if(this._check(E.keywords.while))return this._while_statement();if(this._check(E.keywords.continuing))return this._continuing_statement();if(this._check(E.keywords.static_assert))return this._static_assert_statement();if(this._check(E.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(E.keywords.return))e=this._return_statement();else if(this._check([E.keywords.var,E.keywords.let,E.keywords.const]))e=this._variable_statement();else if(this._match(E.keywords.discard))e=this._updateNode(new VC);else if(this._match(E.keywords.break)){const t=this._updateNode(new Zb);if(this._currentLoop.length>0){const i=this._currentLoop[this._currentLoop.length-1];t.loopId=i.id}e=t,this._check(E.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(E.keywords.continue)){const t=this._updateNode(new Kb);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const i=this._currentLoop[this._currentLoop.length-1];t.loopId=i.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(E.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(E.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new FC(t),e)}_while_statement(){if(!this._match(E.keywords.while))return null;const e=this._updateNode(new zb(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(E.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(E.keywords.continuing))return null;const t=this._currentLine,i=this._compound_statement();return this._updateNode(new Rp(i,e),t)}_for_statement(){if(!this._match(E.keywords.for))return null;this._consume(E.tokens.paren_left,"Expected '('.");const e=this._updateNode(new jb(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(E.tokens.semicolon)?null:this._for_init(),this._consume(E.tokens.semicolon,"Expected ';'."),e.condition=this._check(E.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(E.tokens.semicolon,"Expected ';'."),e.increment=this._check(E.tokens.paren_right)?null:this._for_increment(),this._consume(E.tokens.paren_right,"Expected ')'."),this._check(E.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(E.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(E.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new _i(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(E.keywords.let)){const e=this._currentLine,t=this._consume(E.tokens.name,"Expected name for let.").toString();let i=null;if(this._match(E.tokens.colon)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}this._consume(E.tokens.equal,"Expected '=' for let.");const s=this._short_circuit_or_expression();return this._updateNode(new Ba(t,i,null,null,s),e)}if(this._match(E.keywords.const)){const e=this._currentLine,t=this._consume(E.tokens.name,"Expected name for const.").toString();let i=null;if(this._match(E.tokens.colon)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}this._consume(E.tokens.equal,"Expected '=' for const.");const s=this._short_circuit_or_expression();return i===null&&s instanceof xt&&(i=s.type),this._updateNode(new eu(t,i,null,null,s),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(t==null)return null;if(!this._check(E.increment_operators))return this._current=e,null;const i=this._consume(E.increment_operators,"Expected increment operator");return this._updateNode(new Vb(i.type===E.tokens.plus_plus?Hr.increment:Hr.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(E.tokens.brace_right))return null;let i=this._match(E.tokens.underscore);if(i||(e=this._unary_expression()),!i&&e==null)return null;const s=this._consume(E.assignment_operators,"Expected assignment operator."),o=this._short_circuit_or_expression();return this._updateNode(new Hb(Ra.parse(s.lexeme),e,o),t)}_func_call_statement(){if(!this._check(E.tokens.ident))return null;const e=this._currentLine,t=this._current,i=this._consume(E.tokens.ident,"Expected function name."),s=this._argument_expression_list();return s===null?(this._current=t,null):this._updateNode(new Ig(i.lexeme,s),e)}_loop_statement(){if(!this._match(E.keywords.loop))return null;this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new $b([],null));this._currentLoop.push(e);let t=this._statement();for(;t!==null;){if(Array.isArray(t))for(let i of t)e.body.push(i);else e.body.push(t);if(t instanceof Rp){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(E.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(E.keywords.switch))return null;const e=this._updateNode(new Wb(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(E.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([E.keywords.default,E.keywords.case]);){if(this._match(E.keywords.case)){const i=this._case_selectors();for(const o of i)if(o instanceof nu){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch case.");const s=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new t8(i,s)))}if(this._match(E.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(E.tokens.colon),this._check(E.tokens.attr)&&this._attribute(),this._consume(E.tokens.brace_left,"Exected '{' for switch default.");const i=this._case_body();this._consume(E.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new n8(i)))}}return e}_case_selectors(){const e=[];for(this._match(E.keywords.default)?e.push(this._updateNode(new nu)):e.push(this._shift_expression());this._match(E.tokens.comma);)this._match(E.keywords.default)?e.push(this._updateNode(new nu)):e.push(this._shift_expression());return e}_case_body(){if(this._match(E.keywords.fallthrough))return this._consume(E.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const t=this._case_body();return t.length==0?e:[...e,t[0]]}_if_statement(){if(!this._match(E.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(E.tokens.attr)&&this._attribute();const i=this._compound_statement();let s=[];this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),s=this._elseif_statement(s));let o=null;return this._match(E.keywords.else)&&(this._check(E.tokens.attr)&&this._attribute(),o=this._compound_statement()),this._updateNode(new Xb(t,i,s,o),e)}_match_elseif(){return this._tokens[this._current].type===E.keywords.else&&this._tokens[this._current+1].type===E.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),i=this._compound_statement();return e.push(this._updateNode(new HC(t,i))),this._match_elseif()&&(this._check(E.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(E.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Yb(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(E.tokens.or_or);)e=this._updateNode(new On(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(E.tokens.and_and);)e=this._updateNode(new On(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(E.tokens.or);)e=this._updateNode(new On(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(E.tokens.xor);)e=this._updateNode(new On(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(E.tokens.and);)e=this._updateNode(new On(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([E.tokens.equal_equal,E.tokens.not_equal])?this._updateNode(new On(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([E.tokens.less_than,E.tokens.greater_than,E.tokens.less_than_equal,E.tokens.greater_than_equal]);)e=this._updateNode(new On(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([E.tokens.shift_left,E.tokens.shift_right]);)e=this._updateNode(new On(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([E.tokens.plus,E.tokens.minus]);)e=this._updateNode(new On(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([E.tokens.star,E.tokens.forward_slash,E.tokens.modulo]);)e=this._updateNode(new On(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([E.tokens.minus,E.tokens.bang,E.tokens.tilde,E.tokens.star,E.tokens.and])?this._updateNode(new mt(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(E.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(E.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new to(e)),i=this._postfix_expression();return i&&(t.postfix=i),t}if(this._match(E.tokens.period)){const e=this._consume(E.tokens.name,"Expected member name."),t=this._postfix_expression(),i=this._updateNode(new js(e.lexeme));return t&&(i.postfix=t),i}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(t!==null)return t;switch(e){case"void":return re.void;case"bool":return re.bool;case"i32":return re.i32;case"u32":return re.u32;case"f32":return re.f32;case"f16":return re.f16;case"vec2f":return W.vec2f;case"vec3f":return W.vec3f;case"vec4f":return W.vec4f;case"vec2i":return W.vec2i;case"vec3i":return W.vec3i;case"vec4i":return W.vec4i;case"vec2u":return W.vec2u;case"vec3u":return W.vec3u;case"vec4u":return W.vec4u;case"vec2h":return W.vec2h;case"vec3h":return W.vec3h;case"vec4h":return W.vec4h;case"mat2x2f":return W.mat2x2f;case"mat2x3f":return W.mat2x3f;case"mat2x4f":return W.mat2x4f;case"mat3x2f":return W.mat3x2f;case"mat3x3f":return W.mat3x3f;case"mat3x4f":return W.mat3x4f;case"mat4x2f":return W.mat4x2f;case"mat4x3f":return W.mat4x3f;case"mat4x4f":return W.mat4x4f;case"mat2x2h":return W.mat2x2h;case"mat2x3h":return W.mat2x3h;case"mat2x4h":return W.mat2x4h;case"mat3x2h":return W.mat3x2h;case"mat3x3h":return W.mat3x3h;case"mat3x4h":return W.mat3x4h;case"mat4x2h":return W.mat4x2h;case"mat4x3h":return W.mat4x3h;case"mat4x4h":return W.mat4x4h;case"mat2x2i":return W.mat2x2i;case"mat2x3i":return W.mat2x3i;case"mat2x4i":return W.mat2x4i;case"mat3x2i":return W.mat3x2i;case"mat3x3i":return W.mat3x3i;case"mat3x4i":return W.mat3x4i;case"mat4x2i":return W.mat4x2i;case"mat4x3i":return W.mat4x3i;case"mat4x4i":return W.mat4x4i;case"mat2x2u":return W.mat2x2u;case"mat2x3u":return W.mat2x3u;case"mat2x4u":return W.mat2x4u;case"mat3x2u":return W.mat3x2u;case"mat3x3u":return W.mat3x3u;case"mat3x4u":return W.mat3x4u;case"mat4x2u":return W.mat4x2u;case"mat4x3u":return W.mat4x3u;case"mat4x4u":return W.mat4x4u}return null}_validateTypeRange(e,t){if(t.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(t.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(E.tokens.ident)){const i=this._previous().toString();if(this._check(E.tokens.paren_left)){const s=this._argument_expression_list(),o=this._getType(i);return o!==null?this._updateNode(new Wn(o,s)):this._updateNode(new kg(i,s))}if(this._context.constants.has(i)){const s=this._context.constants.get(i);return this._updateNode(new Gb(i,s.value))}return this._updateNode(new un(i))}if(this._match(E.tokens.int_literal)){const i=this._previous().toString();let s=i.endsWith("i")||i.endsWith("i")?re.i32:i.endsWith("u")||i.endsWith("U")?re.u32:re.x32;const o=parseInt(i);return this._validateTypeRange(o,s),this._updateNode(new xt(new j(o,this._exec.getTypeInfo(s)),s))}if(this._match(E.tokens.uint_literal)){const i=parseInt(this._previous().toString());return this._validateTypeRange(i,re.u32),this._updateNode(new xt(new j(i,this._exec.getTypeInfo(re.u32)),re.u32))}if(this._match([E.tokens.decimal_float_literal,E.tokens.hex_float_literal])){let i=this._previous().toString(),s=i.endsWith("h");s&&(i=i.substring(0,i.length-1));const o=parseFloat(i);this._validateTypeRange(o,s?re.f16:re.f32);const l=s?re.f16:re.f32;return this._updateNode(new xt(new j(o,this._exec.getTypeInfo(l)),l))}if(this._match([E.keywords.true,E.keywords.false])){let i=this._previous().toString()===E.keywords.true.rule;return this._updateNode(new xt(new j(i?1:0,this._exec.getTypeInfo(re.bool)),re.bool))}if(this._check(E.tokens.paren_left))return this._paren_expression();if(this._match(E.keywords.bitcast)){this._consume(E.tokens.less_than,"Expected '<'.");const i=this._type_decl();this._consume(E.tokens.greater_than,"Expected '>'.");const s=this._paren_expression();return this._updateNode(new Qb(i,s))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Wn(e,t))}_argument_expression_list(){if(!this._match(E.tokens.paren_left))return null;const e=[];do{if(this._check(E.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(E.tokens.comma));return this._consume(E.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(E.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(E.tokens.paren_right),e}_paren_expression(){this._consume(E.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(E.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(E.keywords.struct))return null;const e=this._currentLine,t=this._consume(E.tokens.ident,"Expected name for struct.").toString();this._consume(E.tokens.brace_left,"Expected '{' for struct body.");const i=[];for(;!this._check(E.tokens.brace_right);){const l=this._attribute(),c=this._consume(E.tokens.name,"Expected variable name.").toString();this._consume(E.tokens.colon,"Expected ':' for struct member type.");const f=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=f),this._check(E.tokens.brace_right)?this._match(E.tokens.comma):this._consume(E.tokens.comma,"Expected ',' for struct member."),i.push(this._updateNode(new x_(c,d,l)))}this._consume(E.tokens.brace_right,"Expected '}' after struct body.");const s=this._currentLine,o=this._updateNode(new pi(t,i,e,s),e);return this._context.structs.set(t,o),o}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(E.tokens.equal)){const t=this._const_expression();e.value=t}if(e.type!==null&&e.value instanceof xt){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof xt&&(e.type=e.value.type.name==="x32"?re.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(E.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(E.keywords.const))return null;const t=this._consume(E.tokens.name,"Expected variable name"),i=this._currentLine;let s=null;if(this._match(E.tokens.colon)){const f=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=f)}let o=null;this._consume(E.tokens.equal,"const declarations require an assignment");const l=this._short_circuit_or_expression();try{let f=[re.f32],d=l.constEvaluate(this._exec,f);d instanceof j&&this._validateTypeRange(d.value,f[0]),f[0]instanceof W&&f[0].format===null&&d.typeInfo instanceof zs&&d.typeInfo.format!==null&&(d.typeInfo.format.name==="f16"?f[0].format=re.f16:d.typeInfo.format.name==="f32"?f[0].format=re.f32:d.typeInfo.format.name==="i32"?f[0].format=re.i32:d.typeInfo.format.name==="u32"?f[0].format=re.u32:d.typeInfo.format.name==="bool"?f[0].format=re.bool:console.error(`TODO: impelement template format type ${d.typeInfo.format.name}`)),o=this._updateNode(new xt(d,f[0])),this._exec.context.setVariable(t.toString(),d)}catch{o=l}if(s!==null&&o instanceof xt){if(o.type.name!=="x32"&&s.getTypeName()!==o.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${o.type.name} to ${s.name}. Line:${this._currentLine}`);o.type=s,o.isScalar&&this._validateTypeRange(o.scalarValue,o.type)}else s===null&&o instanceof xt&&(s=(e=o?.type)!==null&&e!==void 0?e:re.f32,s===re.x32&&(s=re.i32));const c=this._updateNode(new eu(t.toString(),s,"","",o),i);return this._context.constants.set(c.name,c),c}_global_let_decl(){if(!this._match(E.keywords.let))return null;const e=this._currentLine,t=this._consume(E.tokens.name,"Expected variable name");let i=null;if(this._match(E.tokens.colon)){const o=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=o)}let s=null;if(this._match(E.tokens.equal)&&(s=this._const_expression()),i!==null&&s instanceof xt){if(s.type.name!=="x32"&&i.getTypeName()!==s.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${s.type.name} to ${i.name}. Line:${this._currentLine}`);s.type=i}else i===null&&s instanceof xt&&(i=s.type.name==="x32"?re.i32:s.type);return s instanceof xt&&s.isScalar&&this._validateTypeRange(s.scalarValue,i),this._updateNode(new Ba(t.toString(),i,"","",s),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(E.keywords.var))return null;const e=this._currentLine;let t="",i="";this._match(E.tokens.less_than)&&(t=this._consume(E.storage_class,"Expected storage_class.").toString(),this._match(E.tokens.comma)&&(i=this._consume(E.access_mode,"Expected access_mode.").toString()),this._consume(E.tokens.greater_than,"Expected '>'."));const s=this._consume(E.tokens.name,"Expected variable name");let o=null;if(this._match(E.tokens.colon)){const l=this._attribute();o=this._type_decl(),o!=null&&(o.attributes=l)}return this._updateNode(new _i(s.toString(),o,t,i,null),e)}_override_decl(){if(!this._match(E.keywords.override))return null;const e=this._consume(E.tokens.name,"Expected variable name");let t=null;if(this._match(E.tokens.colon)){const i=this._attribute();t=this._type_decl(),t!=null&&(t.attributes=i)}return this._updateNode(new Og(e.toString(),t,null))}_diagnostic(){this._consume(E.tokens.paren_left,"Expected '('");const e=this._consume(E.tokens.ident,"Expected severity control name.");this._consume(E.tokens.comma,"Expected ','");let t=this._consume(E.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(E.tokens.period)&&(t+=`.${this._consume(E.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(E.tokens.paren_right,"Expected ')'"),this._updateNode(new qb(e.toString(),t))}_enable_directive(){const e=this._consume(E.tokens.ident,"identity expected.");return this._updateNode(new zC(e.toString()))}_requires_directive(){const e=[this._consume(E.tokens.ident,"identity expected.").toString()];for(;this._match(E.tokens.comma);){const t=this._consume(E.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new jC(e))}_type_alias(){const e=this._consume(E.tokens.ident,"identity expected.");this._consume(E.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(t===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const i=this._updateNode(new Ng(e.toString(),t));return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([E.tokens.ident,...E.texel_format,E.keywords.bool,E.keywords.f32,E.keywords.i32,E.keywords.u32])){const i=this._advance().toString();if(this._context.structs.has(i))return this._context.structs.get(i);if(this._context.aliases.has(i))return this._context.aliases.get(i).type;if(!this._getType(i)){const s=this._updateNode(new b_(i));return this._forwardTypeCount++,s}return this._updateNode(new re(i))}let e=this._texture_sampler_types();if(e)return e;if(this._check(E.template_types)){let i=this._advance().toString(),s=null,o=null;return this._match(E.tokens.less_than)&&(s=this._type_decl(),o=null,this._match(E.tokens.comma)&&(o=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new W(i,s,o))}if(this._match(E.keywords.ptr)){let i=this._previous().toString();this._consume(E.tokens.less_than,"Expected '<' for pointer.");const s=this._consume(E.storage_class,"Expected storage_class for pointer");this._consume(E.tokens.comma,"Expected ',' for pointer.");const o=this._type_decl();let l=null;return this._match(E.tokens.comma)&&(l=this._consume(E.access_mode,"Expected access_mode for pointer").toString()),this._consume(E.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new tu(i,s.toString(),o,l))}const t=this._attribute();if(this._match(E.keywords.array)){let i=null,s=-1;const o=this._previous();let l=null;if(this._match(E.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let f="";if(this._match(E.tokens.comma)){l=this._shift_expression();try{f=l.constEvaluate(this._exec).toString(),l=null}catch{f="1"}}this._consume(E.tokens.greater_than,"Expected '>' for array."),s=f?parseInt(f):0}const c=this._updateNode(new Ua(o.toString(),t,i,s));return l&&this._deferArrayCountEval.push({arrayType:c,countNode:l}),c}return null}_texture_sampler_types(){if(this._match(E.sampler_type))return this._updateNode(new Ma(this._previous().toString(),null,null));if(this._match(E.depth_texture_type))return this._updateNode(new Ma(this._previous().toString(),null,null));if(this._match(E.sampled_texture_type)||this._match(E.multisampled_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Ma(e.toString(),t,null))}if(this._match(E.storage_texture_type)){const e=this._previous();this._consume(E.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(E.texel_format,"Invalid texel format.").toString();this._consume(E.tokens.comma,"Expected ',' after texel format.");const i=this._consume(E.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(E.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new Ma(e.toString(),t,i))}return null}_attribute(){let e=[];for(;this._match(E.tokens.attr);){const t=this._consume(E.attribute_name,"Expected attribute name"),i=this._updateNode(new i8(t.toString(),null));if(this._match(E.tokens.paren_left)){if(i.value=this._consume(E.literal_or_ident,"Expected attribute value").toString(),this._check(E.tokens.comma)){this._advance();do{const s=this._consume(E.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(s)}while(this._match(E.tokens.comma))}this._consume(E.tokens.paren_right,"Expected ')'")}e.push(i)}return e.length==0?null:e}}class i5 extends Yn{constructor(e){super(),e&&this.update(e)}update(e){const t=new n5().parse(e);this.updateAST(t)}}function s5(n){const e={attributes:[],bindings:[]};let t;try{t=r5(n)}catch(o){return le.error(o.message)(),e}for(const o of t.uniforms){const l=[];for(const c of o.type?.members||[])l.push({name:c.name,type:S_(c.type)});e.bindings.push({type:"uniform",name:o.name,group:o.group,location:o.binding,members:l})}for(const o of t.textures)e.bindings.push({type:"texture",name:o.name,group:o.group,location:o.binding});for(const o of t.samplers)e.bindings.push({type:"sampler",name:o.name,group:o.group,location:o.binding});const i=t.entry.vertex[0],s=i?.inputs.length||0;for(let o=0;o<s;o++){const l=i.inputs[o];if(l.locationType==="location"){const c=S_(l.type);e.attributes.push({name:l.name,location:Number(l.location),type:c})}}return e}function S_(n){return n?.format?`${n.name}<${n.format.name}>`:n.name}function r5(n){try{return new i5(n)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw typeof e=="object"&&e?.message&&(t+=`: ${e.message} `),typeof e=="object"&&e?.token&&(t+=e.token.line||""),new Error(t,{cause:e})}}const o5={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...o5}};const wn=globalThis.mathgl.config;function a5(n,{precision:e=wn.precision}={}){return n=l5(n),`${parseFloat(n.toPrecision(e))}`}function no(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function ts(n,e,t){return u5(n,i=>Math.max(e,Math.min(t,i)))}function Ru(n,e,t){return no(n)?n.map((i,s)=>Ru(i,e[s],t)):t*e+(1-t)*n}function Ya(n,e,t){const i=wn.EPSILON;try{if(n===e)return!0;if(no(n)&&no(e)){if(n.length!==e.length)return!1;for(let s=0;s<n.length;++s)if(!Ya(n[s],e[s]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):typeof n=="number"&&typeof e=="number"?Math.abs(n-e)<=wn.EPSILON*Math.max(1,Math.abs(n),Math.abs(e)):!1}finally{wn.EPSILON=i}}function l5(n){return Math.round(n/wn.EPSILON)*wn.EPSILON}function c5(n){return n.clone?n.clone():new Array(n.length)}function u5(n,e,t){if(no(n)){const i=n;t=t||c5(i);for(let s=0;s<t.length&&s<i.length;++s){const o=typeof n=="number"?n:n[s];t[s]=e(o,s,t)}return t}return e(n)}class s8 extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=e[i+t];return this.check()}toArray(e=[],t=0){for(let i=0;i<this.ELEMENTS;++i)e[t+i]=this[i];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:no(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(wn)}formatString(e){let t="";for(let i=0;i<this.ELEMENTS;++i)t+=(i>0?", ":"")+a5(this[i],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Ya(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,i){if(i===void 0)return this.lerp(this,e,t);for(let s=0;s<this.ELEMENTS;++s){const o=e[s],l=typeof t=="number"?t:t[s];this[s]=o+i*(l-o)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e[i]),t[i]);return this.check()}add(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]+=t[i];return this.check()}subtract(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]-=t[i];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(wn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],e),t);return this.check()}get elements(){return this}}function f5(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}function cn(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${JSON.stringify(n)}`);return n}function Bd(n,e,t=""){if(wn.debug&&!f5(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}function A_(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}class h5 extends s8{get x(){return this[0]}set x(e){this[0]=cn(e)}get y(){return this[1]}set y(e){this[1]=cn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let i=0;i<this.ELEMENTS;++i){const s=this[i]-e[i];t+=s*s}return cn(t)}dot(e){let t=0;for(let i=0;i<this.ELEMENTS;++i)t+=this[i]*e[i];return cn(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]*=t[i];return this.check()}divide(...e){for(const t of e)for(let i=0;i<this.ELEMENTS;++i)this[i]/=t[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return A_(e>=0&&e<this.ELEMENTS,"index is out of range"),cn(this[e])}setComponent(e,t){return A_(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const iu=1e-6;let io=typeof Float32Array<"u"?Float32Array:Array;function d5(){const n=new io(2);return io!=Float32Array&&(n[0]=0,n[1]=0),n}function E_(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function p5(n,e){return n[0]=-e[0],n[1]=-e[1],n}function r8(n,e,t,i){const s=e[0],o=e[1];return n[0]=s+i*(t[0]-s),n[1]=o+i*(t[1]-o),n}function g5(n,e,t){const i=e[0],s=e[1];return n[0]=t[0]*i+t[4]*s+t[12],n[1]=t[1]*i+t[5]*s+t[13],n}(function(){const n=d5();return function(e,t,i,s,o,l){let c,f;for(t||(t=2),i||(i=0),s?f=Math.min(s*t+i,e.length):f=e.length,c=i;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],o(n,n,l),e[c]=n[0],e[c+1]=n[1];return e}})();function m5(n,e,t){const i=e[0],s=e[1],o=t[3]*i+t[7]*s||1;return n[0]=(t[0]*i+t[4]*s)/o,n[1]=(t[1]*i+t[5]*s)/o,n}function o8(n,e,t){const i=e[0],s=e[1],o=e[2],l=t[3]*i+t[7]*s+t[11]*o||1;return n[0]=(t[0]*i+t[4]*s+t[8]*o)/l,n[1]=(t[1]*i+t[5]*s+t[9]*o)/l,n[2]=(t[2]*i+t[6]*s+t[10]*o)/l,n}function _5(n,e,t){const i=e[0],s=e[1];return n[0]=t[0]*i+t[2]*s,n[1]=t[1]*i+t[3]*s,n[2]=e[2],n}function y5(){const n=new io(3);return io!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function b5(n){const e=n[0],t=n[1],i=n[2];return Math.sqrt(e*e+t*t+i*i)}function v5(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function x5(n){const e=n[0],t=n[1],i=n[2];return e*e+t*t+i*i}function T5(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function w5(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function S5(n,e,t){const i=e[0],s=e[1],o=e[2],l=t[0],c=t[1],f=t[2];return n[0]=s*f-o*c,n[1]=o*l-i*f,n[2]=i*c-s*l,n}function A5(n,e,t,i){const s=e[0],o=e[1],l=e[2];return n[0]=s+i*(t[0]-s),n[1]=o+i*(t[1]-o),n[2]=l+i*(t[2]-l),n}function a8(n,e,t){const i=e[0],s=e[1],o=e[2];let l=t[3]*i+t[7]*s+t[11]*o+t[15];return l=l||1,n[0]=(t[0]*i+t[4]*s+t[8]*o+t[12])/l,n[1]=(t[1]*i+t[5]*s+t[9]*o+t[13])/l,n[2]=(t[2]*i+t[6]*s+t[10]*o+t[14])/l,n}function E5(n,e,t){const i=e[0],s=e[1],o=e[2];return n[0]=i*t[0]+s*t[3]+o*t[6],n[1]=i*t[1]+s*t[4]+o*t[7],n[2]=i*t[2]+s*t[5]+o*t[8],n}function C5(n,e,t){const i=t[0],s=t[1],o=t[2],l=t[3],c=e[0],f=e[1],d=e[2];let p=s*d-o*f,_=o*c-i*d,y=i*f-s*c,v=s*y-o*_,x=o*p-i*y,S=i*_-s*p;const M=l*2;return p*=M,_*=M,y*=M,v*=2,x*=2,S*=2,n[0]=c+p+v,n[1]=f+_+x,n[2]=d+y+S,n}function R5(n,e,t,i){const s=[],o=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],o[0]=s[0],o[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),o[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}function M5(n,e,t,i){const s=[],o=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],o[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),o[1]=s[1],o[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}function P5(n,e,t,i){const s=[],o=[];return s[0]=e[0]-t[0],s[1]=e[1]-t[1],s[2]=e[2]-t[2],o[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),o[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),o[2]=s[2],n[0]=o[0]+t[0],n[1]=o[1]+t[1],n[2]=o[2]+t[2],n}function O5(n,e){const t=n[0],i=n[1],s=n[2],o=e[0],l=e[1],c=e[2],f=Math.sqrt((t*t+i*i+s*s)*(o*o+l*l+c*c)),d=f&&w5(n,e)/f;return Math.acos(Math.min(Math.max(d,-1),1))}const l8=v5,I5=b5,Ud=x5;(function(){const n=y5();return function(e,t,i,s,o,l){let c,f;for(t||(t=3),i||(i=0),s?f=Math.min(s*t+i,e.length):f=e.length,c=i;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],n[2]=e[c+2],o(n,n,l),e[c]=n[0],e[c+1]=n[1],e[c+2]=n[2];return e}})();const Fd=[0,0,0];let kc;class Zn extends h5{static get ZERO(){return kc||(kc=new Zn(0,0,0),Object.freeze(kc)),kc}constructor(e=0,t=0,i=0){super(-0,-0,-0),arguments.length===1&&no(e)?this.copy(e):(wn.debug&&(cn(e),cn(t),cn(i)),this[0]=e,this[1]=t,this[2]=i)}set(e,t,i){return this[0]=e,this[1]=t,this[2]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return wn.debug&&(cn(e.x),cn(e.y),cn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=cn(e)}angle(e){return O5(this,e)}cross(e){return S5(this,this,e),this.check()}rotateX({radians:e,origin:t=Fd}){return R5(this,this,t,e),this.check()}rotateY({radians:e,origin:t=Fd}){return M5(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=Fd}){return P5(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return a8(this,this,e),this.check()}transformAsVector(e){return o8(this,this,e),this.check()}transformByMatrix3(e){return E5(this,this,e),this.check()}transformByMatrix2(e){return _5(this,this,e),this.check()}transformByQuaternion(e){return C5(this,this,e),this.check()}}class N5 extends s8{toString(){let e="[";if(wn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let i=0;i<this.RANK;++i)e+=` ${this[i*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,i){return this[t*this.RANK+e]=cn(i),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const i=e*this.RANK;for(let s=0;s<this.RANK;++s)t[s]=this[i+s];return t}setColumn(e,t){const i=e*this.RANK;for(let s=0;s<this.RANK;++s)this[i+s]=t[s];return this}}function k5(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function D5(n,e){if(n===e){const t=e[1],i=e[2],s=e[3],o=e[6],l=e[7],c=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=i,n[9]=o,n[11]=e[14],n[12]=s,n[13]=l,n[14]=c}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function Pp(n,e){const t=e[0],i=e[1],s=e[2],o=e[3],l=e[4],c=e[5],f=e[6],d=e[7],p=e[8],_=e[9],y=e[10],v=e[11],x=e[12],S=e[13],M=e[14],C=e[15],U=t*c-i*l,R=t*f-s*l,D=t*d-o*l,B=i*f-s*c,Q=i*d-o*c,ce=s*d-o*f,Z=p*S-_*x,ee=p*M-y*x,he=p*C-v*x,de=_*M-y*S,_e=_*C-v*S,ge=y*C-v*M;let ue=U*ge-R*_e+D*de+B*he-Q*ee+ce*Z;return ue?(ue=1/ue,n[0]=(c*ge-f*_e+d*de)*ue,n[1]=(s*_e-i*ge-o*de)*ue,n[2]=(S*ce-M*Q+C*B)*ue,n[3]=(y*Q-_*ce-v*B)*ue,n[4]=(f*he-l*ge-d*ee)*ue,n[5]=(t*ge-s*he+o*ee)*ue,n[6]=(M*D-x*ce-C*R)*ue,n[7]=(p*ce-y*D+v*R)*ue,n[8]=(l*_e-c*he+d*Z)*ue,n[9]=(i*he-t*_e-o*Z)*ue,n[10]=(x*Q-S*D+C*U)*ue,n[11]=(_*D-p*Q-v*U)*ue,n[12]=(c*ee-l*de-f*Z)*ue,n[13]=(t*de-i*ee+s*Z)*ue,n[14]=(S*R-x*B-M*U)*ue,n[15]=(p*B-_*R+y*U)*ue,n):null}function L5(n){const e=n[0],t=n[1],i=n[2],s=n[3],o=n[4],l=n[5],c=n[6],f=n[7],d=n[8],p=n[9],_=n[10],y=n[11],v=n[12],x=n[13],S=n[14],M=n[15],C=e*l-t*o,U=e*c-i*o,R=t*c-i*l,D=d*x-p*v,B=d*S-_*v,Q=p*S-_*x,ce=e*Q-t*B+i*D,Z=o*Q-l*B+c*D,ee=d*R-p*U+_*C,he=v*R-x*U+S*C;return f*ce-s*Z+M*ee-y*he}function Ds(n,e,t){const i=e[0],s=e[1],o=e[2],l=e[3],c=e[4],f=e[5],d=e[6],p=e[7],_=e[8],y=e[9],v=e[10],x=e[11],S=e[12],M=e[13],C=e[14],U=e[15];let R=t[0],D=t[1],B=t[2],Q=t[3];return n[0]=R*i+D*c+B*_+Q*S,n[1]=R*s+D*f+B*y+Q*M,n[2]=R*o+D*d+B*v+Q*C,n[3]=R*l+D*p+B*x+Q*U,R=t[4],D=t[5],B=t[6],Q=t[7],n[4]=R*i+D*c+B*_+Q*S,n[5]=R*s+D*f+B*y+Q*M,n[6]=R*o+D*d+B*v+Q*C,n[7]=R*l+D*p+B*x+Q*U,R=t[8],D=t[9],B=t[10],Q=t[11],n[8]=R*i+D*c+B*_+Q*S,n[9]=R*s+D*f+B*y+Q*M,n[10]=R*o+D*d+B*v+Q*C,n[11]=R*l+D*p+B*x+Q*U,R=t[12],D=t[13],B=t[14],Q=t[15],n[12]=R*i+D*c+B*_+Q*S,n[13]=R*s+D*f+B*y+Q*M,n[14]=R*o+D*d+B*v+Q*C,n[15]=R*l+D*p+B*x+Q*U,n}function Mu(n,e,t){const i=t[0],s=t[1],o=t[2];let l,c,f,d,p,_,y,v,x,S,M,C;return e===n?(n[12]=e[0]*i+e[4]*s+e[8]*o+e[12],n[13]=e[1]*i+e[5]*s+e[9]*o+e[13],n[14]=e[2]*i+e[6]*s+e[10]*o+e[14],n[15]=e[3]*i+e[7]*s+e[11]*o+e[15]):(l=e[0],c=e[1],f=e[2],d=e[3],p=e[4],_=e[5],y=e[6],v=e[7],x=e[8],S=e[9],M=e[10],C=e[11],n[0]=l,n[1]=c,n[2]=f,n[3]=d,n[4]=p,n[5]=_,n[6]=y,n[7]=v,n[8]=x,n[9]=S,n[10]=M,n[11]=C,n[12]=l*i+p*s+x*o+e[12],n[13]=c*i+_*s+S*o+e[13],n[14]=f*i+y*s+M*o+e[14],n[15]=d*i+v*s+C*o+e[15]),n}function Fg(n,e,t){const i=t[0],s=t[1],o=t[2];return n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*s,n[5]=e[5]*s,n[6]=e[6]*s,n[7]=e[7]*s,n[8]=e[8]*o,n[9]=e[9]*o,n[10]=e[10]*o,n[11]=e[11]*o,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function B5(n,e,t,i){let s=i[0],o=i[1],l=i[2],c=Math.sqrt(s*s+o*o+l*l),f,d,p,_,y,v,x,S,M,C,U,R,D,B,Q,ce,Z,ee,he,de,_e,ge,ue,Se;return c<iu?null:(c=1/c,s*=c,o*=c,l*=c,d=Math.sin(t),f=Math.cos(t),p=1-f,_=e[0],y=e[1],v=e[2],x=e[3],S=e[4],M=e[5],C=e[6],U=e[7],R=e[8],D=e[9],B=e[10],Q=e[11],ce=s*s*p+f,Z=o*s*p+l*d,ee=l*s*p-o*d,he=s*o*p-l*d,de=o*o*p+f,_e=l*o*p+s*d,ge=s*l*p+o*d,ue=o*l*p-s*d,Se=l*l*p+f,n[0]=_*ce+S*Z+R*ee,n[1]=y*ce+M*Z+D*ee,n[2]=v*ce+C*Z+B*ee,n[3]=x*ce+U*Z+Q*ee,n[4]=_*he+S*de+R*_e,n[5]=y*he+M*de+D*_e,n[6]=v*he+C*de+B*_e,n[7]=x*he+U*de+Q*_e,n[8]=_*ge+S*ue+R*Se,n[9]=y*ge+M*ue+D*Se,n[10]=v*ge+C*ue+B*Se,n[11]=x*ge+U*ue+Q*Se,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function c8(n,e,t){const i=Math.sin(t),s=Math.cos(t),o=e[4],l=e[5],c=e[6],f=e[7],d=e[8],p=e[9],_=e[10],y=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=o*s+d*i,n[5]=l*s+p*i,n[6]=c*s+_*i,n[7]=f*s+y*i,n[8]=d*s-o*i,n[9]=p*s-l*i,n[10]=_*s-c*i,n[11]=y*s-f*i,n}function U5(n,e,t){const i=Math.sin(t),s=Math.cos(t),o=e[0],l=e[1],c=e[2],f=e[3],d=e[8],p=e[9],_=e[10],y=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=o*s-d*i,n[1]=l*s-p*i,n[2]=c*s-_*i,n[3]=f*s-y*i,n[8]=o*i+d*s,n[9]=l*i+p*s,n[10]=c*i+_*s,n[11]=f*i+y*s,n}function u8(n,e,t){const i=Math.sin(t),s=Math.cos(t),o=e[0],l=e[1],c=e[2],f=e[3],d=e[4],p=e[5],_=e[6],y=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=o*s+d*i,n[1]=l*s+p*i,n[2]=c*s+_*i,n[3]=f*s+y*i,n[4]=d*s-o*i,n[5]=p*s-l*i,n[6]=_*s-c*i,n[7]=y*s-f*i,n}function F5(n,e){const t=e[0],i=e[1],s=e[2],o=e[3],l=t+t,c=i+i,f=s+s,d=t*l,p=i*l,_=i*c,y=s*l,v=s*c,x=s*f,S=o*l,M=o*c,C=o*f;return n[0]=1-_-x,n[1]=p+C,n[2]=y-M,n[3]=0,n[4]=p-C,n[5]=1-d-x,n[6]=v+S,n[7]=0,n[8]=y+M,n[9]=v-S,n[10]=1-d-_,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function z5(n,e,t,i,s,o,l){const c=1/(t-e),f=1/(s-i),d=1/(o-l);return n[0]=o*2*c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o*2*f,n[6]=0,n[7]=0,n[8]=(t+e)*c,n[9]=(s+i)*f,n[10]=(l+o)*d,n[11]=-1,n[12]=0,n[13]=0,n[14]=l*o*2*d,n[15]=0,n}function j5(n,e,t,i,s){const o=1/Math.tan(e/2);if(n[0]=o/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=o,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,s!=null&&s!==1/0){const l=1/(i-s);n[10]=(s+i)*l,n[14]=2*s*i*l}else n[10]=-1,n[14]=-2*i;return n}const V5=j5;function H5(n,e,t,i,s,o,l){const c=1/(e-t),f=1/(i-s),d=1/(o-l);return n[0]=-2*c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*f,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*d,n[11]=0,n[12]=(e+t)*c,n[13]=(s+i)*f,n[14]=(l+o)*d,n[15]=1,n}const $5=H5;function W5(n,e,t,i){let s,o,l,c,f,d,p,_,y,v;const x=e[0],S=e[1],M=e[2],C=i[0],U=i[1],R=i[2],D=t[0],B=t[1],Q=t[2];return Math.abs(x-D)<iu&&Math.abs(S-B)<iu&&Math.abs(M-Q)<iu?k5(n):(_=x-D,y=S-B,v=M-Q,s=1/Math.sqrt(_*_+y*y+v*v),_*=s,y*=s,v*=s,o=U*v-R*y,l=R*_-C*v,c=C*y-U*_,s=Math.sqrt(o*o+l*l+c*c),s?(s=1/s,o*=s,l*=s,c*=s):(o=0,l=0,c=0),f=y*c-v*l,d=v*o-_*c,p=_*l-y*o,s=Math.sqrt(f*f+d*d+p*p),s?(s=1/s,f*=s,d*=s,p*=s):(f=0,d=0,p=0),n[0]=o,n[1]=f,n[2]=_,n[3]=0,n[4]=l,n[5]=d,n[6]=y,n[7]=0,n[8]=c,n[9]=p,n[10]=v,n[11]=0,n[12]=-(o*x+l*S+c*M),n[13]=-(f*x+d*S+p*M),n[14]=-(_*x+y*S+v*M),n[15]=1,n)}function X5(){const n=new io(4);return io!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function f8(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function _o(n,e,t){const i=e[0],s=e[1],o=e[2],l=e[3];return n[0]=t[0]*i+t[4]*s+t[8]*o+t[12]*l,n[1]=t[1]*i+t[5]*s+t[9]*o+t[13]*l,n[2]=t[2]*i+t[6]*s+t[10]*o+t[14]*l,n[3]=t[3]*i+t[7]*s+t[11]*o+t[15]*l,n}(function(){const n=X5();return function(e,t,i,s,o,l){let c,f;for(t||(t=4),i||(i=0),s?f=Math.min(s*t+i,e.length):f=e.length,c=i;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],n[2]=e[c+2],n[3]=e[c+3],o(n,n,l),e[c]=n[0],e[c+1]=n[1],e[c+2]=n[2],e[c+3]=n[3];return e}})();var Op;(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3"})(Op||(Op={}));const Y5=45*Math.PI/180,q5=1,zd=.1,jd=500,Z5=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class Dn extends N5{static get IDENTITY(){return G5()}static get ZERO(){return K5()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Op}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,i,s,o,l,c,f,d,p,_,y,v,x,S,M){return this[0]=e,this[1]=t,this[2]=i,this[3]=s,this[4]=o,this[5]=l,this[6]=c,this[7]=f,this[8]=d,this[9]=p,this[10]=_,this[11]=y,this[12]=v,this[13]=x,this[14]=S,this[15]=M,this.check()}setRowMajor(e,t,i,s,o,l,c,f,d,p,_,y,v,x,S,M){return this[0]=e,this[1]=o,this[2]=d,this[3]=v,this[4]=t,this[5]=l,this[6]=p,this[7]=x,this[8]=i,this[9]=c,this[10]=_,this[11]=S,this[12]=s,this[13]=f,this[14]=y,this[15]=M,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Z5)}fromObject(e){return this.check()}fromQuaternion(e){return F5(this,e),this.check()}frustum(e){const{left:t,right:i,bottom:s,top:o,near:l=zd,far:c=jd}=e;return c===1/0?Q5(this,t,i,s,o,l):z5(this,t,i,s,o,l,c),this.check()}lookAt(e){const{eye:t,center:i=[0,0,0],up:s=[0,1,0]}=e;return W5(this,t,i,s),this.check()}ortho(e){const{left:t,right:i,bottom:s,top:o,near:l=zd,far:c=jd}=e;return $5(this,t,i,s,o,l,c),this.check()}orthographic(e){const{fovy:t=Y5,aspect:i=q5,focalDistance:s=1,near:o=zd,far:l=jd}=e;C_(t);const c=t/2,f=s*Math.tan(c),d=f*i;return this.ortho({left:-d,right:d,bottom:-f,top:f,near:o,far:l})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:i=1,near:s=.1,far:o=500}=e;return C_(t),V5(this,t,i,s,o),this.check()}determinant(){return L5(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),s=1/i[0],o=1/i[1],l=1/i[2];return e[0]=this[0]*s,e[1]=this[1]*o,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*s,e[5]=this[5]*o,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*s,e[9]=this[9]*o,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const i=this.getScale(t),s=1/i[0],o=1/i[1],l=1/i[2];return e[0]=this[0]*s,e[1]=this[1]*o,e[2]=this[2]*l,e[3]=this[4]*s,e[4]=this[5]*o,e[5]=this[6]*l,e[6]=this[8]*s,e[7]=this[9]*o,e[8]=this[10]*l,e}transpose(){return D5(this,this),this.check()}invert(){return Pp(this,this),this.check()}multiplyLeft(e){return Ds(this,e,this),this.check()}multiplyRight(e){return Ds(this,this,e),this.check()}rotateX(e){return c8(this,this,e),this.check()}rotateY(e){return U5(this,this,e),this.check()}rotateZ(e){return u8(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return B5(this,this,e,t),this.check()}scale(e){return Fg(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Mu(this,this,e),this.check()}transform(e,t){return e.length===4?(t=_o(t||[-0,-0,-0,-0],e,this),Bd(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:i}=e;let s;switch(i){case 2:s=g5(t||[-0,-0],e,this);break;case 3:s=a8(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Bd(s,e.length),s}transformAsVector(e,t){let i;switch(e.length){case 2:i=m5(t||[-0,-0],e,this);break;case 3:i=o8(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Bd(i,e.length),i}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,i){return this.identity().translate([e,t,i])}}let Dc,Lc;function K5(){return Dc||(Dc=new Dn([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(Dc)),Dc}function G5(){return Lc||(Lc=new Dn,Object.freeze(Lc)),Lc}function C_(n){if(n>Math.PI*2)throw Error("expected radians")}function Q5(n,e,t,i,s,o){const l=2*o/(t-e),c=2*o/(s-i),f=(t+e)/(t-e),d=(s+i)/(s-i),p=-1,_=-1,y=-2*o;return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=f,n[9]=d,n[10]=p,n[11]=_,n[12]=0,n[13]=0,n[14]=y,n[15]=0,n}function h8(n,e=[],t=0){const i=Math.fround(n),s=n-i;return e[t]=i,e[t+1]=s,e}function J5(n){return n-Math.fround(n)}function eR(n){const e=new Float32Array(32);for(let t=0;t<4;++t)for(let i=0;i<4;++i){const s=t*4+i;h8(n[i*4+t],e,s*2)}return e}const tR=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,nR={name:"fp32",vs:tR},iR=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,sR={ONE:1},rR={name:"fp64arithmetic",vs:iR,defaultUniforms:sR,uniformTypes:{ONE:"f32"},fp64ify:h8,fp64LowPart:J5,fp64ifyMatrix4:eR},oR=[0,1,1,1],aR=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,lR=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,R_={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:oR},vs:aR,fs:lR,getUniforms:cR};function cR(n={},e){const t={};if(n.highlightedObjectColor!==void 0)if(n.highlightedObjectColor===null)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const i=n.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=i}if(n.highlightColor){const i=Array.from(n.highlightColor,s=>s/255);Number.isFinite(i[3])||(i[3]=1),t.highlightColor=i}return n.isActive!==void 0&&(t.isActive=!!n.isActive,t.isAttribute=!!n.isAttribute),n.useFloatColors!==void 0&&(t.useFloatColors=!!n.useFloatColors),t}const M_=`precision highp int;

// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  vec3 color;
};

struct PointLight {
  vec3 color;
  vec3 position;
  vec3 attenuation; // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform lightingUniforms {
  int enabled;
  int lightType;

  int directionalLightCount;
  int pointLightCount;

  vec3 ambientColor;

  vec3 lightColor0;
  vec3 lightPosition0;
  vec3 lightDirection0;
  vec3 lightAttenuation0;

  vec3 lightColor1;
  vec3 lightPosition1;
  vec3 lightDirection1;
  vec3 lightAttenuation1;

  vec3 lightColor2;
  vec3 lightPosition2;
  vec3 lightDirection2;
  vec3 lightAttenuation2;
} lighting;

PointLight lighting_getPointLight(int index) {
  switch (index) {
    case 0:
      return PointLight(lighting.lightColor0, lighting.lightPosition0, lighting.lightAttenuation0);
    case 1:
      return PointLight(lighting.lightColor1, lighting.lightPosition1, lighting.lightAttenuation1);
    case 2:
    default:  
      return PointLight(lighting.lightColor2, lighting.lightPosition2, lighting.lightAttenuation2);
  }
}

DirectionalLight lighting_getDirectionalLight(int index) {
  switch (index) {
    case 0:
      return DirectionalLight(lighting.lightColor0, lighting.lightDirection0);
    case 1:
      return DirectionalLight(lighting.lightColor1, lighting.lightDirection1);
    case 2:
    default:   
      return DirectionalLight(lighting.lightColor2, lighting.lightDirection2);
  }
} 

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

// #endif
`,uR=`// #if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
  color: vec3<f32>,
};

struct PointLight {
  color: vec3<f32>,
  position: vec3<f32>,
  attenuation: vec3<f32>, // 2nd order x:Constant-y:Linear-z:Exponential
};

struct DirectionalLight {
  color: vec3<f32>,
  direction: vec3<f32>,
};

struct lightingUniforms {
  enabled: i32,
  pointLightCount: i32,
  directionalLightCount: i32,

  ambientColor: vec3<f32>,

  // TODO - support multiple lights by uncommenting arrays below
  lightType: i32,
  lightColor: vec3<f32>,
  lightDirection: vec3<f32>,
  lightPosition: vec3<f32>,
  lightAttenuation: vec3<f32>,

  // AmbientLight ambientLight;
  // PointLight pointLight[MAX_LIGHTS];
  // DirectionalLight directionalLight[MAX_LIGHTS];
};

// Binding 0:1 is reserved for lighting (Note: could go into separate bind group as it is stable across draw calls)
@binding(1) @group(0) var<uniform> lighting : lightingUniforms;

fn lighting_getPointLight(index: i32) -> PointLight {
  return PointLight(lighting.lightColor, lighting.lightPosition, lighting.lightAttenuation);
}

fn lighting_getDirectionalLight(index: i32) -> DirectionalLight {
  return DirectionalLight(lighting.lightColor, lighting.lightDirection);
} 

fn getPointLightAttenuation(pointLight: PointLight, distance: f32) -> f32 {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}
`,fR=5,hR=255;var qa;(function(n){n[n.POINT=0]="POINT",n[n.DIRECTIONAL=1]="DIRECTIONAL"})(qa||(qa={}));const su={props:{},uniforms:{},name:"lighting",defines:{},uniformTypes:{enabled:"i32",lightType:"i32",directionalLightCount:"i32",pointLightCount:"i32",ambientColor:"vec3<f32>",lightColor0:"vec3<f32>",lightPosition0:"vec3<f32>",lightDirection0:"vec3<f32>",lightAttenuation0:"vec3<f32>",lightColor1:"vec3<f32>",lightPosition1:"vec3<f32>",lightDirection1:"vec3<f32>",lightAttenuation1:"vec3<f32>",lightColor2:"vec3<f32>",lightPosition2:"vec3<f32>",lightDirection2:"vec3<f32>",lightAttenuation2:"vec3<f32>"},defaultUniforms:{enabled:1,lightType:qa.POINT,directionalLightCount:0,pointLightCount:0,ambientColor:[.1,.1,.1],lightColor0:[1,1,1],lightPosition0:[1,1,2],lightDirection0:[1,1,1],lightAttenuation0:[1,0,0],lightColor1:[1,1,1],lightPosition1:[1,1,2],lightDirection1:[1,1,1],lightAttenuation1:[1,0,0],lightColor2:[1,1,1],lightPosition2:[1,1,2],lightDirection2:[1,1,1],lightAttenuation2:[1,0,0]},source:uR,vs:M_,fs:M_,getUniforms:dR};function dR(n,e={}){if(n=n&&{...n},!n)return{...su.defaultUniforms};n.lights&&(n={...n,...gR(n.lights),lights:void 0});const{ambientLight:t,pointLights:i,directionalLights:s}=n||{};if(!(t||i&&i.length>0||s&&s.length>0))return{...su.defaultUniforms,enabled:0};const l={...su.defaultUniforms,...e,...pR({ambientLight:t,pointLights:i,directionalLights:s})};return n.enabled!==void 0&&(l.enabled=n.enabled?1:0),l}function pR({ambientLight:n,pointLights:e=[],directionalLights:t=[]}){const i={};i.ambientColor=Vd(n);let s=0;for(const o of e){i.lightType=qa.POINT;const l=s;i[`lightColor${l}`]=Vd(o),i[`lightPosition${l}`]=o.position,i[`lightAttenuation${l}`]=o.attenuation||[1,0,0],s++}for(const o of t){i.lightType=qa.DIRECTIONAL;const l=s;i[`lightColor${l}`]=Vd(o),i[`lightDirection${l}`]=o.direction,s++}return s>fR&&le.warn("MAX_LIGHTS exceeded")(),i.directionalLightCount=t.length,i.pointLightCount=e.length,i}function gR(n){const e={pointLights:[],directionalLights:[]};for(const t of n||[])switch(t.type){case"ambient":e.ambientLight=t;break;case"directional":e.directionalLights?.push(t);break;case"point":e.pointLights?.push(t);break}return e}function Vd(n={}){const{color:e=[0,0,0],intensity:t=1}=n;return e.map(i=>i*t/hR)}const mR=`uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;
`,_R=`#define MAX_LIGHTS 3

uniform phongMaterialUniforms {
  uniform float ambient;
  uniform float diffuse;
  uniform float shininess;
  uniform vec3  specularColor;
} material;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
  vec3 halfway_direction = normalize(light_direction + view_direction);
  float lambertian = dot(light_direction, normal_worldspace);
  float specular = 0.0;
  if (lambertian > 0.0) {
    float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, material.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * material.diffuse * surfaceColor + specular * material.specularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  vec3 view_direction = normalize(cameraPosition - position_worldspace);
  lightColor = material.ambient * surfaceColor * lighting.ambientColor;

  for (int i = 0; i < lighting.pointLightCount; i++) {
    PointLight pointLight = lighting_getPointLight(i);
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    float light_attenuation = getPointLightAttenuation(pointLight, distance(light_position_worldspace, position_worldspace));
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color / light_attenuation);
  }

  int totalLights = min(MAX_LIGHTS, lighting.pointLightCount + lighting.directionalLightCount);
  for (int i = lighting.pointLightCount; i < totalLights; i++) {
    DirectionalLight directionalLight = lighting_getDirectionalLight(i);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
}
`,yR=`struct phongMaterialUniforms {
  ambient: f32,
  diffuse: f32,
  shininess: f32,
  specularColor: vec3<f32>,
};

@binding(2) @group(0) var<uniform> phongMaterial : phongMaterialUniforms;

fn lighting_getLightColor(surfaceColor: vec3<f32>, light_direction: vec3<f32>, view_direction: vec3<f32>, normal_worldspace: vec3<f32>, color: vec3<f32>) -> vec3<f32> {
  let halfway_direction: vec3<f32> = normalize(light_direction + view_direction);
  var lambertian: f32 = dot(light_direction, normal_worldspace);
  var specular: f32 = 0.0;
  if (lambertian > 0.0) {
    let specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
    specular = pow(specular_angle, phongMaterial.shininess);
  }
  lambertian = max(lambertian, 0.0);
  return (lambertian * phongMaterial.diffuse * surfaceColor + specular * phongMaterial.specularColor) * color;
}

fn lighting_getLightColor2(surfaceColor: vec3<f32>, cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32> {
  var lightColor: vec3<f32> = surfaceColor;

  if (lighting.enabled == 0) {
    return lightColor;
  }

  let view_direction: vec3<f32> = normalize(cameraPosition - position_worldspace);
  lightColor = phongMaterial.ambient * surfaceColor * lighting.ambientColor;

  if (lighting.lightType == 0) {
    let pointLight: PointLight  = lighting_getPointLight(0);
    let light_position_worldspace: vec3<f32> = pointLight.position;
    let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  } else if (lighting.lightType == 1) {
    var directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  
  return lightColor;
  /*
  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.pointLightCount) {
      break;
    }
    PointLight pointLight = lighting.pointLight[i];
    vec3 light_position_worldspace = pointLight.position;
    vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
    lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
  }

  for (int i = 0; i < MAX_LIGHTS; i++) {
    if (i >= lighting.directionalLightCount) {
      break;
    }
    DirectionalLight directionalLight = lighting.directionalLight[i];
    lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
  }
  */
}

fn lighting_getSpecularLightColor(cameraPosition: vec3<f32>, position_worldspace: vec3<f32>, normal_worldspace: vec3<f32>) -> vec3<f32>{
  var lightColor = vec3<f32>(0, 0, 0);
  let surfaceColor = vec3<f32>(0, 0, 0);

  if (lighting.enabled == 0) {
    let view_direction = normalize(cameraPosition - position_worldspace);

    switch (lighting.lightType) {
      case 0, default: {
        let pointLight: PointLight = lighting_getPointLight(0);
        let light_position_worldspace: vec3<f32> = pointLight.position;
        let light_direction: vec3<f32> = normalize(light_position_worldspace - position_worldspace);
        lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
      }
      case 1: {
        let directionalLight: DirectionalLight = lighting_getDirectionalLight(0);
        lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
      }
    }
  }
  return lightColor;
}
`,d8={props:{},name:"gouraudMaterial",vs:_R.replace("phongMaterial","gouraudMaterial"),fs:mR.replace("phongMaterial","gouraudMaterial"),source:yR.replaceAll("phongMaterial","gouraudMaterial"),defines:{LIGHTING_VERTEX:!0},dependencies:[su],uniformTypes:{ambient:"f32",diffuse:"f32",shininess:"f32",specularColor:"vec3<f32>"},defaultUniforms:{ambient:.35,diffuse:.6,shininess:32,specularColor:[.15,.15,.15]},getUniforms(n){const e={...n};return e.specularColor&&(e.specularColor=e.specularColor.map(t=>t/255)),{...d8.defaultUniforms,...e}}},P_=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,bR={name:"layer",vs:P_,fs:P_,getUniforms:n=>({opacity:Math.pow(n.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},vR=`

struct ColorUniforms {
  opacity: f32,
};

var<private> color: ColorUniforms = ColorUniforms(1.0);
// TODO (kaapp) avoiding binding index collisions to handle layer opacity 
// requires some thought.
// @group(0) @binding(0) var<uniform> color: ColorUniforms;

@must_use
fn deckgl_premultiplied_alpha(fragColor: vec4<f32>) -> vec4<f32> {
    return vec4(fragColor.rgb * fragColor.a, fragColor.a); 
};
`,xR={name:"color",dependencies:[],source:vR,getUniforms:n=>({}),uniformTypes:{opacity:"f32"}},TR=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,p8="#define SMOOTH_EDGE_RADIUS 0.5",wR=`${p8}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,SR=`${p8}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,g8={name:"geometry",source:TR,vs:wR,fs:SR},AR=25;var _t;(function(n){n[n.Start=1]="Start",n[n.Move=2]="Move",n[n.End=4]="End",n[n.Cancel=8]="Cancel"})(_t||(_t={}));var Tt;(function(n){n[n.None=0]="None",n[n.Left=1]="Left",n[n.Right=2]="Right",n[n.Up=4]="Up",n[n.Down=8]="Down",n[n.Horizontal=3]="Horizontal",n[n.Vertical=12]="Vertical",n[n.All=15]="All"})(Tt||(Tt={}));var Me;(function(n){n[n.Possible=1]="Possible",n[n.Began=2]="Began",n[n.Changed=4]="Changed",n[n.Ended=8]="Ended",n[n.Recognized=8]="Recognized",n[n.Cancelled=16]="Cancelled",n[n.Failed=32]="Failed"})(Me||(Me={}));const ER="compute",CR="auto",Ip="manipulation",ru="none",Np="pan-x",kp="pan-y";function RR(n){if(n.includes(ru))return ru;const e=n.includes(Np),t=n.includes(kp);return e&&t?ru:e||t?e?Np:kp:n.includes(Ip)?Ip:CR}class MR{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){e===ER&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return RR(e.join(" "))}}function Pu(n){return n.trim().split(/\s+/g)}function Hd(n,e,t){if(n)for(const i of Pu(e))n.addEventListener(i,t,!1)}function $d(n,e,t){if(n)for(const i of Pu(e))n.removeEventListener(i,t,!1)}function O_(n){return(n.ownerDocument||n).defaultView}function PR(n,e){let t=n;for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function m8(n){const e=n.length;if(e===1)return{x:Math.round(n[0].clientX),y:Math.round(n[0].clientY)};let t=0,i=0,s=0;for(;s<e;)t+=n[s].clientX,i+=n[s].clientY,s++;return{x:Math.round(t/e),y:Math.round(i/e)}}function I_(n){const e=[];let t=0;for(;t<n.pointers.length;)e[t]={clientX:Math.round(n.pointers[t].clientX),clientY:Math.round(n.pointers[t].clientY)},t++;return{timeStamp:Date.now(),pointers:e,center:m8(e),deltaX:n.deltaX,deltaY:n.deltaY}}function _8(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.sqrt(t*t+i*i)}function N_(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.sqrt(t*t+i*i)}function OR(n,e){const t=e.x-n.x,i=e.y-n.y;return Math.atan2(i,t)*180/Math.PI}function k_(n,e){const t=e.clientX-n.clientX,i=e.clientY-n.clientY;return Math.atan2(i,t)*180/Math.PI}function y8(n,e){return n===e?Tt.None:Math.abs(n)>=Math.abs(e)?n<0?Tt.Left:Tt.Right:e<0?Tt.Up:Tt.Down}function IR(n,e){const t=e.center;let i=n.offsetDelta,s=n.prevDelta;const o=n.prevInput;return(e.eventType===_t.Start||o?.eventType===_t.End)&&(s=n.prevDelta={x:o?.deltaX||0,y:o?.deltaY||0},i=n.offsetDelta={x:t.x,y:t.y}),{deltaX:s.x+(t.x-i.x),deltaY:s.y+(t.y-i.y)}}function b8(n,e,t){return{x:e/n||0,y:t/n||0}}function NR(n,e){return N_(e[0],e[1])/N_(n[0],n[1])}function kR(n,e){return k_(e[1],e[0])-k_(n[1],n[0])}function DR(n,e){const t=n.lastInterval||e,i=e.timeStamp-t.timeStamp;let s,o,l,c;if(e.eventType!==_t.Cancel&&(i>AR||t.velocity===void 0)){const f=e.deltaX-t.deltaX,d=e.deltaY-t.deltaY,p=b8(i,f,d);o=p.x,l=p.y,s=Math.abs(p.x)>Math.abs(p.y)?p.x:p.y,c=y8(f,d),n.lastInterval=e}else s=t.velocity,o=t.velocityX,l=t.velocityY,c=t.direction;e.velocity=s,e.velocityX=o,e.velocityY=l,e.direction=c}function LR(n,e){const{session:t}=n,{pointers:i}=e,{length:s}=i;t.firstInput||(t.firstInput=I_(e)),s>1&&!t.firstMultiple?t.firstMultiple=I_(e):s===1&&(t.firstMultiple=!1);const{firstInput:o,firstMultiple:l}=t,c=l?l.center:o.center,f=e.center=m8(i);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=OR(c,f),e.distance=_8(c,f);const{deltaX:d,deltaY:p}=IR(t,e);e.deltaX=d,e.deltaY=p,e.offsetDirection=y8(e.deltaX,e.deltaY);const _=b8(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=_.x,e.overallVelocityY=_.y,e.overallVelocity=Math.abs(_.x)>Math.abs(_.y)?_.x:_.y,e.scale=l?NR(l.pointers,i):1,e.rotation=l?kR(l.pointers,i):0,e.maxPointers=t.prevInput?e.pointers.length>t.prevInput.maxPointers?e.pointers.length:t.prevInput.maxPointers:e.pointers.length;let y=n.element;return PR(e.srcEvent.target,y)&&(y=e.srcEvent.target),e.target=y,DR(t,e),e}function BR(n,e,t){const i=t.pointers.length,s=t.changedPointers.length,o=e&_t.Start&&i-s===0,l=e&(_t.End|_t.Cancel)&&i-s===0;t.isFirst=!!o,t.isFinal=!!l,o&&(n.session={}),t.eventType=e;const c=LR(n,t);n.emit("hammer.input",c),n.recognize(c),n.session.prevInput=c}let UR=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=t=>{this.manager.options.enable&&this.handler(t)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){BR(this.manager,e,t)}init(){Hd(this.element,this.evEl,this.domHandler),Hd(this.target,this.evTarget,this.domHandler),Hd(O_(this.element),this.evWin,this.domHandler)}destroy(){$d(this.element,this.evEl,this.domHandler),$d(this.target,this.evTarget,this.domHandler),$d(O_(this.element),this.evWin,this.domHandler)}};const FR={pointerdown:_t.Start,pointermove:_t.Move,pointerup:_t.End,pointercancel:_t.Cancel,pointerout:_t.Cancel},zR="pointerdown",jR="pointermove pointerup pointercancel";class VR extends UR{constructor(e){super(e),this.evEl=zR,this.evWin=jR,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let i=!1;const s=FR[e.type],o=e.pointerType,l=o==="touch";let c=t.findIndex(f=>f.pointerId===e.pointerId);s&_t.Start&&(e.buttons||l)?c<0&&(t.push(e),c=t.length-1):s&(_t.End|_t.Cancel)&&(i=!0),!(c<0)&&(t[c]=e,this.callback(s,{pointers:t,changedPointers:[e],eventType:s,pointerType:o,srcEvent:e}),i&&t.splice(c,1))}}const HR=["","webkit","Moz","MS","ms","o"];function $R(n,e){const t=e[0].toUpperCase()+e.slice(1);for(const i of HR){const s=i?i+t:e;if(s in n)return s}}const WR=1,D_=2,L_={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class XR{constructor(e,t){this.options={...L_,...t,cssProps:{...L_.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new VR(this),this.touchAction=new MR(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?D_:WR}recognize(e){const{session:t}=this;if(t.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let i;const{recognizers:s}=this;let{curRecognizer:o}=t;(!o||o&&o.state&Me.Recognized)&&(o=t.curRecognizer=null);let l=0;for(;l<s.length;)i=s[l],t.stopped!==D_&&(!o||i===o||i.canRecognizeWith(o))?i.recognize(e):i.reset(),!o&&i.state&(Me.Began|Me.Changed|Me.Ended)&&(o=t.curRecognizer=i),l++}get(e){const{recognizers:t}=this;for(let i=0;i<t.length;i++)if(t[i].options.event===e)return t[i];return null}add(e){if(Array.isArray(e)){for(const i of e)this.add(i);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const i of e)this.remove(i);return this}const t=typeof e=="string"?this.get(e):e;if(t){const{recognizers:i}=this,s=i.indexOf(t);s!==-1&&(i.splice(s,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:i}=this;for(const s of Pu(e))i[s]=i[s]||[],i[s].push(t)}off(e,t){if(!e)return;const{handlers:i}=this;for(const s of Pu(e))t?i[s]&&i[s].splice(i[s].indexOf(t),1):delete i[s]}emit(e,t){const i=this.handlers[e]&&this.handlers[e].slice();if(!i||!i.length)return;const s=t;s.type=e,s.preventDefault=function(){t.srcEvent.preventDefault()};let o=0;for(;o<i.length;)i[o](s),o++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[i,s]of Object.entries(this.options.cssProps)){const o=$R(t.style,i);e?(this.oldCssProps[o]=t.style[o],t.style[o]=s):t.style[o]=this.oldCssProps[o]||""}e||(this.oldCssProps={})}}}let YR=1;function qR(){return YR++}function B_(n){return n&Me.Cancelled?"cancel":n&Me.Ended?"end":n&Me.Changed?"move":n&Me.Began?"start":""}class v8{constructor(e){this.options=e,this.id=qR(),this.state=Me.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const s of e)this.recognizeWith(s);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:i}=this;return i[t.id]||(i[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const i of e)this.dropRecognizeWith(i);return this}let t;return typeof e=="string"?t=this.manager.get(e):t=e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const s of e)this.requireFailure(s);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:i}=this;return i.indexOf(t)===-1&&(i.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const i of e)this.dropRequireFailure(i);return this}let t;if(typeof e=="string"?t=this.manager.get(e):t=e,t){const i=this.requireFail.indexOf(t);i>-1&&this.requireFail.splice(i,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:t}=this;t<Me.Ended&&this.manager.emit(this.options.event+B_(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Me.Ended&&this.manager.emit(this.options.event+B_(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Me.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Me.Failed|Me.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable){this.reset(),this.state=Me.Failed;return}this.state&(Me.Recognized|Me.Cancelled|Me.Failed)&&(this.state=Me.Possible),this.state=this.process(t),this.state&(Me.Began|Me.Changed|Me.Ended|Me.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class x8 extends v8{attrTest(e){const t=this.options.pointers;return t===0||e.pointers.length===t}process(e){const{state:t}=this,{eventType:i}=e,s=t&(Me.Began|Me.Changed),o=this.attrTest(e);return s&&(i&_t.Cancel||!o)?t|Me.Cancelled:s||o?i&_t.End?t|Me.Ended:t&Me.Began?t|Me.Changed:Me.Began:Me.Failed}}class U_ extends v8{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Ip]}process(e){const{options:t}=this,i=e.pointers.length===t.pointers,s=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),e.eventType&_t.Start&&this.count===0)return this.failTimeout();if(s&&o&&i){if(e.eventType!==_t.End)return this.failTimeout();const l=this.pTime?e.timeStamp-this.pTime<t.interval:!0,c=!this.pCenter||_8(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!c||!l?this.count=1:this.count+=1,this._input=e,this.count%t.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Me.Recognized,this.tryEmit(this._input)},t.interval),Me.Began):Me.Recognized}return Me.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Me.Failed},this.options.interval),Me.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Me.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const ZR=["","start","move","end","cancel","up","down","left","right"];class F_ extends x8{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Tt.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Tt.Horizontal&&t.push(kp),e&Tt.Vertical&&t.push(Np),t}getEventNames(){return ZR.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let i=!0,{distance:s}=e,{direction:o}=e;const l=e.deltaX,c=e.deltaY;return o&t.direction||(t.direction&Tt.Horizontal?(o=l===0?Tt.None:l<0?Tt.Left:Tt.Right,i=l!==this.pX,s=Math.abs(e.deltaX)):(o=c===0?Tt.None:c<0?Tt.Up:Tt.Down,i=c!==this.pY,s=Math.abs(e.deltaY))),e.direction=o,i&&s>t.threshold&&!!(o&t.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Me.Began)||!(this.state&Me.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Tt[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const KR=["","start","move","end","cancel","in","out"];class GR extends x8{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[ru]}getEventNames(){return KR.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Me.Began))}emit(e){if(e.scale!==1){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}class Yu{constructor(e,t,i){this.element=e,this.callback=t,this.options=i}}const QR=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",JR=QR.indexOf("firefox")!==-1,z_=4.000244140625,eM=40,tM=.25;class nM extends Yu{constructor(e,t,i){super(e,t,{enable:!0,...i}),this.handleEvent=s=>{if(!this.options.enable)return;let o=s.deltaY;globalThis.WheelEvent&&(JR&&s.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(o/=globalThis.devicePixelRatio),s.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(o*=eM)),o!==0&&o%z_===0&&(o=Math.floor(o/z_)),s.shiftKey&&o&&(o=o*tM),this.callback({type:"wheel",center:{x:s.clientX,y:s.clientY},delta:-o,srcEvent:s,pointerType:"mouse",target:s.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){e==="wheel"&&(this.options.enable=t)}}const j_=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class iM extends Yu{constructor(e,t,i){super(e,t,{enable:!0,...i}),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;const{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,j_.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){j_.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const V_=["keydown","keyup"];class sM extends Yu{constructor(e,t,i){super(e,t,{enable:!0,tabIndex:0,...i}),this.handleEvent=s=>{const o=s.target||s.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:"keydown",srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:"keyup",srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",V_.forEach(s=>e.addEventListener(s,this.handleEvent))}destroy(){V_.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e==="keydown"&&(this.enableDownEvent=t),e==="keyup"&&(this.enableUpEvent=t)}}class rM extends Yu{constructor(e,t,i){super(e,t,i),this.handleEvent=s=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e==="contextmenu"&&(this.options.enable=t)}}const H_=1,Dp=2,$_=4,oM={pointerdown:H_,pointermove:Dp,pointerup:$_,mousedown:H_,mousemove:Dp,mouseup:$_},aM=0,lM=1,cM=2,uM=1,fM=2,hM=4;function dM(n){const e=oM[n.srcEvent.type];if(!e)return null;const{buttons:t,button:i}=n.srcEvent;let s=!1,o=!1,l=!1;return e===Dp?(s=!!(t&uM),o=!!(t&hM),l=!!(t&fM)):(s=i===aM,o=i===lM,l=i===cM),{leftButton:s,middleButton:o,rightButton:l}}function pM(n,e){const t=n.center;if(!t)return null;const i=e.getBoundingClientRect(),s=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1,l={x:(t.x-i.left-e.clientLeft)/s,y:(t.y-i.top-e.clientTop)/o};return{center:t,offsetCenter:l}}const gM={srcElement:"root",priority:0};class mM{constructor(e,t){this.handleEvent=i=>{if(this.isEmpty())return;const s=this._normalizeEvent(i);let o=i.srcEvent.target;for(;o&&o!==s.rootElement;){if(this._emit(s,o),s.handled)return;o=o.parentNode}this._emit(s,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,i,s=!1,o=!1){const{handlers:l,handlersByElement:c}=this,f={...gM,...i};let d=c.get(f.srcElement);d||(d=[],c.set(f.srcElement,d));const p={type:e,handler:t,srcElement:f.srcElement,priority:f.priority};s&&(p.once=!0),o&&(p.passive=!0),l.push(p),this._active=this._active||!p.passive;let _=d.length-1;for(;_>=0&&!(d[_].priority>=p.priority);)_--;d.splice(_+1,0,p)}remove(e,t){const{handlers:i,handlersByElement:s}=this;for(let o=i.length-1;o>=0;o--){const l=i[o];if(l.type===e&&l.handler===t){i.splice(o,1);const c=s.get(l.srcElement);c.splice(c.indexOf(l),1),c.length===0&&s.delete(l.srcElement)}}this._active=i.some(o=>!o.passive)}_emit(e,t){const i=this.handlersByElement.get(t);if(i){let s=!1;const o=()=>{e.handled=!0},l=()=>{e.handled=!0,s=!0},c=[];for(let f=0;f<i.length;f++){const{type:d,handler:p,once:_}=i[f];if(p({...e,type:d,stopPropagation:o,stopImmediatePropagation:l}),_&&c.push(i[f]),s)break}for(let f=0;f<c.length;f++){const{type:d,handler:p}=c[f];this.remove(d,p)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...dM(e),...pM(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function _M(n){if("recognizer"in n)return n;let e;const t=Array.isArray(n)?[...n]:[n];if(typeof t[0]=="function"){const i=t.shift(),s=t.shift()||{};e=new i(s)}else e=t.shift();return{recognizer:e,recognizeWith:typeof t[0]=="string"?[t[0]]:t[0],requireFailure:typeof t[1]=="string"?[t[1]]:t[1]}}class yM{constructor(e=null,t={}){if(this._onBasicInput=i=>{this.manager.emit(i.srcEvent.type,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,!!e){this.manager=new XR(e,this.options);for(const i of this.options.recognizers){const{recognizer:s,recognizeWith:o,requireFailure:l}=_M(i);this.manager.add(s),o&&s.recognizeWith(o),l&&s.requireFailure(l)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new nM(e,this._onOtherEvent,{enable:!1}),this.moveInput=new iM(e,this._onOtherEvent,{enable:!1}),this.keyInput=new sM(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new rM(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,i){this._addEventHandler(e,t,i,!1)}once(e,t,i){this._addEventHandler(e,t,i,!0)}watch(e,t,i){this._addEventHandler(e,t,i,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){const{manager:i}=this;if(!i)return;const s=i.get(e);s&&(s.set({enable:t}),i.touchAction.update()),this.wheelInput?.enableEventType(e,t),this.moveInput?.enableEventType(e,t),this.keyInput?.enableEventType(e,t),this.contextmenuInput?.enableEventType(e,t)}_addEventHandler(e,t,i,s,o){if(typeof e!="string"){i=t;for(const[d,p]of Object.entries(e))this._addEventHandler(d,p,i,s,o);return}const{manager:l,events:c}=this;if(!l)return;let f=c.get(e);if(!f){const d=this._getRecognizerName(e)||e;f=new mM(this,d),c.set(e,f),l&&l.on(e,f.handleEvent)}f.add(e,t,i,s,o),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const[o,l]of Object.entries(e))this._removeEventHandler(o,l);return}const{events:i}=this,s=i.get(e);if(s&&(s.remove(e,t),s.isEmpty())){const{recognizerName:o}=s;let l=!1;for(const c of i.values())if(c.recognizerName===o&&!c.isEmpty()){l=!0;break}l||this._toggleRecognizer(o,!1)}}_getRecognizerName(e){return this.manager.recognizers.find(t=>t.getEventNames().includes(e))?.options.event}}const Fe={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Fe,"IDENTITY",{get:()=>(ke.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const fn={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},vi={common:0,meters:1,pixels:2},Lp={click:"onClick",dblclick:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},W_={multipan:[F_,{threshold:10,direction:Tt.Vertical,pointers:2}],pinch:[GR,{},null,["multipan"]],pan:[F_,{threshold:1},["pinch"],["multipan"]],dblclick:[U_,{event:"dblclick",taps:2}],click:[U_,{event:"click"},null,["dblclick"]]};function bM(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let i=0;i<t;i++)if(n[i]!==e[i])return!1;return!0}return!1}function ol(n){let e={},t;return i=>{for(const s in i)if(!bM(i[s],e[s])){t=n(i),e=i;break}return t}}const X_=[0,0,0,0],vM=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],T8=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],xM=[0,0,0],w8=[0,0,0],TM=ol(AM);function S8(n,e,t=w8){t.length<3&&(t=[t[0],t[1],0]);let i=t,s,o=!0;switch(e===Fe.LNGLAT_OFFSETS||e===Fe.METER_OFFSETS?s=t:s=n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case fn.WEB_MERCATOR:(e===Fe.LNGLAT||e===Fe.CARTESIAN)&&(s=[0,0,0],o=!1);break;case fn.WEB_MERCATOR_AUTO_OFFSET:e===Fe.LNGLAT?i=s:e===Fe.CARTESIAN&&(i=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],s=n.unprojectPosition(i),i[0]-=t[0],i[1]-=t[1],i[2]-=t[2]);break;case fn.IDENTITY:i=n.position.map(Math.fround),i[2]=i[2]||0;break;case fn.GLOBE:o=!1,s=null;break;default:o=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:i,offsetMode:o}}function wM(n,e,t){const{viewMatrixUncentered:i,projectionMatrix:s}=n;let{viewMatrix:o,viewProjectionMatrix:l}=n,c=X_,f=X_,d=n.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:_,offsetMode:y}=S8(n,e,t);return y&&(f=n.projectPosition(p||_),d=[d[0]-f[0],d[1]-f[1],d[2]-f[2]],f[3]=1,c=_o([],f,l),o=i||o,l=Ds([],s,o),l=Ds([],l,vM)),{viewMatrix:o,viewProjectionMatrix:l,projectionCenter:c,originCommon:f,cameraPosCommon:d,shaderCoordinateOrigin:_,geospatialOrigin:p}}function SM({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:i=Fe.DEFAULT,coordinateOrigin:s=w8,autoWrapLongitude:o=!1}){i===Fe.DEFAULT&&(i=n.isGeospatial?Fe.LNGLAT:Fe.CARTESIAN);const l=TM({viewport:n,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:s});return l.wrapLongitude=o,l.modelMatrix=t||T8,l}function AM({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:i}){const{projectionCenter:s,viewProjectionMatrix:o,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:d}=wM(n,t,i),p=n.getDistanceScales(),_=[n.width*e,n.height*e],y=_o([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,v={coordinateSystem:t,projectionMode:n.projectionMode,coordinateOrigin:f,commonOrigin:l.slice(0,3),center:s,pseudoMeters:!!n._pseudoMeters,viewportSize:_,devicePixelRatio:e,focalDistance:y,commonUnitsPerMeter:p.unitsPerMeter,commonUnitsPerWorldUnit:p.unitsPerMeter,commonUnitsPerWorldUnit2:xM,scale:n.scale,wrapLongitude:!1,viewProjectionMatrix:o,modelMatrix:T8,cameraPosition:c};if(d){const x=n.getDistanceScales(d);switch(t){case Fe.METER_OFFSETS:v.commonUnitsPerWorldUnit=x.unitsPerMeter,v.commonUnitsPerWorldUnit2=x.unitsPerMeter2;break;case Fe.LNGLAT:case Fe.LNGLAT_OFFSETS:n._pseudoMeters||(v.commonUnitsPerMeter=x.unitsPerMeter),v.commonUnitsPerWorldUnit=x.unitsPerDegree,v.commonUnitsPerWorldUnit2=x.unitsPerDegree2;break;case Fe.CARTESIAN:v.commonUnitsPerWorldUnit=[1,1,x.unitsPerMeter[2]],v.commonUnitsPerWorldUnit2=[0,0,x.unitsPerMeter2[2]];break}}return v}const EM=Object.keys(Fe).map(n=>`const COORDINATE_SYSTEM_${n}: i32 = ${Fe[n]};`).join(""),CM=Object.keys(fn).map(n=>`const PROJECTION_MODE_${n}: i32 = ${fn[n]};`).join(""),RM=Object.keys(vi).map(n=>`const UNIT_${n.toUpperCase()}: i32 = ${vi[n]};`).join(""),MM=`${EM}
${CM}
${RM}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,PM=`${MM}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,OM=Object.keys(Fe).map(n=>`const int COORDINATE_SYSTEM_${n} = ${Fe[n]};`).join(""),IM=Object.keys(fn).map(n=>`const int PROJECTION_MODE_${n} = ${fn[n]};`).join(""),NM=Object.keys(vi).map(n=>`const int UNIT_${n.toUpperCase()} = ${vi[n]};`).join(""),kM=`${OM}
${IM}
${NM}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,DM={};function LM(n=DM){return"viewport"in n?SM(n):{}}const zg={name:"project",dependencies:[nR,g8],source:PM,vs:kM,getUniforms:LM,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},BM=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,UM=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,al={name:"project32",dependencies:[zg],source:BM,vs:UM};function FM(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Gr(n,e){const t=_o([],e,n);return f8(t,t,1/t[3]),t}function Y_(n,e){const t=n%e;return t<0?e+t:t}function Bp(n,e,t){return n<e?e:n>t?t:n}function zM(n){return Math.log(n)*Math.LOG2E}const jg=Math.log2||zM;function xi(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const In=Math.PI,A8=In/4,Sn=In/180,Up=180/In,so=512,Ou=4003e4,ns=85.051129,jM=1.5;function VM(n){return jg(n)}function Iu(n){const[e,t]=n;xi(Number.isFinite(e)),xi(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const i=e*Sn,s=t*Sn,o=so*(i+In)/(2*In),l=so*(In+Math.log(Math.tan(A8+s*.5)))/(2*In);return[o,l]}function ro(n){const[e,t]=n,i=e/so*(2*In)-In,s=2*(Math.atan(Math.exp(t/so*(2*In)-In))-A8);return[i*Up,s*Up]}function HM(n){const{latitude:e}=n;xi(Number.isFinite(e));const t=Math.cos(e*Sn);return VM(Ou*t)-9}function Wd(n){const e=Math.cos(n*Sn);return so/Ou/e}function Fp(n){const{latitude:e,longitude:t,highPrecision:i=!1}=n;xi(Number.isFinite(e)&&Number.isFinite(t));const s=so,o=Math.cos(e*Sn),l=s/360,c=l/o,f=s/Ou/o,d={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[l,c,f],degreesPerUnit:[1/l,1/c,1/f]};if(i){const p=Sn*Math.tan(e*Sn)/o,_=l*p/2,y=s/Ou*p,v=y/c*f;d.unitsPerDegree2=[0,_,y],d.unitsPerMeter2=[v,0,v]}return d}function E8(n,e){const[t,i,s]=n,[o,l,c]=e,{unitsPerMeter:f,unitsPerMeter2:d}=Fp({longitude:t,latitude:i,highPrecision:!0}),p=Iu(n);p[0]+=o*(f[0]+d[0]*l),p[1]+=l*(f[1]+d[1]*l);const _=ro(p),y=(s||0)+(c||0);return Number.isFinite(s)||Number.isFinite(c)?[_[0],_[1],y]:_}function $M(n){const{height:e,pitch:t,bearing:i,altitude:s,scale:o,center:l}=n,c=FM();Mu(c,c,[0,0,-s]),c8(c,c,-t*Sn),u8(c,c,i*Sn);const f=o/e;return Fg(c,c,[f,f,f]),l&&Mu(c,c,T5([],l)),c}function WM(n){const{width:e,height:t,altitude:i,pitch:s=0,offset:o,center:l,scale:c,nearZMultiplier:f=1,farZMultiplier:d=1}=n;let{fovy:p=Za(jM)}=n;i!==void 0&&(p=Za(i));const _=p*Sn,y=s*Sn,v=Vg(p);let x=v;l&&(x+=l[2]*c/Math.cos(y)/t);const S=_*(.5+(o?o[1]:0)/t),M=Math.sin(S)*x/Math.sin(Bp(Math.PI/2-y-S,.01,Math.PI-.01)),C=Math.sin(y)*M+x,U=x*10,R=Math.min(C*d,U);return{fov:_,aspect:e/t,focalDistance:v,near:f,far:R}}function Za(n){return 2*Math.atan(.5/n)*Up}function Vg(n){return .5/Math.tan(.5*n*Sn)}function C8(n,e){const[t,i,s=0]=n;return xi(Number.isFinite(t)&&Number.isFinite(i)&&Number.isFinite(s)),Gr(e,[t,i,s,1])}function Hg(n,e,t=0){const[i,s,o]=n;if(xi(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(o))return Gr(e,[i,s,o,1]);const l=Gr(e,[i,s,0,1]),c=Gr(e,[i,s,1,1]),f=l[2],d=c[2],p=f===d?0:((t||0)-f)/(d-f);return r8([],l,c,p)}function XM(n){const{width:e,height:t,bounds:i,minExtent:s=0,maxZoom:o=24,offset:l=[0,0]}=n,[[c,f],[d,p]]=i,_=YM(n.padding),y=Iu([c,Bp(p,-ns,ns)]),v=Iu([d,Bp(f,-ns,ns)]),x=[Math.max(Math.abs(v[0]-y[0]),s),Math.max(Math.abs(v[1]-y[1]),s)],S=[e-_.left-_.right-Math.abs(l[0])*2,t-_.top-_.bottom-Math.abs(l[1])*2];xi(S[0]>0&&S[1]>0);const M=S[0]/x[0],C=S[1]/x[1],U=(_.right-_.left)/2/M,R=(_.top-_.bottom)/2/C,D=[(v[0]+y[0])/2+U,(v[1]+y[1])/2+R],B=ro(D),Q=Math.min(o,jg(Math.abs(Math.min(M,C))));return xi(Number.isFinite(Q)),{longitude:B[0],latitude:B[1],zoom:Q}}function YM(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(xi(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const q_=Math.PI/180;function qM(n,e=0){const{width:t,height:i,unproject:s}=n,o={targetZ:e},l=s([0,i],o),c=s([t,i],o);let f,d;const p=n.fovy?.5*n.fovy*q_:Math.atan(.5/n.altitude),_=(90-n.pitch)*q_;return p>_-.01?(f=Z_(n,0,e),d=Z_(n,t,e)):(f=s([0,0],o),d=s([t,0],o)),[l,c,d,f]}function Z_(n,e,t){const{pixelUnprojectionMatrix:i}=n,s=Gr(i,[e,0,1,1]),o=Gr(i,[e,n.height,1,1]),c=(t*n.distanceScales.unitsPerMeter[2]-s[2])/(o[2]-s[2]),f=r8([],s,o,c),d=ro(f);return d.push(t),d}const K_=512;function ZM(n){const{width:e,height:t,pitch:i=0}=n;let{longitude:s,latitude:o,zoom:l,bearing:c=0}=n;(s<-180||s>180)&&(s=Y_(s+180,360)-180),(c<-180||c>180)&&(c=Y_(c+180,360)-180);const f=jg(t/K_);if(l<=f)l=f,o=0;else{const d=t/2/Math.pow(2,l),p=ro([0,d])[1];if(o<p)o=p;else{const _=ro([0,K_-d])[1];o>_&&(o=_)}}return{width:e,height:t,longitude:s,latitude:o,zoom:l,pitch:i,bearing:c}}const R8=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,KM=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,GM=`
${R8}
${KM}
`,QM=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,JM=`
${R8}
${QM}
`,eP=ol(rP),tP=ol(oP),nP=[0,0,0,1],iP=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function sP(n,e){const[t,i,s]=n,o=Hg([t,i,s],e);return Number.isFinite(s)?o:[o[0],o[1],0]}function rP({viewport:n,center:e}){return new Dn(n.viewProjectionMatrix).invert().transform(e)}function oP({viewport:n,shadowMatrices:e}){const t=[],i=n.pixelUnprojectionMatrix,s=n.isGeospatial?void 0:1,o=[[0,0,s],[n.width,0,s],[0,n.height,s],[n.width,n.height,s],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(l=>sP(l,i));for(const l of e){const c=l.clone().translate(new Zn(n.center).negate()),f=o.map(p=>c.transform(p)),d=new Dn().ortho({left:Math.min(...f.map(p=>p[0])),right:Math.max(...f.map(p=>p[0])),bottom:Math.min(...f.map(p=>p[1])),top:Math.max(...f.map(p=>p[1])),near:Math.min(...f.map(p=>-p[2])),far:Math.max(...f.map(p=>-p[2]))});t.push(d.multiplyRight(l))}return t}function aP(n){const{shadowEnabled:e=!0,project:t}=n;if(!e||!t||!n.shadowMatrices||!n.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};const i=zg.getUniforms(t),s=eP({viewport:t.viewport,center:i.center}),o=[],l=tP({shadowMatrices:n.shadowMatrices,viewport:t.viewport}).slice();for(let f=0;f<n.shadowMatrices.length;f++){const d=l[f],p=d.clone().translate(new Zn(t.viewport.center).negate());i.coordinateSystem===Fe.LNGLAT&&i.projectionMode===fn.WEB_MERCATOR?(l[f]=p,o[f]=s):(l[f]=d.clone().multiplyRight(iP),o[f]=p.transform(s))}const c={drawShadowMap:!!n.drawToShadowMap,useShadowMap:n.shadowMaps?n.shadowMaps.length>0:!1,color:n.shadowColor||nP,lightId:n.shadowLightId||0,lightCount:n.shadowMatrices.length,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};for(let f=0;f<l.length;f++)c[`viewProjectionMatrix${f}`]=l[f],c[`projectCenter${f}`]=o[f];for(let f=0;f<2;f++)c[`shadow_uShadowMap${f}`]=n.shadowMaps&&n.shadowMaps[f]||n.dummyShadowMap;return c}const G_={name:"shadow",dependencies:[zg],vs:GM,fs:JM,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:aP,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},ll={...R_,defaultUniforms:{...R_.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},lP=[g8],cP=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],uP=[];function fP(n){const e=Ps.getDefaultShaderAssembler();for(const i of lP)e.addDefaultModule(i);e._hookFunctions.length=0;const t=n==="glsl"?cP:uP;for(const i of t)e.addShaderHook(i);return e}const hP=[255,255,255],dP=1;let pP=0;class gP{constructor(e={}){this.type="ambient";const{color:t=hP}=e,{intensity:i=dP}=e;this.id=e.id||`ambient-${pP++}`,this.color=t,this.intensity=i}}const mP=[255,255,255],_P=1,yP=[0,0,-1];let bP=0;class Q_{constructor(e={}){this.type="directional";const{color:t=mP}=e,{intensity:i=_P}=e,{direction:s=yP}=e,{_shadow:o=!1}=e;this.id=e.id||`directional-${bP++}`,this.color=t,this.intensity=i,this.type="directional",this.direction=new Zn(s).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}}class vP{constructor(e,t={id:"pass"}){const{id:i}=t;this.id=i,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class $g extends vP{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,i]=this.device.canvasContext.getDrawingBufferSize(),s=e.clearCanvas??!0,o=e.clearColor??(s?[0,0,0,0]:!1),l=s?1:!1,c=s?0:!1,f=e.colorMask??15,d={viewport:[0,0,t,i]};e.colorMask&&(d.colorMask=f),e.scissorRect&&(d.scissorRect=e.scissorRect);const p=this.device.beginRenderPass({framebuffer:e.target,parameters:d,clearColor:o,clearDepth:l,clearStencil:c});try{return this._drawLayers(p,e)}finally{p.end(),this.device.submit()}}_drawLayers(e,t){const{target:i,shaderModuleProps:s,viewports:o,views:l,onViewportActive:c,clearStack:f=!0}=t;t.pass=t.pass||"unknown",f&&(this._lastRenderIndex=-1);const d=[];for(const p of o){const _=l&&l[p.id];c?.(p);const y=this._getDrawLayerParams(p,t),v=p.subViewports||[p];for(const x of v){const S=this._drawLayersInViewport(e,{target:i,shaderModuleProps:s,viewport:x,view:_,pass:t.pass,layers:t.layers},y);d.push(S)}}return d}_getDrawLayerParams(e,{layers:t,pass:i,isPicking:s=!1,layerFilter:o,cullRect:l,effects:c,shaderModuleProps:f},d=!1){const p=[],_=M8(this._lastRenderIndex+1),y={layer:t[0],viewport:e,isPicking:s,renderPass:i,cullRect:l},v={};for(let x=0;x<t.length;x++){const S=t[x],M=this._shouldDrawLayer(S,y,o,v),C={shouldDrawLayer:M};M&&!d&&(C.shouldDrawLayer=!0,C.layerRenderIndex=_(S,M),C.shaderModuleProps=this._getShaderModuleProps(S,c,i,f),C.layerParameters={...S.context.deck?.props.parameters,...this.getLayerParameters(S,x,e)}),p[x]=C}return p}_drawLayersInViewport(e,{layers:t,shaderModuleProps:i,pass:s,target:o,viewport:l,view:c},f){const d=xP(this.device,{shaderModuleProps:i,target:o,viewport:l});if(c){const{clear:_,clearColor:y,clearDepth:v,clearStencil:x}=c.props;if(_){let S=[0,0,0,0],M=1,C=0;Array.isArray(y)?S=[...y.slice(0,3),y[3]||255].map(R=>R/255):y===!1&&(S=!1),v!==void 0&&(M=v),x!==void 0&&(C=x),this.device.beginRenderPass({framebuffer:o,parameters:{viewport:d,scissorRect:d},clearColor:S,clearDepth:M,clearStencil:C}).end()}}const p={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:d});for(let _=0;_<t.length;_++){const y=t[_],v=f[_],{shouldDrawLayer:x}=v;if(x&&y.props.pickable&&p.pickableCount++,y.isComposite&&p.compositeCount++,y.isDrawable&&v.shouldDrawLayer){const{layerRenderIndex:S,shaderModuleProps:M,layerParameters:C}=v;p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,S),M.project&&(M.project.viewport=l),y.context.renderPass=e;try{y._drawLayer({renderPass:e,shaderModuleProps:M,uniforms:{layerIndex:S},parameters:C})}catch(U){y.raiseError(U,`drawing ${y} to ${s}`)}}}return p}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,i){return null}getLayerParameters(e,t,i){return e.props.parameters}_shouldDrawLayer(e,t,i,s){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(t))return!1;t.layer=l,l=l.parent}if(i){const c=t.layer.id;if(c in s||(s[c]=i(t)),!s[c])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,i,s){const o=this.device.canvasContext.cssToDeviceRatio(),l=e.internalState?.propsInTransition||e.props,c={layer:l,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:o,modelMatrix:l.modelMatrix,coordinateSystem:l.coordinateSystem,coordinateOrigin:l.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const f of t)J_(c,f.getShaderModuleProps?.(e,c));return J_(c,this.getShaderModuleProps(e,t,c),s)}}function M8(n=0,e={}){const t={},i=(s,o)=>{const l=s.props._offset,c=s.id,f=s.parent&&s.parent.id;let d;if(f&&!(f in e)&&i(s.parent,!1),f in t){const p=t[f]=t[f]||M8(e[f],e);d=p(s,o),t[c]=p}else Number.isFinite(l)?(d=l+(e[f]||0),t[c]=null):d=n;return o&&d>=n&&(n=d+1),e[c]=d,d};return i}function xP(n,{shaderModuleProps:e,target:t,viewport:i}){const s=e?.project?.devicePixelRatio??n.canvasContext.cssToDeviceRatio(),[,o]=n.canvasContext.getDrawingBufferSize(),l=t?t.height:o,c=i;return[c.x*s,l-(c.y+c.height)*s,c.width*s,c.height*s]}function J_(n,...e){for(const t of e)if(t)for(const i in t)n[i]?Object.assign(n[i],t[i]):n[i]=t[i];return n}class TP extends $g{constructor(e,t){super(e,t);const i=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),s=e.createTexture({format:"depth16unorm",width:1,height:1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[i],depthStencilAttachment:s})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),s=e.viewports[0],o=s.width*i,l=s.height*i,c=[1,1,1,1];(o!==t.width||l!==t.height)&&t.resize({width:o,height:l}),super.render({...e,clearColor:c,target:t,pass:"shadow"})}getLayerParameters(e,t,i){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,t,i){return{shadow:{project:i.project,drawToShadowMap:!0}}}}const wP={color:[255,255,255],intensity:1},ey=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],SP=[0,0,0,200/255];class P8{constructor(e={}){this.id="lighting-effect",this.shadowColor=SP,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:i}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),i._addDefaultShaderModule(G_),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const i=e[t];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:i,onViewportActive:s,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:e,layerFilter:t,viewports:i,onViewportActive:s,views:o,shaderModuleProps:{shadow:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,t){const i=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(l=>l.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},s={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(l=>l.getProjectedLight({layer:e})),pointLights:this.pointLights.map(l=>l.getProjectedLight({layer:e}))},o=e.props.material;return{shadow:i,lighting:s,phongMaterial:o,gouraudMaterial:o}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(G_))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const i=new Dn().lookAt({eye:new Zn(t.direction).negate()});e.push(i)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const i=new TP(e);this.shadowPasses[t]=i}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:i}=this;!e&&t.length===0&&i.length===0&&(this.ambientLight=new gP(wP),this.directionalLights.push(new Q_(ey[0]),new Q_(ey[1])))}}class AP{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:i=1,type:s,padding:o=0,copy:l=!1,initialize:c=!1,maxCount:f}){const d=s||e&&e.constructor||Float32Array,p=t*i+o;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new d(e.buffer,0,p)}let _=1/0;f&&(_=f*i+o);const y=this._allocate(d,p,c,_);return e&&l?y.set(e):c||y.fill(0,0,4),this._release(e),y}release(e){this._release(e)}_allocate(e,t,i,s){let o=Math.max(Math.ceil(t*this.opts.overAlloc),1);o>s&&(o=s);const l=this._pool,c=e.BYTES_PER_ELEMENT*o,f=l.findIndex(d=>d.byteLength>=c);if(f>=0){const d=new e(l.splice(f,1)[0],0,o);return i&&d.fill(0),d}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:i}=e,{byteLength:s}=i,o=t.findIndex(l=>l.byteLength>=s);o<0?t.push(i):(o>0||t.length<this.opts.poolSize)&&t.splice(o,0,i),t.length>this.opts.poolSize&&t.shift()}}const oo=new AP;function Pa(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function EP(n){return[n[12],n[13],n[14]]}function CP(n){return{left:zr(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:zr(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:zr(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:zr(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:zr(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:zr(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}const ty=new Zn;function zr(n,e,t,i){ty.set(n,e,t);const s=ty.len();return{distance:i/s,normal:new Zn(-n/s,-e/s,-t/s)}}function RP(n){return n-Math.fround(n)}let wa;function Xd(n,e){const{size:t=1,startIndex:i=0}=e,s=e.endIndex!==void 0?e.endIndex:n.length,o=(s-i)/t;wa=oo.allocate(wa,o,{type:Float32Array,size:t*2});let l=i,c=0;for(;l<s;){for(let f=0;f<t;f++){const d=n[l++];wa[c+f]=d,wa[c+f+t]=RP(d)}c+=t*2}return wa.subarray(0,o*t*2)}function MP(n){let e=null,t=!1;for(const i of n)i&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}const PP=Math.PI/180,OP=Pa(),ny=[0,0,0],IP={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function NP({width:n,height:e,orthographic:t,fovyRadians:i,focalDistance:s,padding:o,near:l,far:c}){const f=n/e,d=t?new Dn().orthographic({fovy:i,aspect:f,focalDistance:s,near:l,far:c}):new Dn().perspective({fovy:i,aspect:f,near:l,far:c});if(o){const{left:p=0,right:_=0,top:y=0,bottom:v=0}=o,x=ts((p+n-_)/2,0,n)-n/2,S=ts((y+e-v)/2,0,e)-e/2;d[8]-=x*2/n,d[9]+=S*2/e}return d}class yo{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||IP,this.focalDistance=e.focalDistance||1,this.position=e.position||ny,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:i}=e;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?fn.WEB_MERCATOR:fn.WEB_MERCATOR_AUTO_OFFSET:fn.IDENTITY}equals(e){return e instanceof yo?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Ya(e.projectionMatrix,this.projectionMatrix)&&Ya(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:t=!0}={}){const i=this.projectPosition(e),s=C8(i,this.pixelProjectionMatrix),[o,l]=s,c=t?l:this.height-l;return e.length===2?[o,c]:[o,c,s[2]]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[s,o,l]=e,c=t?o:this.height-o,f=i&&i*this.distanceScales.unitsPerMeter[2],d=Hg([s,c,l],this.pixelUnprojectionMatrix,f),[p,_,y]=this.unprojectPosition(d);return Number.isFinite(l)?[p,_,y]:Number.isFinite(i)?[p,_,i]:[p,_]}projectPosition(e){const[t,i]=this.projectFlat(e),s=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,i,s]}unprojectPosition(e){const[t,i]=this.unprojectFlat(e),s=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,i,s]}projectFlat(e){if(this.isGeospatial){const t=Iu(e);return t[1]=ts(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?ro(e):e}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,0],t),s=this.unproject([this.width,0],t),o=this.unproject([0,this.height],t),l=this.unproject([this.width,this.height],t);return[Math.min(i[0],s[0],o[0],l[0]),Math.min(i[1],s[1],o[1],l[1]),Math.max(i[0],s[0],o[0],l[0]),Math.max(i[1],s[1],o[1],l[1])]}getDistanceScales(e){return e&&this.isGeospatial?Fp({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:i=1,height:s=1}){return e<this.x+this.width&&this.x<e+i&&t<this.y+this.height&&this.y<t+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,CP(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t,i){return null}_initProps(e){const t=e.longitude,i=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=HM({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Fp({latitude:i,longitude:t}));const s=Math.pow(2,this.zoom);this.scale=s;const{position:o,modelMatrix:l}=e;let c=ny;if(o&&(c=l?new Dn(l).transformAsVector(o,[]):o),this.isGeospatial){const f=this.projectPosition([t,i,0]);this.center=new Zn(c).scale(this.distanceScales.unitsPerMeter).add(f)}else this.center=this.projectPosition(c)}_initMatrices(e){const{viewMatrix:t=OP,projectionMatrix:i=null,orthographic:s=!1,fovyRadians:o,fovy:l=75,near:c=.1,far:f=1e3,padding:d=null,focalDistance:p=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new Dn().multiplyRight(t).translate(new Zn(this.center).negate()),this.projectionMatrix=i||NP({width:this.width,height:this.height,orthographic:s,fovyRadians:o||l*PP,focalDistance:p,padding:d,near:c,far:f});const _=Pa();Ds(_,_,this.projectionMatrix),Ds(_,_,this.viewMatrix),this.viewProjectionMatrix=_,this.viewMatrixInverse=Pp([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=EP(this.viewMatrixInverse);const y=Pa(),v=Pa();Fg(y,y,[this.width/2,-this.height/2,1]),Mu(y,y,[1,-1,0]),Ds(v,y,this.viewProjectionMatrix),this.pixelProjectionMatrix=v,this.pixelUnprojectionMatrix=Pp(Pa(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||ke.warn("Pixel project matrix not invertible")()}}yo.displayName="Viewport";class ao extends yo{constructor(e={}){const{latitude:t=0,longitude:i=0,zoom:s=0,pitch:o=0,bearing:l=0,nearZMultiplier:c=.1,farZMultiplier:f=1.01,nearZ:d,farZ:p,orthographic:_=!1,projectionMatrix:y,repeat:v=!1,worldOffset:x=0,position:S,padding:M,legacyMeterSizes:C=!1}=e;let{width:U,height:R,altitude:D=1.5}=e;const B=Math.pow(2,s);U=U||1,R=R||1;let Q,ce=null;if(y)D=y[5]/2,Q=Za(D);else{e.fovy?(Q=e.fovy,D=Vg(Q)):Q=Za(D);let ee;if(M){const{top:he=0,bottom:de=0}=M;ee=[0,ts((he+R-de)/2,0,R)-R/2]}ce=WM({width:U,height:R,scale:B,center:S&&[0,0,S[2]*Wd(t)],offset:ee,pitch:o,fovy:Q,nearZMultiplier:c,farZMultiplier:f}),Number.isFinite(d)&&(ce.near=d),Number.isFinite(p)&&(ce.far=p)}let Z=$M({height:R,pitch:o,bearing:l,scale:B,altitude:D});x&&(Z=new Dn().translate([512*x,0,0]).multiplyLeft(Z)),super({...e,width:U,height:R,viewMatrix:Z,longitude:i,latitude:t,zoom:s,...ce,fovy:Q,focalDistance:D}),this.latitude=t,this.longitude=i,this.zoom=s,this.pitch=o,this.bearing=l,this.altitude=D,this.fovy=Q,this.orthographic=_,this._subViewports=v?[]:null,this._pseudoMeters=C,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),i=Math.ceil((e[2]-180)/360);for(let s=t;s<=i;s++){const o=s?new ao({...this,worldOffset:s}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,i]=this.projectFlat(e),s=(e[2]||0)*Wd(e[1]);return[t,i,s]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,i]=this.unprojectFlat(e),s=(e[2]||0)/Wd(i);return[t,i,s]}addMetersToLngLat(e,t){return E8(e,t)}panByPosition(e,t,i){const s=Hg(t,this.pixelUnprojectionMatrix),o=this.projectFlat(e),l=E_([],o,p5([],s)),c=E_([],this.center,l),[f,d]=this.unprojectFlat(c);return{longitude:f,latitude:d}}getBounds(e={}){const t=qM(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:i,height:s}=this,{longitude:o,latitude:l,zoom:c}=XM({width:i,height:s,bounds:e,...t});return new ao({width:i,height:s,longitude:o,latitude:l,zoom:c})}}ao.displayName="WebMercatorViewport";const iy=[0,0,0];function Yd(n,e,t=!1){const i=e.projectPosition(n);if(t&&e instanceof ao){const[s,o,l=0]=n,c=e.getDistanceScales([s,o]);i[2]=l*c.unitsPerMeter[2]}return i}function kP(n){const{viewport:e,modelMatrix:t,coordinateOrigin:i}=n;let{coordinateSystem:s,fromCoordinateSystem:o,fromCoordinateOrigin:l}=n;return s===Fe.DEFAULT&&(s=e.isGeospatial?Fe.LNGLAT:Fe.CARTESIAN),o===void 0&&(o=s),l===void 0&&(l=i),{viewport:e,coordinateSystem:s,coordinateOrigin:i,modelMatrix:t,fromCoordinateSystem:o,fromCoordinateOrigin:l}}function O8(n,{viewport:e,modelMatrix:t,coordinateSystem:i,coordinateOrigin:s,offsetMode:o}){let[l,c,f=0]=n;switch(t&&([l,c,f]=_o([],[l,c,f,1],t)),i){case Fe.LNGLAT:return Yd([l,c,f],e,o);case Fe.LNGLAT_OFFSETS:return Yd([l+s[0],c+s[1],f+(s[2]||0)],e,o);case Fe.METER_OFFSETS:return Yd(E8(s,[l,c,f]),e,o);case Fe.CARTESIAN:default:return e.isGeospatial?[l+s[0],c+s[1],f+s[2]]:e.projectPosition([l,c,f])}}function DP(n,e){const{viewport:t,coordinateSystem:i,coordinateOrigin:s,modelMatrix:o,fromCoordinateSystem:l,fromCoordinateOrigin:c}=kP(e),{autoOffset:f=!0}=e,{geospatialOrigin:d=iy,shaderCoordinateOrigin:p=iy,offsetMode:_=!1}=f?S8(t,i,s):{},y=O8(n,{viewport:t,modelMatrix:o,coordinateSystem:l,coordinateOrigin:c,offsetMode:_});if(_){const v=t.projectPosition(d||p);l8(y,y,v)}return y}let LP=1,BP=1;class I8{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(e){const{delay:t=0,duration:i=Number.POSITIVE_INFINITY,rate:s=1,repeat:o=1}=e,l=LP++,c={time:0,delay:t,duration:i,rate:s,repeat:o};return this._setChannelTime(c,this.time),this.channels.set(l,c),l}removeChannel(e){this.channels.delete(e);for(const[t,i]of this.animations)i.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const s of t)this._setChannelTime(s,this.time);const i=this.animations.values();for(const s of i){const{animation:o,channel:l}=s;o.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const i=BP++;return this.animations.set(i,{animation:e,channel:t}),e.setTime(this.getTime(t)),i}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const i=t-e.delay,s=e.duration*e.repeat;i>=s?e.time=e.duration*e.rate:(e.time=Math.max(0,i)%e.duration,e.time*=e.rate)}}function UP(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}function FP(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}let zP=0;class Wg{static defaultAnimationLoopProps={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Ep.stats.get(`animation-loop-${zP++}`),autoResizeViewport:!1};device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;_error=null;constructor(e){if(this.props={...Wg.defaultAnimationLoopProps,...e},e=this.props,!e.device)throw new Error("No device provided");this.stats=e.stats||new ju({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}reportError(e){this.props.onError(e),this._error=e}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=UP(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(FP(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),this.device?.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeViewport()}_initializeAnimationProps(){const e=this.device?.getDefaultCanvasContext();if(!this.device||!e)throw new Error("loop");const t=e?.canvas,i=e.props.useDevicePixels;this.animationProps={animationLoop:this,device:this.device,canvasContext:e,canvas:t,useDevicePixels:i,timeline:this.timeline,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:i}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.getDefaultCanvasContext().canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const i=this.props.onAddHTML(t);i&&(t.innerHTML=i)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=this.device?.getDefaultCanvasContext().getDevicePixelSize()||[1,1];let i=1;const s=this.device?.getDefaultCanvasContext().canvas;return s&&s.clientHeight?i=s.clientWidth/s.clientHeight:e>0&&t>0&&(i=e/t),{width:e,height:t,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const qd={};function cl(n="id"){qd[n]=qd[n]||1;const e=qd[n]++;return`${n}-${e}`}class sy{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(e){if(this.id=e.id||cl("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&tt.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){this.indices?.destroy();for(const e of Object.values(this.attributes))e.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function jP(n,e){if(e instanceof sy)return e;const t=VP(n,e),{attributes:i,bufferLayout:s}=HP(n,e);return new sy({topology:e.topology||"triangle-list",bufferLayout:s,vertexCount:e.vertexCount,indices:t,attributes:i})}function VP(n,e){if(!e.indices)return;const t=e.indices.value;return n.createBuffer({usage:tt.INDEX,data:t})}function HP(n,e){const t=[],i={};for(const[o,l]of Object.entries(e.attributes)){let c=o;switch(o){case"POSITION":c="positions";break;case"NORMAL":c="normals";break;case"TEXCOORD_0":c="texCoords";break;case"COLOR_0":c="colors";break}if(l){i[c]=n.createBuffer({data:l.value,id:`${o}-buffer`});const{value:f,size:d,normalized:p}=l;t.push({name:c,format:OE(f,d,p)})}}const s=e._calculateVertexCount(e.attributes,e.indices);return{attributes:i,bufferLayout:t,vertexCount:s}}class Xg{static defaultProps={...ks.defaultProps};static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new Xg(e),e._lumaData.defaultPipelineFactory}device;cachingEnabled;destroyPolicy;debug;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};get[Symbol.toStringTag](){return"PipelineFactory"}toString(){return`PipelineFactory(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cachePipelines,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=e.props.debugFactories}createRenderPipeline(e){if(!this.cachingEnabled)return this.device.createRenderPipeline(e);const t={...ks.defaultProps,...e},i=this._renderPipelineCache,s=this._hashRenderPipeline(t);let o=i[s]?.pipeline;return o?(i[s].useCount++,this.debug&&le.log(3,`${this}: ${i[s].pipeline} reused, count=${i[s].useCount}, (id=${e.id})`)()):(o=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:cl("unnamed-cached")}),o.hash=s,i[s]={pipeline:o,useCount:1},this.debug&&le.log(3,`${this}: ${o} created, count=${i[s].useCount}`)()),o}createComputePipeline(e){if(!this.cachingEnabled)return this.device.createComputePipeline(e);const t={...xu.defaultProps,...e},i=this._computePipelineCache,s=this._hashComputePipeline(t);let o=i[s]?.pipeline;return o?(i[s].useCount++,this.debug&&le.log(3,`${this}: ${i[s].pipeline} reused, count=${i[s].useCount}, (id=${e.id})`)()):(o=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0}),o.hash=s,i[s]={pipeline:o,useCount:1},this.debug&&le.log(3,`${this}: ${o} created, count=${i[s].useCount}`)()),o}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._getCache(e),i=e.hash;t[i].useCount--,t[i].useCount===0?(this._destroyPipeline(e),this.debug&&le.log(3,`${this}: ${e} released and destroyed`)()):t[i].useCount<0?(le.error(`${this}: ${e} released, useCount < 0, resetting`)(),t[i].useCount=0):this.debug&&le.log(3,`${this}: ${e} released, count=${t[i].useCount}`)()}_destroyPipeline(e){const t=this._getCache(e);switch(this.destroyPolicy){case"never":return!1;case"unused":return delete t[e.hash],e.destroy(),!0}}_getCache(e){let t;if(e instanceof xu&&(t=this._computePipelineCache),e instanceof ks&&(t=this._renderPipelineCache),!t)throw new Error(`${this}`);if(!t[e.hash])throw new Error(`${this}: ${e} matched incorrect entry`);return t}_hashComputePipeline(e){const{type:t}=this.device,i=this._getHash(e.shader.source);return`${t}/C/${i}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,i=e.fs?this._getHash(e.fs.source):0,s="-",o=this._getHash(JSON.stringify(e.bufferLayout)),{type:l}=this.device;switch(l){case"webgl":return`${l}/R/${t}/${i}V${s}BL${o}`;case"webgpu":default:const c=this._getHash(JSON.stringify(e.parameters));return`${l}/R/${t}/${i}V${s}T${e.topology}P${c}BL${o}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}}class Yg{static defaultProps={...Wu.defaultProps};static getDefaultShaderFactory(e){return e._lumaData.defaultShaderFactory||=new Yg(e),e._lumaData.defaultShaderFactory}device;cachingEnabled;destroyPolicy;debug;_cache={};get[Symbol.toStringTag](){return"ShaderFactory"}toString(){return`${this[Symbol.toStringTag]}(${this.device.id})`}constructor(e){this.device=e,this.cachingEnabled=e.props._cacheShaders,this.destroyPolicy=e.props._cacheDestroyPolicy,this.debug=!0}createShader(e){if(!this.cachingEnabled)return this.device.createShader(e);const t=this._hashShader(e);let i=this._cache[t];if(i)i.useCount++,this.debug&&le.log(3,`${this}: Reusing shader ${i.shader.id} count=${i.useCount}`)();else{const s=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=i={shader:s,useCount:1},this.debug&&le.log(3,`${this}: Created new shader ${s.id}`)()}return i.shader}release(e){if(!this.cachingEnabled){e.destroy();return}const t=this._hashShader(e),i=this._cache[t];if(i)if(i.useCount--,i.useCount===0)this.destroyPolicy==="unused"&&(delete this._cache[t],i.shader.destroy(),this.debug&&le.log(3,`${this}: Releasing shader ${e.id}, destroyed`)());else{if(i.useCount<0)throw new Error(`ShaderFactory: Shader ${e.id} released too many times`);this.debug&&le.log(3,`${this}: Releasing shader ${e.id} count=${i.useCount}`)()}}_hashShader(e){return`${e.stage}:${e.source}`}}function $P(n,e){const t={},i="Values";if(n.attributes.length===0&&!n.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(const s of n.attributes)if(s){const o=`${s.location} ${s.name}: ${s.type}`;t[`in ${o}`]={[i]:s.stepMode||"vertex"}}for(const s of n.varyings||[]){const o=`${s.location} ${s.name}`;t[`out ${o}`]={[i]:JSON.stringify(s)}}return t}let Rt=null,Zd=null;function WP(n,{id:e,minimap:t,opaque:i,top:s="0",left:o="0",rgbaScale:l=1}){Rt||(Rt=document.createElement("canvas"),Rt.id=e,Rt.title=e,Rt.style.zIndex="100",Rt.style.position="absolute",Rt.style.top=s,Rt.style.left=o,Rt.style.border="blue 5px solid",Rt.style.transform="scaleY(-1)",document.body.appendChild(Rt),Zd=Rt.getContext("2d")),(Rt.width!==n.width||Rt.height!==n.height)&&(Rt.width=n.width/2,Rt.height=n.height/2,Rt.style.width="400px",Rt.style.height="400px");const c=n.device.readPixelsToArrayWebGL(n),f=Zd?.createImageData(n.width,n.height);if(f){for(let p=0;p<c.length;p+=4)f.data[0+p+0]=c[p+0]*l,f.data[0+p+1]=c[p+1]*l,f.data[0+p+2]=c[p+2]*l,f.data[0+p+3]=i?255:c[p+3]*l;Zd?.putImageData(f,0,0)}}function zp(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!zp(n[i],e[i],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const i=Object.keys(n),s=Object.keys(e);if(i.length!==s.length)return!1;for(const o of i)if(!e.hasOwnProperty(o)||!zp(n[o],e[o],t-1))return!1;return!0}return!1}class Kd{bufferLayouts;constructor(e){this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){return e.attributes?e.attributes?.map(t=>t.attribute):[e.name]}mergeBufferLayouts(e,t){const i=[...e];for(const s of t){const o=i.findIndex(l=>l.name===s.name);o<0?i.push(s):i[o]=s}return i}getBufferIndex(e){const t=this.bufferLayouts.findIndex(i=>i.name===e);return t===-1&&le.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}function XP(n,e){const t=Object.fromEntries(n.attributes.map(s=>[s.name,s.location])),i=e.slice();return i.sort((s,o)=>{const l=s.attributes?s.attributes.map(p=>p.attribute):[s.name],c=o.attributes?o.attributes.map(p=>p.attribute):[o.name],f=Math.min(...l.map(p=>t[p])),d=Math.min(...c.map(p=>t[p]));return f-d}),i}function YP(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function qP(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function ZP(n){return YP(n)||qP(n)}function KP(n){return ZP(n)||typeof n=="number"||typeof n=="boolean"}function GP(n){const e={bindings:{},uniforms:{}};return Object.keys(n).forEach(t=>{const i=n[t];KP(i)?e.uniforms[t]=i:e.bindings[t]=i}),e}class QP{options={disableWarnings:!1};modules;moduleUniforms;moduleBindings;constructor(e,t){Object.assign(this.options,t);const i=vg(Object.values(e).filter(s=>s.dependencies));for(const s of i)e[s.name]=s;le.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[s,o]of Object.entries(e))this._addModule(o),o.name&&s!==o.name&&!this.options.disableWarnings&&le.warn(`Module name: ${s} vs ${o.name}`)()}destroy(){}setProps(e){for(const t of Object.keys(e)){const i=t,s=e[i]||{},o=this.modules[i];if(!o){this.options.disableWarnings||le.warn(`Module ${t} not found`)();continue}const l=this.moduleUniforms[i],c=this.moduleBindings[i],f=o.getUniforms?.(s,l)||s,{uniforms:d,bindings:p}=GP(f);this.moduleUniforms[i]={...l,...d},this.moduleBindings[i]={...c,...p}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){const e={};for(const[t,i]of Object.entries(this.moduleUniforms))for(const[s,o]of Object.entries(i))e[`${t}.${s}`]={type:this.modules[t].uniformTypes?.[s],value:String(o)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let JP="";async function eO(n,e){const t=new Image;return t.crossOrigin="anonymous",t.src=n.startsWith("http")?n:JP+n,await t.decode(),e?await createImageBitmap(t,e):await createImageBitmap(t)}const tO=["+X","-X","+Y","-Y","+Z","-Z"],nO=["+X","-X","+Y","-Y","+Z","-Z"];class Fa{device;id;props;texture;sampler;view;ready;isReady=!1;destroyed=!1;resolveReady=()=>{};rejectReady=()=>{};get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}constructor(e,t){this.device=e;const i=cl("async-texture");this.props={...Fa.defaultProps,id:i,...t},this.id=this.props.id,t={...t},typeof t?.data=="string"&&t.dimension==="2d"&&(t.data=eO(t.data)),t.mipmaps&&(t.mipLevels="auto"),this.ready=new Promise((s,o)=>{this.resolveReady=()=>{this.isReady=!0,s()},this.rejectReady=o}),this.initAsync(t)}async initAsync(e){const t=e.data,i=await N8(t).then(void 0,this.rejectReady);if(this.destroyed)return;const s=this.props.width&&this.props.height?{width:this.props.width,height:this.props.height}:this.getTextureDataSize(i);if(!s)throw new Error("Texture size could not be determined");const o={...s,...e,data:void 0,mipLevels:1},l=this.device.getMipLevelCount(o.width,o.height);if(o.mipLevels=this.props.mipLevels==="auto"?l:Math.min(l,this.props.mipLevels),this.texture=this.device.createTexture(o),this.sampler=this.texture.sampler,this.view=this.texture.view,e.data)switch(this.props.dimension){case"1d":this._setTexture1DData(this.texture,i);break;case"2d":this._setTexture2DData(i);break;case"3d":this._setTexture3DData(this.texture,i);break;case"2d-array":this._setTextureArrayData(this.texture,i);break;case"cube":this._setTextureCubeData(this.texture,i);break;case"cube-array":this._setTextureCubeArrayData(this.texture,i);break}this.props.mipmaps&&this.generateMipmaps(),le.info(1,`${this} loaded`),this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}generateMipmaps(){this.texture.generateMipmapsWebGL()}setSampler(e={}){this.texture.setSampler(e instanceof Fs?e:this.device.createSampler(e))}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}isTextureLevelData(e){const t=e?.data;return ArrayBuffer.isView(t)}getTextureDataSize(e){if(!e||ArrayBuffer.isView(e))return null;if(Array.isArray(e))return this.getTextureDataSize(e[0]);if(this.device.isExternalImage(e))return this.device.getExternalImageSize(e);if(e&&typeof e=="object"&&e.constructor===Object){const i=Object.values(e)[0];return{width:i.width,height:i.height}}throw new Error("texture size deduction failed")}getCubeFaceDepth(e){switch(e){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(e)}}setTextureData(e){}_setTexture1DData(e,t){throw new Error("setTexture1DData not supported in WebGL.")}_setTexture2DData(e,t=0){if(!this.texture)throw new Error("Texture not initialized");const i=this._normalizeTextureData(e);i.length>1&&this.props.mipmaps!==!1&&le.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let s=0;s<i.length;s++){const o=i[s];this.device.isExternalImage(o)?this.texture.copyExternalImage({image:o,depth:t,mipLevel:s,flipY:!0}):this.texture.copyImageData({data:o.data,mipLevel:s})}}_setTexture3DData(e,t){if(this.texture?.props.dimension!=="3d")throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeData(e,t){if(this.texture?.props.dimension!=="cube")throw new Error(this.id);for(const[i,s]of Object.entries(t)){const o=nO.indexOf(i);this._setTexture2DData(s,o)}}_setTextureArrayData(e,t){if(this.texture?.props.dimension!=="2d-array")throw new Error(this.id);for(let i=0;i<t.length;i++)this._setTexture2DData(t[i],i)}_setTextureCubeArrayData(e,t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}_setTextureCubeFaceData(e,t,i,s=0){Array.isArray(t)&&t.length>1&&this.props.mipmaps!==!1&&le.warn(`${this.id} has mipmap and multiple LODs.`)();const o=tO.indexOf(i);this._setTexture2DData(t,o)}_normalizeTextureData(e){const t=this.texture;let i;return ArrayBuffer.isView(e)?i=[{data:e,width:t.width,height:t.height}]:Array.isArray(e)?i=e:i=[e],i}static defaultProps={...wt.defaultProps,data:null,mipmaps:!1}}async function N8(n){if(n=await n,Array.isArray(n))return await Promise.all(n.map(N8));if(n&&typeof n=="object"&&n.constructor===Object){const e=n,t=await Promise.all(Object.values(e)),i=Object.keys(e),s={};for(let o=0;o<i.length;o++)s[i[o]]=t[o];return s}return n}const Cs=2,iO=1e4;class kn{static defaultProps={...ks.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Ps.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}constructor(e,t){this.props={...kn.defaultProps,...t},t=this.props,this.id=t.id||cl("model"),this.device=e,Object.assign(this.userData,t.userData);const i=Object.fromEntries(this.props.modules?.map(f=>[f.name,f])||[]),s=t.shaderInputs||new QP(i,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(s);const o=rO(e),l=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:f,getUniforms:d}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:o,...this.props,modules:l});this.source=f,this._getModuleUniforms=d,this.props.shaderLayout||=s5(this.source)}else{const{vs:f,fs:d,getUniforms:p}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:o,...this.props,modules:l});this.vs=f,this.fs=d,this._getModuleUniforms=p}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||Xg.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||Yg.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||=e}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return le.info(Cs,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let i;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const s=this._getBindings();this.pipeline.setBindings(s,{disableWarnings:this.props.disableWarnings});const{indexBuffer:o}=this.vertexArray,l=o?o.byteLength/(o.indexType==="uint32"?4:2):void 0;i=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:l,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),i?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",i}setGeometry(e){this._gpuGeometry?.destroy();const t=e&&jP(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const i=new Kd(this.bufferLayout);this.bufferLayout=i.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new Kd(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({shaderLayout:this.pipeline.shaderLayout,bufferLayout:this.pipeline.bufferLayout}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){zp(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new RC(this.shaderInputs.modules);for(const[t,i]of Object.entries(this.shaderInputs.modules))if(sO(i)){const s=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=s}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const i=t?.disableWarnings??this.props.disableWarnings;e.indices&&le.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=XP(this.pipeline.shaderLayout,this.bufferLayout);const s=new Kd(this.bufferLayout);for(const[o,l]of Object.entries(e)){const c=s.getBufferLayout(o);if(!c){i||le.warn(`Model(${this.id}): Missing layout for buffer "${o}".`)();continue}const f=s.getAttributeNamesForBuffer(c);let d=!1;for(const p of f){const _=this._attributeInfos[p];if(_){const y=this.device.type==="webgpu"?s.getBufferIndex(_.bufferName):_.location;this.vertexArray.setBuffer(y,l),d=!0}}!d&&!i&&le.warn(`Model(${this.id}): Ignoring buffer "${l.id}" for unknown attribute "${o}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[i,s]of Object.entries(e)){const o=this._attributeInfos[i];o?this.vertexArray.setConstantWebGL(o.location,s):(t?.disableWarnings??this.props.disableWarnings)||le.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${i}"`)()}this.setNeedsRedraw("constants")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Fa&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,i]of Object.entries(this.bindings))i instanceof Fa?i.isReady&&(e[t]=i.texture):e[t]=i;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof $u?e=Math.max(e,t.texture.updateTimestamp):t instanceof tt||t instanceof wt?e=Math.max(e,t.updateTimestamp):t instanceof Fa?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof Fs||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[i]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(s=>s.name===i)&&i!=="positions"&&delete t[i];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||=e,this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(le.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const i=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let s=null;this.source?s=i:this.fs&&(s=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:i,fs:s}),this._attributeInfos=Db(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){const e=le.level>3?0:iO;le.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,le.group(Cs,`>>> DRAWING MODEL ${this.id}`,{collapsed:le.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=$P(this.pipeline.shaderLayout,this.id);le.table(Cs,e)();const t=this.shaderInputs.getDebugTable();le.table(Cs,t)();const i=this._getAttributeDebugTable();le.table(Cs,this._attributeInfos)(),le.table(Cs,i)(),le.groupEnd(Cs)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const i=e.props.framebuffer;i&&WP(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,i]of Object.entries(this._attributeInfos)){const s=this.vertexArray.attributes[i.location];e[i.location]={name:t,type:i.shaderType,values:s?this._getBufferOrConstantValues(s,i.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,i=t.indexType==="uint32"?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:i.toString()}}return e}_getBufferOrConstantValues(e,t){const i=Tg(t);return(e instanceof tt?new i(e.debugData):e).toString()}}function sO(n){return!!(n.uniformTypes&&!oO(n.uniformTypes))}function rO(n){return{type:n.type,shaderLanguage:n.info.shadingLanguage,shaderLanguageVersion:n.info.shadingLanguageVersion,gpu:n.info.gpu,features:n.features}}function oO(n){for(const e in n)return!1;return!0}class lo{device;model;transformFeedback;static defaultProps={...kn.defaultProps,outputs:void 0,feedbackBuffers:void 0};static isSupported(e){return e?.info?.type==="webgl"}constructor(e,t=lo.defaultProps){if(!lo.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new kn(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||wE(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e?.inputBuffers&&this.model.setAttributes(e.inputBuffers),e?.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof tt)return t.readAsync();const{buffer:i,byteOffset:s=0,byteLength:o=i.byteLength}=t;return i.readAsync(s,o)}}class co{id;topology;vertexCount;indices;attributes;userData={};constructor(e){const{attributes:t={},indices:i=null,vertexCount:s=null}=e;this.id=e.id||cl("geometry"),this.topology=e.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(const[o,l]of Object.entries(t)){const c=ArrayBuffer.isView(l)?{value:l}:l;if(!ArrayBuffer.isView(c.value))throw new Error(`${this._print(o)}: must be typed array or object with value as typed array`);if((o==="POSITION"||o==="positions")&&!c.size&&(c.size=3),o==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=c}else this.attributes[o]=c}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let i=1/0;for(const s of Object.values(e)){const{value:o,size:l,constant:c}=s;!c&&o&&l!==void 0&&l>=1&&(i=Math.min(i,o.length/l))}return i}}const aO={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant",blendAlphaDstFactor:"zero"};class k8 extends $g{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:i,viewports:s,onViewportActive:o,pickingFBO:l,deviceRect:{x:c,y:f,width:d,height:p},cullRect:_,effects:y,pass:v="picking",pickZ:x,shaderModuleProps:S}){this.pickZ=x;const M=this._resetColorEncoder(x),C=[c,f,d,p],U=super.render({target:l,layers:e,layerFilter:t,views:i,viewports:s,onViewportActive:o,cullRect:_,effects:y?.filter(D=>D.useInPicking),pass:v,isPicking:!0,shaderModuleProps:S,clearColor:[0,0,0,0],colorMask:15,scissorRect:C});return this._colorEncoderState=null,{decodePickingColor:M&&cO.bind(null,M),stats:U}}shouldDrawLayer(e){const{pickable:t,operation:i}=e.props;return t&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getShaderModuleProps(e,t,i){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,i){const s={...e.props.parameters},{pickable:o,operation:l}=e.props;return this._colorEncoderState?o&&l.includes("draw")?(Object.assign(s,aO),s.blend=!0,s.blendColor=lO(this._colorEncoderState,e,i)):l.includes("terrain")&&(s.blend=!1):s.blend=!1,s}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function lO(n,e,t){const{byLayer:i,byAlpha:s}=n;let o,l=i.get(e);return l?(l.viewports.push(t),o=l.a):(o=i.size+1,o<=255?(l={a:o,layer:e,viewports:[t]},i.set(e,l),s[o]=l):(ke.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function cO(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const Vr={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Nu=Symbol.for("component"),os=Symbol.for("propTypes"),Gd=Symbol.for("deprecatedProps"),Qr=Symbol.for("asyncPropDefaults"),Vs=Symbol.for("asyncPropOriginal"),is=Symbol.for("asyncPropResolved");function qg(n,e=()=>!0){return Array.isArray(n)?D8(n,e,[]):e(n)?[n]:[]}function D8(n,e,t){let i=-1;for(;++i<n.length;){const s=n[i];Array.isArray(s)?D8(s,e,t):e(s)&&t.push(s)}return t}function uO({target:n,source:e,start:t=0,count:i=1}){const s=e.length,o=i*s;let l=0;for(let c=t;l<s;l++)n[c++]=e[l];for(;l<o;)l<o-l?(n.copyWithin(t+l,t,t+l),l*=2):(n.copyWithin(t+l,t,t+o-l),l=o);return n}class fO{constructor(e,t,i){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=i,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const i=++this._loadCount;let s=e;typeof e=="string"&&(s=_u(e)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===i&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const o of this._subscribers)o.onChange(this.getData())}}class hO{constructor(e){this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:e.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:t,forceUpdate:i=!1,persistent:s=!0}){let o=this._resources[e];o?o.setData(t,i):(o=new fO(e,t,this._context),this._resources[e]=o),o.persistent=s}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const i in t){const s=t[i],o=this._resources[s.resourceId];o&&o.unsubscribe(s)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:i,requestId:s="default"}){const{_resources:o,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const c=o[e];if(this._track(i,s,c,t),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,i,s){const o=this._consumers,l=o[e]=o[e]||{};let c=l[t];const f=c&&c.resourceId&&this._resources[c.resourceId];f&&(f.unsubscribe(c),this.prune()),i&&(c?(c.onChange=s,c.resourceId=i.id):c={onChange:s,resourceId:i.id},l[t]=c,i.subscribe(c))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const dO="layerManager.setLayers",pO="layerManager.activateViewport";class gO{constructor(e,t){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=c=>{Ft(pO,this,c),c&&(this.context.viewport=c)};const{deck:i,stats:s,viewport:o,timeline:l}=t||{};this.layers=[],this.resourceManager=new hO({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e?.gl,deck:i,shaderAssembler:fP(e?.info?.shadingLanguage||"glsl"),defaultShaderModules:[bR],renderPass:void 0,stats:s||new ju({id:"deck.gl"}),viewport:o||new yo({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new I8,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const i of this.layers){const s=i.getNeedsRedraw(e);t=t||s}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(i=>t.id.indexOf(i)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Ft(dO,this,t,e),this._lastRenderedLayers=e;const i=qg(e,Boolean);for(const s of i)s.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(i=>i.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,i=t.findIndex(s=>s.name===e.name);i>=0&&(t.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,i){i.raiseError(t,`${e} of ${i}`)}_updateLayers(e,t){const i={};for(const l of e)i[l.id]?ke.warn(`Multiple old layers with same id ${l.id}`)():i[l.id]=l;if(this._defaultShaderModulesChanged){for(const l of e)l.setNeedsUpdate(),l.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const s=[];this._updateSublayersRecursively(t,i,s),this._finalizeOldLayers(i);let o=!1;for(const l of s)if(l.hasUniformTransition()){o=`Uniform transition in ${l}`;break}this._needsUpdate=o,this.layers=s}_updateSublayersRecursively(e,t,i){for(const s of e){s.context=this.context;const o=t[s.id];o===null&&ke.warn(`Multiple new layers with same id ${s.id}`)(),t[s.id]=null;let l=null;try{this._debug&&o!==s&&s.validateProps(),o?(this._transferLayerState(o,s),this._updateLayer(s)):this._initializeLayer(s),i.push(s),l=s.isComposite?s.getSubLayers():null}catch(c){this._handleError("matching",c,s)}l&&this._updateSublayersRecursively(l,t,i)}}_finalizeOldLayers(e){for(const t in e){const i=e[t];i&&this._finalizeLayer(i)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=Vr.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=Vr.MATCHED,t!==e&&(e.lifecycle=Vr.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=Vr.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=Vr.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function xn(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let i=0;i<n.length;i++)if(!xn(n[i],e[i],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const i=Object.keys(n),s=Object.keys(e);if(i.length!==s.length)return!1;for(const o of i)if(!e.hasOwnProperty(o)||!xn(n[o],e[o],t-1))return!1;return!0}return!1}class mO{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,i=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(i):i}getViewport(e){return this._viewportMap[e]}unproject(e,t){const i=this.getViewports(),s={x:e[0],y:e[1]};for(let o=i.length-1;o>=0;--o){const l=i[o];if(l.containsPixel(s)){const c=e.slice();return c[0]-=l.x,c[1]-=l.y,l.unproject(c,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=qg(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!xn(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):ke.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){const i=t.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>this.getView(e.id)?.makeViewport({viewState:o,width:this.width,height:this.height})})}_updateController(e,t,i,s){const o=e.controller;if(o&&i){const l={...t,...o,id:e.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!s||s.constructor!==o.type)&&(s=this._createController(e,l)),s&&s.setProps(l),s}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let s=e.length;s--;){const o=e[s],l=this.getViewState(o),c=o.makeViewport({viewState:l,width:this.width,height:this.height});let f=t[o.id];const d=!!o.controller;d&&!f&&(i=!0),(i||!d)&&f&&(f.finalize(),f=null),this.controllers[o.id]=this._updateController(o,l,c,f),c&&this._viewports.unshift(c)}for(const s in t){const o=t[s];o&&!this.controllers[s]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((i,s)=>!e[s].equals(t[s]))}}const _O=/([0-9]+\.?[0-9]*)(%|px)/;function Zi(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=_O.exec(n);if(e&&e.length>=3){const t=e[2]==="%",i=parseFloat(e[1]);return{position:t?i/100:i,relative:t}}default:throw new Error(`Could not parse position string ${n}`)}}function Ki(n,e){return n.relative?Math.round(n.position*e):n.position}class uo{constructor(e){const{id:t,x:i=0,y:s=0,width:o="100%",height:l="100%",padding:c=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=Zi(i),this._y=Zi(s),this._width=Zi(o),this._height=Zi(l),this._padding=c&&{left:Zi(c.left||0),right:Zi(c.right||0),top:Zi(c.top||0),bottom:Zi(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&xn(this.props,e.props,2)}clone(e){const t=this.constructor;return new t({...this.props,...e})}makeViewport({width:e,height:t,viewState:i}){i=this.filterViewState(i);const s=this.getDimensions({width:e,height:t});if(!s.height||!s.width)return null;const o=this.getViewportType(i);return new o({...i,...this.props,...s})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:e?.id||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const i in this.props.viewState)i!=="id"&&(t[i]=this.props.viewState[i]);return t}return e}getDimensions({width:e,height:t}){const i={x:Ki(this._x,e),y:Ki(this._y,t),width:Ki(this._width,e),height:Ki(this._height,t)};return this._padding&&(i.padding={left:Ki(this._padding.left,e),top:Ki(this._padding.top,t),right:Ki(this._padding.right,e),bottom:Ki(this._padding.bottom,t)}),i}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class qu{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){this.cancel(),this.settings=e,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:e,settings:t}=this;this._handle=e.addChannel({delay:e.getTime(),duration:t.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const ry=()=>{},jp={BREAK:1,SNAP_TO_END:2,IGNORE:3},yO=n=>n,bO=jp.BREAK;class vO{constructor(e){this._onTransitionUpdate=t=>{const{time:i,settings:{interpolator:s,startProps:o,endProps:l,duration:c,easing:f}}=t,d=f(i/c),p=s.interpolateProps(o,l,d);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new qu(e.timeline),this.onViewStateChange=e.onViewStateChange||ry,this.onStateChange=e.onStateChange||ry}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const i=this.props;if(this.props=e,!i||this._shouldIgnoreViewportChange(i,e))return!1;if(this._isTransitionEnabled(e)){let s=i;if(this.transition.inProgress){const{interruption:o,endProps:l}=this.transition.settings;s={...i,...o===jp.SNAP_TO_END?l:this.propsInTransition||i}}this._triggerTransition(s,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:i}=e;return(t>0||t==="auto")&&!!i}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===jp.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const i=this.getControllerState(e),s=this.getControllerState(t).shortestPathFrom(i),o=t.transitionInterpolator,l=o.getDuration?o.getDuration(e,t):t.transitionDuration;if(l===0)return;const c=o.initializeProps(e,s);this.propsInTransition={};const f={duration:l,easing:t.transitionEasing||yO,interpolator:o,interruption:t.transitionInterruption||bO,startProps:c.start,endProps:c.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(f),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e?.(t)}}}function Mt(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class xO{constructor(e){const{compare:t,extract:i,required:s}=e;this._propsToCompare=t,this._propsToExtract=i||t,this._requiredProps=s}arePropsEqual(e,t){for(const i of this._propsToCompare)if(!(i in e)||!(i in t)||!Ya(e[i],t[i]))return!1;return!0}initializeProps(e,t){const i={},s={};for(const o of this._propsToExtract)(o in e||o in t)&&(i[o]=e[o],s[o]=t[o]);return this._checkRequiredProps(i),this._checkRequiredProps(s),{start:i,end:s}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const i=e[t];Mt(Number.isFinite(i)||Array.isArray(i),`${t} is required for transition`)})}}const Bc=Math.PI/180,oy=180/Math.PI,ou=6370972,$r=256;function TO(){const n=$r/ou,e=Math.PI/180*$r;return{unitsPerMeter:[n,n,n],unitsPerMeter2:[0,0,0],metersPerUnit:[1/n,1/n,1/n],unitsPerDegree:[e,e,n],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/n]}}class L8 extends yo{constructor(e={}){const{longitude:t=0,zoom:i=0,nearZMultiplier:s=.5,farZMultiplier:o=1,resolution:l=10}=e;let{latitude:c=0,height:f,altitude:d=1.5,fovy:p}=e;c=Math.max(Math.min(c,ns),-ns),f=f||1,p?d=Vg(p):p=Za(d);const _=Math.pow(2,i-Uc(c)),y=e.nearZ??s,v=e.farZ??(d+$r*2*_/f)*o,x=new Dn().lookAt({eye:[0,-d,0],up:[0,0,1]});x.rotateX(c*Bc),x.rotateZ(-t*Bc),x.scale(_/f),super({...e,height:f,viewMatrix:x,longitude:t,latitude:c,zoom:i,distanceScales:TO(),fovy:p,focalDistance:d,near:y,far:v}),this.scale=_,this.latitude=c,this.longitude=t,this.fovy=p,this.resolution=l}get projectionMode(){return fn.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const t={targetZ:e.z||0},i=this.unproject([0,this.height/2],t),s=this.unproject([this.width/2,0],t),o=this.unproject([this.width,this.height/2],t),l=this.unproject([this.width/2,this.height],t);return o[0]<this.longitude&&(o[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],o[0],s[0],l[0]),Math.min(i[1],o[1],s[1],l[1]),Math.max(i[0],o[0],s[0],l[0]),Math.max(i[1],o[1],s[1],l[1])]}unproject(e,{topLeft:t=!0,targetZ:i}={}){const[s,o,l]=e,c=t?o:this.height-o,{pixelUnprojectionMatrix:f}=this;let d;if(Number.isFinite(l))d=Qd(f,[s,c,l,1]);else{const v=Qd(f,[s,c,-1,1]),x=Qd(f,[s,c,1,1]),S=((i||0)/ou+1)*$r,M=Ud(l8([],v,x)),C=Ud(v),U=Ud(x),D=4*((4*C*U-(M-C-U)**2)/16)/M,B=Math.sqrt(C-D),Q=Math.sqrt(Math.max(0,S*S-D)),ce=(B-Q)/Math.sqrt(M);d=A5([],v,x,ce)}const[p,_,y]=this.unprojectPosition(d);return Number.isFinite(l)?[p,_,y]:Number.isFinite(i)?[p,_,i]:[p,_]}projectPosition(e){const[t,i,s=0]=e,o=t*Bc,l=i*Bc,c=Math.cos(l),f=(s/ou+1)*$r;return[Math.sin(o)*c*f,-Math.cos(o)*c*f,Math.sin(l)*f]}unprojectPosition(e){const[t,i,s]=e,o=I5(e),l=Math.asin(s/o),f=Math.atan2(t,-i)*oy,d=l*oy,p=(o/$r-1)*ou;return[f,d,p]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition([e,t,i],s,o){const c=.25/Math.pow(2,this.zoom-Uc(this.latitude)),f=e+c*(o[0]-s[0]);let d=t-c*(o[1]-s[1]);d=Math.max(Math.min(d,ns),-ns);const p={longitude:f,latitude:d,zoom:i-Uc(t)};return p.zoom+=Uc(p.latitude),p}}L8.displayName="GlobeViewport";function Uc(n){const e=Math.PI*Math.cos(n*Math.PI/180);return Math.log2(e)}function Qd(n,e){const t=_o([],e,n);return f8(t,t,1/t[3]),t}const wO=["longitude","latitude","zoom","bearing","pitch"],SO=["longitude","latitude","zoom"];class B8 extends xO{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,i=Array.isArray(e)?{}:e;i.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:wO,required:SO},super(i.transitionProps),this.opts=i}initializeProps(e,t){const i=super.initializeProps(e,t),{makeViewport:s,around:o}=this.opts;if(s&&o)if(s(e)instanceof L8)ke.warn("around not supported in GlobeView")();else{const c=s(e),f=s(t),d=c.unproject(o);i.start.around=o,Object.assign(i.end,{around:f.project(d),aroundPosition:d,width:t.width,height:t.height})}return i}interpolateProps(e,t,i){const s={};for(const o of this._propsToExtract)s[o]=Ru(e[o]||0,t[o]||0,i);if(t.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...t,...s});Object.assign(s,o.panByPosition(t.aroundPosition,Ru(e.around,t.around,i)))}return s}}const di={transitionDuration:0},AO=300,Fc=n=>1-(1-n)*(1-n),jr={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Rs={};class EO{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new vO({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events)this._events[e]&&this.eventManager?.off(e,this.handleEvent);this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return t?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:i}=this.props,{offsetCenter:s}=e;return[s.x-t,s.y-i]}isPointInBounds(e,t){const{width:i,height:s}=this.props;if(t&&t.handled)return!1;const o=e[0]>=0&&e[0]<=i&&e[1]>=0&&e[1]<=s;return o&&t&&t.stopPropagation(),o}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?AO:0;const{scrollZoom:i=!0,dragPan:s=!0,dragRotate:o=!0,doubleClickZoom:l=!0,touchZoom:c=!0,touchRotate:f=!1,keyboard:d=!0}=e,p=!!this.onViewStateChange;this.toggleEvents(jr.WHEEL,p&&i),this.toggleEvents(jr.PAN,p),this.toggleEvents(jr.PINCH,p&&(c||f)),this.toggleEvents(jr.MULTI_PAN,p&&f),this.toggleEvents(jr.DOUBLE_CLICK,p&&l),this.toggleEvents(jr.KEYBOARD,p&&d),this.scrollZoom=i,this.dragPan=s,this.dragRotate=o,this.doubleClickZoom=l,this.touchZoom=c,this.touchRotate=f,this.keyboard=d}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(i=>{this._events[i]!==t&&(this._events[i]=t,t?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(e,t=null,i={}){const s={...e.getViewportProps(),...t},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(i),o){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:l,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let i=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);const s=this.controllerState[i?"panStart":"rotateStart"]({pos:t});return this._panMove=i,this.updateViewport(s,di,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),i=this.controllerState.pan({pos:t});return this.updateViewport(i,di,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const i=this.getCenter(e),s=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],o=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Fc},{isDragging:!1,isPanning:!0})}else{const i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),i=this.controllerState.rotate({pos:t});return this.updateViewport(i,di,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const i=this.getCenter(e),s=[i[0]+e.velocityX*t/2,i[1]+e.velocityY*t/2],o=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Fc},{isDragging:!1,isRotating:!0})}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:i=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e;let l=2/(1+Math.exp(-Math.abs(o*i)));o<0&&l!==0&&(l=1/l);const c=s?{...this._getTransitionProps({around:t}),transitionDuration:250}:di,f=this.controllerState.zoom({pos:t,scale:l});return this.updateViewport(f,c,{isZooming:!0,isPanning:!0}),s||this._setInteractionState({isZooming:!1,isPanning:!1}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.rotateStart({pos:t});return this.updateViewport(i,di,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const i=this.controllerState.rotate({pos:t});return this.updateViewport(i,di,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const i=this.getCenter(e),s=[i[0],i[1]+=e.velocityY*t/2],o=this.controllerState.rotate({pos:s});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:Fc},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Rs._startPinchRotation=e.rotation,Rs._lastPinchEvent=e,this.updateViewport(i,di,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:i}=e,s=this.getCenter(e);t=t.zoom({pos:s,scale:i})}if(this.touchRotate){const{rotation:i}=e;t=t.rotate({deltaAngleX:Rs._startPinchRotation-i})}return this.updateViewport(t,di,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Rs._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:i}=Rs;if(this.touchZoom&&t&&i&&e.scale!==i.scale){const s=this.getCenter(e);let o=this.controllerState.rotateEnd();const l=Math.log2(e.scale),c=(l-Math.log2(i.scale))/(e.deltaTime-i.deltaTime),f=Math.pow(2,l+c*t/2);o=o.zoom({pos:s,scale:f}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:s}),transitionDuration:t,transitionEasing:Fc},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Rs._startPinchRotation=null,Rs._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const i=this.isFunctionKeyPressed(e),s=this.controllerState.zoom({pos:t,scale:i?.5:2});return this.updateViewport(s,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:i,moveSpeed:s,rotateSpeedX:o,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this;let f;const d={};switch(e.srcEvent.code){case"Minus":f=t?c.zoomOut(i).zoomOut(i):c.zoomOut(i),d.isZooming=!0;break;case"Equal":f=t?c.zoomIn(i).zoomIn(i):c.zoomIn(i),d.isZooming=!0;break;case"ArrowLeft":t?(f=c.rotateLeft(o),d.isRotating=!0):(f=c.moveLeft(s),d.isPanning=!0);break;case"ArrowRight":t?(f=c.rotateRight(o),d.isRotating=!0):(f=c.moveRight(s),d.isPanning=!0);break;case"ArrowUp":t?(f=c.rotateUp(l),d.isRotating=!0):(f=c.moveUp(s),d.isPanning=!0);break;case"ArrowDown":t?(f=c.rotateDown(l),d.isRotating=!0):(f=c.moveDown(s),d.isPanning=!0);break;default:return!1}return this.updateViewport(f,this._getTransitionProps(),d),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?di:e?{...t,transitionInterpolator:new B8({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class CO{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const ay=5,RO=1.2;class MO extends CO{constructor(e){const{width:t,height:i,latitude:s,longitude:o,zoom:l,bearing:c=0,pitch:f=0,altitude:d=1.5,position:p=[0,0,0],maxZoom:_=20,minZoom:y=0,maxPitch:v=60,minPitch:x=0,startPanLngLat:S,startZoomLngLat:M,startRotatePos:C,startBearing:U,startPitch:R,startZoom:D,normalize:B=!0}=e;Mt(Number.isFinite(o)),Mt(Number.isFinite(s)),Mt(Number.isFinite(l)),super({width:t,height:i,latitude:s,longitude:o,zoom:l,bearing:c,pitch:f,altitude:d,maxZoom:_,minZoom:y,maxPitch:v,minPitch:x,normalize:B,position:p},{startPanLngLat:S,startZoomLngLat:M,startRotatePos:C,startBearing:U,startPitch:R,startZoom:D}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const i=this.getState().startPanLngLat||this._unproject(t);if(!i)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(i,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:i=0}){const{startRotatePos:s,startBearing:o,startPitch:l}=this.getState();if(!s||o===void 0||l===void 0)return this;let c;return e?c=this._getNewRotation(e,s,l,o):c={bearing:o+t,pitch:l+i},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:i}){let{startZoom:s,startZoomLngLat:o}=this.getState();if(o||(s=this.getViewportProps().zoom,o=this._unproject(t)||this._unproject(e)),!o)return this;const{maxZoom:l,minZoom:c}=this.getViewportProps();let f=s+Math.log2(i);f=ts(f,c,l);const d=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...d.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),i={...this.getViewportProps()},{bearing:s,longitude:o}=i;return Math.abs(s-t.bearing)>180&&(i.bearing=s<0?s+360:s-360),Math.abs(o-t.longitude)>180&&(i.longitude=o<0?o+360:o-360),i}applyConstraints(e){const{maxZoom:t,minZoom:i,zoom:s}=e;e.zoom=ts(s,i,t);const{maxPitch:o,minPitch:l,pitch:c}=e;e.pitch=ts(c,l,o);const{normalize:f=!0}=e;return f&&Object.assign(e,ZM(e)),e}_zoomFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.zoom({pos:[t/2,i/2],scale:e})}_panFromCenter(e){const{width:t,height:i}=this.getViewportProps();return this.pan({startPos:[t/2,i/2],pos:[t/2+e[0],i/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,i,s){const o=e[0]-t[0],l=e[1]-t[1],c=e[1],f=t[1],{width:d,height:p}=this.getViewportProps(),_=o/d;let y=0;l>0?Math.abs(p-f)>ay&&(y=l/(f-p)*RO):l<0&&f>ay&&(y=1-c/f),y=ts(y,-1,1);const{minPitch:v,maxPitch:x}=this.getViewportProps(),S=s+180*_;let M=i;return y>0?M=i+y*(x-i):y<0&&(M=i-y*(v-i)),{pitch:M,bearing:S}}}class PO extends EO{constructor(){super(...arguments),this.ControllerState=MO,this.transition={transitionDuration:300,transitionInterpolator:new B8({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class U8 extends uo{constructor(e={}){super(e)}getViewportType(){return ao}get ControllerType(){return PO}}U8.displayName="MapView";const OO=new P8;function IO(n,e){const t=n.order??1/0,i=e.order??1/0;return t-i}class NO{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(i=>i.id===e.id)){const i=t.findIndex(s=>IO(s,e)>0);i<0?t.push(e):t.splice(i,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(xn(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const s of this.effects)t[s.id]=s;const i=[];for(const s of e){const o=t[s.id];let l=s;o&&o!==s?o.setProps?(o.setProps(s.props),l=o):o.cleanup(this._context):o||s.setup(this._context),i.push(l),delete t[s.id]}for(const s in t)t[s].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),e.some(s=>s instanceof P8)||this._resolvedEffects.push(OO),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class kO extends $g{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const DO="deckRenderer.renderLayers";class LO{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new kO(e),this.pickLayersPass=new k8(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};i.effects&&this._preRender(i.effects,i);const s=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);const o=t.render({...i,target:s});i.effects&&(this.lastPostProcessEffect&&(i.clearCanvas=e.clearCanvas===void 0?!0:e.clearCanvas),this._postRender(i.effects,i)),this.renderCount++,Ft(DO,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const i of e)t.preRenderStats[i.id]=i.preRender(t),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize(),[i,s]=t;e.length===0&&[0,1].map(o=>{const l=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"},width:i,height:s});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${o}`,colorAttachments:[l]}))});for(const o of e)o.resize(t)}_postRender(e,t){const{renderBuffers:i}=this,s={...t,inputBuffer:i[0],swapBuffer:i[1]};for(const o of e)if(o.postRender){s.target=o.id===this.lastPostProcessEffect?t.target:void 0;const l=o.postRender(s);s.inputBuffer=l,s.swapBuffer=l===i[0]?i[1]:i[0]}}}const BO={pickedColor:null,pickedObjectIndex:-1};function ly({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:i,deviceRadius:s,deviceRect:o}){const{x:l,y:c,width:f,height:d}=o;let p=s*s,_=-1,y=0;for(let v=0;v<d;v++){const x=v+c-i,S=x*x;if(S>p)y+=4*f;else for(let M=0;M<f;M++){if(n[y+3]-1>=0){const U=M+l-t,R=U*U+S;R<=p&&(p=R,_=y)}y+=4}}if(_>=0){const v=n.slice(_,_+4),x=e(v);if(x){const S=Math.floor(_/4/f),M=_/4-S*f;return{...x,pickedColor:v,pickedX:l+M,pickedY:c+S}}ke.error("Picked non-existent layer. Is picking buffer corrupt?")()}return BO}function cy({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n){for(let i=0;i<n.length;i+=4)if(n[i+3]-1>=0){const o=n.slice(i,i+4),l=o.join(",");if(!t.has(l)){const c=e(o);c?t.set(l,{...c,color:o}):ke.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}function Vp({pickInfo:n,viewports:e,pixelRatio:t,x:i,y:s,z:o}){let l=e[0];e.length>1&&(l=UO(n?.pickedViewports||e,{x:i,y:s}));let c;if(l){const f=[i-l.x,s-l.y];o!==void 0&&(f[2]=o),c=l.unproject(f)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:c,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function uy(n){const{pickInfo:e,lastPickedInfo:t,mode:i,layers:s}=n,{pickedColor:o,pickedLayer:l,pickedObjectIndex:c}=e,f=l?[l]:[];if(i==="hover"){const _=t.index,y=t.layerId,v=l?l.props.id:null;if(v!==y||c!==_){if(v!==y){const x=s.find(S=>S.props.id===y);x&&f.unshift(x)}t.layerId=v,t.index=c,t.info=null}}const d=Vp(n),p=new Map;return p.set(null,d),f.forEach(_=>{let y={...d};_===l&&(y.color=o,y.index=c,y.picked=!0),y=Hp({layer:_,info:y,mode:i});const v=y.layer;_===l&&i==="hover"&&(t.info=y),p.set(v.id,y),i==="hover"&&v.updateAutoHighlight(y)}),p}function Hp({layer:n,info:e,mode:t}){for(;n&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:i}),n=n.parent}return e}function UO(n,e){for(let t=n.length-1;t>=0;t--){const i=n[t];if(i.containsPixel(e))return i}return n[0]}class FO{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new k8(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObjectAsync(e){return this._pickClosestObjectAsync(e)}pickObjectsAsync(e){return this._pickVisibleObjectsAsync(e)}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:i,viewports:s},o=this.lastPickedInfo.info){const l=o&&o.layer&&o.layer.id,c=o&&o.viewport&&o.viewport.id,f=l?i.find(y=>y.id===l):null,d=c&&s.find(y=>y.id===c)||s[0],p=d&&d.unproject([e-d.x,t-d.y]);return{...o,...{x:e,y:t,viewport:d,coordinate:p,layer:f}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const t=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=t}const{canvas:e}=this.device.getDefaultCanvasContext();this.pickingFBO?.resize({width:e.width,height:e.height}),this.depthFBO?.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return t.length?t:null}async _pickClosestObjectAsync({layers:e,views:t,viewports:i,x:s,y:o,radius:l=0,depth:c=1,mode:f="query",unproject3D:d,onViewportActive:p,effects:_}){const y=this.device.canvasContext.cssToDeviceRatio(),v=this._getPickable(e);if(!v||i.length===0)return{result:[],emptyInfo:Vp({viewports:i,x:s,y:o,pixelRatio:y})};this._resizeBuffer();const x=this.device.canvasContext.cssToDevicePixels([s,o],!0),S=[x.x+Math.floor(x.width/2),x.y+Math.floor(x.height/2)],M=Math.round(l*y),{width:C,height:U}=this.pickingFBO,R=this._getPickingRect({deviceX:S[0],deviceY:S[1],deviceRadius:M,deviceWidth:C,deviceHeight:U}),D={x:s-l,y:o-l,width:l*2+1,height:l*2+1};let B;const Q=[],ce=new Set;for(let Z=0;Z<c;Z++){let ee;if(R){const de=this._drawAndSample({layers:v,views:t,viewports:i,onViewportActive:p,deviceRect:R,cullRect:D,effects:_,pass:`picking:${f}`});ee=ly({...de,deviceX:S[0],deviceY:S[1],deviceRadius:M,deviceRect:R})}else ee={pickedColor:null,pickedObjectIndex:-1};let he;if(ee.pickedLayer&&d&&this.depthFBO){const{pickedColors:de}=this._drawAndSample({layers:[ee.pickedLayer],views:t,viewports:i,onViewportActive:p,deviceRect:{x:ee.pickedX,y:ee.pickedY,width:1,height:1},cullRect:D,effects:_,pass:`picking:${f}:z`},!0);de[3]&&(he=de[0])}ee.pickedLayer&&Z+1<c&&(ce.add(ee.pickedLayer),ee.pickedLayer.disablePickingIndex(ee.pickedObjectIndex)),B=uy({pickInfo:ee,lastPickedInfo:this.lastPickedInfo,mode:f,layers:v,viewports:i,x:s,y:o,z:he,pixelRatio:y});for(const de of B.values())de.layer&&Q.push(de);if(!ee.pickedColor)break}for(const Z of ce)Z.restorePickingColors();return{result:Q,emptyInfo:B.get(null)}}_pickClosestObject({layers:e,views:t,viewports:i,x:s,y:o,radius:l=0,depth:c=1,mode:f="query",unproject3D:d,onViewportActive:p,effects:_}){const y=this.device.canvasContext.cssToDeviceRatio(),v=this._getPickable(e);if(!v||i.length===0)return{result:[],emptyInfo:Vp({viewports:i,x:s,y:o,pixelRatio:y})};this._resizeBuffer();const x=this.device.canvasContext.cssToDevicePixels([s,o],!0),S=[x.x+Math.floor(x.width/2),x.y+Math.floor(x.height/2)],M=Math.round(l*y),{width:C,height:U}=this.pickingFBO,R=this._getPickingRect({deviceX:S[0],deviceY:S[1],deviceRadius:M,deviceWidth:C,deviceHeight:U}),D={x:s-l,y:o-l,width:l*2+1,height:l*2+1};let B;const Q=[],ce=new Set;for(let Z=0;Z<c;Z++){let ee;if(R){const de=this._drawAndSample({layers:v,views:t,viewports:i,onViewportActive:p,deviceRect:R,cullRect:D,effects:_,pass:`picking:${f}`});ee=ly({...de,deviceX:S[0],deviceY:S[1],deviceRadius:M,deviceRect:R})}else ee={pickedColor:null,pickedObjectIndex:-1};let he;if(ee.pickedLayer&&d&&this.depthFBO){const{pickedColors:de}=this._drawAndSample({layers:[ee.pickedLayer],views:t,viewports:i,onViewportActive:p,deviceRect:{x:ee.pickedX,y:ee.pickedY,width:1,height:1},cullRect:D,effects:_,pass:`picking:${f}:z`},!0);de[3]&&(he=de[0])}ee.pickedLayer&&Z+1<c&&(ce.add(ee.pickedLayer),ee.pickedLayer.disablePickingIndex(ee.pickedObjectIndex)),B=uy({pickInfo:ee,lastPickedInfo:this.lastPickedInfo,mode:f,layers:v,viewports:i,x:s,y:o,z:he,pixelRatio:y});for(const de of B.values())de.layer&&Q.push(de);if(!ee.pickedColor)break}for(const Z of ce)Z.restorePickingColors();return{result:Q,emptyInfo:B.get(null)}}async _pickVisibleObjectsAsync({layers:e,views:t,viewports:i,x:s,y:o,width:l=1,height:c=1,mode:f="query",maxObjects:d=null,onViewportActive:p,effects:_}){const y=this._getPickable(e);if(!y||i.length===0)return[];this._resizeBuffer();const v=this.device.canvasContext.cssToDeviceRatio(),x=this.device.canvasContext.cssToDevicePixels([s,o],!0),S=x.x,M=x.y+x.height,C=this.device.canvasContext.cssToDevicePixels([s+l,o+c],!0),U=C.x+C.width,R=C.y,D={x:S,y:R,width:U-S,height:M-R},B=this._drawAndSample({layers:y,views:t,viewports:i,onViewportActive:p,deviceRect:D,cullRect:{x:s,y:o,width:l,height:c},effects:_,pass:`picking:${f}`}),Q=cy(B),ce=new Map,Z=[],ee=Number.isFinite(d);for(let he=0;he<Q.length&&!(ee&&Z.length>=d);he++){const de=Q[he];let _e={color:de.pickedColor,layer:null,index:de.pickedObjectIndex,picked:!0,x:s,y:o,pixelRatio:v};_e=Hp({layer:de.pickedLayer,info:_e,mode:f});const ge=_e.layer.id;ce.has(ge)||ce.set(ge,new Set);const ue=ce.get(ge),Se=_e.object??_e.index;ue.has(Se)||(ue.add(Se),Z.push(_e))}return Z}_pickVisibleObjects({layers:e,views:t,viewports:i,x:s,y:o,width:l=1,height:c=1,mode:f="query",maxObjects:d=null,onViewportActive:p,effects:_}){const y=this._getPickable(e);if(!y||i.length===0)return[];this._resizeBuffer();const v=this.device.canvasContext.cssToDeviceRatio(),x=this.device.canvasContext.cssToDevicePixels([s,o],!0),S=x.x,M=x.y+x.height,C=this.device.canvasContext.cssToDevicePixels([s+l,o+c],!0),U=C.x+C.width,R=C.y,D={x:S,y:R,width:U-S,height:M-R},B=this._drawAndSample({layers:y,views:t,viewports:i,onViewportActive:p,deviceRect:D,cullRect:{x:s,y:o,width:l,height:c},effects:_,pass:`picking:${f}`}),Q=cy(B),ce=new Map,Z=[],ee=Number.isFinite(d);for(let he=0;he<Q.length&&!(ee&&Z.length>=d);he++){const de=Q[he];let _e={color:de.pickedColor,layer:null,index:de.pickedObjectIndex,picked:!0,x:s,y:o,pixelRatio:v};_e=Hp({layer:de.pickedLayer,info:_e,mode:f});const ge=_e.layer.id;ce.has(ge)||ce.set(ge,new Set);const ue=ce.get(ge),Se=_e.object??_e.index;ue.has(Se)||(ue.add(Se),Z.push(_e))}return Z}async _drawAndSampleAsync({layers:e,views:t,viewports:i,onViewportActive:s,deviceRect:o,cullRect:l,effects:c,pass:f},d=!1){const p=d?this.depthFBO:this.pickingFBO,_={layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:s,pickingFBO:p,deviceRect:o,cullRect:l,effects:c,pass:f,pickZ:d,preRenderStats:{},isPicking:!0};for(const U of c)U.useInPicking&&(_.preRenderStats[U.id]=U.preRender(_));const{decodePickingColor:y}=this.pickLayersPass.render(_),{x:v,y:x,width:S,height:M}=o,C=new(d?Float32Array:Uint8Array)(S*M*4);return this.device.readPixelsToArrayWebGL(p,{sourceX:v,sourceY:x,sourceWidth:S,sourceHeight:M,target:C}),{pickedColors:C,decodePickingColor:y}}_drawAndSample({layers:e,views:t,viewports:i,onViewportActive:s,deviceRect:o,cullRect:l,effects:c,pass:f},d=!1){const p=d?this.depthFBO:this.pickingFBO,_={layers:e,layerFilter:this.layerFilter,views:t,viewports:i,onViewportActive:s,pickingFBO:p,deviceRect:o,cullRect:l,effects:c,pass:f,pickZ:d,preRenderStats:{},isPicking:!0};for(const U of c)U.useInPicking&&(_.preRenderStats[U.id]=U.preRender(_));const{decodePickingColor:y}=this.pickLayersPass.render(_),{x:v,y:x,width:S,height:M}=o,C=new(d?Float32Array:Uint8Array)(S*M*4);return this.device.readPixelsToArrayWebGL(p,{sourceX:v,sourceY:x,sourceWidth:S,sourceHeight:M,target:C}),{pickedColors:C,decodePickingColor:y}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:i,deviceWidth:s,deviceHeight:o}){const l=Math.max(0,e-i),c=Math.max(0,t-i),f=Math.min(s,e+i+1)-l,d=Math.min(o,t+i+1)-c;return f<=0||d<=0?null:{x:l,y:c,width:f,height:d}}}const zO={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},jO="top-left",fy="root";class VO{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,t?.classList.add("deck-widget-container"),this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){if(e.widgets&&!xn(e.widgets,this.widgets,1)){const t=e.widgets.filter(Boolean);this._setWidgets(t)}}finalize(){for(const e of this.getWidgets())this._removeWidget(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._addWidget(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}onRedraw({viewports:e,layers:t}){const i=e.reduce((s,o)=>(s[o.id]=o,s),{});for(const s of this.getWidgets()){const{viewId:o}=s;if(o){const l=i[o];l&&(s.onViewportChange&&s.onViewportChange(l),s.onRedraw?.({viewports:[l],layers:t}))}else{if(s.onViewportChange)for(const l of e)s.onViewportChange(l);s.onRedraw?.({viewports:e,layers:t})}}this.lastViewports=i,this._updateContainers()}onHover(e,t){for(const i of this.getWidgets()){const{viewId:s}=i;(!s||s===e.viewport?.id)&&i.onHover?.(e,t)}}onEvent(e,t){const i=Lp[t.type];if(i)for(const s of this.getWidgets()){const{viewId:o}=s;(!o||o===e.viewport?.id)&&s[i]?.(e,t)}}_setWidgets(e){const t={};for(const i of this.resolvedWidgets)t[i.id]=i;this.resolvedWidgets.length=0;for(const i of this.defaultWidgets)t[i.id]=null,this.resolvedWidgets.push(i);for(let i of e){const s=t[i.id];s?s.viewId!==i.viewId||s.placement!==i.placement?(this._removeWidget(s),this._addWidget(i)):i!==s&&(s.setProps(i.props),i=s):this._addWidget(i),t[i.id]=null,this.resolvedWidgets.push(i)}for(const i in t){const s=t[i];s&&this._removeWidget(s)}this.widgets=e}_addWidget(e){const{viewId:t=null,placement:i=jO}=e,s=e.props._container??t;e.widgetManager=this,e.deck=this.deck,e.rootElement=e._onAdd({deck:this.deck,viewId:t}),e.rootElement&&this._getContainer(s,i).append(e.rootElement),e.updateHTML()}_removeWidget(e){e.onRemove?.(),e.rootElement&&e.rootElement.remove(),e.rootElement=void 0,e.deck=void 0,e.widgetManager=void 0}_getContainer(e,t){if(e&&typeof e!="string")return e;const i=e||fy;let s=this.containers[i];s||(s=document.createElement("div"),s.style.pointerEvents="none",s.style.position="absolute",s.style.overflow="hidden",this.parentElement?.append(s),this.containers[i]=s);let o=s.querySelector(`.${t}`);return o||(o=globalThis.document.createElement("div"),o.className=t,o.style.position="absolute",o.style.zIndex="2",Object.assign(o.style,zO[t]),s.append(o)),o}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const i in this.containers){const s=this.lastViewports[i]||null,o=i===fy||s,l=this.containers[i];o?(l.style.display="block",l.style.left=`${s?s.x:0}px`,l.style.top=`${s?s.y:0}px`,l.style.width=`${s?s.width:e}px`,l.style.height=`${s?s.height:t}px`):l.style.display="none"}}}function hy(n,e){e&&Object.entries(e).map(([t,i])=>{t.startsWith("--")?n.style.setProperty(t,i):n.style[t]=i})}function HO(n,e){e&&Object.keys(e).map(t=>{t.startsWith("--")?n.style.removeProperty(t):n.style[t]=""})}class Zg{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const t=this.props,i=this.rootElement;i&&t.className!==e.className&&(t.className&&i.classList.remove(t.className),e.className&&i.classList.add(e.className)),i&&!xn(t.style,e.style,1)&&(HO(i,t.style),hy(i,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(i=>typeof i=="string"&&i.length>0).forEach(i=>t.classList.add(i)),hy(t,this.props.style),t}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}Zg.defaultProps={id:"widget",style:{},_container:null,className:""};const $O={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class F8 extends Zg{constructor(e={}){super(e),this.id="default-tooltip",this.placement="fill",this.className="deck-tooltip",this.isVisible=!1,this.setProps(e)}onCreateRootElement(){const e=document.createElement("div");return e.className=this.className,Object.assign(e.style,$O),e}onRenderHTML(e){}onViewportChange(e){this.isVisible&&e.id===this.lastViewport?.id&&!e.equals(this.lastViewport)&&this.setTooltip(null),this.lastViewport=e}onHover(e){const{deck:t}=this,i=t&&t.props.getTooltip;if(!i)return;const s=i(e);this.setTooltip(s,e.x,e.y)}setTooltip(e,t,i){const s=this.rootElement;if(s){if(typeof e=="string")s.innerText=e;else if(e)e.text&&(s.innerText=e.text),e.html&&(s.innerHTML=e.html),e.className&&(s.className=e.className);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform=`translate(${t}px, ${i}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(s.style,e.style)}}}F8.defaultProps={...Zg.defaultProps};var Wr;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",n[n.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.CULL_FACE=2884]="CULL_FACE",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.BLEND=3042]="BLEND",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.DITHER=3024]="DITHER",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DOUBLE=5130]="DOUBLE",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",n[n.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",n[n.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.READ_BUFFER=3074]="READ_BUFFER",n[n.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",n[n.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",n[n.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",n[n.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",n[n.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",n[n.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",n[n.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",n[n.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",n[n.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",n[n.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",n[n.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",n[n.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",n[n.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",n[n.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",n[n.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",n[n.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",n[n.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",n[n.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",n[n.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",n[n.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",n[n.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",n[n.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",n[n.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",n[n.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",n[n.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",n[n.RED=6403]="RED",n[n.RGB8=32849]="RGB8",n[n.RGBA8=32856]="RGBA8",n[n.RGB10_A2=32857]="RGB10_A2",n[n.TEXTURE_3D=32879]="TEXTURE_3D",n[n.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",n[n.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",n[n.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",n[n.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",n[n.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",n[n.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",n[n.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",n[n.SRGB=35904]="SRGB",n[n.SRGB8=35905]="SRGB8",n[n.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",n[n.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",n[n.RGBA32F=34836]="RGBA32F",n[n.RGB32F=34837]="RGB32F",n[n.RGBA16F=34842]="RGBA16F",n[n.RGB16F=34843]="RGB16F",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",n[n.R11F_G11F_B10F=35898]="R11F_G11F_B10F",n[n.RGB9_E5=35901]="RGB9_E5",n[n.RGBA32UI=36208]="RGBA32UI",n[n.RGB32UI=36209]="RGB32UI",n[n.RGBA16UI=36214]="RGBA16UI",n[n.RGB16UI=36215]="RGB16UI",n[n.RGBA8UI=36220]="RGBA8UI",n[n.RGB8UI=36221]="RGB8UI",n[n.RGBA32I=36226]="RGBA32I",n[n.RGB32I=36227]="RGB32I",n[n.RGBA16I=36232]="RGBA16I",n[n.RGB16I=36233]="RGB16I",n[n.RGBA8I=36238]="RGBA8I",n[n.RGB8I=36239]="RGB8I",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.R8=33321]="R8",n[n.RG8=33323]="RG8",n[n.R16F=33325]="R16F",n[n.R32F=33326]="R32F",n[n.RG16F=33327]="RG16F",n[n.RG32F=33328]="RG32F",n[n.R8I=33329]="R8I",n[n.R8UI=33330]="R8UI",n[n.R16I=33331]="R16I",n[n.R16UI=33332]="R16UI",n[n.R32I=33333]="R32I",n[n.R32UI=33334]="R32UI",n[n.RG8I=33335]="RG8I",n[n.RG8UI=33336]="RG8UI",n[n.RG16I=33337]="RG16I",n[n.RG16UI=33338]="RG16UI",n[n.RG32I=33339]="RG32I",n[n.RG32UI=33340]="RG32UI",n[n.R8_SNORM=36756]="R8_SNORM",n[n.RG8_SNORM=36757]="RG8_SNORM",n[n.RGB8_SNORM=36758]="RGB8_SNORM",n[n.RGBA8_SNORM=36759]="RGBA8_SNORM",n[n.RGB10_A2UI=36975]="RGB10_A2UI",n[n.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",n[n.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.HALF_FLOAT=5131]="HALF_FLOAT",n[n.RG=33319]="RG",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",n[n.CURRENT_QUERY=34917]="CURRENT_QUERY",n[n.QUERY_RESULT=34918]="QUERY_RESULT",n[n.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",n[n.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",n[n.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",n[n.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",n[n.DRAW_BUFFER0=34853]="DRAW_BUFFER0",n[n.DRAW_BUFFER1=34854]="DRAW_BUFFER1",n[n.DRAW_BUFFER2=34855]="DRAW_BUFFER2",n[n.DRAW_BUFFER3=34856]="DRAW_BUFFER3",n[n.DRAW_BUFFER4=34857]="DRAW_BUFFER4",n[n.DRAW_BUFFER5=34858]="DRAW_BUFFER5",n[n.DRAW_BUFFER6=34859]="DRAW_BUFFER6",n[n.DRAW_BUFFER7=34860]="DRAW_BUFFER7",n[n.DRAW_BUFFER8=34861]="DRAW_BUFFER8",n[n.DRAW_BUFFER9=34862]="DRAW_BUFFER9",n[n.DRAW_BUFFER10=34863]="DRAW_BUFFER10",n[n.DRAW_BUFFER11=34864]="DRAW_BUFFER11",n[n.DRAW_BUFFER12=34865]="DRAW_BUFFER12",n[n.DRAW_BUFFER13=34866]="DRAW_BUFFER13",n[n.DRAW_BUFFER14=34867]="DRAW_BUFFER14",n[n.DRAW_BUFFER15=34868]="DRAW_BUFFER15",n[n.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",n[n.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",n[n.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",n[n.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",n[n.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",n[n.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",n[n.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",n[n.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",n[n.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",n[n.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",n[n.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",n[n.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",n[n.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",n[n.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",n[n.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",n[n.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",n[n.SAMPLER_3D=35679]="SAMPLER_3D",n[n.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",n[n.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",n[n.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",n[n.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",n[n.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",n[n.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",n[n.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",n[n.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",n[n.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",n[n.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",n[n.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",n[n.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",n[n.MAX_SAMPLES=36183]="MAX_SAMPLES",n[n.SAMPLER_BINDING=35097]="SAMPLER_BINDING",n[n.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",n[n.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",n[n.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",n[n.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",n[n.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",n[n.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",n[n.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",n[n.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",n[n.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",n[n.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",n[n.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",n[n.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",n[n.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",n[n.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",n[n.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",n[n.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",n[n.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",n[n.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",n[n.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",n[n.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",n[n.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",n[n.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",n[n.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",n[n.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",n[n.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",n[n.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",n[n.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",n[n.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",n[n.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",n[n.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",n[n.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",n[n.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",n[n.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",n[n.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",n[n.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",n[n.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",n[n.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",n[n.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",n[n.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",n[n.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",n[n.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n[n.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",n[n.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",n[n.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",n[n.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",n[n.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",n[n.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",n[n.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",n[n.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",n[n.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",n[n.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",n[n.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",n[n.UNIFORM_TYPE=35383]="UNIFORM_TYPE",n[n.UNIFORM_SIZE=35384]="UNIFORM_SIZE",n[n.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",n[n.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",n[n.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",n[n.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",n[n.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",n[n.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",n[n.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",n[n.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",n[n.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",n[n.OBJECT_TYPE=37138]="OBJECT_TYPE",n[n.SYNC_CONDITION=37139]="SYNC_CONDITION",n[n.SYNC_STATUS=37140]="SYNC_STATUS",n[n.SYNC_FLAGS=37141]="SYNC_FLAGS",n[n.SYNC_FENCE=37142]="SYNC_FENCE",n[n.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",n[n.UNSIGNALED=37144]="UNSIGNALED",n[n.SIGNALED=37145]="SIGNALED",n[n.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",n[n.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",n[n.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",n[n.WAIT_FAILED=37149]="WAIT_FAILED",n[n.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",n[n.COLOR=6144]="COLOR",n[n.DEPTH=6145]="DEPTH",n[n.STENCIL=6146]="STENCIL",n[n.MIN=32775]="MIN",n[n.MAX=32776]="MAX",n[n.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",n[n.STREAM_READ=35041]="STREAM_READ",n[n.STREAM_COPY=35042]="STREAM_COPY",n[n.STATIC_READ=35045]="STATIC_READ",n[n.STATIC_COPY=35046]="STATIC_COPY",n[n.DYNAMIC_READ=35049]="DYNAMIC_READ",n[n.DYNAMIC_COPY=35050]="DYNAMIC_COPY",n[n.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",n[n.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",n[n.INVALID_INDEX=4294967295]="INVALID_INDEX",n[n.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",n[n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",n[n.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",n[n.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",n[n.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",n[n.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",n[n.R16_EXT=33322]="R16_EXT",n[n.RG16_EXT=33324]="RG16_EXT",n[n.RGB16_EXT=32852]="RGB16_EXT",n[n.RGBA16_EXT=32859]="RGBA16_EXT",n[n.R16_SNORM_EXT=36760]="R16_SNORM_EXT",n[n.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",n[n.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",n[n.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",n[n.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",n[n.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",n[n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",n[n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",n[n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",n[n.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",n[n.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",n[n.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",n[n.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",n[n.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",n[n.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",n[n.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",n[n.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",n[n.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",n[n.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",n[n.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",n[n.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",n[n.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",n[n.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",n[n.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",n[n.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",n[n.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",n[n.LINE_WEBGL=6913]="LINE_WEBGL",n[n.FILL_WEBGL=6914]="FILL_WEBGL",n[n.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",n[n.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",n[n.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",n[n.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",n[n.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",n[n.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",n[n.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",n[n.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",n[n.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",n[n.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",n[n.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",n[n.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",n[n.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",n[n.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",n[n.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",n[n.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",n[n.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",n[n.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",n[n.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",n[n.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",n[n.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",n[n.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",n[n.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",n[n.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Wr||(Wr={}));const WO={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},XO=n=>({drawBuffersWEBGL(e){return n.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),YO=n=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return n.createVertexArray()},deleteVertexArrayOES(e){return n.deleteVertexArray(e)},isVertexArrayOES(e){return n.isVertexArray(e)},bindVertexArrayOES(e){return n.bindVertexArray(e)}}),qO=n=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return n.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return n.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return n.vertexAttribDivisor(...e)}});function ZO(n=!0){const e=HTMLCanvasElement.prototype;if(!n&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(t,i){if(t==="webgl"||t==="experimental-webgl"){const s=this.originalGetContext("webgl2",i);return s instanceof HTMLElement&&KO(s),s}return this.originalGetContext(t,i)}}function KO(n){n.getExtension("EXT_color_buffer_float");const e={...WO,WEBGL_disjoint_timer_query:n.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:XO(n),OES_vertex_array_object:YO(n),ANGLE_instanced_arrays:qO(n)},t=n.getExtension;n.getExtension=function(s){const o=t.call(n,s);return o||(s in e?e[s]:null)};const i=n.getSupportedExtensions;n.getSupportedExtensions=function(){return(i.apply(n)||[])?.concat(Object.keys(e))}}async function z8(n,e){const t=document.getElementsByTagName("head")[0];if(!t)throw new Error("loadScript");const i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",n),new Promise((s,o)=>{i.onload=s,i.onerror=l=>o(new Error(`Unable to load script '${n}': ${l}`)),t.appendChild(i)})}const GO=1;let an=null,dy=!1;const Kg={debugSpectorJS:le.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function QO(n){if(!globalThis.SPECTOR)try{await z8(n.debugSpectorJSUrl||Kg.debugSpectorJSUrl)}catch(e){le.warn(String(e))}}function JO(n){if(n={...Kg,...n},!n.debugSpectorJS)return null;if(!an&&globalThis.SPECTOR&&!globalThis.luma?.spector){le.probe(GO,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:e}=globalThis.SPECTOR;an=new e,globalThis.luma&&(globalThis.luma.spector=an)}if(!an)return null;if(dy||(dy=!0,an.spyCanvases(),an?.onCaptureStarted.add(e=>le.info("Spector capture started:",e)()),an?.onCapture.add(e=>{le.info("Spector capture complete:",e)(),an?.getResultUI(),an?.resultView.display(),an?.resultView.addCapture(e)})),n.gl){const e=n.gl,t=e.device;an?.startCapture(n.gl,500),e.device=t,new Promise(i=>setTimeout(i,2e3)).then(i=>{le.info("Spector capture stopped after 2 seconds")(),an?.stopCapture()})}return an}const eI="https://unpkg.com/webgl-debug@2.0.1/index.js";function j8(n){return n.luma=n.luma||{},n.luma}async function tI(){Ws()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await z8(eI))}function nI(n,e={}){return e.debugWebGL||e.traceWebGL?sI(n,e):iI(n)}function iI(n){const e=j8(n);return e.realContext?e.realContext:n}function sI(n,e){if(!globalThis.WebGLDebugUtils)return le.warn("webgl-debug not loaded")(),n;const t=j8(n);if(t.debugContext)return t.debugContext;globalThis.WebGLDebugUtils.init({...Wr,...n});const i=globalThis.WebGLDebugUtils.makeDebugContext(n,rI.bind(null,e),oI.bind(null,e));for(const l in Wr)!(l in i)&&typeof Wr[l]=="number"&&(i[l]=Wr[l]);class s{}Object.setPrototypeOf(i,Object.getPrototypeOf(n)),Object.setPrototypeOf(s,i);const o=Object.create(s);return t.realContext=n,t.debugContext=o,o.debug=!0,o}function py(n,e){e=Array.from(e).map(i=>i===void 0?"undefined":i);let t=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,e);return t=`${t.slice(0,100)}${t.length>100?"...":""}`,`gl.${n}(${t})`}function rI(n,e,t,i){i=Array.from(i).map(c=>c===void 0?"undefined":c);const s=globalThis.WebGLDebugUtils.glEnumToString(e),o=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,i),l=`${s} in gl.${t}(${o})`;le.error(l)();debugger}function oI(n,e,t){let i="";le.level>=1&&(i=py(e,t),n.traceWebGL&&le.log(1,i)());for(const s of t)if(s===void 0){i=i||py(e,t);debugger}}const zc=1;class aI extends qE{type="webgl";constructor(){super(),Us.defaultProps={...Us.defaultProps,...Kg}}enforceWebGL2(e){ZO(e)}isSupported(){return typeof WebGL2RenderingContext<"u"}isDeviceHandle(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:(typeof WebGLRenderingContext<"u"&&e instanceof WebGLRenderingContext&&le.warn("WebGL1 is not supported",e)(),!1)}async attach(e,t={}){const{WebGLDevice:i}=await du(async()=>{const{WebGLDevice:o}=await Promise.resolve().then(()=>Py);return{WebGLDevice:o}},void 0);if(e instanceof i)return e;if(e?.device instanceof i)return e.device;if(!lI(e))throw new Error("Invalid WebGL2RenderingContext");const s=t.createCanvasContext===!0?{}:t.createCanvasContext;return new i({...t,_handle:e,createCanvasContext:{canvas:e.canvas,autoResize:!1,...s}})}async create(e={}){const{WebGLDevice:t}=await du(async()=>{const{WebGLDevice:i}=await Promise.resolve().then(()=>Py);return{WebGLDevice:i}},void 0);le.groupCollapsed(zc,"WebGLDevice created")();try{const i=[];(e.debugWebGL||e.debug)&&i.push(tI()),e.debugSpectorJS&&i.push(QO(e));const s=await Promise.allSettled(i);for(const c of s)c.status==="rejected"&&le.error(`Failed to initialize debug libraries ${c.reason}`)();const o=new t(e),l=`${o._reused?"Reusing":"Created"} device with WebGL2 ${o.props.debug?"debug ":""}context: ${o.info.vendor}, ${o.info.renderer} for canvas: ${o.canvasContext.id}`;return le.probe(zc,l)(),le.table(zc,o.info)(),o}finally{le.groupEnd(zc)()}}}function lI(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?!0:!!(n&&Number.isFinite(n._version))}const Jd=new aI,Gg={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},gt=(n,e,t)=>e?n.enable(t):n.disable(t),gy=(n,e,t)=>n.hint(t,e),ln=(n,e,t)=>n.pixelStorei(t,e),my=(n,e,t)=>{const i=t===36006?36009:36008;return n.bindFramebuffer(i,e)},Sa=(n,e,t)=>{const s={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[t];n.bindBuffer(s,e)};function ep(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}const cI={3042:gt,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:gt,2885:(n,e)=>n.cullFace(e),2929:gt,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:gt,35723:gy,35725:(n,e)=>n.useProgram(e),36007:(n,e)=>n.bindRenderbuffer(36161,e),36389:(n,e)=>n.bindTransformFeedback?.(36386,e),34229:(n,e)=>n.bindVertexArray(e),36006:my,36010:my,34964:Sa,36662:Sa,36663:Sa,35053:Sa,35055:Sa,2886:(n,e)=>n.frontFace(e),33170:gy,2849:(n,e)=>n.lineWidth(e),32823:gt,32824:"polygonOffset",10752:"polygonOffset",35977:gt,32926:gt,32928:gt,32938:"sampleCoverage",32939:"sampleCoverage",3089:gt,3088:(n,e)=>n.scissor(...e),2960:gt,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),34383:gt,10754:gt,12288:gt,12289:gt,12290:gt,12291:gt,12292:gt,12293:gt,12294:gt,12295:gt,3333:ln,3317:ln,37440:ln,37441:ln,37443:ln,3330:ln,3332:ln,3331:ln,3314:ln,32878:ln,3316:ln,3315:ln,32877:ln,framebuffer:(n,e)=>{const t=e&&"handle"in e?e.handle:e;return n.bindFramebuffer(36160,t)},blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{const t=typeof e=="number"?[e,e]:e;n.blendEquationSeparate(...t)},blendFunc:(n,e)=>{const t=e?.length===2?[...e,...e]:e;n.blendFuncSeparate(...t)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(e[0],e[1]||!1),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=ep(e)?e:[e,e];const[t,i]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,i)},stencilFunc:(n,e)=>{e=ep(e)&&e.length===3?[...e,...e]:e;const[t,i,s,o,l,c]=e;n.stencilFuncSeparate(1028,t,i,s),n.stencilFuncSeparate(1029,o,l,c)},stencilOp:(n,e)=>{e=ep(e)&&e.length===3?[...e,...e]:e;const[t,i,s,o,l,c]=e;n.stencilOpSeparate(1028,t,i,s),n.stencilOpSeparate(1029,o,l,c)},viewport:(n,e)=>n.viewport(...e)};function ct(n,e,t){return e[n]!==void 0?e[n]:t[n]}const uI={blendEquation:(n,e,t)=>n.blendEquationSeparate(ct(32777,e,t),ct(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(ct(32969,e,t),ct(32968,e,t),ct(32971,e,t),ct(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(ct(32824,e,t),ct(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(ct(32938,e,t),ct(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,ct(2962,e,t),ct(2967,e,t),ct(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,ct(34816,e,t),ct(36003,e,t),ct(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,ct(2964,e,t),ct(2965,e,t),ct(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,ct(34817,e,t),ct(34818,e,t),ct(34819,e,t))},_y={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),useProgram:(n,e)=>n({35725:e}),bindRenderbuffer:(n,e,t)=>n({36007:t}),bindTransformFeedback:(n,e,t)=>n({36389:t}),bindVertexArray:(n,e)=>n({34229:e}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},bindBuffer:(n,e,t)=>{const i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return i?n({[i]:t}):{valueChanged:!0}},blendColor:(n,e,t,i,s)=>n({32773:new Float32Array([e,t,i,s])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,i,s)=>n({32969:e,32968:t,32971:i,32970:s}),clearColor:(n,e,t,i,s)=>n({3106:new Float32Array([e,t,i,s])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,i,s)=>n({3107:[e,t,i,s]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,i,s)=>n({3088:new Int32Array([e,t,i,s])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[e===1028?2968:36005]:t}),stencilFunc:(n,e,t,i)=>n({2962:e,2967:t,2963:i,34816:e,36003:t,36004:i}),stencilFuncSeparate:(n,e,t,i,s)=>n({[e===1028?2962:34816]:t,[e===1028?2967:36003]:i,[e===1028?2963:36004]:s}),stencilOp:(n,e,t,i)=>n({2964:e,2965:t,2966:i,34817:e,34818:t,34819:i}),stencilOpSeparate:(n,e,t,i,s)=>n({[e===1028?2964:34817]:t,[e===1028?2965:34818]:i,[e===1028?2966:34819]:s}),viewport:(n,e,t,i,s)=>n({2978:[e,t,i,s]})},$n=(n,e)=>n.isEnabled(e),yy={3042:$n,2884:$n,2929:$n,3024:$n,32823:$n,32926:$n,32928:$n,3089:$n,2960:$n,35977:$n},fI=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function bo(n,e){if(dI(e))return;const t={};for(const s in e){const o=Number(s),l=cI[s];l&&(typeof l=="string"?t[l]=!0:l(n,e[s],o))}const i=n.state&&n.state.cache;if(i)for(const s in t){const o=uI[s];o(n,e,i)}}function V8(n,e=Gg){if(typeof e=="number"){const s=e,o=yy[s];return o?o(n,s):n.getParameter(s)}const t=Array.isArray(e)?e:Object.keys(e),i={};for(const s of t){const o=yy[s];i[s]=o?o(n,Number(s)):n.getParameter(Number(s))}return i}function hI(n){bo(n,Gg)}function dI(n){for(const e in n)return!1;return!0}function pI(n,e){if(n===e)return!0;if(by(n)&&by(e)&&n.length===e.length){for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}return!1}function by(n){return Array.isArray(n)||ArrayBuffer.isView(n)}class Ls{static get(e){return e.state}gl;program=null;stateStack=[];enable=!0;cache=null;log;initialized=!1;constructor(e,t){this.gl=e,this.log=t?.log||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];bo(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t?.copyState?V8(e):Object.assign({},Gg),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,mI(e);for(const i in _y){const s=_y[i];gI(e,i,s)}vy(e,"getParameter"),vy(e,"isEnabled")}_updateCache(e){let t=!1,i;const s=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const o in e){const l=e[o],c=this.cache[o];pI(l,c)||(t=!0,i=c,s&&!(o in s)&&(s[o]=c),this.cache[o]=l)}return{valueChanged:t,oldValue:i}}}function vy(n,e){const t=n[e].bind(n);n[e]=function(s){if(s===void 0||fI.has(s))return t(s);const o=Ls.get(n);return s in o.cache||(o.cache[s]=t(s)),o.enable?o.cache[s]:t(s)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function gI(n,e,t){if(!n[e])return;const i=n[e].bind(n);n[e]=function(...o){const l=Ls.get(n),{valueChanged:c,oldValue:f}=t(l._updateCache,...o);return c&&i(...o),f},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}function mI(n){const e=n.useProgram.bind(n);n.useProgram=function(i){const s=Ls.get(n);s.program!==i&&(e(i),s.program=i)}}function _I(n,e,t){let i="";const s={preserveDrawingBuffer:!0,...t};let o=null;if(o||=n.getContext("webgl2",s),s.failIfMajorPerformanceCaveat&&(i||="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow."),!o&&!t.failIfMajorPerformanceCaveat&&(s.failIfMajorPerformanceCaveat=!1,o=n.getContext("webgl2",s),o.luma||={},o.luma.softwareRenderer=!0),o||(o=n.getContext("webgl",{}),o&&(o=null,i||="Your browser only supports WebGL1")),!o)throw i||="Your browser does not support WebGL",new Error(`Failed to create WebGL context: ${i}`);const{onContextLost:l,onContextRestored:c}=e;return n.addEventListener("webglcontextlost",f=>l(f),!1),n.addEventListener("webglcontextrestored",f=>c(f),!1),o.luma||={},o}function fo(n,e,t){return t[e]===void 0&&(t[e]=n.getExtension(e)||null),t[e]}function yI(n,e){const t=n.getParameter(7936),i=n.getParameter(7937);fo(n,"WEBGL_debug_renderer_info",e);const s=e.WEBGL_debug_renderer_info,o=n.getParameter(s?s.UNMASKED_VENDOR_WEBGL:7936),l=n.getParameter(s?s.UNMASKED_RENDERER_WEBGL:7937),c=o||t,f=l||i,d=n.getParameter(7938),p=H8(c,f),_=bI(c,f),y=vI(c,f);return{type:"webgl",gpu:p,gpuType:y,gpuBackend:_,vendor:c,renderer:f,version:d,shadingLanguage:"glsl",shadingLanguageVersion:300}}function H8(n,e){return/NVIDIA/i.exec(n)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(n)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(n)||/Apple/i.exec(e)?"apple":/AMD/i.exec(n)||/AMD/i.exec(e)||/ATI/i.exec(n)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e)?"software":"unknown"}function bI(n,e){return/Metal/i.exec(n)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(n)||/ANGLE/i.exec(e)?"opengl":"unknown"}function vI(n,e){if(/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e))return"cpu";switch(H8(n,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function $8(n){switch(n){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(n))}const Oa="WEBGL_compressed_texture_s3tc",Ia="WEBGL_compressed_texture_s3tc_srgb",Xr="EXT_texture_compression_rgtc",Yr="EXT_texture_compression_bptc",xI="WEBGL_compressed_texture_etc",TI="WEBGL_compressed_texture_astc",wI="WEBGL_compressed_texture_etc1",SI="WEBGL_compressed_texture_pvrtc",AI="WEBGL_compressed_texture_atc",xy="EXT_texture_norm16",Ty="EXT_render_snorm",EI="EXT_color_buffer_float",Qg={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Ty],"norm16-renderable-webgl":[xy],"snorm16-renderable-webgl":[xy,Ty],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Oa,Ia,Xr,Yr],"texture-compression-bc5-webgl":[Xr],"texture-compression-bc7-webgl":[Yr],"texture-compression-etc2":[xI],"texture-compression-astc":[TI],"texture-compression-etc1-webgl":[wI],"texture-compression-pvrtc-webgl":[SI],"texture-compression-atc-webgl":[AI]};function CI(n){return n in Qg}function RI(n,e,t){return(Qg[e]||[]).every(s=>fo(n,s,t))}const Jg={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},r16unorm:{gl:33322,rb:!0},r16snorm:{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},rg16unorm:{gl:33324},rg16snorm:{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},rgb10a2uint:{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},rgba16unorm:{gl:32859,rb:!0},rgba16snorm:{gl:36763},"rgb32float-webgl":{gl:34837,x:EI,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Oa},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Ia},"bc1-rgba-unorm":{gl:33777,x:Oa},"bc1-rgba-unorm-srgb":{gl:35916,x:Ia},"bc2-rgba-unorm":{gl:33778,x:Oa},"bc2-rgba-unorm-srgb":{gl:35918,x:Ia},"bc3-rgba-unorm":{gl:33779,x:Oa},"bc3-rgba-unorm-srgb":{gl:35919,x:Ia},"bc4-r-unorm":{gl:36283,x:Xr},"bc4-r-snorm":{gl:36284,x:Xr},"bc5-rg-unorm":{gl:36285,x:Xr},"bc5-rg-snorm":{gl:36286,x:Xr},"bc6h-rgb-ufloat":{gl:36495,x:Yr},"bc6h-rgb-float":{gl:36494,x:Yr},"bc7-rgba-unorm":{gl:36492,x:Yr},"bc7-rgba-unorm-srgb":{gl:36493,x:Yr},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function MI(n,e,t){let i=e.create;const s=Jg[e.format];return s?.gl===void 0&&(i=!1),s?.x&&(i=i&&!!fo(n,s.x,t)),{format:e.format,create:i&&e.create,render:i&&e.render,filter:i&&e.filter,blend:i&&e.blend,store:i&&e.store}}function W8(n){const e=Jg[n],t=II(n),i=Kr.getInfo(n);return i.compressed&&(e.dataFormat=t),{internalFormat:t,format:e?.dataFormat||OI(i.channels,i.integer,i.normalized,t),type:i.dataType?$8(i.dataType):e?.types?.[0]||5121,compressed:i.compressed||!1}}function PI(n){switch(Kr.getInfo(n).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${n}`)}}function OI(n,e,t,i){if(i===6408||i===6407)return i;switch(n){case"r":return e&&!t?36244:6403;case"rg":return e&&!t?33320:33319;case"rgb":return e&&!t?36248:6407;case"rgba":return e&&!t?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function II(n){const t=Jg[n]?.gl;if(t===void 0)throw new Error(`Unsupported texture format ${n}`);return t}const wy={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class NI extends XE{gl;extensions;testedFeatures=new Set;constructor(e,t,i){super([],i),this.gl=e,this.extensions=t,fo(e,"EXT_color_buffer_float",t)}*[Symbol.iterator](){const e=this.getFeatures();for(const t of e)this.has(t)&&(yield t);return[]}has(e){return this.disabledFeatures?.[e]?!1:(this.testedFeatures.has(e)||(this.testedFeatures.add(e),CI(e)&&RI(this.gl,e,this.extensions)&&this.features.add(e),this.getWebGLFeature(e)&&this.features.add(e)),this.features.has(e))}initializeFeatures(){const e=this.getFeatures().filter(t=>t!=="polygon-mode-webgl");for(const t of e)this.has(t)}getFeatures(){return[...Object.keys(wy),...Object.keys(Qg)]}getWebGLFeature(e){const t=wy[e];return typeof t=="string"?!!fo(this.gl,t,this.extensions):!!t}}class kI extends WE{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderVariables(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(e){super(),this.gl=e}getParameter(e){return this.limits[e]===void 0&&(this.limits[e]=this.gl.getParameter(e)),this.limits[e]||0}}class za extends Xu{device;gl;handle;colorAttachments=[];depthStencilAttachment=null;constructor(e,t){super(e,t);const i=t.handle===null;this.device=e,this.gl=e.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const e=this.gl.bindFramebuffer(36160,this.handle);for(let t=0;t<this.colorAttachments.length;++t){const i=this.colorAttachments[t];if(i){const s=36064+t;this._attachTextureView(s,i)}}if(this.depthStencilAttachment){const t=PI(this.depthStencilAttachment.props.format);this._attachTextureView(t,this.depthStencilAttachment)}if(this.device.props.debug){const t=this.gl.checkFramebufferStatus(36160);if(t!==36053)throw new Error(`Framebuffer ${LI(t)}`)}this.gl.bindFramebuffer(36160,e)}_attachTextureView(e,t){const{gl:i}=this.device,{texture:s}=t,o=t.props.baseMipLevel,l=t.props.baseArrayLayer;switch(i.bindTexture(s.glTarget,s.handle),s.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,e,s.handle,o,l);break;case 34067:const c=DI(l);i.framebufferTexture2D(36160,e,c,s.handle,o);break;case 3553:i.framebufferTexture2D(36160,e,3553,s.handle,o);break;default:throw new Error("Illegal texture type")}i.bindTexture(s.glTarget,null)}}function DI(n){return n<34069?n+34069:n}function LI(n){switch(n){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${n}`}}class BI extends Os{device;handle=null;_framebuffer=null;get[Symbol.toStringTag](){return"WebGLCanvasContext"}constructor(e,t){super(t),this.device=e,this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this._updateDevice()}getCurrentFramebuffer(){return this._framebuffer=this._framebuffer||new za(this.device,{handle:null}),this._framebuffer}_updateDevice(){}}const tp={};function UI(n="id"){tp[n]=tp[n]||1;const e=tp[n]++;return`${n}-${e}`}class ja extends tt{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength=0;bytesUsed=0;constructor(e,t={}){super(e,t),this.device=e,this.gl=this.device.gl;const i=typeof t=="object"?t.handle:void 0;this.handle=i||this.gl.createBuffer(),e._setWebGLDebugMetadata(this.handle,this,{spector:{...this.props,data:typeof this.props.data}}),this.glTarget=FI(this.props.usage),this.glUsage=zI(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,t.data?this._initWithData(t.data,t.byteOffset,t.byteLength):this._initWithByteLength(t.byteLength||0)}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}_initWithData(e,t=0,i=e.byteLength+t){const s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,t,e),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(e,t,i),this.trackAllocatedMemory(i)}_initWithByteLength(e){let t=e;e===0&&(t=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,t,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=e,this.byteLength=e,this._setDebugData(null,0,e),this.trackAllocatedMemory(e),this}write(e,t=0){const i=ArrayBuffer.isView(e)?e:new Uint8Array(e),s=36663;this.gl.bindBuffer(s,this.handle),this.gl.bufferSubData(s,t,i),this.gl.bindBuffer(s,null),this._setDebugData(e,t,e.byteLength)}async mapAndWriteAsync(e,t=0,i=this.byteLength-t){const s=new ArrayBuffer(i);await e(s,"copied"),this.write(s,t)}async readAsync(e=0,t){return this.readSyncWebGL(e,t)}async mapAndReadAsync(e,t=0,i){const s=await this.readAsync(t,i);return await e(s.buffer,"copied")}readSyncWebGL(e=0,t){t=t??this.byteLength-e;const i=new Uint8Array(t),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,i,s,t),this.gl.bindBuffer(36662,null),this._setDebugData(i,e,t),i}}function FI(n){return n&tt.INDEX?34963:n&tt.VERTEX?34962:n&tt.UNIFORM?35345:34962}function zI(n){return n&tt.INDEX||n&tt.VERTEX?35044:n&tt.UNIFORM?35048:35044}function jI(n){const e=n.split(/\r?\n/),t=[];for(const i of e){if(i.length<=1)continue;const s=i.split(":");if(s.length===2){const[_,y]=s;t.push({message:y.trim(),type:Sy(_),lineNum:0,linePos:0});continue}const[o,l,c,...f]=s;let d=parseInt(c,10);isNaN(d)&&(d=0);let p=parseInt(l,10);isNaN(p)&&(p=0),t.push({message:f.join(":").trim(),type:Sy(o),lineNum:d,linePos:p})}return t}function Sy(n){const e=["warning","error","info"],t=n.toLowerCase();return e.includes(t)?t:"info"}class VI extends Wu{device;handle;constructor(e,t){switch(super(e,t),this.device=e,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}e._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0,this.handle.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>(this._getCompilationStatus(),this.compilationStatus))}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const e=this.device.gl.getShaderInfoLog(this.handle);return e?jI(e):[]}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)||null}async _compile(e){e=e.startsWith("#version ")?e:`#version 300 es
${e}`;const{gl:t}=this.device;if(t.shaderSource(this.handle,e),t.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}le.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),le.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const e=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await e(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function HI(n,e,t,i){if(YI(e))return i(n);const s=n;s.pushState();try{return $I(n,e),bo(s.gl,t),i(n)}finally{s.popState()}}function $I(n,e){const t=n,{gl:i}=t;if(e.cullMode)switch(e.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029);break}if(e.frontFace&&i.frontFace(Bs("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&n.features.has("depth-clip-control")&&i.enable(34383),e.depthBias!==void 0&&(i.enable(32823),i.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&n.features.has("provoking-vertex-webgl")){const o=t.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,l=Bs("provokingVertex",e.provokingVertex,{first:36429,last:36430});o?.provokingVertexWEBGL(l)}if((e.polygonMode||e.polygonOffsetLine)&&n.features.has("polygon-mode-webgl")){if(e.polygonMode){const o=t.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,l=Bs("polygonMode",e.polygonMode,{fill:6914,line:6913});o?.polygonModeWEBGL(1028,l),o?.polygonModeWEBGL(1029,l)}e.polygonOffsetLine&&i.enable(10754)}if(n.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&i.enable(12288),e.clipDistance1&&i.enable(12289),e.clipDistance2&&i.enable(12290),e.clipDistance3&&i.enable(12291),e.clipDistance4&&i.enable(12292),e.clipDistance5&&i.enable(12293),e.clipDistance6&&i.enable(12294),e.clipDistance7&&i.enable(12295)),e.depthWriteEnabled!==void 0&&i.depthMask(XI("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?i.enable(2929):i.disable(2929),i.depthFunc($p("depthCompare",e.depthCompare))),e.stencilWriteMask){const s=e.stencilWriteMask;i.stencilMaskSeparate(1028,s),i.stencilMaskSeparate(1029,s)}if(e.stencilReadMask&&le.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const s=e.stencilReadMask||4294967295,o=$p("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,o,0,s),i.stencilFuncSeparate(1029,o,0,s)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const s=np("stencilPassOperation",e.stencilPassOperation),o=np("stencilFailOperation",e.stencilFailOperation),l=np("stencilDepthFailOperation",e.stencilDepthFailOperation);i.stencilOpSeparate(1028,o,l,s),i.stencilOpSeparate(1029,o,l,s)}switch(e.blend){case!0:i.enable(3042);break;case!1:i.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const s=Ay("blendColorOperation",e.blendColorOperation||"add"),o=Ay("blendAlphaOperation",e.blendAlphaOperation||"add");i.blendEquationSeparate(s,o);const l=jc("blendColorSrcFactor",e.blendColorSrcFactor||"one"),c=jc("blendColorDstFactor",e.blendColorDstFactor||"zero"),f=jc("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),d=jc("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");i.blendFuncSeparate(l,c,f,d)}}function $p(n,e){return Bs(n,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function np(n,e){return Bs(n,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function Ay(n,e){return Bs(n,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function jc(n,e,t="color"){return Bs(n,e,{one:1,zero:0,src:768,"one-minus-src":769,dst:774,"one-minus-dst":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,constant:t==="color"?32769:32771,"one-minus-constant":t==="color"?32770:32772,src1:768,"one-minus-src1":769,"src1-alpha":770,"one-minus-src1-alpha":771})}function WI(n,e){return`Illegal parameter ${e} for ${n}`}function Bs(n,e,t){if(!(e in t))throw new Error(WI(n,e));return t[e]}function XI(n,e){return e}function YI(n){let e=!0;for(const t in n){e=!1;break}return e}function X8(n){const e={};return n.addressModeU&&(e[10242]=ip(n.addressModeU)),n.addressModeV&&(e[10243]=ip(n.addressModeV)),n.addressModeW&&(e[32882]=ip(n.addressModeW)),n.magFilter&&(e[10240]=Wp(n.magFilter)),(n.minFilter||n.mipmapFilter)&&(e[10241]=qI(n.minFilter||"linear",n.mipmapFilter)),n.lodMinClamp!==void 0&&(e[33082]=n.lodMinClamp),n.lodMaxClamp!==void 0&&(e[33083]=n.lodMaxClamp),n.type==="comparison-sampler"&&(e[34892]=34894),n.compare&&(e[34893]=$p("compare",n.compare)),n.maxAnisotropy&&(e[34046]=n.maxAnisotropy),e}function ip(n){switch(n){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function Wp(n){switch(n){case"nearest":return 9728;case"linear":return 9729}}function qI(n,e="none"){if(!e)return Wp(n);switch(e){case"none":return Wp(n);case"nearest":switch(n){case"nearest":return 9984;case"linear":return 9985}break;case"linear":switch(n){case"nearest":return 9986;case"linear":return 9987}}}class ZI extends Fs{device;handle;parameters;constructor(e,t){super(e,t),this.device=e,this.parameters=X8(t),this.handle=t.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(e){for(const[t,i]of Object.entries(e)){const s=Number(t);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}}function Ka(n,e,t){if(KI(e))return t(n);const{nocatch:i=!0}=e,s=Ls.get(n);s.push(),bo(n,e);let o;if(i)o=t(n),s.pop();else try{o=t(n)}finally{s.pop()}return o}function KI(n){for(const e in n)return!1;return!0}class qr extends $u{device;gl;handle;texture;constructor(e,t){super(e,{...wt.defaultProps,...t}),this.device=e,this.gl=this.device.gl,this.handle=null,this.texture=t.texture}}class Va extends wt{device;gl;handle;sampler=void 0;view;glTarget;glFormat;glType;glInternalFormat;compressed;_textureUnit=0;constructor(e,t){super(e,t),this.device=e,this.gl=this.device.gl;const i=W8(this.props.format);this.glTarget=GI(this.props.dimension),this.glInternalFormat=i.internalFormat,this.glFormat=i.format,this.glType=i.type,this.compressed=i.compressed,this.handle=this.props.handle||this.gl.createTexture(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:this.props}),this.gl.bindTexture(this.glTarget,this.handle);const{dimension:s,width:o,height:l,depth:c,mipLevels:f,glTarget:d,glInternalFormat:p}=this;switch(s){case"2d":case"cube":this.gl.texStorage2D(d,f,p,o,l);break;case"2d-array":case"3d":this.gl.texStorage3D(d,f,p,o,l,c);break;default:throw new Error(s)}this.gl.bindTexture(this.glTarget,null),this._initializeData(t.data),this.setSampler(this.props.sampler),this.view=new qr(this.device,{...this.props,texture:this}),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(e){return new qr(this.device,{...e,texture:this})}setSampler(e={}){super.setSampler(e);const t=X8(this.sampler.props);this._setSamplerParameters(t)}copyImageData(e){const t=this._normalizeCopyImageDataOptions(e),i=t.data,{width:s,height:o,depth:l}=this,{mipLevel:c=0,byteOffset:f=0,x:d=0,y:p=0,z:_=0}=t,{glFormat:y,glType:v,compressed:x}=this,S=Ey(this.glTarget,this.dimension,_);let M;if(!this.compressed){const{bytesPerPixel:U}=this.device.getTextureFormatInfo(this.format);if(U){if(t.bytesPerRow%U!==0)throw new Error(`bytesPerRow (${t.bytesPerRow}) must be a multiple of bytesPerPixel (${U}) for ${this.format}`);M=t.bytesPerRow/U}}const C=this.compressed?{}:{...M!==void 0?{3314:M}:{},32878:t.rowsPerImage};this.gl.bindTexture(S,this.handle),Ka(this.gl,C,()=>{switch(this.dimension){case"2d":case"cube":x?this.gl.compressedTexSubImage2D(S,c,d,p,s,o,y,i,f):this.gl.texSubImage2D(S,c,d,p,s,o,y,v,i,f);break;case"2d-array":case"3d":x?this.gl.compressedTexSubImage3D(S,c,d,p,_,s,o,l,y,i,f):this.gl.texSubImage3D(S,c,d,p,_,s,o,l,y,v,i,f);break;default:}}),this.gl.bindTexture(S,null)}copyExternalImage(e){const t=this._normalizeCopyExternalImageOptions(e);if(t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");const{glFormat:i,glType:s}=this,{image:o,depth:l,mipLevel:c,x:f,y:d,z:p,width:_,height:y}=t,v=Ey(this.glTarget,this.dimension,l),x=t.flipY?{37440:!0}:{};return this.gl.bindTexture(this.glTarget,this.handle),Ka(this.gl,x,()=>{switch(this.dimension){case"2d":case"cube":this.gl.texSubImage2D(v,c,f,d,_,y,i,s,o);break;case"2d-array":case"3d":this.gl.texSubImage3D(v,c,f,d,p,_,y,l,i,s,o);break;default:}}),this.gl.bindTexture(this.glTarget,null),{width:t.width,height:t.height}}generateMipmapsWebGL(e){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(le.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!e?.force)))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){le.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}_setSamplerParameters(e){le.log(2,`${this.id} sampler parameters`,this.device.getGLKeys(e))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[t,i]of Object.entries(e)){const s=Number(t),o=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.glTarget,s,o);break;case 10240:case 10241:this.gl.texParameteri(this.glTarget,s,o);break;case 10242:case 10243:case 32882:this.gl.texParameteri(this.glTarget,s,o);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,s,o);break;case 34892:case 34893:this.gl.texParameteri(this.glTarget,s,o);break}}this.gl.bindTexture(this.glTarget,null)}_getActiveUnit(){return this.gl.getParameter(34016)-33984}_bind(e){const{gl:t}=this;return e!==void 0&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,this.handle),e}_unbind(e){const{gl:t}=this;return e!==void 0&&(this._textureUnit=e,t.activeTexture(33984+e)),t.bindTexture(this.glTarget,null),e}}function GI(n){switch(n){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(n)}function Ey(n,e,t){return e==="cube"?34069+t:n}function QI(n){return nN[n]}function e2(n){return tN[n]}function JI(n){return!!Y8[n]}function eN(n){return Y8[n]}const tN={5126:"f32",35664:"vec2<f32>",35665:"vec3<f32>",35666:"vec4<f32>",5124:"i32",35667:"vec2<i32>",35668:"vec3<i32>",35669:"vec4<i32>",5125:"u32",36294:"vec2<u32>",36295:"vec3<u32>",36296:"vec4<u32>",35670:"f32",35671:"vec2<f32>",35672:"vec3<f32>",35673:"vec4<f32>",35674:"mat2x2<f32>",35685:"mat2x3<f32>",35686:"mat2x4<f32>",35687:"mat3x2<f32>",35675:"mat3x3<f32>",35688:"mat3x4<f32>",35689:"mat4x2<f32>",35690:"mat4x3<f32>",35676:"mat4x4<f32>"},Y8={35678:{viewDimension:"2d",sampleType:"float"},35680:{viewDimension:"cube",sampleType:"float"},35679:{viewDimension:"3d",sampleType:"float"},35682:{viewDimension:"3d",sampleType:"depth"},36289:{viewDimension:"2d-array",sampleType:"float"},36292:{viewDimension:"2d-array",sampleType:"depth"},36293:{viewDimension:"cube",sampleType:"float"},36298:{viewDimension:"2d",sampleType:"sint"},36299:{viewDimension:"3d",sampleType:"sint"},36300:{viewDimension:"cube",sampleType:"sint"},36303:{viewDimension:"2d-array",sampleType:"uint"},36306:{viewDimension:"2d",sampleType:"uint"},36307:{viewDimension:"3d",sampleType:"uint"},36308:{viewDimension:"cube",sampleType:"uint"},36311:{viewDimension:"2d-array",sampleType:"uint"}},nN={uint8:5121,sint8:5120,unorm8:5121,snorm8:5120,uint16:5123,sint16:5122,unorm16:5123,snorm16:5122,uint32:5125,sint32:5124,float16:5131,float32:5126};function iN(n,e){const t={attributes:[],bindings:[]};t.attributes=sN(n,e);const i=aN(n,e);for(const c of i){const f=c.uniforms.map(d=>({name:d.name,format:d.format,byteOffset:d.byteOffset,byteStride:d.byteStride,arrayLength:d.arrayLength}));t.bindings.push({type:"uniform",name:c.name,group:0,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:f})}const s=oN(n,e);let o=0;for(const c of s)if(JI(c.type)){const{viewDimension:f,sampleType:d}=eN(c.type);t.bindings.push({type:"texture",name:c.name,group:0,location:o,viewDimension:f,sampleType:d}),c.textureUnit=o,o+=1}s.length&&(t.uniforms=s);const l=rN(n,e);return l?.length&&(t.varyings=l),t}function sN(n,e){const t=[],i=n.getProgramParameter(e,35721);for(let s=0;s<i;s++){const o=n.getActiveAttrib(e,s);if(!o)throw new Error("activeInfo");const{name:l,type:c}=o,f=n.getAttribLocation(e,l);if(f>=0){const d=e2(c),p=/instance/i.test(l)?"instance":"vertex";t.push({name:l,location:f,stepMode:p,type:d})}}return t.sort((s,o)=>s.location-o.location),t}function rN(n,e){const t=[],i=n.getProgramParameter(e,35971);for(let s=0;s<i;s++){const o=n.getTransformFeedbackVarying(e,s);if(!o)throw new Error("activeInfo");const{name:l,type:c,size:f}=o,d=e2(c),{type:p,components:_}=kb(d);t.push({location:s,name:l,type:p,size:f*_})}return t.sort((s,o)=>s.location-o.location),t}function oN(n,e){const t=[],i=n.getProgramParameter(e,35718);for(let s=0;s<i;s++){const o=n.getActiveUniform(e,s);if(!o)throw new Error("activeInfo");const{name:l,size:c,type:f}=o,{name:d,isArray:p}=lN(l);let _=n.getUniformLocation(e,d);const y={location:_,name:d,size:c,type:f,isArray:p};if(t.push(y),y.size>1)for(let v=0;v<y.size;v++){const x=`${d}[${v}]`;_=n.getUniformLocation(e,x);const S={...y,name:x,location:_};t.push(S)}}return t}function aN(n,e){const t=(o,l)=>n.getActiveUniformBlockParameter(e,o,l),i=[],s=n.getProgramParameter(e,35382);for(let o=0;o<s;o++){const l={name:n.getActiveUniformBlockName(e,o)||"",location:t(o,35391),byteLength:t(o,35392),vertex:t(o,35396),fragment:t(o,35398),uniformCount:t(o,35394),uniforms:[]},c=t(o,35395)||[],f=n.getActiveUniforms(e,c,35383),d=n.getActiveUniforms(e,c,35384),p=n.getActiveUniforms(e,c,35387),_=n.getActiveUniforms(e,c,35388);for(let y=0;y<l.uniformCount;++y){const v=n.getActiveUniform(e,c[y]);if(!v)throw new Error("activeInfo");const x=e2(f[y]);l.uniforms.push({name:v.name,format:x,type:f[y],arrayLength:d[y],byteOffset:p[y],byteStride:_[y]})}i.push(l)}return i.sort((o,l)=>o.location-l.location),i}function lN(n){if(n[n.length-1]!=="]")return{name:n,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(n);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]?1:0,isArray:!!t[2]}}function cN(n,e,t,i){const s=n;let o=i;o===!0&&(o=1),o===!1&&(o=0);const l=typeof o=="number"?[o]:o;switch(t){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof i!="number")throw new Error("samplers must be set to integers");return n.uniform1i(e,i);case 5126:return n.uniform1fv(e,l);case 35664:return n.uniform2fv(e,l);case 35665:return n.uniform3fv(e,l);case 35666:return n.uniform4fv(e,l);case 5124:return n.uniform1iv(e,l);case 35667:return n.uniform2iv(e,l);case 35668:return n.uniform3iv(e,l);case 35669:return n.uniform4iv(e,l);case 35670:return n.uniform1iv(e,l);case 35671:return n.uniform2iv(e,l);case 35672:return n.uniform3iv(e,l);case 35673:return n.uniform4iv(e,l);case 5125:return s.uniform1uiv(e,l,1);case 36294:return s.uniform2uiv(e,l,2);case 36295:return s.uniform3uiv(e,l,3);case 36296:return s.uniform4uiv(e,l,4);case 35674:return n.uniformMatrix2fv(e,!1,l);case 35675:return n.uniformMatrix3fv(e,!1,l);case 35676:return n.uniformMatrix4fv(e,!1,l);case 35685:return s.uniformMatrix2x3fv(e,!1,l);case 35686:return s.uniformMatrix2x4fv(e,!1,l);case 35687:return s.uniformMatrix3x2fv(e,!1,l);case 35688:return s.uniformMatrix3x4fv(e,!1,l);case 35689:return s.uniformMatrix4x2fv(e,!1,l);case 35690:return s.uniformMatrix4x3fv(e,!1,l)}throw new Error("Illegal uniform")}function uN(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(n)}}function fN(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(n)}}const Cy=4;class hN extends ks{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};get[Symbol.toStringTag](){return"WEBGLRenderPipeline"}constructor(e,t){super(e,t),this.device=e,this.handle=this.props.handle||this.device.gl.createProgram(),this.device._setWebGLDebugMetadata(this.handle,this,{spector:{id:this.props.id}}),this.vs=t.vs,this.fs=t.fs;const{varyings:i,bufferMode:s=35981}=t;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),le.time(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=iN(this.device.gl,this.handle),le.timeEnd(3,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=t.shaderLayout?dN(this.introspectedLayout,t.shaderLayout):this.introspectedLayout}destroy(){this.handle&&(this.device.gl.useProgram(null),this.device.gl.deleteProgram(this.handle),this.destroyed=!0,this.handle.destroyed=!0,this.handle=null)}setBindings(e,t){for(const[i,s]of Object.entries(e)){const o=this.shaderLayout.bindings.find(l=>l.name===i)||this.shaderLayout.bindings.find(l=>l.name===`${i}Uniforms`);if(!o){const l=this.shaderLayout.bindings.map(c=>`"${c.name}"`).join(", ");t?.disableWarnings||le.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${l}`,s)();continue}switch(s||le.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),o.type){case"uniform":if(!(s instanceof ja)&&!(s.buffer instanceof ja))throw new Error("buffer value");break;case"texture":if(!(s instanceof qr||s instanceof Va||s instanceof za))throw new Error(`${this} Bad texture binding for ${i}`);break;case"sampler":le.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(o.type)}this.bindings[i]=s}}draw(e){const{renderPass:t,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:o,vertexCount:l,instanceCount:c,isInstanced:f=!1,firstVertex:d=0,transformFeedback:p}=e,_=uN(s),y=!!o.indexBuffer,v=o.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return le.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return le.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),o.bindBeforeRender(t),p&&p.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const x=t;return HI(this.device,i,x.glParameters,()=>{y&&f?this.device.gl.drawElementsInstanced(_,l||0,v,d,c||0):y?this.device.gl.drawElements(_,l||0,v,d):f?this.device.gl.drawArraysInstanced(_,d,l||0,c||0):this.device.gl.drawArrays(_,d,l||0),p&&p.end()}),o.unbindAfterRender(t),!0}async _linkShaders(){const{gl:e}=this.device;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),le.time(Cy,`linkProgram for ${this.id}`)(),e.linkProgram(this.handle),le.timeEnd(Cy,`linkProgram for ${this.id}`)(),le.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}le.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),le.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const t=this._getLinkStatus();this._reportLinkStatus(t)}async _reportLinkStatus(e){switch(e){case"success":return;default:const t=e==="link-error"?"Link error":"Validation error";switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`${this} ${t} during compilation of ${this.vs}`);case"pending":await this.vs.asyncCompilationStatus,this.vs.debugShader();break}switch(this.fs?.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`${this} ${t} during compilation of ${this.fs}`);case"pending":await this.fs.asyncCompilationStatus,this.fs.debugShader();break}const i=this.device.gl.getProgramInfoLog(this.handle);this.device.reportError(new Error(`${t} during ${e}: ${i}`),this)(),this.device.debug()}}_getLinkStatus(){const{gl:e}=this.device;return e.getProgramParameter(this.handle,35714)?(e.validateProgram(this.handle),e.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation-error")):(this.linkStatus="error","link-error")}async _waitForLinkComplete(){const e=async s=>await new Promise(o=>setTimeout(o,s));if(!this.device.features.has("compilation-status-async-webgl")){await e(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await e(10)}}_areTexturesRenderable(){let e=!0;for(const t of this.shaderLayout.bindings)!this.bindings[t.name]&&!this.bindings[t.name.replace(/Uniforms$/,"")]&&(le.warn(`Binding ${t.name} not found in ${this.id}`)(),e=!1);return e}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:e}=this.device;e.useProgram(this.handle);let t=0,i=0;for(const s of this.shaderLayout.bindings){const o=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!o)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":const{name:l}=s,c=e.getUniformBlockIndex(this.handle,l);if(c===4294967295)throw new Error(`Invalid uniform block name ${l}`);e.uniformBlockBinding(this.handle,i,c),o instanceof ja?e.bindBufferBase(35345,i,o.handle):e.bindBufferRange(35345,i,o.buffer.handle,o.offset||0,o.size||o.buffer.byteLength-o.offset),i+=1;break;case"texture":if(!(o instanceof qr||o instanceof Va||o instanceof za))throw new Error("texture");let f;if(o instanceof qr)f=o.texture;else if(o instanceof Va)f=o;else if(o instanceof za&&o.colorAttachments[0]instanceof qr)le.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),f=o.colorAttachments[0].texture;else throw new Error("No texture");e.activeTexture(33984+t),e.bindTexture(f.glTarget,f.handle),t+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(const e of this.shaderLayout.uniforms||[]){const{name:t,location:i,type:s,textureUnit:o}=e,l=this.uniforms[t]??o;l!==void 0&&cN(this.device.gl,i,s,l)}}}function dN(n,e){const t={...n,attributes:n.attributes.map(i=>({...i}))};for(const i of e?.attributes||[]){const s=t.attributes.find(o=>o.name===i.name);s?(s.type=i.type||s.type,s.stepMode=i.stepMode||s.stepMode):le.warn(`shader layout attribute ${i.name} not present in shader`)}return t}class pN extends Eg{device;handle=null;commands=[];constructor(e){super(e,{}),this.device=e}_executeCommands(e=this.commands){for(const t of e)switch(t.name){case"copy-buffer-to-buffer":gN(this.device,t.options);break;case"copy-buffer-to-texture":mN(this.device,t.options);break;case"copy-texture-to-buffer":_N(this.device,t.options);break;case"copy-texture-to-texture":yN(this.device,t.options);break;default:throw new Error(t.name)}}}function gN(n,e){const t=e.sourceBuffer,i=e.destinationBuffer;n.gl.bindBuffer(36662,t.handle),n.gl.bindBuffer(36663,i.handle),n.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),n.gl.bindBuffer(36662,null),n.gl.bindBuffer(36663,null)}function mN(n,e){throw new Error("Not implemented")}function _N(n,e){const{sourceTexture:t,mipLevel:i=0,aspect:s="all",width:o=e.sourceTexture.width,height:l=e.sourceTexture.height,depthOrArrayLayers:c=0,origin:f=[0,0],destinationBuffer:d,byteOffset:p=0,bytesPerRow:_,rowsPerImage:y}=e;if(s!=="all")throw new Error("aspect not supported in WebGL");if(i!==0||c!==0||_||y)throw new Error("not implemented");const{framebuffer:v,destroyFramebuffer:x}=q8(t);let S;try{const M=d,C=o||v.width,U=l||v.height,R=W8(v.colorAttachments[0].texture.props.format),D=R.format,B=R.type;n.gl.bindBuffer(35051,M.handle),S=n.gl.bindFramebuffer(36160,v.handle),n.gl.readPixels(f[0],f[1],C,U,D,B,p)}finally{n.gl.bindBuffer(35051,null),S!==void 0&&n.gl.bindFramebuffer(36160,S),x&&v.destroy()}}function yN(n,e){const{sourceTexture:t,destinationMipLevel:i=0,origin:s=[0,0],destinationOrigin:o=[0,0],destinationTexture:l}=e;let{width:c=e.destinationTexture.width,height:f=e.destinationTexture.height}=e;const{framebuffer:d,destroyFramebuffer:p}=q8(t),[_,y]=s,[v,x,S]=o,M=n.gl.bindFramebuffer(36160,d.handle);let C,U;if(l instanceof Va)C=l,c=Number.isFinite(c)?c:C.width,f=Number.isFinite(f)?f:C.height,C._bind(0),U=C.glTarget;else throw new Error("invalid destination");switch(U){case 3553:case 34067:n.gl.copyTexSubImage2D(U,i,v,x,_,y,c,f);break;case 35866:case 32879:n.gl.copyTexSubImage3D(U,i,v,x,S,_,y,c,f);break}C&&C._unbind(),n.gl.bindFramebuffer(36160,M),p&&d.destroy()}function q8(n){if(n instanceof wt){const{width:e,height:t,id:i}=n;return{framebuffer:n.device.createFramebuffer({id:`framebuffer-for-${i}`,width:e,height:t,colorAttachments:[n]}),destroyFramebuffer:!0}}return{framebuffer:n,destroyFramebuffer:!1}}const bN=[1,2,4,8];class vN extends Ms{device;handle=null;glParameters={};constructor(e,t){super(e,t),this.device=e;let i;if(!t?.parameters?.viewport)if(t?.framebuffer){const{width:o,height:l}=t.framebuffer;i=[0,0,o,l]}else{const[o,l]=e.getDefaultCanvasContext().getDrawingBufferSize();i=[0,0,o,l]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});const s=this.props.framebuffer;if(this.props.framebuffer&&s?.handle){const o=this.props.framebuffer.colorAttachments.map((l,c)=>36064+c);this.device.gl.drawBuffers(o)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}setParameters(e={}){const t={...this.glParameters};t.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(t.depthMask=!this.props.depthReadOnly),t.stencilMask=this.props.stencilReadOnly?0:1,t[35977]=this.props.discard,e.viewport&&(e.viewport.length>=6?(t.viewport=e.viewport.slice(0,4),t.depthRange=[e.viewport[4],e.viewport[5]]):t.viewport=e.viewport),e.scissorRect&&(t.scissorTest=!0,t.scissor=e.scissorRect),e.blendConstant&&(t.blendColor=e.blendConstant),e.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=e.stencilReference),"colorMask"in e&&(t.colorMask=bN.map(i=>!!(i&e.colorMask))),this.glParameters=t,bo(this.device.gl,t)}beginOcclusionQuery(e){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){const e={...this.glParameters};let t=0;this.props.clearColors&&this.props.clearColors.forEach((i,s)=>{i&&this.clearColorBuffer(s,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(t|=16384,e.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(t|=256,e.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(t|=1024,e.clearStencil=this.props.clearStencil),t!==0&&Ka(this.device.gl,e,()=>{this.device.gl.clear(t)})}clearColorBuffer(e=0,t=[0,0,0,0]){Ka(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,e,t);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,e,t);break;case Float32Array:this.device.gl.clearBufferfv(6144,e,t);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}class Ry extends Ag{device;handle=null;commandBuffer;constructor(e,t){super(e,t),this.device=e,this.commandBuffer=new pN(e)}destroy(){}finish(){return this.commandBuffer}beginRenderPass(e){return new vN(this.device,e)}beginComputePass(e){throw new Error("ComputePass not supported in WebGL")}copyBufferToBuffer(e){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:e})}copyBufferToTexture(e){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:e})}copyTextureToBuffer(e){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:e})}copyTextureToTexture(e){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:e})}pushDebugGroup(e){}popDebugGroup(){}insertDebugMarker(e){}resolveQuerySet(e,t,i){}}function xN(n){const{target:e,source:t,start:i=0,count:s=1}=n,o=t.length,l=s*o;let c=0;for(let f=i;c<o;c++)e[f++]=t[c];for(;c<l;)c<l-c?(e.copyWithin(i+c,i,i+c),c*=2):(e.copyWithin(i+c,i,i+l-c),c=l);return n.target}class t2 extends Cg{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(e){return MS()==="Chrome"}constructor(e,t){super(e,t),this.device=e,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(e){const t=e;if(t&&t.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,t?t.handle:null),this.indexBuffer=t,this.device.gl.bindVertexArray(null)}setBuffer(e,t){const i=t;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:s,type:o,stride:l,offset:c,normalized:f,integer:d,divisor:p}=this._getAccessor(e);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),d?this.device.gl.vertexAttribIPointer(e,s,o,l,c):this.device.gl.vertexAttribPointer(e,s,o,f,l,c),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(e),this.device.gl.vertexAttribDivisor(e,p||0),this.attributes[e]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(e,t){this._enable(e,!1),this.attributes[e]=t}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let e=0;e<this.maxVertexAttributes;++e){const t=this.attributes[e];ArrayBuffer.isView(t)&&this.device.setConstantAttributeWebGL(e,t)}}_getAccessor(e){const t=this.attributeInfos[e];if(!t)throw new Error(`Unknown attribute location ${e}`);const i=$8(t.bufferDataType);return{size:t.bufferComponents,type:i,stride:t.byteStride,offset:t.byteOffset,normalized:t.normalized,integer:t.integer,divisor:t.stepMode==="instance"?1:0}}_enable(e,t=!0){const s=t2.isConstantAttributeZeroSupported(this.device)||e!==0;(t||s)&&(e=Number(e),this.device.gl.bindVertexArray(this.handle),t?this.device.gl.enableVertexAttribArray(e):this.device.gl.disableVertexAttribArray(e),this.device.gl.bindVertexArray(null))}getConstantBuffer(e,t){const i=TN(t),s=i.byteLength*e,o=i.length*e;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let l=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),l||=!wN(i,this.bufferValue),l){const c=xC(t.constructor,o);xN({target:c,source:i,start:0,count:o}),this.buffer.write(c),this.bufferValue=t}return this.buffer}}function TN(n){return Array.isArray(n)?new Float32Array(n):n}function wN(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}class SN extends Rg{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(e,t){super(e,t),this.device=e,this.gl=e.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,t.buffers&&this.setBuffers(t.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(e="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(fN(e))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(e){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const t in e)this.setBuffer(t,e[t])})}setBuffer(e,t){const i=this._getVaryingIndex(e),{buffer:s,byteLength:o,byteOffset:l}=this._getBufferRange(t);if(i<0){this.unusedBuffers[e]=s,le.warn(`${this.id} unusedBuffers varying buffer ${e}`)();return}this.buffers[i]={buffer:s,byteLength:o,byteOffset:l},this.bindOnUse||this._bindBuffer(i,s,l,o)}getBuffer(e){if(My(e))return this.buffers[e]||null;const t=this._getVaryingIndex(e);return t>=0?this.buffers[t]:null}bind(e=this.handle){if(typeof e!="function")return this.gl.bindTransformFeedback(36386,e),this;let t;return this._bound?t=e():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,t=e(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),t}unbind(){this.bind(null)}_getBufferRange(e){if(e instanceof ja)return{buffer:e,byteOffset:0,byteLength:e.byteLength};const{buffer:t,byteOffset:i=0,byteLength:s=e.buffer.byteLength}=e;return{buffer:t,byteOffset:i,byteLength:s}}_getVaryingIndex(e){if(My(e))return Number(e);for(const t of this.layout.varyings||[])if(e===t.name)return t.location;return-1}_bindBuffers(){for(const e in this.buffers){const{buffer:t,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[e]);this._bindBuffer(Number(e),t,s,i)}}_unbindBuffers(){for(const e in this.buffers)this.gl.bindBufferBase(35982,Number(e),null)}_bindBuffer(e,t,i=0,s){const o=t&&t.handle;!o||s===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,i,s)}}function My(n){return typeof n=="number"?Number.isInteger(n):/^\d+$/.test(n)}class AN extends Mg{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(e,t){if(super(e,t),this.device=e,t.count>1)throw new Error("WebGL QuerySet can only have one value");const i=this.device.gl.createQuery();if(!i)throw new Error("WebGL query not supported");this.handle=i,Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(e){return this._begin(e?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(e){this._queryPending||(this.target=e,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.device.gl.getQueryParameter(this.handle,34919);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(e=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let t=0;return this._pollingPromise=new Promise((i,s)=>{const o=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):t++>e?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}}function Z8(n){switch(n){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function EN(n){switch(n){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function CN(n){return RN[n]}const RN={5124:"sint32",5125:"uint32",5122:"sint16",5123:"uint16",5120:"sint8",5121:"uint8",5126:"float32",5131:"float16",33635:"uint16",32819:"uint16",32820:"uint16",33640:"uint32",35899:"uint32",35902:"uint32",34042:"uint32",36269:"uint32"};function MN(n,e){const{sourceX:t=0,sourceY:i=0,sourceAttachment:s=0}=e||{};let{target:o=null,sourceWidth:l,sourceHeight:c,sourceDepth:f,sourceFormat:d,sourceType:p}=e||{};const{framebuffer:_,deleteFramebuffer:y}=K8(n),{gl:v,handle:x}=_;l||=_.width,c||=_.height;const S=_.colorAttachments[s]?.texture;if(!S)throw new Error(`Invalid framebuffer attachment ${s}`);f=S?.depth||1,d||=S?.glFormat||6408,p||=S?.glType||5121,o=IN(o,p,d,l,c);const M=xg(o);p=p||QI(M);const C=v.bindFramebuffer(36160,x);return v.readBuffer(36064+s),v.readPixels(t,i,l,c,d,p,o),v.readBuffer(36064),v.bindFramebuffer(36160,C||null),y&&_.destroy(),o}function PN(n,e){const{target:t,sourceX:i=0,sourceY:s=0,sourceFormat:o=6408,targetByteOffset:l=0}=e||{};let{sourceWidth:c,sourceHeight:f,sourceType:d}=e||{};const{framebuffer:p,deleteFramebuffer:_}=K8(n);c=c||p.width,f=f||p.height;const y=p;d=d||5121;let v=t;if(!v){const S=Z8(o),M=EN(d),C=l+c*f*S*M;v=y.device.createBuffer({byteLength:C})}const x=n.device.createCommandEncoder();return x.copyTextureToBuffer({sourceTexture:n,width:c,height:f,origin:[i,s],destinationBuffer:v,byteOffset:l}),x.destroy(),_&&p.destroy(),v}function K8(n){return n instanceof Xu?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:ON(n),deleteFramebuffer:!0}}function ON(n,e){const{device:t,width:i,height:s,id:o}=n;return t.createFramebuffer({...e,id:`framebuffer-for-${o}`,width:i,height:s,colorAttachments:[n]})}function IN(n,e,t,i,s,o){if(n)return n;e||=5121;const l=CN(e),c=Tg(l),f=Z8(t);return new c(i*s*f)}class Xp extends Us{type="webgl";handle;features;limits;info;canvasContext;preferredColorFormat="rgba8unorm";preferredDepthFormat="depth24plus";commandEncoder;lost;_resolveContextLost;gl;_constants;_extensions={};_polyfilled=!1;spectorJS;get[Symbol.toStringTag](){return"WebGLDevice"}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}isVertexFormatSupported(e){switch(e){case"unorm8x4-bgra":return!1;default:return!0}}constructor(e){super({...e,id:e.id||UI("webgl-device")});const t=Us._getCanvasContextProps(e);if(!t)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=t.canvas?.gl?.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new BI(this,t),this.lost=new Promise(p=>{this._resolveContextLost=p});const s={...e.webgl};t.alphaMode==="premultiplied"&&(s.premultipliedAlpha=!0),e.powerPreference!==void 0&&(s.powerPreference=e.powerPreference);const l=this.props._handle||_I(this.canvasContext.canvas,{onContextLost:p=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."}),onContextRestored:p=>console.log("WebGL context restored")},s);if(!l)throw new Error("WebGL context creation failed");if(i=l.device,i){if(e._reuseDevices)return le.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=l,this.gl=l,this.spectorJS=JO({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=yI(this.gl,this._extensions),this.limits=new kI(this.gl),this.features=new NI(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),new Ls(this.gl,{log:(...p)=>le.log(1,...p)()}).trackState(this.gl,{copyState:!1});const f=e.debugWebGL||e.debug,d=e.debugWebGL;f&&(this.gl=nI(this.gl,{debugWebGL:f,traceWebGL:d}),le.warn("WebGL debug mode activated. Performance reduced.")(),e.debugWebGL&&(le.level=Math.max(le.level,1))),this.commandEncoder=new Ry(this,{id:`${this}-command-encoder`})}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}getTextureByteAlignment(){return 4}createCanvasContext(e){throw new Error("WebGL only supports a single canvas")}createBuffer(e){const t=this._normalizeBufferProps(e);return new ja(this,t)}createTexture(e){return new Va(this,e)}createExternalTexture(e){throw new Error("createExternalTexture() not implemented")}createSampler(e){return new ZI(this,e)}createShader(e){return new VI(this,e)}createFramebuffer(e){return new za(this,e)}createVertexArray(e){return new t2(this,e)}createTransformFeedback(e){return new SN(this,e)}createQuerySet(e){return new AN(this,e)}createRenderPipeline(e){return new hN(this,e)}createComputePipeline(e){throw new Error("ComputePipeline not supported in WebGL")}createCommandEncoder(e={}){return new Ry(this,e)}submit(e){e||(e=this.commandEncoder.finish(),this.commandEncoder.destroy(),this.commandEncoder=this.createCommandEncoder({id:`${this.id}-default-encoder`})),e._executeCommands()}readPixelsToArrayWebGL(e,t){return MN(e,t)}readPixelsToBufferWebGL(e,t){return PN(e,t)}setParametersWebGL(e){bo(this.gl,e)}getParametersWebGL(e){return V8(this.gl,e)}withParametersWebGL(e,t){return Ka(this.gl,e,t)}resetWebGL(){le.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),hI(this.gl)}_getDeviceSpecificTextureFormatCapabilities(e){return MI(this.gl,e,this._extensions)}loseDevice(){let e=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(e=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),e}pushState(){Ls.get(this.gl).push()}popState(){Ls.get(this.gl).pop()}getGLKey(e,t){const i=Number(e);for(const s in this.gl)if(this.gl[s]===i)return`GL.${s}`;return t?.emptyIfUnknown?"":String(e)}getGLKeys(e){const t={emptyIfUnknown:!0};return Object.entries(e).reduce((i,[s,o])=>(i[`${s}:${this.getGLKey(s,t)}`]=`${o}:${this.getGLKey(o,t)}`,i),{})}setConstantAttributeWebGL(e,t){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const s=this._constants[e];switch(s&&LN(s,t)&&le.info(1,`setConstantAttributeWebGL(${e}) could have been skipped, value unchanged`)(),this._constants[e]=t,t.constructor){case Float32Array:NN(this,e,t);break;case Int32Array:kN(this,e,t);break;case Uint32Array:DN(this,e,t);break;default:throw new Error("constant")}}getExtension(e){return fo(this.gl,e,this._extensions),this._extensions}_setWebGLDebugMetadata(e,t,i){e.luma=t;const s={props:i.spector,id:i.spector.id};e.__SPECTOR_Metadata=s}}function NN(n,e,t){switch(t.length){case 1:n.gl.vertexAttrib1fv(e,t);break;case 2:n.gl.vertexAttrib2fv(e,t);break;case 3:n.gl.vertexAttrib3fv(e,t);break;case 4:n.gl.vertexAttrib4fv(e,t);break}}function kN(n,e,t){n.gl.vertexAttribI4iv(e,t)}function DN(n,e,t){n.gl.vertexAttribI4uiv(e,t)}function LN(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}const Py=Object.freeze(Object.defineProperty({__proto__:null,WebGLDevice:Xp},Symbol.toStringTag,{value:"Module"}));function Gi(){}const BN=({isDragging:n})=>n?"grabbing":"grab",G8={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Gi,onWebGLInitialized:Gi,onResize:Gi,onViewStateChange:Gi,onInteractionStateChange:Gi,onBeforeRender:Gi,onAfterRender:Gi,onLoad:Gi,onError:n=>ke.error(n.message,n.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:BN,getTooltip:null,debug:!1,drawPickingColors:!1};class n2{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new ju({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null,unproject3D:!1},this._lastPointerDownInfo=null,this._onPointerMove=i=>{const{_pickRequest:s}=this;if(i.type==="pointerleave")s.x=-1,s.y=-1,s.radius=0;else{if(i.leftButton||i.rightButton)return;{const o=i.offsetCenter;if(!o)return;s.x=o.x,s.y=o.y,s.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:s.x,y:s.y}),s.event=i},this._onEvent=i=>{const s=Lp[i.type],o=i.offsetCenter;if(!s||!o||!this.layerManager)return;let l;const c=this.layerManager.getLayers(),f=c.some(v=>v.props.pickable==="3d");if(i.type==="click"&&f){const v=this._pick("pickObject","pickObject Time",{x:o.x,y:o.y,radius:this.props.pickingRadius,unproject3D:!0});l=v.result[0]||v.emptyInfo}else l=this.deckPicker.getLastPickedObject({x:o.x,y:o.y,layers:c,viewports:this.getViewports(o)},this._lastPointerDownInfo);const{layer:d}=l,p=d&&(d[s]||d.props[s]),_=this.props[s];let y=!1;p&&(y=p.call(d,l,i)),y||(_?.(l,i),this.widgetManager.onEvent(l,i))},this._onPointerDown=i=>{if(this.device?.type==="webgpu")return;const s=i.offsetCenter,o=this._pick("pickObject","pickObject Time",{x:s.x,y:s.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=o.result[0]||o.emptyInfo},this.props={...G8,...e},e=this.props,e.viewState&&e.initialViewState&&ke.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;if(!t&&e.gl){e.gl instanceof WebGLRenderingContext&&ke.error("WebGL1 context not supported.")();const i=this.props.deviceProps?.onResize;t=Jd.attach(e.gl,{_cacheShaders:!0,_cachePipelines:!0,...this.props.deviceProps,onResize:(s,o)=>{const{width:l,height:c}=s.canvas;s.drawingBufferWidth=l,s.drawingBufferHeight=c,this._needsRedraw="Canvas resized",i?.(s,o)}})}t||(t=this._createDevice(e)),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&oo.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&ke.removed("onLayerHover","onHover")(),"onLayerClick"in e&&ke.removed("onLayerClick","onClick")(),e.initialViewState&&!xn(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),e.device&&e.device.id!==this.device?.id&&(this.animationLoop?.stop(),this.canvas!==e.device.canvasContext?.canvas&&(this.canvas?.remove(),this.eventManager?.destroy(),this.canvas=null),ke.log(`recreating animation loop for new device! id=${e.device.id}`)(),this.animationLoop=this._createAnimationLoop(e.device,e),this.animationLoop.start()),this.animationLoop?.setProps(t),e.useDevicePixels!==void 0&&this.device?.canvasContext?.setProps&&this.device.canvasContext.setProps({useDevicePixels:e.useDevicePixels}),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const i=this.viewManager.needsRedraw(e),s=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return t=t||i||s||o||l,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return Mt(this.viewManager),this.viewManager.views}getView(e){return Mt(this.viewManager),this.viewManager.getView(e)}getViewports(e){return Mt(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const i in e)this.layerManager.resourceManager.add({resourceId:i,data:e[i],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){this.layerManager?.removeDefaultShaderModule(e)}_pick(e,t,i){Mt(this.deckPicker);const{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(t).timeStart();const o=this.deckPicker[e]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return s.get(t).timeEnd(),o}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),Mt(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",e.width&&typeof e.width=="number"&&(t.width=e.width),e.height&&typeof e.height=="number"&&(t.height=e.height),(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){if(!this.canvas)return;const{width:t,height:i}=e;if(t||t===0){const s=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=s}if(i||i===0){const s=Number.isFinite(i)?`${i}px`:i;this.canvas.style.position=e.style?.position||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,i=e.clientHeight??e.height;(t!==this.width||i!==this.height)&&(this.width=t,this.height=i,this.viewManager?.setProps({width:t,height:i}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:i}))}_createAnimationLoop(e,t){const{gl:i,onError:s}=t;return new Wg({device:e,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:s})}_createDevice(e){const t=this.props.deviceProps?.createCanvasContext,i=typeof t=="object"?t:void 0,s={adapters:[],_cacheShaders:!0,_cachePipelines:!0,...e.deviceProps};s.adapters.includes(Jd)||s.adapters.push(Jd);const o={alphaMode:this.props.deviceProps?.type==="webgpu"?"premultiplied":void 0},l=this.props.deviceProps?.onResize;return Ep.createDevice({_reuseDevices:!0,type:"webgl",...s,createCanvasContext:{...o,...i,canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!0},onResize:(c,f)=>{this._needsRedraw="Canvas resized",l?.(c,f)}})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new U8({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){if(this.device?.type==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const i=(this.layerManager?.getLayers()||[]).some(f=>f.props.pickable==="3d");e.unproject3D=i;const{result:s,emptyInfo:o}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=s.length>0;let l=o,c=!1;for(const f of s)l=f,c=f.layer?.onHover(f,e.event)||c;c||(this.props.onHover?.(l,e.event),this.widgetManager.onHover(l,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas,!this.canvas.isConnected&&this.props.parent&&this.props.parent.insertBefore(this.canvas,this.props.parent.firstChild)),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const t=new I8;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new yM(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(W_).map(s=>{const[o,l,c,f]=W_[s],d=this.props.eventRecognizerOptions?.[s],p={...l,...d,event:s};return{recognizer:new o(p),recognizeWith:c,requestFailure:f}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const s in Lp)this.eventManager.on(s,this._onEvent);this.viewManager=new mO({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const i=this.viewManager.getViewports()[0];this.layerManager=new gO(this.device,{deck:this,stats:this.stats,viewport:i,timeline:t}),this.effectManager=new NO({deck:this,device:this.device}),this.deckRenderer=new LO(this.device),this.deckPicker=new FO(this.device),this.widgetManager=new VO({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new F8),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){const{device:i,gl:s}=this.layerManager.context;this.props.onBeforeRender({device:i,gl:s});const o={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};this.deckRenderer?.renderLayers(o),o.pass==="screen"&&this.widgetManager.onRedraw({viewports:o.viewports,layers:o.layers}),this.props.onAfterRender({device:i,gl:s})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),ke.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this.device?.type!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const i=Ep.stats.get("Memory Usage");e.bufferMemory=i.get("Buffer Memory").count,e.textureMemory=i.get("Texture Memory").count,e.renderbufferMemory=i.get("Renderbuffer Memory").count,e.gpuMemory=i.get("GPU Memory").count}}n2.defaultProps=G8;n2.VERSION=KA;function UN(n){switch(n){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Tg(n)}}const FN=xg;function Vc(n,e,t){const i=t==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:n,format:e.size>1?`${i}x${e.size}`:e.type,byteOffset:e.offset||0}}function Is(n){return n.stride||n.size*n.bytesPerElement}function zN(n,e){return n.type===e.type&&n.size===e.size&&Is(n)===Is(e)&&(n.offset||0)===(e.offset||0)}function Yp(n,e){e.offset&&ke.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Is(n),i=e.vertexOffset!==void 0?e.vertexOffset:n.vertexOffset||0,s=e.elementOffset||0,o=i*t+s*n.bytesPerElement+(n.offset||0);return{...e,offset:o,stride:t}}function jN(n,e){const t=Yp(n,e);return{high:t,low:{...t,offset:t.offset+n.size*4}}}class VN{constructor(e,t,i){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const s=t.logicalType||t.type,o=s==="float64";let{defaultValue:l}=t;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let c;o?c="float32":!s&&t.isIndexed?c="uint32":c=s||"float32";let f=UN(s||c);this.doublePrecision=o,o&&t.fp64===!1&&(f=Float32Array),this.value=null,this.settings={...t,defaultType:f,defaultValue:l,logicalType:s,type:c,normalized:c.includes("norm"),size:this.size,bytesPerElement:f.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Is(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),oo.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const i={};if(this.state.constant){const s=this.value;if(t){const o=Yp(this.getAccessor(),t),l=o.offset/s.BYTES_PER_ELEMENT,c=o.size||this.size;i[e]=s.subarray(l,l+c)}else i[e]=s}else i[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i[`${e}64Low`]=i[e]:i[`${e}64Low`]=new Float32Array(this.size)),i}_getBufferLayout(e=this.id,t=null){const i=this.getAccessor(),s=[],o={name:this.id,byteStride:Is(i),attributes:s};if(this.doublePrecision){const l=jN(i,t||{});s.push(Vc(e,{...i,...l.high},this.device.type),Vc(`${e}64Low`,{...i,...l.low},this.device.type))}else if(t){const l=Yp(i,t);s.push(Vc(e,{...i,...l},this.device.type))}else s.push(Vc(e,i,this.device.type));return o}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:i,size:s}=this,o=i*s;if(t&&o&&t.length>=o){const l=new Array(s).fill(1/0),c=new Array(s).fill(-1/0);for(let f=0;f<o;)for(let d=0;d<s;d++){const p=t[f++];p<l[d]&&(l[d]=p),p>c[d]&&(c[d]=p)}e=[l,c]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let i;ArrayBuffer.isView(e)?i={value:e}:e instanceof tt?i={buffer:e}:i=e;const s={...this.settings,...i};if(ArrayBuffer.isView(i.value)){if(!i.type)if(this.doublePrecision&&i.value instanceof Float64Array)s.type="float32";else{const l=FN(i.value);s.type=s.normalized?l.replace("int","norm"):l}s.bytesPerElement=i.value.BYTES_PER_ELEMENT,s.stride=Is(s)}if(t.bounds=null,i.constant){let o=i.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!t.constant||!this._areValuesEqual(o,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(o)?o:new Float32Array(o)}else if(i.buffer){const o=i.buffer;t.externalBuffer=o,t.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let o=i.value;t.externalBuffer=null,t.constant=!1,this.value=o;let{buffer:l}=this;const c=Is(s),f=(s.vertexOffset||0)*c;if(this.doublePrecision&&o instanceof Float64Array&&(o=Xd(o,s)),this.settings.isIndexed){const p=this.settings.defaultType;o.constructor!==p&&(o=new p(o))}const d=o.byteLength+f+c*2;(!l||l.byteLength<d)&&(l=this._createBuffer(d)),l.write(o,f)}return this.setAccessor(s),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:i=0,endOffset:s}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?Xd(t,{size:this.size,startIndex:i,endIndex:s}):t.subarray(i,s),i*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:i}=this,s=i.allocatedValue,o=oo.allocate(s,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=o;const{byteOffset:l}=this;let{buffer:c}=this;return(!c||c.byteLength<o.byteLength+l)&&(c=this._createBuffer(o.byteLength+l),t&&s&&c.write(s instanceof Float64Array?Xd(s,this):s,l)),i.allocatedValue=o,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const i=this.settings.defaultType;let s=!1;if(this.doublePrecision&&(s=t.BYTES_PER_ELEMENT<4),s)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);!(t instanceof i)&&this.settings.normalized&&!("normalized"in e)&&ke.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(t=>(t+128)/255*2-1);case"snorm16":return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(t=>t/255);case"unorm16":return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,i){const{defaultValue:s,size:o}=this.settings;if(Number.isFinite(e))return t[i]=e,t;if(!e){let l=o;for(;--l>=0;)t[i+l]=s[l];return t}switch(o){case 4:t[i+3]=Number.isFinite(e[3])?e[3]:s[3];case 3:t[i+2]=Number.isFinite(e[2])?e[2]:s[2];case 2:t[i+1]=Number.isFinite(e[1])?e[1]:s[1];case 1:t[i+0]=Number.isFinite(e[0])?e[0]:s[0];break;default:let l=o;for(;--l>=0;)t[i+l]=Number.isFinite(e[l])?e[l]:s[l]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:i}=this;for(let s=0;s<i;s++)if(e[s]!==t[s])return!1;return!0}_createBuffer(e){this._buffer&&this._buffer.destroy();const{isIndexed:t,type:i}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:(t?tt.INDEX:tt.VERTEX)|tt.COPY_DST,indexType:t?i:void 0,byteLength:e}),this._buffer}}const Oy=[],Iy=[];function Zu(n,e=0,t=1/0){let i=Oy;const s={index:-1,data:n,target:[]};return n?typeof n[Symbol.iterator]=="function"?i=n:n.length>0&&(Iy.length=n.length,i=Iy):i=Oy,(e>0||Number.isFinite(t))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,t),s.index=e-1),{iterable:i,objectInfo:s}}function Q8(n){return n&&n[Symbol.asyncIterator]}function J8(n,e){const{size:t,stride:i,offset:s,startIndices:o,nested:l}=e,c=n.BYTES_PER_ELEMENT,f=i?i/c:t,d=s?s/c:0,p=Math.floor((n.length-d)/f);return(_,{index:y,target:v})=>{if(!o){const C=y*f+d;for(let U=0;U<t;U++)v[U]=n[C+U];return v}const x=o[y],S=o[y+1]||p;let M;if(l){M=new Array(S-x);for(let C=x;C<S;C++){const U=C*f+d;v=new Array(t);for(let R=0;R<t;R++)v[R]=n[U+R];M[C-x]=v}}else if(f===t)M=n.subarray(x*t+d,S*t+d);else{M=new n.constructor((S-x)*t);let C=0;for(let U=x;U<S;U++){const R=U*f+d;for(let D=0;D<t;D++)M[C++]=n[R+D]}}return M}}const HN=[],au=[[0,1/0]];function $N(n,e){if(n===au||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],i=n.length;let s=0;for(let o=0;o<i;o++){const l=n[o];l[1]<e[0]?(t.push(l),s=o+1):l[0]>e[1]?t.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return t.splice(s,0,e),t}const WN={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function ev(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...WN[t],...e,...n,type:t}}class tv extends VN{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:au}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!zN(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,i=this.settings.transition,s=Array.isArray(t)?e[t.find(o=>e[o])]:e[t];return ev(s,i)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:i=0,endRow:s=1/0}=t;this.state.updateRanges=$N(this.state.updateRanges,[i,s])}else this.state.updateRanges=au}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=HN}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(e,t.updateRanges!==au),!0):!1}updateBuffer({numInstances:e,data:t,props:i,context:s}){if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:l,noAlloc:c}}=this;let f=!0;if(l){for(const[d,p]of o)l.call(s,this,{data:t,startRow:d,endRow:p,props:i,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[d,p]of o){const _=Number.isFinite(d)?this.getVertexOffset(d):0,y=Number.isFinite(p)?this.getVertexOffset(p):c||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:_,endOffset:y})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(e,t){const i=this.device.type==="webgpu";if(i||t===void 0||typeof t=="function"){if(i&&typeof t!="function"){const l=this._normalizeValue(t,[],0);this._areValuesEqual(l,this.value)||this.setNeedsUpdate("WebGPU constant updated")}return!1}const s=this.settings.transform&&e?this.settings.transform.call(e,t):t;return this.setData({constant:!0,value:s})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:i,settings:s}=this;if(!e)return i.binaryValue=null,i.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(i.binaryValue===e)return this.clearNeedsUpdate(),!0;if(i.binaryValue=e,this.setNeedsRedraw(),s.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Mt(ArrayBuffer.isView(l.value),`invalid ${s.accessor}`);const c=!!l.size&&l.size!==this.size;return i.binaryAccessor=J8(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:t,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const i in e)Object.assign(t,super.getValue(i,e[i]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:s}=this.settings;if(s==="dynamic"?i.stepMode=e?e.isInstanced?"instance":"vertex":"instance":i.stepMode=s??"vertex",!t)return i;for(const o in t){const l=super._getBufferLayout(o,t[o]);i.attributes.push(...l.attributes)}return i}_autoUpdater(e,{data:t,startRow:i,endRow:s,props:o,numInstances:l}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:c,state:f,value:d,size:p,startIndices:_}=e,{accessor:y,transform:v}=c;let x=f.binaryAccessor||(typeof y=="function"?y:o[y]);typeof x!="function"&&typeof y=="string"&&(x=()=>o[y]),Mt(typeof x=="function",`accessor "${y}" is not a function`);let S=e.getVertexOffset(i);const{iterable:M,objectInfo:C}=Zu(t,i,s);for(const U of M){C.index++;let R=x(U,C);if(v&&(R=v.call(this,R)),_){const D=(C.index<_.length-1?_[C.index+1]:l)-_[C.index];if(R&&Array.isArray(R[0])){let B=S;for(const Q of R)e._normalizeValue(Q,d,B),B+=p}else R&&R.length>p?d.set(R,S):(e._normalizeValue(R,C.target,0),uO({target:d,source:C.target,start:S,count:D}));S+=D*p}else e._normalizeValue(R,d,S),S+=p}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let i=!0;switch(t){case 4:i=i&&Number.isFinite(e[3]);case 3:i=i&&Number.isFinite(e[2]);case 2:i=i&&Number.isFinite(e[1]);case 1:i=i&&Number.isFinite(e[0]);break;default:i=!1}if(!i)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function sp(n){const{source:e,target:t,start:i=0,size:s,getData:o}=n,l=n.end||t.length,c=e.length,f=l-i;if(c>f){t.set(e.subarray(0,f),i);return}if(t.set(e,i),!o)return;let d=c;for(;d<f;){const p=o(d,e);for(let _=0;_<s;_++)t[i+d]=p[_]||0,d++}}function XN({source:n,target:e,size:t,getData:i,sourceStartIndices:s,targetStartIndices:o}){if(!s||!o)return sp({source:n,target:e,size:t,getData:i}),e;let l=0,c=0;const f=i&&((p,_)=>i(p+c,_)),d=Math.min(s.length,o.length);for(let p=1;p<d;p++){const _=s[p]*t,y=o[p]*t;sp({source:n.subarray(l,_),target:e,start:c,end:y,size:t,getData:f}),l=_,c=y}return c<e.length&&sp({source:[],target:e,start:c,size:t,getData:f}),e}function YN(n){const{device:e,settings:t,value:i}=n,s=new tv(e,t);return s.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:t.normalized}),s}function nv(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${n}"`)}}function iv(n){switch(n){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function sv(n){n.push(n.shift())}function qN(n,e){const{doublePrecision:t,settings:i,value:s,size:o}=n,l=t&&s instanceof Float64Array?2:1;let c=0;const{shaderAttributes:f}=n.settings;if(f)for(const d of Object.values(f))c=Math.max(c,d.vertexOffset??0);return(i.noAlloc?s.length:(e+c)*o)*l}function rv({device:n,source:e,target:t}){return(!t||t.byteLength<e.byteLength)&&(t?.destroy(),t=n.createBuffer({byteLength:e.byteLength,usage:e.usage})),t}function ov({device:n,buffer:e,attribute:t,fromLength:i,toLength:s,fromStartIndices:o,getData:l=c=>c}){const c=t.doublePrecision&&t.value instanceof Float64Array?2:1,f=t.size*c,d=t.byteOffset,p=t.settings.bytesPerElement<4?d/t.settings.bytesPerElement*4:d,_=t.startIndices,y=o&&_,v=t.isConstant;if(!y&&e&&i>=s)return e;const x=t.value instanceof Float64Array?Float32Array:t.value.constructor,S=v?t.value:new x(t.getBuffer().readSyncWebGL(d,s*x.BYTES_PER_ELEMENT).buffer);if(t.settings.normalized&&!v){const R=l;l=(D,B)=>t.normalizeConstant(R(D,B))}const M=v?(R,D)=>l(S,D):(R,D)=>l(S.subarray(R+d,R+d+f),D),C=e?new Float32Array(e.readSyncWebGL(p,i*4).buffer):new Float32Array(0),U=new Float32Array(s);return XN({source:C,target:U,sourceStartIndices:o,targetStartIndices:_,size:f,getData:M}),(!e||e.byteLength<U.byteLength+p)&&(e?.destroy(),e=n.createBuffer({byteLength:U.byteLength+p,usage:35050})),e.write(U,p),e}class av{constructor({device:e,attribute:t,timeline:i}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new qu(i),this.attribute=t,this.attributeInTransition=YN(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,i=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=qN(this.attribute,t),this.transition.start({...e,duration:i})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class ZN extends av{constructor({device:e,attribute:t,timeline:i}){super({device:e,attribute:t,timeline:i}),this.type="interpolation",this.transform=JN(e,t)}start(e,t){const i=this.currentLength,s=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:o,attribute:l}=this;sv(o),o[0]=ov({device:this.device,buffer:o[0],attribute:l,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:e.enter}),o[1]=rv({device:this.device,source:o[0],target:o[1]}),this.setBuffer(o[1]);const{transform:c}=this,f=c.model;let d=Math.floor(this.currentLength/l.size);lv(l)&&(d/=2),f.setVertexCount(d),l.isConstant?(f.setAttributes({aFrom:o[0]}),f.setConstantAttributes({aTo:l.value})):f.setAttributes({aFrom:o[0],aTo:l.getBuffer()}),c.transformFeedback.setBuffers({vCurrent:o[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:i}=this.transition;let s=i/e;t&&(s=t(s));const{model:o}=this.transform,l={time:s};o.shaderInputs.setProps({interpolation:l}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const KN=`uniform interpolationUniforms {
  float time;
} interpolation;
`,Ny={name:"interpolation",vs:KN,uniformTypes:{time:"f32"}},GN=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,QN=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function lv(n){return n.doublePrecision&&n.value instanceof Float64Array}function JN(n,e){const t=e.size,i=nv(t),s=iv(t),o=e.getBufferLayout();return lv(e)?new lo(n,{vs:QN,bufferLayout:[{name:"aFrom",byteStride:8*t,attributes:[{attribute:"aFrom",format:s,byteOffset:0},{attribute:"aFrom64Low",format:s,byteOffset:4*t}]},{name:"aTo",byteStride:8*t,attributes:[{attribute:"aTo",format:s,byteOffset:0},{attribute:"aTo64Low",format:s,byteOffset:4*t}]}],modules:[rR,Ny],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:t},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new lo(n,{vs:GN,bufferLayout:[{name:"aFrom",format:s},{name:"aTo",format:o.attributes[0].format}],modules:[Ny],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}class ek extends av{constructor({device:e,attribute:t,timeline:i}){super({device:e,attribute:t,timeline:i}),this.type="spring",this.texture=ok(e),this.framebuffer=ak(e,this.texture),this.transform=rk(e,t)}start(e,t){const i=this.currentLength,s=this.currentStartIndices;super.start(e,t);const{buffers:o,attribute:l}=this;for(let f=0;f<2;f++)o[f]=ov({device:this.device,buffer:o[f],attribute:l,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:e.enter});o[2]=rv({device:this.device,source:o[0],target:o[2]}),this.setBuffer(o[1]);const{model:c}=this.transform;c.setVertexCount(Math.floor(this.currentLength/l.size)),l.isConstant?c.setConstantAttributes({aTo:l.value}):c.setAttributes({aTo:l.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:i,transition:s}=this,o=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const l={stiffness:o.stiffness,damping:o.damping};t.model.shaderInputs.setProps({spring:l}),t.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),sv(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(i)[0]>0||s.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const tk=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,nk={name:"spring",vs:tk,uniformTypes:{damping:"f32",stiffness:"f32"}},ik=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,sk=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function rk(n,e){const t=nv(e.size),i=iv(e.size);return new lo(n,{vs:ik,fs:sk,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[nk],defines:{ATTRIBUTE_TYPE:t},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function ok(n){return n.createTexture({data:new Uint8Array(4),format:"rgba8unorm",width:1,height:1})}function ak(n,e){return n.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const lk={interpolation:ZN,spring:ek};class ck{constructor(e,{id:t,timeline:i}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:i}){this.numInstances=i||1;for(const s in e){const o=e[s],l=o.getTransitionSetting(t);l&&this._updateAttribute(s,o,l)}for(const s in this.transitions){const o=e[s];(!o||!o.getTransitionSetting(t))&&this._removeTransition(s)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const i=this.transitions[t];i.inProgress&&(e[t]=i.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,i){const s=this.transitions[e];let o=!s||s.type!==i.type;if(o){s&&this._removeTransition(e);const l=lk[i.type];l?this.transitions[e]=new l({attribute:t,timeline:this.timeline,device:this.device}):(ke.error(`unsupported transition type '${i.type}'`)(),o=!1)}(o||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(i,this.numInstances))}}const ky="attributeManager.invalidate",uk="attributeManager.updateStart",fk="attributeManager.updateEnd",hk="attribute.updateStart",dk="attribute.allocate",pk="attribute.updateEnd";class gk{constructor(e,{id:t="attribute-manager",stats:i,timeline:s}={}){this.mergeBoundsMemoized=ol(MP),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new ck(e,{id:`${t}-transitions`,timeline:s}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const i=this._invalidateTrigger(e,t);Ft(ky,this,e,i)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Ft(ky,this,"all")}update({data:e,numInstances:t,startIndices:i=null,transitions:s,props:o={},buffers:l={},context:c={}}){let f=!1;Ft(uk,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const d in this.attributes){const p=this.attributes[d],_=p.settings.accessor;p.startIndices=i,p.numInstances=t,o[d]&&ke.removed(`props.${d}`,`data.attributes.${d}`)(),p.setExternalBuffer(l[d])||p.setBinaryValue(typeof _=="string"?l[_]:void 0,e.startIndices)||typeof _=="string"&&!l[_]&&p.setConstantValue(c,o[_])||p.needsUpdate()&&(f=!0,this._updateAttribute({attribute:p,numInstances:t,data:e,props:o,context:c})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}f&&Ft(fk,this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:s})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(i=>this.attributes[i]?.getBounds());return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:i}=this,s={...i.getAttributes()};for(const o in t){const l=t[o];l.needsRedraw(e)&&!i.hasAttribute(o)&&(s[o]=l)}return s}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const i in e){const s=e[i],o={...s,id:i,size:s.isIndexed&&1||s.size||1,...t};this.attributes[i]=new tv(this.device,o)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(s=>{e[s]||(e[s]=[]),e[s].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:i,updateTriggers:s}=this,o=s[e];return o&&o.forEach(l=>{const c=i[l];c&&c.setNeedsUpdate(c.id,t)}),o}_updateAttribute(e){const{attribute:t,numInstances:i}=e;if(Ft(hk,t),t.constant){t.setConstantValue(e.context,t.value);return}t.allocate(i)&&Ft(dk,t,i),t.updateBuffer(e)&&(this.needsRedraw=!0,Ft(pk,t,i))}}class mk extends qu{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:i,duration:s,easing:o}}=this,l=o(e/s);this._value=Ru(t,i,l)}}const Dy=1e-5;function Ly(n,e,t,i,s){const o=e-n,c=(t-e)*s,f=-o*i;return c+f+o+e}function _k(n,e,t,i,s){if(Array.isArray(t)){const o=[];for(let l=0;l<t.length;l++)o[l]=Ly(n[l],e[l],t[l],i,s);return o}return Ly(n,e,t,i,s)}function By(n,e){if(Array.isArray(n)){let t=0;for(let i=0;i<n.length;i++){const s=n[i]-e[i];t+=s*s}return Math.sqrt(t)}return Math.abs(n-e)}class yk extends qu{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:i,stiffness:s}=this.settings,{_prevValue:o=e,_currValue:l=e}=this;let c=_k(o,l,t,i,s);const f=By(c,t),d=By(c,l);f<Dy&&d<Dy&&(c=t,this.end()),this._prevValue=l,this._currValue=c}}const bk={interpolation:mk,spring:yk};class vk{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,i,s){const{transitions:o}=this;if(o.has(e)){const f=o.get(e),{value:d=f.settings.fromValue}=f;t=d,this.remove(e)}if(s=ev(s),!s)return;const l=bk[s.type];if(!l){ke.error(`unsupported transition type '${s.type}'`)();return}const c=new l(this.timeline);c.start({...s,fromValue:t,toValue:i}),o.set(e,c)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,i]of this.transitions)i.update(),e[t]=i.value,i.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function xk(n){const e=n[os];for(const t in e){const i=e[t],{validate:s}=i;if(s&&!s(n[t],i))throw new Error(`Invalid prop ${t}: ${n[t]}`)}}function Tk(n,e){const t=cv({newProps:n,oldProps:e,propTypes:n[os],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=Sk(n,e);let s=!1;return i||(s=Ak(n,e)),{dataChanged:i,propsChanged:t,updateTriggersChanged:s,extensionsChanged:Ek(n,e),transitionsChanged:wk(n,e)}}function wk(n,e){if(!n.transitions)return!1;const t={},i=n[os];let s=!1;for(const o in n.transitions){const l=i[o],c=l&&l.type;(c==="number"||c==="color"||c==="array")&&qp(n[o],e[o],l)&&(t[o]=!0,s=!0)}return s?t:!1}function cv({newProps:n,oldProps:e,ignoreProps:t={},propTypes:i={},triggerName:s="props"}){if(e===n)return!1;if(typeof n!="object"||n===null)return`${s} changed shallowly`;if(typeof e!="object"||e===null)return`${s} changed shallowly`;for(const o of Object.keys(n))if(!(o in t)){if(!(o in e))return`${s}.${o} added`;const l=qp(n[o],e[o],i[o]);if(l)return`${s}.${o} ${l}`}for(const o of Object.keys(e))if(!(o in t)){if(!(o in n))return`${s}.${o} dropped`;if(!Object.hasOwnProperty.call(n,o)){const l=qp(n[o],e[o],i[o]);if(l)return`${s}.${o} ${l}`}}return!1}function qp(n,e,t){let i=t&&t.equal;return i&&!i(n,e,t)||!i&&(i=n&&e&&n.equals,i&&!i.call(n,e))?"changed deeply":!i&&e!==n?"changed shallowly":null}function Sk(n,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:i,_dataDiff:s}=n;return i?i(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&s&&(t=s(n.data,e.data)||t),t}function Ak(n,e){if(e===null)return{all:!0};if("all"in n.updateTriggers&&Uy(n,e,"all"))return{all:!0};const t={};let i=!1;for(const s in n.updateTriggers)s!=="all"&&Uy(n,e,s)&&(t[s]=!0,i=!0);return i?t:!1}function Ek(n,e){if(e===null)return!0;const t=e.extensions,{extensions:i}=n;if(i===t)return!1;if(!t||!i||i.length!==t.length)return!0;for(let s=0;s<i.length;s++)if(!i[s].equals(t[s]))return!0;return!1}function Uy(n,e,t){let i=n.updateTriggers[t];i=i??{};let s=e.updateTriggers[t];return s=s??{},cv({oldProps:s,newProps:i,triggerName:t})}const Ck="count(): argument not an object",Rk="count(): argument not a container";function Mk(n){if(!Ok(n))throw new Error(Ck);if(typeof n.count=="function")return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(Pk(n))return Object.keys(n).length;throw new Error(Rk)}function Pk(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function Ok(n){return n!==null&&typeof n=="object"}function Fy(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(i=>i.name==="project64"))){const i=t.modules.findIndex(s=>s.name==="project32");i>=0&&t.modules.splice(i,1)}if("inject"in e)if(!n.inject)t.inject=e.inject;else{const i={...n.inject};for(const s in e.inject)i[s]=(i[s]||"")+e.inject[s];t.inject=i}return t}const Ik={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},Zp={};function Nk(n,e,t,i){if(t instanceof wt)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let s=null;t.compressed&&(s={minFilter:"linear",mipmapFilter:t.data.length>1?"nearest":"linear"});const{width:o,height:l}=t.data,c=e.createTexture({...t,sampler:{...Ik,...s,...i},mipLevels:e.getMipLevelCount(o,l)});return c.generateMipmapsWebGL(),Zp[c.id]=n,c}function kk(n,e){!e||!(e instanceof wt)||Zp[e.id]===n&&(e.delete(),delete Zp[e.id])}const Dk={boolean:{validate(n,e){return!0},equal(n,e,t){return!!n==!!e}},number:{validate(n,e){return Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)}},color:{validate(n,e){return e.optional&&!n||Kp(n)&&(n.length===3||n.length===4)},equal(n,e,t){return xn(n,e,1)}},accessor:{validate(n,e){const t=ku(n);return t==="function"||t===ku(e.value)},equal(n,e,t){return typeof e=="function"?!0:xn(n,e,1)}},array:{validate(n,e){return e.optional&&!n||Kp(n)},equal(n,e,t){const{compare:i}=t,s=Number.isInteger(i)?i:i?1:0;return i?xn(n,e,s):n===e}},object:{equal(n,e,t){if(t.ignore)return!0;const{compare:i}=t,s=Number.isInteger(i)?i:i?1:0;return i?xn(n,e,s):n===e}},function:{validate(n,e){return e.optional&&!n||typeof n=="function"},equal(n,e,t){return!t.compare&&t.ignore!==!1||n===e}},data:{transform:(n,e,t)=>{if(!n)return n;const{dataTransform:i}=t.props;return i?i(n):typeof n.shape=="string"&&n.shape.endsWith("-table")&&Array.isArray(n.data)?n.data:n}},image:{transform:(n,e,t)=>{const i=t.context;return!i||!i.device?null:Nk(t.id,i.device,n,{...e.parameters,...t.props.textureParameters})},release:(n,e,t)=>{kk(t.id,n)}}};function Lk(n){const e={},t={},i={};for(const[s,o]of Object.entries(n)){const l=o?.deprecatedFor;if(l)i[s]=Array.isArray(l)?l:[l];else{const c=Bk(s,o);e[s]=c,t[s]=c.value}}return{propTypes:e,defaultProps:t,deprecatedProps:i}}function Bk(n,e){switch(ku(e)){case"object":return Aa(n,e);case"array":return Aa(n,{type:"array",value:e,compare:!1});case"boolean":return Aa(n,{type:"boolean",value:e});case"number":return Aa(n,{type:"number",value:e});case"function":return Aa(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function Aa(n,e){return"type"in e?{name:n,...Dk[e.type],...e}:"value"in e?{name:n,type:ku(e.value),...e}:{name:n,type:"object",value:e}}function Kp(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function ku(n){return Kp(n)?"array":n===null?"null":typeof n}function Uk(n,e){let t;for(let o=e.length-1;o>=0;o--){const l=e[o];"extensions"in l&&(t=l.extensions)}const i=Gp(n.constructor,t),s=Object.create(i);s[Nu]=n,s[Vs]={},s[is]={};for(let o=0;o<e.length;++o){const l=e[o];for(const c in l)s[c]=l[c]}return Object.freeze(s),s}const Fk="_mergedDefaultProps";function Gp(n,e){if(!(n instanceof Ku.constructor))return{};let t=Fk;if(e)for(const s of e){const o=s.constructor;o&&(t+=`:${o.extensionName||o.name}`)}const i=uv(n,t);return i||(n[t]=zk(n,e||[]))}function zk(n,e){if(!n.prototype)return null;const i=Object.getPrototypeOf(n),s=Gp(i),o=uv(n,"defaultProps")||{},l=Lk(o),c=Object.assign(Object.create(null),s,l.defaultProps),f=Object.assign(Object.create(null),s?.[os],l.propTypes),d=Object.assign(Object.create(null),s?.[Gd],l.deprecatedProps);for(const p of e){const _=Gp(p.constructor);_&&(Object.assign(c,_),Object.assign(f,_[os]),Object.assign(d,_[Gd]))}return jk(c,n),Hk(c,f),Vk(c,d),c[os]=f,c[Gd]=d,e.length===0&&!i2(n,"_propTypes")&&(n._propTypes=f),c}function jk(n,e){const t=Wk(e);Object.defineProperties(n,{id:{writable:!0,value:t}})}function Vk(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(i){const s=`${this.id}: ${t}`;for(const o of e[t])i2(this,o)||(this[o]=i);ke.deprecated(s,e[t].join("/"))()}})}function Hk(n,e){const t={},i={};for(const s in e){const o=e[s],{name:l,value:c}=o;o.async&&(t[l]=c,i[l]=$k(l))}n[Qr]=t,n[Vs]={},Object.defineProperties(n,i)}function $k(n){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Q8(e)?this[Vs][n]=e:this[is][n]=e},get(){if(this[is]){if(n in this[is])return this[is][n]||this[Qr][n];if(n in this[Vs]){const e=this[Nu]&&this[Nu].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[Qr][n]}}return this[Qr][n]}}}function i2(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function uv(n,e){return i2(n,e)&&n[e]}function Wk(n){const e=n.componentName;return e||ke.warn(`${n.name}.componentName not specified`)(),e||n.name}let Xk=0;class Ku{constructor(...e){this.props=Uk(this,e),this.id=this.props.id,this.count=Xk++}clone(e){const{props:t}=this,i={};for(const s in t[Qr])s in t[is]?i[s]=t[is][s]:s in t[Vs]&&(i[s]=t[Vs][s]);return new this.constructor({...t,...i,...e})}}Ku.componentName="Component";Ku.defaultProps={};const Yk=Object.freeze({});class qk{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Yk}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[Nu]||this.component;const t=e[is]||{},i=e[Vs]||e,s=e[Qr]||{};for(const o in t){const l=t[o];this._createAsyncPropData(o,s[o]),this._updateAsyncProp(o,l),t[o]=this.getAsyncProp(o)}for(const o in i){const l=i[o];this._createAsyncPropData(o,s[o]),this._updateAsyncProp(o,l)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(Q8(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const i=this.asyncProps[e];return t===i.resolvedValue||t===i.lastValue?!1:(i.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const i=this.asyncProps[e];i&&(t=this._postProcessValue(i,t),i.resolvedValue=t,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(e,t,i){const s=this.asyncProps[e];s&&i>=s.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=t,s.resolvedLoadCount=i,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const i=this.asyncProps[e];if(i){i.pendingLoadCount++;const s=i.pendingLoadCount;t.then(o=>{this.component&&(o=this._postProcessValue(i,o),this._setAsyncPropValue(e,o,s),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const i=this.asyncProps[e];if(!i)return;i.pendingLoadCount++;const s=i.pendingLoadCount;let o=[],l=0;for await(const c of t){if(!this.component)return;const{dataTransform:f}=this.component.props;f?o=f(c,o):o=o.concat(c),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:l,endRow:o.length}]}),l=o.length,this._setAsyncPropValue(e,o,s)}this._onResolve(e,o)}_postProcessValue(e,t){const i=e.type;return i&&this.component&&(i.release&&i.release(e.resolvedValue,i,this.component),i.transform)?i.transform(t,i,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const s=this.component&&this.component.props[os];this.asyncProps[e]={type:s&&s[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class Zk extends qk{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const i=this.layer,s=i?.props.fetch;return s?s(t,{propName:e,layer:i}):super._fetch(e,t)}_onResolve(e,t){const i=this.layer;if(i){const s=i.props.onDataLoad;e==="data"&&s&&s(t,{propName:e,layer:i})}}_onError(e,t){const i=this.layer;i&&i.raiseError(t,`loading ${e} of ${this.layer}`)}}const Kk="layer.changeFlag",Gk="layer.initialize",Qk="layer.update",Jk="layer.finalize",eD="layer.matched",zy=2**24-1,tD=Object.freeze([]),nD=ol(({oldViewport:n,viewport:e})=>n.equals(e));let Pn=new Uint8ClampedArray(0);const iD={data:{type:"data",value:tD,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:i,loadOptions:s,signal:o})=>{const{resourceManager:l}=t.context;s=s||t.getLoadOptions(),i=i||t.props.loaders,o&&(s={...s,fetch:{...s?.fetch,signal:o}});let c=l.contains(n);return!c&&!s&&(l.add({resourceId:n,data:_u(n,i),persistent:!1}),c=!0),c?l.subscribe({resourceId:n,onChange:f=>t.internalState?.reloadAsyncProp(e,f),consumerId:t.id,requestId:e}):_u(n,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Fe.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,-n*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class wi extends Ku{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Vr.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Mt(this.internalState);const t=this.internalState.viewport||this.context.viewport,i=O8(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,o,l]=C8(i,t.pixelProjectionMatrix);return e.length===2?[s,o]:[s,o,l]}unproject(e){return Mt(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Mt(this.internalState);const i=this.internalState.viewport||this.context.viewport;return DP(e,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Fe.DEFAULT||e===Fe.LNGLAT||e===Fe.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Mt(e instanceof Uint8Array);const[t,i,s]=e;return t+i*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Mk(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(e){e=Fy(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=Fy(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:i}=e.changeFlags;if(i&&t)if(Array.isArray(i))for(const s of i)t.invalidateAll(s);else t.invalidateAll();if(t){const{props:s}=e,o=this.internalState.hasPickingBuffer,l=Number.isInteger(s.highlightedObjectIndex)||!!s.pickable||s.extensions.some(c=>c.getNeedsPickingBuffer.call(this,c));if(o!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:c,instancePickingColors:f}=t.attributes,d=c||f;d&&(l&&d.constant&&(d.constant=!1,t.invalidate(d.id)),!d.value&&!l&&(d.constant=!0,d.value=[0,0,0]))}}}finalizeState(e){for(const i of this.getModels())i.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:i}){const{index:s}=e;return s>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[s]),e}raiseError(e,t){t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),this.props.onError?.(e)||this.context?.onError?.(e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!nD({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const i in e)e[i].layoutChanged()&&(t=!0);for(const i of this.getModels())this._setModelAttributes(i,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,i=this.getNumInstances(),s=this.getStartIndices();e.update({data:t.data,numInstances:i,startIndices:s,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),i=Object.create(this.props);for(const s in t)Object.defineProperty(i,s,{value:t[s]});return i}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const i=Math.floor(Pn.length/4);if(this.internalState.usesPickingColorCache=!0,i<t){t>zy&&ke.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Pn=oo.allocate(Pn,t,{size:4,copy:!0,maxCount:Math.max(t,zy)});const s=Math.floor(Pn.length/4),o=[0,0,0];for(let l=i;l<s;l++)this.encodePickingColor(l,o),Pn[l*4+0]=o[0],Pn[l*4+1]=o[1],Pn[l*4+2]=o[2],Pn[l*4+3]=0}e.value=Pn.subarray(0,t*4)}_setModelAttributes(e,t,i=!1){if(!Object.keys(t).length)return;if(i){const c=this.getAttributeManager();e.setBufferLayout(c.getBufferLayouts(e)),t=c.getAttributes()}const s=e.userData?.excludeAttributes||{},o={},l={};for(const c in t){if(s[c])continue;const f=t[c].getValue();for(const d in f){const p=f[d];p instanceof tt?t[c].settings.isIndexed?e.setIndexBuffer(p):o[d]=p:p&&(l[d]=p)}}e.setAttributes(o),e.setConstantAttributes(l)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:i,instancePickingColors:s}=this.getAttributeManager().attributes,o=i||s,l=o&&t.attributes&&t.attributes[o.id];if(l&&l.value){const c=l.value,f=this.encodePickingColor(e);for(let d=0;d<t.length;d++){const p=o.getVertexOffset(d);c[p]===f[0]&&c[p+1]===f[1]&&c[p+2]===f[2]&&this._disablePickingIndex(d)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:i}=this.getAttributeManager().attributes,s=t||i;if(!s)return;const o=s.getVertexOffset(e),l=s.getVertexOffset(e+1);s.buffer.write(new Uint8Array(l-o),o)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,i=e||t;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Pn.buffer&&(i.value=Pn.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Mt(!this.internalState),Mt(Number.isFinite(this.props.coordinateSystem)),Ft(Gk,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Zk({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(ke.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new vk(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Ft(eD,this,this===e);const{state:t,internalState:i}=e;this!==e&&(this.internalState=i,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Ft(Qk,this,e),!e)return;const t=this.props,i=this.context,s=this.internalState,o=i.viewport,l=this._updateUniformTransition();s.propsInTransition=l,i.viewport=s.viewport||o,this.props=l;try{const c=this._getUpdateParams(),f=this.getModels();if(i.device)this.updateState(c);else try{this.updateState(c)}catch{}for(const p of this.props.extensions)p.updateState.call(this,c,p);this.setNeedsRedraw(),this._updateAttributes();const d=this.getModels()[0]!==f[0];this._postUpdate(c,d)}finally{i.viewport=o,this.props=t,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){Ft(Jk,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:i={},parameters:s={}}){this._updateAttributeTransition();const o=this.props,l=this.context;this.props=this.internalState.propsInTransition||o;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:c}=this.props,f=c&&c(i)||[0,0];l.device instanceof Xp&&l.device.setParametersWebGL({polygonOffset:f});for(const d of this.getModels())d.device.type==="webgpu"?d.setParameters({...d.parameters,...s}):d.setParameters(s);if(l.device instanceof Xp)l.device.withParametersWebGL(s,()=>{const d={renderPass:e,shaderModuleProps:t,uniforms:i,parameters:s,context:l};for(const p of this.props.extensions)p.draw.call(this,d,p);this.draw(d)});else{const d={renderPass:e,shaderModuleProps:t,uniforms:i,parameters:s,context:l};for(const p of this.props.extensions)p.draw.call(this,d,p);this.draw(d)}}finally{this.props=o}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const s in e)if(e[s]){let o=!1;switch(s){case"dataChanged":const l=e[s],c=t[s];l&&Array.isArray(c)&&(t.dataChanged=Array.isArray(l)?c.concat(l):l,o=!0);default:t[s]||(t[s]=e[s],o=!0)}o&&Ft(Kk,this,s,e)}const i=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=i,t.somethingChanged=i||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){const i=Tk(e,t);if(i.updateTriggersChanged)for(const s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(const s in i.transitionsChanged)this.internalState.uniformTransitions.add(s,t[s],e[s],e.transitions?.[s]);return this.setChangeFlags(i)}validateProps(){xk(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:i}=this.props;e.picked&&typeof i=="function"&&(t.highlightColor=i(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new gk(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:i,oldProps:s}=e,o=this.state.model;o?.isInstanced&&o.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:c,highlightColor:f}=i;if(t||s.autoHighlight!==l||s.highlightedObjectIndex!==c||s.highlightColor!==f){const d={};Array.isArray(f)&&(d.highlightColor=f),(t||s.autoHighlight!==l||c!==s.highlightedObjectIndex)&&(d.highlightedObjectColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setShaderModuleProps({picking:d})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const i=this.getAttributeManager(),s=i?i.getNeedsRedraw(e):!1;if(t=t||s,t)for(const o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}wi.defaultProps=iD;wi.layerName="Layer";const sD="compositeLayer.renderLayers";class s2 extends wi{get isComposite(){return!0}get isDrawable(){return!1}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:t}=e;return t&&t.__source&&t.__source.parent&&t.__source.parent.id===this.id&&(e.object=t.__source.object,e.index=t.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,t){return t&&t.length}getSubLayerClass(e,t){const{_subLayerProps:i}=this.props;return i&&i[e]&&i[e].type||t}getSubLayerRow(e,t,i){return e.__source={parent:this,object:t,index:i},e}getSubLayerAccessor(e){if(typeof e=="function"){const t={index:-1,data:this.props.data,target:[]};return(i,s)=>i&&i.__source?(t.index=i.__source.index,e(i.__source.object,t)):e(i,s)}return e}getSubLayerProps(e={}){const{opacity:t,pickable:i,visible:s,parameters:o,getPolygonOffset:l,highlightedObjectIndex:c,autoHighlight:f,highlightColor:d,coordinateSystem:p,coordinateOrigin:_,wrapLongitude:y,positionFormat:v,modelMatrix:x,extensions:S,fetch:M,operation:C,_subLayerProps:U}=this.props,R={id:"",updateTriggers:{},opacity:t,pickable:i,visible:s,parameters:o,getPolygonOffset:l,highlightedObjectIndex:c,autoHighlight:f,highlightColor:d,coordinateSystem:p,coordinateOrigin:_,wrapLongitude:y,positionFormat:v,modelMatrix:x,extensions:S,fetch:M,operation:C},D=U&&e.id&&U[e.id],B=D&&D.updateTriggers,Q=e.id||"sublayer";if(D){const ce=this.props[os],Z=e.type?e.type._propTypes:{};for(const ee in D){const he=Z[ee]||ce[ee];he&&he.type==="accessor"&&(D[ee]=this.getSubLayerAccessor(D[ee]))}}Object.assign(R,e,D),R.id=`${this.props.id}-${Q}`,R.updateTriggers={all:this.props.updateTriggers?.all,...e.updateTriggers,...B};for(const ce of S){const Z=ce.getSubLayerProps.call(this,ce);Z&&Object.assign(R,Z,{updateTriggers:Object.assign(R.updateTriggers,Z.updateTriggers)})}return R}_updateAutoHighlight(e){for(const t of this.getSubLayers())t.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,t){let i=this.internalState.subLayers;const s=!i||this.needsUpdate();if(s){const o=this.renderLayers();i=qg(o,Boolean),this.internalState.subLayers=i}Ft(sD,this,s,i);for(const o of i)o.parent=this}}s2.layerName="CompositeLayer";class fv{constructor(e){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;const{attributes:t={}}=e;this.typedArrayManager=oo,this.attributes={},this._attributeDefs=t,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:t,buffers:i={},getGeometry:s,geometryBuffer:o,positionFormat:l,dataChanged:c,normalize:f=!0}=this.opts;if(this.data=t,this.getGeometry=s,this.positionSize=o&&o.size||(l==="XY"?2:3),this.buffers=i,this.normalize=f,o&&(Mt(t.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),f||(i.vertexPositions=o)),this.geometryBuffer=i.vertexPositions,Array.isArray(c))for(const d of c)this._rebuildGeometry(d);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:t}){this._rebuildGeometry({startRow:e,endRow:t})}getGeometryFromBuffer(e){const t=e.value||e;return ArrayBuffer.isView(t)?J8(t,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,t){const{attributes:i,buffers:s,_attributeDefs:o,typedArrayManager:l}=this;for(const c in o)if(c in s)l.release(i[c]),i[c]=null;else{const f=o[c];f.copy=t,i[c]=l.allocate(i[c],e,f)}}_forEachGeometry(e,t,i){const{data:s,getGeometry:o}=this,{iterable:l,objectInfo:c}=Zu(s,t,i);for(const f of l){c.index++;const d=o?o(f,c):null;e(d,c.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:t,vertexStarts:i,instanceCount:s}=this;const{data:o,geometryBuffer:l}=this,{startRow:c=0,endRow:f=1/0}=e||{},d={};if(e||(t=[0],i=[0]),this.normalize||!l)this._forEachGeometry((_,y)=>{const v=_&&this.normalizeGeometry(_);d[y]=v,i[y+1]=i[y]+(v?this.getGeometrySize(v):0)},c,f),s=i[i.length-1];else if(i=o.startIndices,s=i[o.length]||0,ArrayBuffer.isView(l))s=s||l.length/this.positionSize;else if(l instanceof tt){const _=this.positionSize*4;s=s||l.byteLength/_}else if(l.buffer){const _=l.stride||this.positionSize*4;s=s||l.buffer.byteLength/_}else if(l.value){const _=l.value,y=l.stride/_.BYTES_PER_ELEMENT||this.positionSize;s=s||_.length/y}this._allocate(s,!!e),this.indexStarts=t,this.vertexStarts=i,this.instanceCount=s;const p={};this._forEachGeometry((_,y)=>{const v=d[y]||_;p.vertexStart=i[y],p.indexStart=t[y];const x=y<i.length-1?i[y+1]:s;p.geometrySize=x-i[y],p.geometryIndex=y,this.updateGeometryAttributes(v,p)},c,f),this.vertexCount=t[t.length-1]}}const rD=typeof window<"u"?L.useLayoutEffect:L.useEffect;function Du(n,e){for(;n;){if(n===e)return!0;n=Object.getPrototypeOf(n)}return!1}const oD={position:"absolute",zIndex:-1};function hv(n,e){if(typeof n=="function")return n(e);if(Array.isArray(n))return n.map(t=>hv(t,e));if(Gu(n)){if(aD(n))return e.style=oD,L.cloneElement(n,e);if(lD(n))return L.cloneElement(n,e)}return n}function Gu(n){return n&&typeof n=="object"&&"type"in n||!1}function aD(n){return n.props?.mapStyle}function lD(n){const e=n.type;return e&&e.deckGLViewProps}function Qp(n){if(typeof n=="function")return L.createElement(uo,{},n);if(Array.isArray(n))return n.map(Qp);if(Gu(n)){if(n.type===L.Fragment)return Qp(n.props.children);if(Du(n.type,uo))return n}return n}function cD({children:n,layers:e=[],views:t=null}){const i=[],s=[],o={};return L.Children.forEach(Qp(n),l=>{if(Gu(l)){const c=l.type;if(Du(c,wi)){const f=uD(c,l.props);s.push(f)}else i.push(l);if(Du(c,uo)&&c!==uo&&l.props.id){const f=new c(l.props);o[f.id]=f}}else l&&i.push(l)}),Object.keys(o).length>0&&(Array.isArray(t)?t.forEach(l=>{o[l.id]=l}):t&&(o[t.id]=t),t=Object.values(o)),e=s.length>0?[...s,...e]:e,{layers:e,children:i,views:t}}function uD(n,e){const t={},i=n.defaultProps||{};for(const s in e)i[s]!==e[s]&&(t[s]=e[s]);return new n(t)}const fD=L.createContext();function hD({children:n,deck:e,ContextProvider:t=fD.Provider}){const{viewManager:i}=e||{};if(!i||!i.views.length)return[];const s={},o=i.views[0].id;for(const l of n){let c=o,f=l;Gu(l)&&Du(l.type,uo)&&(c=l.props.id||o,f=l.props.children);const d=i.getViewport(c),p=i.getViewState(c);if(d){p.padding=d.padding;const{x:_,y,width:v,height:x}=d;f=hv(f,{x:_,y,width:v,height:x,viewport:d,viewState:p}),s[c]||(s[c]={viewport:d,children:[]}),s[c].children.push(f)}}return Object.keys(s).map(l=>{const{viewport:c,children:f}=s[l],{x:d,y:p,width:_,height:y}=c,v={position:"absolute",left:d,top:p,width:_,height:y},x=`view-${l}`,S=L.createElement("div",{key:x,id:x,style:v},...f),M={deck:e,viewport:c,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:U=>{U.viewId=l,e._onViewStateChange(U)},widgets:[]},C=`view-${l}-context`;return L.createElement(t,{key:C,value:M},S)})}const dD={mixBlendMode:null};function pD({width:n,height:e,style:t}){const i={position:"absolute",zIndex:0,left:0,top:0,width:n,height:e},s={left:0,top:0};if(t)for(const o in t)o in dD?s[o]=t[o]:i[o]=t[o];return{containerStyle:i,canvasStyle:s}}function gD(n){return{get deck(){return n.deck},pickObject:e=>n.deck.pickObject(e),pickMultipleObjects:e=>n.deck.pickMultipleObjects(e),pickObjects:e=>n.deck.pickObjects(e)}}function dv(n){n.redrawReason&&(n.deck._drawLayers(n.redrawReason),n.redrawReason=null)}function mD(n,e,t){const i=new e({...t,_customRender:t.deviceProps?.adapters?.[0]?.type==="webgpu"?void 0:s=>{n.redrawReason=s;const o=i.getViewports();n.lastRenderedViewports!==o?n.forceUpdate():dv(n)}});return i}function _D(n,e){const[t,i]=L.useState(0),o=L.useRef({control:null,version:t,forceUpdate:()=>i(B=>B+1)}).current,l=L.useRef(null),c=L.useRef(null),f=L.useMemo(()=>cD(n),[n.layers,n.views,n.children]);let d=!0;const p=B=>d&&n.viewState?(o.viewStateUpdateRequested=B,null):(o.viewStateUpdateRequested=null,n.onViewStateChange?.(B)),_=B=>{d?o.interactionStateUpdateRequested=B:(o.interactionStateUpdateRequested=null,n.onInteractionStateChange?.(B))},y=L.useMemo(()=>{const B={widgets:[],...n,style:null,width:"100%",height:"100%",parent:l.current,canvas:c.current,layers:f.layers,views:f.views,onViewStateChange:p,onInteractionStateChange:_};return delete B._customRender,o.deck&&o.deck.setProps(B),B},[n]);L.useEffect(()=>{const B=n.Deck||n2;return o.deck=mD(o,B,{...y,parent:l.current,canvas:c.current}),()=>o.deck?.finalize()},[]),rD(()=>{dv(o);const{viewStateUpdateRequested:B,interactionStateUpdateRequested:Q}=o;B&&p(B),Q&&_(Q),o.deck?.isInitialized&&o.deck.redraw("Initial render")}),L.useImperativeHandle(e,()=>gD(o),[]);const v=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:x,width:S="100%",height:M="100%",id:C,style:U}=n,{containerStyle:R,canvasStyle:D}=L.useMemo(()=>pD({width:S,height:M,style:U}),[S,M,U]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===v||o.version!==t){o.lastRenderedViewports=v,o.version=t;const B=hD({children:f.children,deck:o.deck,ContextProvider:x}),Q=L.createElement("canvas",{key:"canvas",id:C||"deckgl-overlay",ref:c,style:D});o.control=L.createElement("div",{id:`${C||"deckgl"}-wrapper`,ref:l,style:R},[Q,B])}return d=!1,o.control}const yD=L.forwardRef(_D),jy=`uniform iconUniforms {
  float sizeScale;
  vec2 iconsTextureDim;
  float sizeBasis;
  float sizeMinPixels;
  float sizeMaxPixels;
  bool billboard;
  highp int sizeUnits;
  float alphaCutoff;
} icon;
`,bD={name:"icon",vs:jy,fs:jy,uniformTypes:{sizeScale:"f32",iconsTextureDim:"vec2<f32>",sizeBasis:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",billboard:"f32",sizeUnits:"i32",alphaCutoff:"f32"}},vD=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * icon.sizeScale, icon.sizeUnits),
icon.sizeMinPixels, icon.sizeMaxPixels
);
float iconConstraint = icon.sizeBasis == 0.0 ? iconSize.x : iconSize.y;
float instanceScale = iconConstraint == 0.0 ? 0.0 : sizePixels / iconConstraint;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (icon.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / icon.iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`,xD=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * layer.opacity * vColor.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,TD=1024,wD=4,Vy=()=>{},Hy={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},SD={x:0,y:0,width:0,height:0};function AD(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function ED(n,e,t,i){const s=Math.min(t/e.width,i/e.height),o=Math.floor(e.width*s),l=Math.floor(e.height*s);return s===1?{image:e,width:o,height:l}:(n.canvas.height=l,n.canvas.width=o,n.clearRect(0,0,o,l),n.drawImage(e,0,0,e.width,e.height,0,0,o,l),{image:n.canvas,width:o,height:l})}function Ga(n){return n&&(n.id||n.url)}function CD(n,e,t,i){const{width:s,height:o,device:l}=n,c=l.createTexture({format:"rgba8unorm",width:e,height:t,sampler:i,mipLevels:l.getMipLevelCount(e,t)}),f=l.createCommandEncoder();return f.copyTextureToTexture({sourceTexture:n,destinationTexture:c,width:s,height:o}),f.finish(),c.generateMipmapsWebGL(),n.destroy(),c}function $y(n,e,t){for(let i=0;i<e.length;i++){const{icon:s,xOffset:o}=e[i],l=Ga(s);n[l]={...s,x:o,y:t}}}function RD({icons:n,buffer:e,mapping:t={},xOffset:i=0,yOffset:s=0,rowHeight:o=0,canvasWidth:l}){let c=[];for(let f=0;f<n.length;f++){const d=n[f],p=Ga(d);if(!t[p]){const{height:_,width:y}=d;i+y+e>l&&($y(t,c,s),i=0,s=o+s+e,o=0,c=[]),c.push({icon:d,xOffset:i}),i=i+y+e,o=Math.max(o,_)}}return c.length>0&&$y(t,c,s),{mapping:t,rowHeight:o,xOffset:i,yOffset:s,canvasWidth:l,canvasHeight:AD(o+s+e)}}function MD(n,e,t){if(!n||!e)return null;t=t||{};const i={},{iterable:s,objectInfo:o}=Zu(n);for(const l of s){o.index++;const c=e(l,o),f=Ga(c);if(!c)throw new Error("Icon is missing.");if(!c.url)throw new Error("Icon url is missing.");!i[f]&&(!t[f]||c.url!==t[f].url)&&(i[f]={...c,source:l,sourceIndex:o.index})}return i}class PD{constructor(e,{onUpdate:t=Vy,onError:i=Vy}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._samplerParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=wD,this._canvasWidth=TD,this._canvasHeight=0,this._canvas=null,this.device=e,this.onUpdate=t,this.onError=i}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const t=this._autoPacking?Ga(e):e;return this._mapping[t]||SD}setProps({loadOptions:e,autoPacking:t,iconAtlas:i,iconMapping:s,textureParameters:o}){e&&(this._loadOptions=e),t!==void 0&&(this._autoPacking=t),s&&(this._mapping=s),i&&(this._texture?.delete(),this._texture=null,this._externalTexture=i),o&&(this._samplerParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,t){if(!this._autoPacking||typeof document>"u")return;const i=Object.values(MD(e,t,this._mapping)||{});if(i.length>0){const{mapping:s,xOffset:o,yOffset:l,rowHeight:c,canvasHeight:f}=RD({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=c,this._mapping=s,this._xOffset=o,this._yOffset=l,this._canvasHeight=f,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",data:null,width:this._canvasWidth,height:this._canvasHeight,sampler:this._samplerParameters||Hy,mipLevels:this.device.getMipLevelCount(this._canvasWidth,this._canvasHeight)})),this._texture.height!==this._canvasHeight&&(this._texture=CD(this._texture,this._canvasWidth,this._canvasHeight,this._samplerParameters||Hy)),this.onUpdate(!0),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(e){const t=this._canvas.getContext("2d",{willReadFrequently:!0});for(const i of e)this._pendingCount++,_u(i.url,this._loadOptions).then(s=>{const o=Ga(i),l=this._mapping[o],{x:c,y:f,width:d,height:p}=l,{image:_,width:y,height:v}=ED(t,s,d,p),x=c+(d-y)/2,S=f+(p-v)/2;this._texture?.copyExternalImage({image:_,x,y:S,width:y,height:v}),l.x=x,l.y=S,l.width=y,l.height=v,this._texture?.generateMipmapsWebGL(),this.onUpdate(y!==d||v!==p)}).catch(s=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:s})}).finally(()=>{this._pendingCount--})}}const pv=[0,0,0,255],OD={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeBasis:"height",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:n=>n.position},getIcon:{type:"accessor",value:n=>n.icon},getColor:{type:"accessor",value:pv},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}};class Qu extends wi{getShaders(){return super.getShaders({vs:vD,fs:xD,modules:[al,ll,bD]})}initializeState(){this.state={iconManager:new PD(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:pv},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:t,oldProps:i,changeFlags:s}=e,o=this.getAttributeManager(),{iconAtlas:l,iconMapping:c,data:f,getIcon:d,textureParameters:p}=t,{iconManager:_}=this.state;if(typeof l=="string")return;const y=l||this.internalState.isAsyncPropLoading("iconAtlas");_.setProps({loadOptions:t.loadOptions,autoPacking:!y,iconAtlas:l,iconMapping:y?c:null,textureParameters:p}),y?i.iconMapping!==t.iconMapping&&o.invalidate("getIcon"):(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getIcon))&&_.packIcons(f,d),s.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),o.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:t,sizeBasis:i,sizeMinPixels:s,sizeMaxPixels:o,sizeUnits:l,billboard:c,alphaCutoff:f}=this.props,{iconManager:d}=this.state,p=d.getTexture();if(p){const _=this.state.model,y={iconsTexture:p,iconsTextureDim:[p.width,p.height],sizeUnits:vi[l],sizeScale:t,sizeBasis:i==="height"?1:0,sizeMinPixels:s,sizeMaxPixels:o,billboard:c,alphaCutoff:f};_.shaderInputs.setProps({icon:y}),_.draw(this.context.renderPass)}}_getModel(){const e=[-1,-1,1,-1,-1,1,1,1];return new kn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new co({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}_onUpdate(e){e?(this.getAttributeManager()?.invalidate("getIcon"),this.setNeedsUpdate()):this.setNeedsRedraw()}_onError(e){const t=this.getCurrentLayer()?.props.onIconError;t?t(e):ke.error(e.error.message)()}getInstanceOffset(e){const{width:t,height:i,anchorX:s=t/2,anchorY:o=i/2}=this.state.iconManager.getIconMapping(e);return[t/2-s,i/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:t,y:i,width:s,height:o}=this.state.iconManager.getIconMapping(e);return[t,i,s,o]}}Qu.defaultProps=OD;Qu.layerName="IconLayer";const Wy=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,ID={name:"scatterplot",vs:Wy,fs:Wy,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},ND=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,kD=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,DD=`// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * color.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  // Apply premultiplied alpha as required by transparent canvas
  fragColor = deckgl_premultiplied_alpha(fragColor);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`,Xy=[0,0,0,255],LD={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:n=>n.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:Xy},getLineColor:{type:"accessor",value:Xy},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class r2 extends wi{getShaders(){return super.getShaders({vs:ND,fs:kD,source:DD,modules:[al,xR,ll,ID]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e),e.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:i,radiusMinPixels:s,radiusMaxPixels:o,stroked:l,filled:c,billboard:f,antialiasing:d,lineWidthUnits:p,lineWidthScale:_,lineWidthMinPixels:y,lineWidthMaxPixels:v}=this.props,x={stroked:l,filled:c,billboard:f,antialiasing:d,radiusUnits:vi[t],radiusScale:i,radiusMinPixels:s,radiusMaxPixels:o,lineWidthUnits:vi[p],lineWidthScale:_,lineWidthMinPixels:y,lineWidthMaxPixels:v},S=this.state.model;S.shaderInputs.setProps({scatterplot:x}),this.context.device.type==="webgpu"&&(S.instanceCount=this.props.data.length),S.draw(this.context.renderPass)}_getModel(){const e=this.context.device.type==="webgpu"?{depthWriteEnabled:!0,depthCompare:"less-equal"}:void 0,t=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new kn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new co({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0,parameters:e})}}r2.defaultProps=LD;r2.layerName="ScatterplotLayer";const gv={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function mv(n,e,t={}){return BD(n,t)!==e?(FD(n,t),!0):!1}function BD(n,e={}){return Math.sign(UD(n,e))}const Yy={x:0,y:1,z:2};function UD(n,e={}){const{start:t=0,end:i=n.length,plane:s="xy"}=e,o=e.size||2;let l=0;const c=Yy[s[0]],f=Yy[s[1]];for(let d=t,p=i-o;d<i;d+=o)l+=(n[d+c]-n[p+c])*(n[d+f]+n[p+f]),p=d;return l/2}function FD(n,e){const{start:t=0,end:i=n.length,size:s=2}=e,o=(i-t)/s,l=Math.floor(o/2);for(let c=0;c<l;++c){const f=t+c*s,d=t+(o-1-c)*s;for(let p=0;p<s;++p){const _=n[f+p];n[f+p]=n[d+p],n[d+p]=_}}}function Nn(n,e){const t=e.length,i=n.length;if(i>0){let s=!0;for(let o=0;o<t;o++)if(n[i-t+o]!==e[o]){s=!1;break}if(s)return!1}for(let s=0;s<t;s++)n[i+s]=e[s];return!0}function Jp(n,e){const t=e.length;for(let i=0;i<t;i++)n[i]=e[i]}function Qa(n,e,t,i,s=[]){const o=i+e*t;for(let l=0;l<t;l++)s[l]=n[o+l];return s}function eg(n,e,t,i,s=[]){let o,l;if(t&8)o=(i[3]-n[1])/(e[1]-n[1]),l=3;else if(t&4)o=(i[1]-n[1])/(e[1]-n[1]),l=1;else if(t&2)o=(i[2]-n[0])/(e[0]-n[0]),l=2;else if(t&1)o=(i[0]-n[0])/(e[0]-n[0]),l=0;else return null;for(let c=0;c<n.length;c++)s[c]=(l&1)===c?i[l]:o*(e[c]-n[c])+n[c];return s}function lu(n,e){let t=0;return n[0]<e[0]?t|=1:n[0]>e[2]&&(t|=2),n[1]<e[1]?t|=4:n[1]>e[3]&&(t|=8),t}function _v(n,e){const{size:t=2,broken:i=!1,gridResolution:s=10,gridOffset:o=[0,0],startIndex:l=0,endIndex:c=n.length}=e||{},f=(c-l)/t;let d=[];const p=[d],_=Qa(n,0,t,l);let y,v;const x=bv(_,s,o,[]),S=[];Nn(d,_);for(let M=1;M<f;M++){for(y=Qa(n,M,t,l,y),v=lu(y,x);v;){eg(_,y,v,x,S);const C=lu(S,x);C&&(eg(_,S,C,x,S),v=C),Nn(d,S),Jp(_,S),jD(x,s,v),i&&d.length>t&&(d=[],p.push(d),Nn(d,_)),v=lu(y,x)}Nn(d,y),Jp(_,y)}return i?p:p[0]}const qy=0,zD=1;function yv(n,e=null,t){if(!n.length)return[];const{size:i=2,gridResolution:s=10,gridOffset:o=[0,0],edgeTypes:l=!1}=t||{},c=[],f=[{pos:n,types:l?new Array(n.length/i).fill(zD):null,holes:e||[]}],d=[[],[]];let p=[];for(;f.length;){const{pos:_,types:y,holes:v}=f.shift();VD(_,i,v[0]||_.length,d),p=bv(d[0],s,o,p);const x=lu(d[1],p);if(x){let S=Zy(_,y,i,0,v[0]||_.length,p,x);const M={pos:S[0].pos,types:S[0].types,holes:[]},C={pos:S[1].pos,types:S[1].types,holes:[]};f.push(M,C);for(let U=0;U<v.length;U++)S=Zy(_,y,i,v[U],v[U+1]||_.length,p,x),S[0]&&(M.holes.push(M.pos.length),M.pos=Hc(M.pos,S[0].pos),l&&(M.types=Hc(M.types,S[0].types))),S[1]&&(C.holes.push(C.pos.length),C.pos=Hc(C.pos,S[1].pos),l&&(C.types=Hc(C.types,S[1].types)))}else{const S={positions:_};l&&(S.edgeTypes=y),v.length&&(S.holeIndices=v),c.push(S)}}return c}function Zy(n,e,t,i,s,o,l){const c=(s-i)/t,f=[],d=[],p=[],_=[],y=[];let v,x,S;const M=Qa(n,c-1,t,i);let C=Math.sign(l&8?M[1]-o[3]:M[0]-o[2]),U=e&&e[c-1],R=0,D=0;for(let B=0;B<c;B++)v=Qa(n,B,t,i,v),x=Math.sign(l&8?v[1]-o[3]:v[0]-o[2]),S=e&&e[i/t+B],x&&C&&C!==x&&(eg(M,v,l,o,y),Nn(f,y)&&p.push(U),Nn(d,y)&&_.push(U)),x<=0?(Nn(f,v)&&p.push(S),R-=x):p.length&&(p[p.length-1]=qy),x>=0?(Nn(d,v)&&_.push(S),D+=x):_.length&&(_[_.length-1]=qy),Jp(M,v),C=x,U=S;return[R?{pos:f,types:e&&p}:null,D?{pos:d,types:e&&_}:null]}function bv(n,e,t,i){const s=Math.floor((n[0]-t[0])/e)*e+t[0],o=Math.floor((n[1]-t[1])/e)*e+t[1];return i[0]=s,i[1]=o,i[2]=s+e,i[3]=o+e,i}function jD(n,e,t){t&8?(n[1]+=e,n[3]+=e):t&4?(n[1]-=e,n[3]-=e):t&2?(n[0]+=e,n[2]+=e):t&1&&(n[0]-=e,n[2]-=e)}function VD(n,e,t,i){let s=1/0,o=-1/0,l=1/0,c=-1/0;for(let f=0;f<t;f+=e){const d=n[f],p=n[f+1];s=d<s?d:s,o=d>o?d:o,l=p<l?p:l,c=p>c?p:c}return i[0][0]=s,i[0][1]=l,i[1][0]=o,i[1][1]=c,i}function Hc(n,e){for(let t=0;t<e.length;t++)n.push(e[t]);return n}const HD=85.051129;function $D(n,e){const{size:t=2,startIndex:i=0,endIndex:s=n.length,normalize:o=!0}=e||{},l=n.slice(i,s);vv(l,t,0,s-i);const c=_v(l,{size:t,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const f of c)xv(f,t);return c}function WD(n,e=null,t){const{size:i=2,normalize:s=!0,edgeTypes:o=!1}=t||{};e=e||[];const l=[],c=[];let f=0,d=0;for(let _=0;_<=e.length;_++){const y=e[_]||n.length,v=d,x=XD(n,i,f,y);for(let S=x;S<y;S++)l[d++]=n[S];for(let S=f;S<x;S++)l[d++]=n[S];vv(l,i,v,d),YD(l,i,v,d,t?.maxLatitude),f=y,c[_]=d}c.pop();const p=yv(l,c,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(s)for(const _ of p)xv(_.positions,i);return p}function XD(n,e,t,i){let s=-1,o=-1;for(let l=t+1;l<i;l+=e){const c=Math.abs(n[l]);c>s&&(s=c,o=l-1)}return o}function YD(n,e,t,i,s=HD){const o=n[t],l=n[i-e];if(Math.abs(o-l)>180){const c=Qa(n,0,e,t);c[0]+=Math.round((l-o)/360)*360,Nn(n,c),c[1]=Math.sign(c[1])*s,Nn(n,c),c[0]=o,Nn(n,c)}}function vv(n,e,t,i){let s=n[0],o;for(let l=t;l<i;l+=e){o=n[l];const c=o-s;(c>180||c<-180)&&(o-=Math.round(c/360)*360),n[l]=s=o}}function xv(n,e){let t;const i=n.length/e;for(let o=0;o<i&&(t=n[o*e],(t+180)%360===0);o++);const s=-Math.round(t/360)*360;if(s!==0)for(let o=0;o<i;o++)n[o*e]+=s}function qD(n,e,t,i){let s;if(Array.isArray(n[0])){const o=n.length*e;s=new Array(o);for(let l=0;l<n.length;l++)for(let c=0;c<e;c++)s[l*e+c]=n[l][c]||0}else s=n;return t?_v(s,{size:e,gridResolution:t}):i?$D(s,{size:e}):s}const ZD=1,KD=2,rp=4;class GD extends fv{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?qD(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(Ky(e)){let i=0;for(const s of e)i+=this.getGeometrySize(s);return i}const t=this.getPathLength(e);return t<2?0:this.isClosed(e)?t<3?0:t+2:t}updateGeometryAttributes(e,t){if(t.geometrySize!==0)if(e&&Ky(e))for(const i of e){const s=this.getGeometrySize(i);t.geometrySize=s,this.updateGeometryAttributes(i,t),t.vertexStart+=s}else this._updateSegmentTypes(e,t),this._updatePositions(e,t)}_updateSegmentTypes(e,t){const i=this.attributes.segmentTypes,s=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:l}=t;i.fill(0,o,o+l),s?(i[o]=rp,i[o+l-2]=rp):(i[o]+=ZD,i[o+l-2]+=KD),i[o+l-1]=rp}_updatePositions(e,t){const{positions:i}=this.attributes;if(!i||!e)return;const{vertexStart:s,geometrySize:o}=t,l=new Array(3);for(let c=s,f=0;f<o;c++,f++)this.getPointOnPath(e,f,l),i[c*3]=l[0],i[c*3+1]=l[1],i[c*3+2]=l[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,t,i=[]){const{positionSize:s}=this;t*s>=e.length&&(t+=1-e.length/s);const o=t*s;return i[0]=e[o],i[1]=e[o+1],i[2]=s===3&&e[o+2]||0,i}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:t}=this,i=e.length-t;return e[0]===e[i]&&e[1]===e[i+1]&&(t===2||e[2]===e[i+2])}}function Ky(n){return Array.isArray(n[0])}const Gy=`uniform pathUniforms {
  float widthScale;
  float widthMinPixels;
  float widthMaxPixels;
  float jointType;
  float capType;
  float miterLimit;
  bool billboard;
  highp int widthUnits;
} path;
`,QD={name:"path",vs:Gy,fs:Gy,uniformTypes:{widthScale:"f32",widthMinPixels:"f32",widthMaxPixels:"f32",jointType:"f32",capType:"f32",miterLimit:"f32",billboard:"f32",widthUnits:"i32"}},JD=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !path.billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * path.capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = path.capType;
} else {
vJointType = path.jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * layer.opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * path.widthScale, path.widthUnits),
path.widthMinPixels, path.widthMaxPixels) / 2.0);
vec3 width;
if (path.billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,eL=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > path.miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Tv=[0,0,0,255],tL={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:n=>n.path},getColor:{type:"accessor",value:Tv},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},op={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class o2 extends wi{getShaders(){return super.getShaders({vs:JD,fs:eL,modules:[al,ll,QD]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:op,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:op,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:op,defaultValue:Tv},instancePickingColors:{size:4,type:"uint8",accessor:(i,{index:s,target:o})=>this.encodePickingColor(i&&i.__source?i.__source.index:s,o)}}),this.setState({pathTesselator:new GD({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:t,changeFlags:i}=e,s=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){const{pathTesselator:l}=this.state,c=t.data.attributes||{};l.updateGeometry({data:t.data,geometryBuffer:c.getPath,buffers:c,normalize:!t._pathType,loop:t._pathType==="loop",getGeometry:t.getPath,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:l.instanceCount,startIndices:l.vertexStarts}),i.dataChanged||s.invalidateAll()}i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll())}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i}=t,s=this.props.data;return s[0]&&s[0].__source&&(t.object=s.find(o=>o.__source.index===i)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:t,capRounded:i,billboard:s,miterLimit:o,widthUnits:l,widthScale:c,widthMinPixels:f,widthMaxPixels:d}=this.props,p=this.state.model,_={jointType:Number(t),capType:Number(i),billboard:s,widthUnits:vi[l],widthScale:c,miterLimit:o,widthMinPixels:f,widthMaxPixels:d};p.shaderInputs.setProps({path:_}),p.draw(this.context.renderPass)}_getModel(){const e=[0,1,2,1,4,2,1,3,4,3,5,4],t=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new kn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new co({topology:"triangle-list",attributes:{indices:new Uint16Array(e),positions:{value:new Float32Array(t),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateSegmentTypes(e){const{pathTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("segmentTypes")}}o2.defaultProps=tL;o2.layerName="PathLayer";var $c={exports:{}},Qy;function nL(){if(Qy)return $c.exports;Qy=1,$c.exports=n,$c.exports.default=n;function n(w,N,O){O=O||2;var ne=N&&N.length,A=ne?N[0]*O:w.length,F=e(w,0,A,O,!0),X=[];if(!F||F.next===F.prev)return X;var G,ae,fe,me,xe,Te,We;if(ne&&(F=f(w,N,F,O)),w.length>80*O){G=fe=w[0],ae=me=w[1];for(var Be=O;Be<A;Be+=O)xe=w[Be],Te=w[Be+1],xe<G&&(G=xe),Te<ae&&(ae=Te),xe>fe&&(fe=xe),Te>me&&(me=Te);We=Math.max(fe-G,me-ae),We=We!==0?32767/We:0}return i(F,X,O,G,ae,We,0),X}function e(w,N,O,ne,A){var F,X;if(A===Se(w,N,O,ne)>0)for(F=N;F<O;F+=ne)X=_e(F,w[F],w[F+1],X);else for(F=O-ne;F>=N;F-=ne)X=_e(F,w[F],w[F+1],X);return X&&D(X,X.next)&&(ge(X),X=X.next),X}function t(w,N){if(!w)return w;N||(N=w);var O=w,ne;do if(ne=!1,!O.steiner&&(D(O,O.next)||R(O.prev,O,O.next)===0)){if(ge(O),O=N=O.prev,O===O.next)break;ne=!0}else O=O.next;while(ne||O!==N);return N}function i(w,N,O,ne,A,F,X){if(w){!X&&F&&v(w,ne,A,F);for(var G=w,ae,fe;w.prev!==w.next;){if(ae=w.prev,fe=w.next,F?o(w,ne,A,F):s(w)){N.push(ae.i/O|0),N.push(w.i/O|0),N.push(fe.i/O|0),ge(w),w=fe.next,G=fe.next;continue}if(w=fe,w===G){X?X===1?(w=l(t(w),N,O),i(w,N,O,ne,A,F,2)):X===2&&c(w,N,O,ne,A,F):i(t(w),N,O,ne,A,F,1);break}}}}function s(w){var N=w.prev,O=w,ne=w.next;if(R(N,O,ne)>=0)return!1;for(var A=N.x,F=O.x,X=ne.x,G=N.y,ae=O.y,fe=ne.y,me=A<F?A<X?A:X:F<X?F:X,xe=G<ae?G<fe?G:fe:ae<fe?ae:fe,Te=A>F?A>X?A:X:F>X?F:X,We=G>ae?G>fe?G:fe:ae>fe?ae:fe,Be=ne.next;Be!==N;){if(Be.x>=me&&Be.x<=Te&&Be.y>=xe&&Be.y<=We&&C(A,G,F,ae,X,fe,Be.x,Be.y)&&R(Be.prev,Be,Be.next)>=0)return!1;Be=Be.next}return!0}function o(w,N,O,ne){var A=w.prev,F=w,X=w.next;if(R(A,F,X)>=0)return!1;for(var G=A.x,ae=F.x,fe=X.x,me=A.y,xe=F.y,Te=X.y,We=G<ae?G<fe?G:fe:ae<fe?ae:fe,Be=me<xe?me<Te?me:Te:xe<Te?xe:Te,Ht=G>ae?G>fe?G:fe:ae>fe?ae:fe,$t=me>xe?me>Te?me:Te:xe>Te?xe:Te,qs=S(We,Be,N,O,ne),Zs=S(Ht,$t,N,O,ne),ze=w.prevZ,je=w.nextZ;ze&&ze.z>=qs&&je&&je.z<=Zs;){if(ze.x>=We&&ze.x<=Ht&&ze.y>=Be&&ze.y<=$t&&ze!==A&&ze!==X&&C(G,me,ae,xe,fe,Te,ze.x,ze.y)&&R(ze.prev,ze,ze.next)>=0||(ze=ze.prevZ,je.x>=We&&je.x<=Ht&&je.y>=Be&&je.y<=$t&&je!==A&&je!==X&&C(G,me,ae,xe,fe,Te,je.x,je.y)&&R(je.prev,je,je.next)>=0))return!1;je=je.nextZ}for(;ze&&ze.z>=qs;){if(ze.x>=We&&ze.x<=Ht&&ze.y>=Be&&ze.y<=$t&&ze!==A&&ze!==X&&C(G,me,ae,xe,fe,Te,ze.x,ze.y)&&R(ze.prev,ze,ze.next)>=0)return!1;ze=ze.prevZ}for(;je&&je.z<=Zs;){if(je.x>=We&&je.x<=Ht&&je.y>=Be&&je.y<=$t&&je!==A&&je!==X&&C(G,me,ae,xe,fe,Te,je.x,je.y)&&R(je.prev,je,je.next)>=0)return!1;je=je.nextZ}return!0}function l(w,N,O){var ne=w;do{var A=ne.prev,F=ne.next.next;!D(A,F)&&B(A,ne,ne.next,F)&&ee(A,F)&&ee(F,A)&&(N.push(A.i/O|0),N.push(ne.i/O|0),N.push(F.i/O|0),ge(ne),ge(ne.next),ne=w=F),ne=ne.next}while(ne!==w);return t(ne)}function c(w,N,O,ne,A,F){var X=w;do{for(var G=X.next.next;G!==X.prev;){if(X.i!==G.i&&U(X,G)){var ae=de(X,G);X=t(X,X.next),ae=t(ae,ae.next),i(X,N,O,ne,A,F,0),i(ae,N,O,ne,A,F,0);return}G=G.next}X=X.next}while(X!==w)}function f(w,N,O,ne){var A=[],F,X,G,ae,fe;for(F=0,X=N.length;F<X;F++)G=N[F]*ne,ae=F<X-1?N[F+1]*ne:w.length,fe=e(w,G,ae,ne,!1),fe===fe.next&&(fe.steiner=!0),A.push(M(fe));for(A.sort(d),F=0;F<A.length;F++)O=p(A[F],O);return O}function d(w,N){return w.x-N.x}function p(w,N){var O=_(w,N);if(!O)return N;var ne=de(O,w);return t(ne,ne.next),t(O,O.next)}function _(w,N){var O=N,ne=w.x,A=w.y,F=-1/0,X;do{if(A<=O.y&&A>=O.next.y&&O.next.y!==O.y){var G=O.x+(A-O.y)*(O.next.x-O.x)/(O.next.y-O.y);if(G<=ne&&G>F&&(F=G,X=O.x<O.next.x?O:O.next,G===ne))return X}O=O.next}while(O!==N);if(!X)return null;var ae=X,fe=X.x,me=X.y,xe=1/0,Te;O=X;do ne>=O.x&&O.x>=fe&&ne!==O.x&&C(A<me?ne:F,A,fe,me,A<me?F:ne,A,O.x,O.y)&&(Te=Math.abs(A-O.y)/(ne-O.x),ee(O,w)&&(Te<xe||Te===xe&&(O.x>X.x||O.x===X.x&&y(X,O)))&&(X=O,xe=Te)),O=O.next;while(O!==ae);return X}function y(w,N){return R(w.prev,w,N.prev)<0&&R(N.next,w,w.next)<0}function v(w,N,O,ne){var A=w;do A.z===0&&(A.z=S(A.x,A.y,N,O,ne)),A.prevZ=A.prev,A.nextZ=A.next,A=A.next;while(A!==w);A.prevZ.nextZ=null,A.prevZ=null,x(A)}function x(w){var N,O,ne,A,F,X,G,ae,fe=1;do{for(O=w,w=null,F=null,X=0;O;){for(X++,ne=O,G=0,N=0;N<fe&&(G++,ne=ne.nextZ,!!ne);N++);for(ae=fe;G>0||ae>0&&ne;)G!==0&&(ae===0||!ne||O.z<=ne.z)?(A=O,O=O.nextZ,G--):(A=ne,ne=ne.nextZ,ae--),F?F.nextZ=A:w=A,A.prevZ=F,F=A;O=ne}F.nextZ=null,fe*=2}while(X>1);return w}function S(w,N,O,ne,A){return w=(w-O)*A|0,N=(N-ne)*A|0,w=(w|w<<8)&16711935,w=(w|w<<4)&252645135,w=(w|w<<2)&858993459,w=(w|w<<1)&1431655765,N=(N|N<<8)&16711935,N=(N|N<<4)&252645135,N=(N|N<<2)&858993459,N=(N|N<<1)&1431655765,w|N<<1}function M(w){var N=w,O=w;do(N.x<O.x||N.x===O.x&&N.y<O.y)&&(O=N),N=N.next;while(N!==w);return O}function C(w,N,O,ne,A,F,X,G){return(A-X)*(N-G)>=(w-X)*(F-G)&&(w-X)*(ne-G)>=(O-X)*(N-G)&&(O-X)*(F-G)>=(A-X)*(ne-G)}function U(w,N){return w.next.i!==N.i&&w.prev.i!==N.i&&!Z(w,N)&&(ee(w,N)&&ee(N,w)&&he(w,N)&&(R(w.prev,w,N.prev)||R(w,N.prev,N))||D(w,N)&&R(w.prev,w,w.next)>0&&R(N.prev,N,N.next)>0)}function R(w,N,O){return(N.y-w.y)*(O.x-N.x)-(N.x-w.x)*(O.y-N.y)}function D(w,N){return w.x===N.x&&w.y===N.y}function B(w,N,O,ne){var A=ce(R(w,N,O)),F=ce(R(w,N,ne)),X=ce(R(O,ne,w)),G=ce(R(O,ne,N));return!!(A!==F&&X!==G||A===0&&Q(w,O,N)||F===0&&Q(w,ne,N)||X===0&&Q(O,w,ne)||G===0&&Q(O,N,ne))}function Q(w,N,O){return N.x<=Math.max(w.x,O.x)&&N.x>=Math.min(w.x,O.x)&&N.y<=Math.max(w.y,O.y)&&N.y>=Math.min(w.y,O.y)}function ce(w){return w>0?1:w<0?-1:0}function Z(w,N){var O=w;do{if(O.i!==w.i&&O.next.i!==w.i&&O.i!==N.i&&O.next.i!==N.i&&B(O,O.next,w,N))return!0;O=O.next}while(O!==w);return!1}function ee(w,N){return R(w.prev,w,w.next)<0?R(w,N,w.next)>=0&&R(w,w.prev,N)>=0:R(w,N,w.prev)<0||R(w,w.next,N)<0}function he(w,N){var O=w,ne=!1,A=(w.x+N.x)/2,F=(w.y+N.y)/2;do O.y>F!=O.next.y>F&&O.next.y!==O.y&&A<(O.next.x-O.x)*(F-O.y)/(O.next.y-O.y)+O.x&&(ne=!ne),O=O.next;while(O!==w);return ne}function de(w,N){var O=new ue(w.i,w.x,w.y),ne=new ue(N.i,N.x,N.y),A=w.next,F=N.prev;return w.next=N,N.prev=w,O.next=A,A.prev=O,ne.next=O,O.prev=ne,F.next=ne,ne.prev=F,ne}function _e(w,N,O,ne){var A=new ue(w,N,O);return ne?(A.next=ne.next,A.prev=ne,ne.next.prev=A,ne.next=A):(A.prev=A,A.next=A),A}function ge(w){w.next.prev=w.prev,w.prev.next=w.next,w.prevZ&&(w.prevZ.nextZ=w.nextZ),w.nextZ&&(w.nextZ.prevZ=w.prevZ)}function ue(w,N,O){this.i=w,this.x=N,this.y=O,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}n.deviation=function(w,N,O,ne){var A=N&&N.length,F=A?N[0]*O:w.length,X=Math.abs(Se(w,0,F,O));if(A)for(var G=0,ae=N.length;G<ae;G++){var fe=N[G]*O,me=G<ae-1?N[G+1]*O:w.length;X-=Math.abs(Se(w,fe,me,O))}var xe=0;for(G=0;G<ne.length;G+=3){var Te=ne[G]*O,We=ne[G+1]*O,Be=ne[G+2]*O;xe+=Math.abs((w[Te]-w[Be])*(w[We+1]-w[Te+1])-(w[Te]-w[We])*(w[Be+1]-w[Te+1]))}return X===0&&xe===0?0:Math.abs((xe-X)/X)};function Se(w,N,O,ne){for(var A=0,F=N,X=O-ne;F<O;F+=ne)A+=(w[X]-w[F])*(w[F+1]+w[X+1]),X=F;return A}return n.flatten=function(w){for(var N=w[0][0].length,O={vertices:[],holes:[],dimensions:N},ne=0,A=0;A<w.length;A++){for(var F=0;F<w[A].length;F++)for(var X=0;X<N;X++)O.vertices.push(w[A][F][X]);A>0&&(ne+=w[A-1].length,O.holes.push(ne))}return O},$c.exports}var iL=nL();const sL=b4(iL),Wc=gv.CLOCKWISE,Jy=gv.COUNTER_CLOCKWISE,ss={};function rL(n){if(n=n&&n.positions||n,!Array.isArray(n)&&!ArrayBuffer.isView(n))throw new Error("invalid polygon")}function Na(n){return"positions"in n?n.positions:n}function cu(n){return"holeIndices"in n?n.holeIndices:null}function oL(n){return Array.isArray(n[0])}function aL(n){return n.length>=1&&n[0].length>=2&&Number.isFinite(n[0][0])}function lL(n){const e=n[0],t=n[n.length-1];return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function cL(n,e,t,i){for(let s=0;s<e;s++)if(n[t+s]!==n[i-e+s])return!1;return!0}function e4(n,e,t,i,s){let o=e;const l=t.length;for(let c=0;c<l;c++)for(let f=0;f<i;f++)n[o++]=t[c][f]||0;if(!lL(t))for(let c=0;c<i;c++)n[o++]=t[0][c]||0;return ss.start=e,ss.end=o,ss.size=i,mv(n,s,ss),o}function t4(n,e,t,i,s=0,o,l){o=o||t.length;const c=o-s;if(c<=0)return e;let f=e;for(let d=0;d<c;d++)n[f++]=t[s+d];if(!cL(t,i,s,o))for(let d=0;d<i;d++)n[f++]=t[s+d];return ss.start=e,ss.end=f,ss.size=i,mv(n,l,ss),f}function uL(n,e){rL(n);const t=[],i=[];if("positions"in n){const{positions:s,holeIndices:o}=n;if(o){let l=0;for(let c=0;c<=o.length;c++)l=t4(t,l,s,e,o[c-1],o[c],c===0?Wc:Jy),i.push(l);return i.pop(),{positions:t,holeIndices:i}}n=s}if(!oL(n))return t4(t,0,n,e,0,t.length,Wc),t;if(!aL(n)){let s=0;for(const[o,l]of n.entries())s=e4(t,s,l,e,o===0?Wc:Jy),i.push(s);return i.pop(),{positions:t,holeIndices:i}}return e4(t,0,n,e,Wc),t}function ap(n,e,t){const i=n.length/3;let s=0;for(let o=0;o<i;o++){const l=(o+1)%i;s+=n[o*3+e]*n[l*3+t],s-=n[l*3+e]*n[o*3+t]}return Math.abs(s/2)}function n4(n,e,t,i){const s=n.length/3;for(let o=0;o<s;o++){const l=o*3,c=n[l+0],f=n[l+1],d=n[l+2];n[l+e]=c,n[l+t]=f,n[l+i]=d}}function fL(n,e,t,i){let s=cu(n);s&&(s=s.map(c=>c/e));let o=Na(n);const l=i&&e===3;if(t){const c=o.length;o=o.slice();const f=[];for(let d=0;d<c;d+=e){f[0]=o[d],f[1]=o[d+1],l&&(f[2]=o[d+2]);const p=t(f);o[d]=p[0],o[d+1]=p[1],l&&(o[d+2]=p[2])}}if(l){const c=ap(o,0,1),f=ap(o,0,2),d=ap(o,1,2);if(!c&&!f&&!d)return[];c>f&&c>d||(f>d?(t||(o=o.slice()),n4(o,0,2,1)):(t||(o=o.slice()),n4(o,2,0,1)))}return sL(o,s,e)}class hL extends fv{constructor(e){const{fp64:t,IndexType:i=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:t?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:i,size:1}}})}get(e){const{attributes:t}=this;return e==="indices"?t.indices&&t.indices.subarray(0,this.vertexCount):t[e]}updateGeometry(e){super.updateGeometry(e);const t=this.buffers.indices;if(t)this.vertexCount=(t.value||t).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const t=uL(e,this.positionSize);return this.opts.resolution?yv(Na(t),cu(t),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?WD(Na(t),cu(t),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):t}return e}getGeometrySize(e){if(i4(e)){let t=0;for(const i of e)t+=this.getGeometrySize(i);return t}return Na(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,t){if(e&&i4(e))for(const i of e){const s=this.getGeometrySize(i);t.geometrySize=s,this.updateGeometryAttributes(i,t),t.vertexStart+=s,t.indexStart=this.indexStarts[t.geometryIndex+1]}else{const i=e;this._updateIndices(i,t),this._updatePositions(i,t),this._updateVertexValid(i,t)}}_updateIndices(e,{geometryIndex:t,vertexStart:i,indexStart:s}){const{attributes:o,indexStarts:l,typedArrayManager:c}=this;let f=o.indices;if(!f||!e)return;let d=s;const p=fL(e,this.positionSize,this.opts.preproject,this.opts.full3d);f=c.allocate(f,s+p.length,{copy:!0});for(let _=0;_<p.length;_++)f[d++]=p[_]+i;l[t+1]=s+p.length,o.indices=f}_updatePositions(e,{vertexStart:t,geometrySize:i}){const{attributes:{positions:s},positionSize:o}=this;if(!s||!e)return;const l=Na(e);for(let c=t,f=0;f<i;c++,f++){const d=l[f*o],p=l[f*o+1],_=o>2?l[f*o+2]:0;s[c*3]=d,s[c*3+1]=p,s[c*3+2]=_}}_updateVertexValid(e,{vertexStart:t,geometrySize:i}){const{positionSize:s}=this,o=this.attributes.vertexValid,l=e&&cu(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,t):o.fill(1,t,t+i),l)for(let c=0;c<l.length;c++)o[t+l[c]/s-1]=0;o[t+i-1]=0}}function i4(n){return Array.isArray(n)&&n.length>0&&!Number.isFinite(n[0])}const s4=`uniform solidPolygonUniforms {
  bool extruded;
  bool isWireframe;
  float elevationScale;
} solidPolygon;
`,dL={name:"solidPolygon",vs:s4,fs:s4,uniformTypes:{extruded:"f32",isWireframe:"f32",elevationScale:"f32"}},wv=`in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project.commonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = solidPolygon.isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (solidPolygon.extruded) {
pos.z += props.elevations * solidPolygon.elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (solidPolygon.extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project.cameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * layer.opacity);
} else {
vColor = vec4(colors.rgb, colors.a * layer.opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`,pL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${wv}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`,gL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${wv}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`,mL=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,Lu=[0,0,0,255],_L={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:n=>n.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:Lu},getLineColor:{type:"accessor",value:Lu},material:!0},Xc={enter:(n,e)=>e.length?e.subarray(e.length-n.length):n};class a2 extends wi{getShaders(e){return super.getShaders({vs:e==="top"?pL:gL,fs:mL,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[al,d8,ll,dL]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){const{viewport:e}=this.context;let{coordinateSystem:t}=this.props;const{_full3d:i}=this.props;e.isGeospatial&&t===Fe.DEFAULT&&(t=Fe.LNGLAT);let s;t===Fe.LNGLAT&&(i?s=e.projectPosition.bind(e):s=e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new hL({preproject:s,fp64:this.use64bitPositions(),IndexType:Uint32Array})});const o=this.getAttributeManager(),l=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:l},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:Xc,accessor:"getPolygon",update:this.calculatePositions,noAlloc:l,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:l},elevations:{size:1,stepMode:"dynamic",transition:Xc,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Xc,accessor:"getFillColor",defaultValue:Lu},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:Xc,accessor:"getLineColor",defaultValue:Lu},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(c,{index:f,target:d})=>this.encodePickingColor(c&&c.__source?c.__source.index:f,d)}})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i}=t,s=this.props.data;return s[0]&&s[0].__source&&(t.object=s.find(o=>o.__source.index===i)),t}disablePickingIndex(e){const t=this.props.data;if(t[0]&&t[0].__source)for(let i=0;i<t.length;i++)t[i].__source.index===e&&this._disablePickingIndex(i);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:t,filled:i,wireframe:s,elevationScale:o}=this.props,{topModel:l,sideModel:c,wireframeModel:f,polygonTesselator:d}=this.state,p={extruded:!!t,elevationScale:o,isWireframe:!1};f&&s&&(f.setInstanceCount(d.instanceCount-1),f.shaderInputs.setProps({solidPolygon:{...p,isWireframe:!0}}),f.draw(this.context.renderPass)),c&&i&&(c.setInstanceCount(d.instanceCount-1),c.shaderInputs.setProps({solidPolygon:p}),c.draw(this.context.renderPass)),l&&i&&(l.setVertexCount(d.vertexCount),l.shaderInputs.setProps({solidPolygon:p}),l.draw(this.context.renderPass))}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:t,oldProps:i,changeFlags:s}=e,o=this.getAttributeManager();(s.extensionsChanged||t.filled!==i.filled||t.extruded!==i.extruded)&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),o.invalidateAll())}updateGeometry({props:e,oldProps:t,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){const{polygonTesselator:o}=this.state,l=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:l.getPolygon,buffers:l,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){const{id:e,filled:t,extruded:i}=this.props;let s,o,l;if(t){const c=this.getShaders("top");c.defines.NON_INSTANCED_MODEL=1;const f=this.getAttributeManager().getBufferLayouts({isInstanced:!1});s=new kn(this.context.device,{...c,id:`${e}-top`,topology:"triangle-list",bufferLayout:f,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(i){const c=this.getAttributeManager().getBufferLayouts({isInstanced:!0});o=new kn(this.context.device,{...this.getShaders("side"),id:`${e}-side`,bufferLayout:c,geometry:new co({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),l=new kn(this.context.device,{...this.getShaders("side"),id:`${e}-wireframe`,bufferLayout:c,geometry:new co({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[o,l,s].filter(Boolean),topModel:s,sideModel:o,wireframeModel:l}}calculateIndices(e){const{polygonTesselator:t}=this.state;e.startIndices=t.indexStarts,e.value=t.get("indices")}calculatePositions(e){const{polygonTesselator:t}=this.state;e.startIndices=t.vertexStarts,e.value=t.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}a2.defaultProps=_L;a2.layerName="SolidPolygonLayer";function yL({data:n,getIndex:e,dataRange:t,replace:i}){const{startRow:s=0,endRow:o=1/0}=t,l=n.length;let c=l,f=l;for(let y=0;y<l;y++){const v=e(n[y]);if(c>y&&v>=s&&(c=y),v>=o){f=y;break}}let d=c;const _=f-c!==i.length?n.slice(f):void 0;for(let y=0;y<i.length;y++)n[d++]=i[y];if(_){for(let y=0;y<_.length;y++)n[d++]=_[y];n.length=d}return{startRow:c,endRow:c+i.length}}function bL(n,e){if(!n)return null;const t="startIndices"in n?n.startIndices[e]:e,i=n.featureIds.value[t];return t!==-1?vL(n,i,t):null}function vL(n,e,t){const i={properties:{...n.properties[e]}};for(const s in n.numericProps)i.properties[s]=n.numericProps[s].value[t];return i}function xL(n,e){const t={points:null,lines:null,polygons:null};for(const i in t){const s=n[i].globalFeatureIds.value;t[i]=new Uint8ClampedArray(s.length*4);const o=[];for(let l=0;l<s.length;l++)e(s[l],o),t[i][l*4+0]=o[0],t[i][l*4+1]=o[1],t[i][l*4+2]=o[2],t[i][l*4+3]=255}return t}const r4=`uniform sdfUniforms {
  float gamma;
  bool enabled;
  float buffer;
  float outlineBuffer;
  vec4 outlineColor;
} sdf;
`,TL={name:"sdf",vs:r4,fs:r4,uniformTypes:{gamma:"f32",enabled:"f32",buffer:"f32",outlineBuffer:"f32",outlineColor:"vec4<f32>"}},wL=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform sampler2D iconsTexture;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf.enabled) {
float distance = alpha;
alpha = smoothstep(sdf.buffer - sdf.gamma, sdf.buffer + sdf.gamma, distance);
if (sdf.outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(sdf.outlineBuffer - sdf.gamma, sdf.outlineBuffer + sdf.gamma, distance);
color = mix(sdf.outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < icon.alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * layer.opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,lp=192/256,o4=[],SL={getIconOffsets:{type:"accessor",value:n=>n.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class l2 extends Qu{getShaders(){const e=super.getShaders();return{...e,modules:[...e.modules,TL],fs:wL}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(t,{index:i,target:s})=>this.encodePickingColor(i,s)}})}updateState(e){super.updateState(e);const{props:t,oldProps:i}=e;let{outlineColor:s}=t;s!==i.outlineColor&&(s=s.map(o=>o/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!t.sdf&&t.outlineWidth&&ke.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(e){const{sdf:t,smoothing:i,outlineWidth:s}=this.props,{outlineColor:o}=this.state,l=s?Math.max(i,lp*(1-s)):-1,c=this.state.model,f={buffer:lp,outlineBuffer:l,gamma:i,enabled:!!t,outlineColor:o};if(c.shaderInputs.setProps({sdf:f}),super.draw(e),t&&s){const{iconManager:d}=this.state;d.getTexture()&&(c.shaderInputs.setProps({sdf:{...f,outlineBuffer:lp}}),c.draw(this.context.renderPass))}}getInstanceOffset(e){return e?Array.from(e).flatMap(t=>super.getInstanceOffset(t)):o4}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(t=>super.getInstanceIconFrame(t)):o4}}l2.defaultProps=SL;l2.layerName="MultiIconLayer";const Ha=1e20;class AL{constructor({fontSize:e=24,buffer:t=3,radius:i=8,cutoff:s=.25,fontFamily:o="sans-serif",fontWeight:l="normal",fontStyle:c="normal",lang:f=null}={}){this.buffer=t,this.cutoff=s,this.radius=i,this.lang=f;const d=this.size=e+t*4,p=this._createCanvas(d),_=this.ctx=p.getContext("2d",{willReadFrequently:!0});_.font=`${c} ${l} ${e}px ${o}`,_.textBaseline="alphabetic",_.textAlign="left",_.fillStyle="black",this.gridOuter=new Float64Array(d*d),this.gridInner=new Float64Array(d*d),this.f=new Float64Array(d),this.z=new Float64Array(d+1),this.v=new Uint16Array(d)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:o,actualBoundingBoxRight:l}=this.ctx.measureText(e),c=Math.ceil(i),f=0,d=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(l-o))),p=Math.min(this.size-this.buffer,c+Math.ceil(s)),_=d+2*this.buffer,y=p+2*this.buffer,v=Math.max(_*y,0),x=new Uint8ClampedArray(v),S={data:x,width:_,height:y,glyphWidth:d,glyphHeight:p,glyphTop:c,glyphLeft:f,glyphAdvance:t};if(d===0||p===0)return S;const{ctx:M,buffer:C,gridInner:U,gridOuter:R}=this;this.lang&&(M.lang=this.lang),M.clearRect(C,C,d,p),M.fillText(e,C,C+c);const D=M.getImageData(C,C,d,p);R.fill(Ha,0,v),U.fill(0,0,v);for(let B=0;B<p;B++)for(let Q=0;Q<d;Q++){const ce=D.data[4*(B*d+Q)+3]/255;if(ce===0)continue;const Z=(B+C)*_+Q+C;if(ce===1)R[Z]=0,U[Z]=Ha;else{const ee=.5-ce;R[Z]=ee>0?ee*ee:0,U[Z]=ee<0?ee*ee:0}}a4(R,0,0,_,y,_,this.f,this.v,this.z),a4(U,C,C,d,p,_,this.f,this.v,this.z);for(let B=0;B<v;B++){const Q=Math.sqrt(R[B])-Math.sqrt(U[B]);x[B]=Math.round(255-255*(Q/this.radius+this.cutoff))}return S}}function a4(n,e,t,i,s,o,l,c,f){for(let d=e;d<e+i;d++)l4(n,t*o+d,o,s,l,c,f);for(let d=t;d<t+s;d++)l4(n,d*o+e,1,i,l,c,f)}function l4(n,e,t,i,s,o,l){o[0]=0,l[0]=-Ha,l[1]=Ha,s[0]=n[e];for(let c=1,f=0,d=0;c<i;c++){s[c]=n[e+c*t];const p=c*c;do{const _=o[f];d=(s[c]-s[_]+p-_*_)/(c-_)/2}while(d<=l[f]&&--f>-1);f++,o[f]=c,l[f]=d,l[f+1]=Ha}for(let c=0,f=0;c<i;c++){for(;l[f+1]<c;)f++;const d=o[f],p=c-d;n[e+c*t]=s[d]+p*p}}const EL=32,CL=[];function RL(n){return Math.pow(2,Math.ceil(Math.log2(n)))}function ML({characterSet:n,getFontWidth:e,fontHeight:t,buffer:i,maxCanvasWidth:s,mapping:o={},xOffset:l=0,yOffset:c=0}){let f=0,d=l;const p=t+i*2;for(const _ of n)if(!o[_]){const y=e(_);d+y+i*2>s&&(d=0,f++),o[_]={x:d+i,y:c+f*p+i,width:y,height:p,layoutWidth:y,layoutHeight:t},d+=y+i*2}return{mapping:o,xOffset:d,yOffset:c+f*p,canvasHeight:RL(c+(f+1)*p)}}function Sv(n,e,t,i){let s=0;for(let o=e;o<t;o++){const l=n[o];s+=i[l]?.layoutWidth||0}return s}function Av(n,e,t,i,s,o){let l=e,c=0;for(let f=e;f<t;f++){const d=Sv(n,f,f+1,s);c+d>i&&(l<f&&o.push(f),l=f,c=0),c+=d}return c}function PL(n,e,t,i,s,o){let l=e,c=e,f=e,d=0;for(let p=e;p<t;p++)if((n[p]===" "||n[p+1]===" "||p+1===t)&&(f=p+1),f>c){let _=Sv(n,c,f,s);d+_>i&&(l<c&&(o.push(c),l=c,d=0),_>i&&(_=Av(n,c,f,i,s,o),l=o[o.length-1])),c=f,d+=_}return d}function OL(n,e,t,i,s=0,o){o===void 0&&(o=n.length);const l=[];return e==="break-all"?Av(n,s,o,t,i,l):PL(n,s,o,t,i,l),l}function IL(n,e,t,i,s,o){let l=0,c=0;for(let f=e;f<t;f++){const d=n[f],p=i[d];p?(c||(c=p.layoutHeight),s[f]=l+p.layoutWidth/2,l+=p.layoutWidth):(ke.warn(`Missing character: ${d} (${d.codePointAt(0)})`)(),s[f]=l,l+=EL)}o[0]=l,o[1]=c}function NL(n,e,t,i,s){const o=Array.from(n),l=o.length,c=new Array(l),f=new Array(l),d=new Array(l),p=(t==="break-word"||t==="break-all")&&isFinite(i)&&i>0,_=[0,0],y=[0,0];let v=0,x=0,S=0;for(let M=0;M<=l;M++){const C=o[M];if((C===`
`||M===l)&&(S=M),S>x){const U=p?OL(o,t,i,s,x,S):CL;for(let R=0;R<=U.length;R++){const D=R===0?x:U[R-1],B=R<U.length?U[R]:S;IL(o,D,B,s,c,y);for(let Q=D;Q<B;Q++){const ce=o[Q],Z=s[ce]?.layoutOffsetY||0;f[Q]=v+y[1]/2+Z,d[Q]=y[0]}v=v+y[1]*e,_[0]=Math.max(_[0],y[0])}x=S}C===`
`&&(c[x]=0,f[x]=0,d[x]=0,x++)}return _[1]=v,{x:c,y:f,rowWidth:d,size:_}}function kL({value:n,length:e,stride:t,offset:i,startIndices:s,characterSet:o}){const l=n.BYTES_PER_ELEMENT,c=t?t/l:1,f=i?i/l:0,d=s[e]||Math.ceil((n.length-f)/c),p=o&&new Set,_=new Array(e);let y=n;if(c>1||f>0){const v=n.constructor;y=new v(d);for(let x=0;x<d;x++)y[x]=n[x*c+f]}for(let v=0;v<e;v++){const x=s[v],S=s[v+1]||d,M=y.subarray(x,S);_[v]=String.fromCodePoint.apply(null,M),p&&M.forEach(p.add,p)}if(p)for(const v of p)o.add(String.fromCodePoint(v));return{texts:_,characterCount:d}}class Ev{constructor(e=5){this._cache={},this._order=[],this.limit=e}get(e){const t=this._cache[e];return t&&(this._deleteOrder(e),this._appendOrder(e)),t}set(e,t){this._cache[e]?(this.delete(e),this._cache[e]=t,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=t,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const t=this._order.indexOf(e);t>=0&&this._order.splice(t,1)}_appendOrder(e){this._order.push(e)}}function DL(){const n=[];for(let e=32;e<128;e++)n.push(String.fromCharCode(e));return n}const Jr={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:DL(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},c4=1024,u4=.9,f4=1.2,Cv=3;let Bu=new Ev(Cv);function LL(n,e){let t;typeof e=="string"?t=new Set(Array.from(e)):t=new Set(e);const i=Bu.get(n);if(!i)return t;for(const s in i.mapping)t.has(s)&&t.delete(s);return t}function BL(n,e){for(let t=0;t<n.length;t++)e.data[4*t+3]=n[t]}function h4(n,e,t,i){n.font=`${i} ${t}px ${e}`,n.fillStyle="#000",n.textBaseline="alphabetic",n.textAlign="left"}function UL(n){ke.assert(Number.isFinite(n)&&n>=Cv,"Invalid cache limit"),Bu=new Ev(n)}class FL{constructor(){this.props={...Jr}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:t}=this.props;return(e*f4+t*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const t=LL(this._key,this.props.characterSet),i=Bu.get(this._key);if(i&&t.size===0){this._atlas!==i&&(this._atlas=i);return}const s=this._generateFontAtlas(t,i);this._atlas=s,Bu.set(this._key,s)}_generateFontAtlas(e,t){const{fontFamily:i,fontWeight:s,fontSize:o,buffer:l,sdf:c,radius:f,cutoff:d}=this.props;let p=t&&t.data;p||(p=document.createElement("canvas"),p.width=c4);const _=p.getContext("2d",{willReadFrequently:!0});h4(_,i,o,s);const{mapping:y,canvasHeight:v,xOffset:x,yOffset:S}=ML({getFontWidth:M=>_.measureText(M).width,fontHeight:o*f4,buffer:l,characterSet:e,maxCanvasWidth:c4,...t&&{mapping:t.mapping,xOffset:t.xOffset,yOffset:t.yOffset}});if(p.height!==v){const M=_.getImageData(0,0,p.width,p.height);p.height=v,_.putImageData(M,0,0)}if(h4(_,i,o,s),c){const M=new AL({fontSize:o,buffer:l,radius:f,cutoff:d,fontFamily:i,fontWeight:`${s}`});for(const C of e){const{data:U,width:R,height:D,glyphTop:B}=M.draw(C);y[C].width=R,y[C].layoutOffsetY=o*u4-B;const Q=_.createImageData(R,D);BL(U,Q),_.putImageData(Q,y[C].x,y[C].y)}}else for(const M of e)_.fillText(M,y[M].x,y[M].y+l+o*u4);return{xOffset:x,yOffset:S,mapping:y,data:p,width:p.width,height:p.height}}_getKey(){const{fontFamily:e,fontWeight:t,fontSize:i,buffer:s,sdf:o,radius:l,cutoff:c}=this.props;return o?`${e} ${t} ${i} ${s} ${l} ${c}`:`${e} ${t} ${i} ${s}`}}const d4=`uniform textBackgroundUniforms {
  bool billboard;
  float sizeScale;
  float sizeMinPixels;
  float sizeMaxPixels;
  vec4 borderRadius;
  vec4 padding;
  highp int sizeUnits;
  bool stroked;
} textBackground;
`,zL={name:"textBackground",vs:d4,fs:d4,uniformTypes:{billboard:"f32",sizeScale:"f32",sizeMinPixels:"f32",sizeMaxPixels:"f32",borderRadius:"vec4<f32>",padding:"vec4<f32>",sizeUnits:"i32",stroked:"f32"}},jL=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * textBackground.sizeScale, textBackground.sizeUnits),
textBackground.sizeMinPixels, textBackground.sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + textBackground.padding.xy + textBackground.padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-textBackground.padding.xy, textBackground.padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (textBackground.billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,VL=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
float round_rect(vec2 p, vec2 size, vec4 radii) {
vec2 pixelPositionCB = (p - 0.5) * size;
vec2 sizeCB = size * 0.5;
float maxBorderRadius = min(size.x, size.y) * 0.5;
vec4 borderRadius = vec4(min(radii, maxBorderRadius));
borderRadius.xy =
(pixelPositionCB.x > 0.0) ? borderRadius.xy : borderRadius.zw;
borderRadius.x = (pixelPositionCB.y > 0.0) ? borderRadius.x : borderRadius.y;
vec2 q = abs(pixelPositionCB) - sizeCB + borderRadius.x;
return -(min(max(q.x, q.y), 0.0) + length(max(q, 0.0)) - borderRadius.x);
}
float rect(vec2 p, vec2 size) {
vec2 pixelPosition = p * size;
return min(min(pixelPosition.x, size.x - pixelPosition.x),
min(pixelPosition.y, size.y - pixelPosition.y));
}
vec4 get_stroked_fragColor(float dist) {
float isBorder = smoothedge(dist, vLineWidth);
return mix(vFillColor, vLineColor, isBorder);
}
void main(void) {
geometry.uv = uv;
if (textBackground.borderRadius != vec4(0.0)) {
float distToEdge = round_rect(uv, dimensions, textBackground.borderRadius);
if (textBackground.stroked) {
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
float shapeAlpha = smoothedge(-distToEdge, 0.0);
fragColor.a *= shapeAlpha;
} else {
if (textBackground.stroked) {
float distToEdge = rect(uv, dimensions);
fragColor = get_stroked_fragColor(distToEdge);
} else {
fragColor = vFillColor;
}
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,HL={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,borderRadius:{type:"object",value:0},padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:n=>n.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class c2 extends wi{getShaders(){return super.getShaders({vs:jL,fs:VL,modules:[al,ll,zL]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:t}=e;t.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{billboard:t,sizeScale:i,sizeUnits:s,sizeMinPixels:o,sizeMaxPixels:l,getLineWidth:c}=this.props;let{padding:f,borderRadius:d}=this.props;f.length<4&&(f=[f[0],f[1],f[0],f[1]]),Array.isArray(d)||(d=[d,d,d,d]);const p=this.state.model,_={billboard:t,stroked:!!c,borderRadius:d,padding:f,sizeUnits:vi[s],sizeScale:i,sizeMinPixels:o,sizeMaxPixels:l};p.shaderInputs.setProps({textBackground:_}),p.draw(this.context.renderPass)}_getModel(){const e=[0,0,1,0,0,1,1,1];return new kn(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new co({topology:"triangle-strip",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(e)}}}),isInstanced:!0})}}c2.defaultProps=HL;c2.layerName="TextBackgroundLayer";const p4={start:1,middle:0,end:-1},g4={top:1,center:0,bottom:-1},cp=[0,0,0,255],$L=1,WL={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:cp},getBorderWidth:{type:"accessor",value:0},backgroundBorderRadius:{type:"object",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Jr.characterSet},fontFamily:Jr.fontFamily,fontWeight:Jr.fontWeight,lineHeight:$L,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:cp},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:n=>n.text},getPosition:{type:"accessor",value:n=>n.position},getColor:{type:"accessor",value:cp},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class u2 extends s2{constructor(){super(...arguments),this.getBoundingRect=(e,t)=>{let{size:[i,s]}=this.transformParagraph(e,t);const{fontSize:o}=this.state.fontAtlasManager.props;i/=o,s/=o;const{getTextAnchor:l,getAlignmentBaseline:c}=this.props,f=p4[typeof l=="function"?l(e,t):l],d=g4[typeof c=="function"?c(e,t):c];return[(f-1)*i/2,(d-1)*s/2,i,s]},this.getIconOffsets=(e,t)=>{const{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:o,y:l,rowWidth:c,size:[f,d]}=this.transformParagraph(e,t),p=p4[typeof i=="function"?i(e,t):i],_=g4[typeof s=="function"?s(e,t):s],y=o.length,v=new Array(y*2);let x=0;for(let S=0;S<y;S++){const M=(1-p)*(f-c[S])/2;v[x++]=(p-1)*f/2+M+o[S],v[x++]=(_-1)*d/2+l[S]}return v}}initializeState(){this.state={styleVersion:0,fontAtlasManager:new FL},this.props.maxWidth>0&&ke.once(1,"v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:t,oldProps:i,changeFlags:s}=e;(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||t.lineHeight!==i.lineHeight||t.wordBreak!==i.wordBreak||t.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:t,fontWeight:i}=this.props,{fontAtlasManager:s,characterSet:o}=this.state,l={...e,characterSet:o,fontFamily:t,fontWeight:i};if(!s.mapping)return s.setProps(l),!0;for(const c in l)if(l[c]!==s.props[c])return s.setProps(l),!0;return!1}_updateText(){const{data:e,characterSet:t}=this.props,i=e.attributes?.getText;let{getText:s}=this.props,o=e.startIndices,l;const c=t==="auto"&&new Set;if(i&&o){const{texts:f,characterCount:d}=kL({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:o,characterSet:c});l=d,s=(p,{index:_})=>f[_]}else{const{iterable:f,objectInfo:d}=Zu(e);o=[0],l=0;for(const p of f){d.index++;const _=Array.from(s(p,d)||"");c&&_.forEach(c.add,c),l+=_.length,o.push(l)}}this.setState({getText:s,startIndices:o,numInstances:l,characterSet:c||t})}transformParagraph(e,t){const{fontAtlasManager:i}=this.state,s=i.mapping,o=this.state.getText,{wordBreak:l,lineHeight:c,maxWidth:f}=this.props,d=o(e,t)||"";return NL(d,c,l,f*i.props.fontSize,s)}renderLayers(){const{startIndices:e,numInstances:t,getText:i,fontAtlasManager:{scale:s,atlas:o,mapping:l},styleVersion:c}=this.state,{data:f,_dataDiff:d,getPosition:p,getColor:_,getSize:y,getAngle:v,getPixelOffset:x,getBackgroundColor:S,getBorderColor:M,getBorderWidth:C,backgroundBorderRadius:U,backgroundPadding:R,background:D,billboard:B,fontSettings:Q,outlineWidth:ce,outlineColor:Z,sizeScale:ee,sizeUnits:he,sizeMinPixels:de,sizeMaxPixels:_e,transitions:ge,updateTriggers:ue}=this.props,Se=this.getSubLayerClass("characters",l2),w=this.getSubLayerClass("background",c2);return[D&&new w({getFillColor:S,getLineColor:M,getLineWidth:C,borderRadius:U,padding:R,getPosition:p,getSize:y,getAngle:v,getPixelOffset:x,billboard:B,sizeScale:ee,sizeUnits:he,sizeMinPixels:de,sizeMaxPixels:_e,transitions:ge&&{getPosition:ge.getPosition,getAngle:ge.getAngle,getSize:ge.getSize,getFillColor:ge.getBackgroundColor,getLineColor:ge.getBorderColor,getLineWidth:ge.getBorderWidth,getPixelOffset:ge.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:ue.getPosition,getAngle:ue.getAngle,getSize:ue.getSize,getFillColor:ue.getBackgroundColor,getLineColor:ue.getBorderColor,getLineWidth:ue.getBorderWidth,getPixelOffset:ue.getPixelOffset,getBoundingRect:{getText:ue.getText,getTextAnchor:ue.getTextAnchor,getAlignmentBaseline:ue.getAlignmentBaseline,styleVersion:c}}}),{data:f.attributes&&f.attributes.background?{length:f.length,attributes:f.attributes.background}:f,_dataDiff:d,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new Se({sdf:Q.sdf,smoothing:Number.isFinite(Q.smoothing)?Q.smoothing:Jr.smoothing,outlineWidth:ce/(Q.radius||Jr.radius),outlineColor:Z,iconAtlas:o,iconMapping:l,getPosition:p,getColor:_,getSize:y,getAngle:v,getPixelOffset:x,billboard:B,sizeScale:ee*s,sizeUnits:he,sizeMinPixels:de*s,sizeMaxPixels:_e*s,transitions:ge&&{getPosition:ge.getPosition,getAngle:ge.getAngle,getColor:ge.getColor,getSize:ge.getSize,getPixelOffset:ge.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:ue.getText,getPosition:ue.getPosition,getAngle:ue.getAngle,getColor:ue.getColor,getSize:ue.getSize,getPixelOffset:ue.getPixelOffset,getIconOffsets:{getTextAnchor:ue.getTextAnchor,getAlignmentBaseline:ue.getAlignmentBaseline,styleVersion:c}}}),{data:f,_dataDiff:d,startIndices:e,numInstances:t,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(e){UL(e)}}u2.defaultProps=WL;u2.layerName="TextLayer";const uu={circle:{type:r2,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:Qu,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:u2,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},fu={type:o2,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},tg={type:a2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function Ea({type:n,props:e}){const t={};for(const i in e)t[i]=n.defaultProps[e[i]];return t}function up(n,e){const{transitions:t,updateTriggers:i}=n.props,s={updateTriggers:{},transitions:t&&{getPosition:t.geometry}};for(const o in e){const l=e[o];let c=n.props[o];o.startsWith("get")&&(c=n.getSubLayerAccessor(c),s.updateTriggers[l]=i[o],t&&(s.transitions[l]=t[o])),s[l]=c}return s}function XL(n){if(Array.isArray(n))return n;switch(ke.assert(n.type,"GeoJSON does not have type"),n.type){case"Feature":return[n];case"FeatureCollection":return ke.assert(Array.isArray(n.features),"GeoJSON does not have features array"),n.features;default:return[{geometry:n}]}}function m4(n,e,t={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:s=0,endRow:o=n.length}=t;for(let l=s;l<o;l++){const c=n[l],{geometry:f}=c;if(f)if(f.type==="GeometryCollection"){ke.assert(Array.isArray(f.geometries),"GeoJSON does not have geometries array");const{geometries:d}=f;for(let p=0;p<d.length;p++){const _=d[p];_4(_,i,e,c,l)}}else _4(f,i,e,c,l)}return i}function _4(n,e,t,i,s){const{type:o,coordinates:l}=n,{pointFeatures:c,lineFeatures:f,polygonFeatures:d,polygonOutlineFeatures:p}=e;if(!qL(o,l)){ke.warn(`${o} coordinates are malformed`)();return}switch(o){case"Point":c.push(t({geometry:n},i,s));break;case"MultiPoint":l.forEach(_=>{c.push(t({geometry:{type:"Point",coordinates:_}},i,s))});break;case"LineString":f.push(t({geometry:n},i,s));break;case"MultiLineString":l.forEach(_=>{f.push(t({geometry:{type:"LineString",coordinates:_}},i,s))});break;case"Polygon":d.push(t({geometry:n},i,s)),l.forEach(_=>{p.push(t({geometry:{type:"LineString",coordinates:_}},i,s))});break;case"MultiPolygon":l.forEach(_=>{d.push(t({geometry:{type:"Polygon",coordinates:_}},i,s)),_.forEach(y=>{p.push(t({geometry:{type:"LineString",coordinates:y}},i,s))})});break}}const YL={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function qL(n,e){let t=YL[n];for(ke.assert(t,`Unknown GeoJSON type ${n}`);e&&--t>0;)e=e[0];return e&&Number.isFinite(e[0])}function Rv(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function Yc(n){return n.geometry.coordinates}function ZL(n,e){const t=Rv(),{pointFeatures:i,lineFeatures:s,polygonFeatures:o,polygonOutlineFeatures:l}=n;return t.points.data=i,t.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),t.points.getPosition=Yc,t.lines.data=s,t.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),t.lines.getPath=Yc,t.polygons.data=o,t.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),t.polygons.getPolygon=Yc,t.polygonsOutline.data=l,t.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),t.polygonsOutline.getPath=Yc,t}function KL(n,e){const t=Rv(),{points:i,lines:s,polygons:o}=n,l=xL(n,e);t.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:4,value:l.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},t.lines.data={length:s.pathIndices.value.length-1,startIndices:s.pathIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:4,value:l.lines}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},t.lines._pathType="open";const c=o.positions.value.length/o.positions.size,f=Array(c).fill(1);for(const d of o.primitivePolygonIndices.value)f[d-1]=0;return t.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,instanceVertexValid:{size:1,value:new Uint16Array(f)},pickingColors:{size:4,value:l.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},t.polygons._normalize=!1,o.triangles&&(t.polygons.data.attributes.indices=o.triangles.value),t.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:4,value:l.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},t.polygonsOutline._pathType="open",t}const GL=["points","linestrings","polygons"],QL={...Ea(uu.circle),...Ea(uu.icon),...Ea(uu.text),...Ea(fu),...Ea(tg),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:n=>n.properties.icon},getText:{type:"accessor",value:n=>n.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class f2 extends s2{initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:e,changeFlags:t}){if(!t.dataChanged)return;const{data:i}=this.props,s=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:s}),s?this._updateStateBinary({props:e,changeFlags:t}):this._updateStateJSON({props:e,changeFlags:t})}_updateStateBinary({props:e,changeFlags:t}){const i=KL(e.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:e,changeFlags:t}){const i=XL(e.data),s=this.getSubLayerRow.bind(this);let o={};const l={};if(Array.isArray(t.dataChanged)){const f=this.state.features;for(const d in f)o[d]=f[d].slice(),l[d]=[];for(const d of t.dataChanged){const p=m4(i,s,d);for(const _ in f)l[_].push(yL({data:o[_],getIndex:y=>y.__source.index,dataRange:d,replace:p[_]}))}}else o=m4(i,s);const c=ZL(o,l);this.setState({features:o,featuresDiff:l,layerProps:c})}getPickingInfo(e){const t=super.getPickingInfo(e),{index:i,sourceLayer:s}=t;return t.featureType=GL.find(o=>s.id.startsWith(`${this.id}-${o}-`)),i>=0&&s.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(t.index=this.props.data.points.globalFeatureIds.value[i]),t}_updateAutoHighlight(e){const t=`${this.id}-points-`,i=e.featureType==="points";for(const s of this.getSubLayers())s.id.startsWith(t)===i&&s.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:t}=this.props,{layerProps:i}=this.state,s="polygons-fill",o=this.shouldRenderSubLayer(s,i.polygons?.data)&&this.getSubLayerClass(s,tg.type);if(o){const l=up(this,tg.props),c=e&&t;return c||delete l.getLineColor,l.updateTriggers.lineColors=c,new o(l,this.getSubLayerProps({id:s,updateTriggers:l.updateTriggers}),i.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:t}=this.props,{layerProps:i}=this.state,s="polygons-stroke",o="linestrings",l=!e&&t&&this.shouldRenderSubLayer(s,i.polygonsOutline?.data)&&this.getSubLayerClass(s,fu.type),c=this.shouldRenderSubLayer(o,i.lines?.data)&&this.getSubLayerClass(o,fu.type);if(l||c){const f=up(this,fu.props);return[l&&new l(f,this.getSubLayerProps({id:s,updateTriggers:f.updateTriggers}),i.polygonsOutline),c&&new c(f,this.getSubLayerProps({id:o,updateTriggers:f.updateTriggers}),i.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:t,binary:i}=this.state;let{highlightedObjectIndex:s}=this.props;!i&&Number.isFinite(s)&&(s=t.points.data.findIndex(c=>c.__source.index===s));const o=new Set(e.split("+")),l=[];for(const c of o){const f=`points-${c}`,d=uu[c],p=d&&this.shouldRenderSubLayer(f,t.points?.data)&&this.getSubLayerClass(f,d.type);if(p){const _=up(this,d.props);let y=t.points;if(c==="text"&&i){const{instancePickingColors:v,...x}=y.data.attributes;y={...y,data:{...y.data,attributes:x}}}l.push(new p(_,this.getSubLayerProps({id:f,updateTriggers:_.updateTriggers,highlightedObjectIndex:s}),y))}}return l}renderLayers(){const{extruded:e}=this.props,t=this._renderPolygonLayer(),i=this._renderLineLayers(),s=this._renderPointLayers();return[!e&&t,i,s,e&&t]}getSubLayerAccessor(e){const{binary:t}=this.state;return!t||typeof e!="function"?super.getSubLayerAccessor(e):(i,s)=>{const{data:o,index:l}=s,c=bL(o,l);return e(c,s)}}}f2.layerName="GeoJsonLayer";f2.defaultProps=QL;const JL=()=>{const[n,e]=L.useState(!1);return L.useEffect(()=>{const t=()=>{const s=document.documentElement.classList.contains("dark");e(s)};t();const i=new MutationObserver(t);return i.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>i.disconnect()},[]),{isDarkMode:n}},eB=fp.memo(({options:n,value:e,onChange:t,disabled:i,placeholder:s="Type a country name..."})=>{const[o,l]=L.useState(""),[c,f]=L.useState([]),[d,p]=L.useState(!1),[_,y]=L.useState(-1),v=L.useRef(null),x=L.useRef(null);L.useEffect(()=>{console.log("CountrySearchInput received options:",n.map(R=>R.name.common))},[n]);const S=L.useMemo(()=>n.find(R=>R.cca3===e),[n,e]);L.useEffect(()=>{S?l(S.name.common):e===""&&l("")},[S,e]),L.useEffect(()=>{if(o.length<4){f([]);return}const R=o.toLowerCase();console.log("Searching for:",o);const D=n.filter(B=>{const ce=B.name.common.toLowerCase().includes(R);return ce&&console.log(" Match:",B.name.common),ce}).slice(0,10);console.log("Suggestions:",D.map(B=>B.name.common)),f(D),y(-1)},[o,n]),L.useEffect(()=>{const R=D=>{x.current&&!x.current.contains(D.target)&&v.current&&!v.current.contains(D.target)&&p(!1)};return document.addEventListener("mousedown",R),()=>document.removeEventListener("mousedown",R)},[]);const M=R=>{const D=R.target.value;l(D),p(!0),(!S||D!==S.name.common)&&t("")},C=R=>{l(R.name.common),t(R.cca3),p(!1)},U=R=>{!d||c.length===0||(R.key==="ArrowDown"?(R.preventDefault(),y(D=>D<c.length-1?D+1:D)):R.key==="ArrowUp"?(R.preventDefault(),y(D=>D>0?D-1:-1)):R.key==="Enter"&&_>=0?(R.preventDefault(),C(c[_])):R.key==="Escape"&&p(!1))};return P.jsxs("div",{className:"relative w-full",children:[P.jsx("input",{ref:v,type:"text",value:o,onChange:M,onFocus:()=>o.length>=4&&p(!0),onKeyDown:U,disabled:i,placeholder:s,className:`
            w-full p-3 text-foreground bg-background 
            border-2 border-input rounded-md 
            focus:outline-none focus:ring-2 focus:ring-primary 
            disabled:opacity-50 disabled:cursor-not-allowed
            ${i?"bg-muted":""}
            `,autoComplete:"off"}),d&&c.length>0&&P.jsx("div",{ref:x,className:"absolute z-50 w-full mt-1 bg-popover border border-border rounded-md shadow-lg max-h-60 overflow-y-auto bg-background",children:c.map((R,D)=>P.jsx("button",{className:`
                    w-full text-left px-4 py-2 hover:bg-accent hover:text-accent-foreground
                    transition-colors duration-150
                    ${D===_?"bg-accent text-accent-foreground":""}
                    ${R.cca3===e?"bg-primary/10":""}
                `,onClick:()=>C(R),onMouseEnter:()=>y(D),type:"button",children:P.jsxs("div",{className:"flex items-center gap-2",children:[R.flags?.png&&P.jsx("img",{src:R.flags.png,alt:`${R.name.common} flag`,className:"w-6 h-4 object-cover rounded-sm"}),P.jsx("span",{children:R.name.common})]})},R.cca3))}),o.length>0&&o.length<4&&P.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Type at least 4 characters to see suggestions"})]})}),Ca=n=>n[Math.floor(Math.random()*n.length)],tB=n=>n?n<1e3?8:n<1e4?7:n<5e4?6:n<2e5?5:n<5e5?4:n<1e6?3.5:n<5e6?3:2.5:4,qc={longitude:0,latitude:20,zoom:1.5,pitch:0,bearing:0},y4=n=>n.toLocaleString("en-US"),nB=({country:n})=>{const e=n.languages?Object.values(n.languages).join(", "):"N/A",t=n.currencies?Object.entries(n.currencies).map(([s,o])=>`${o.name} (${o.symbol||s})`).join(", "):"N/A",i=n.area&&n.population?(n.population/n.area).toFixed(2):null;return P.jsxs("div",{className:"w-full lg:w-80 p-4 overflow-y-auto bg-card lg:border-l-2 border-t-2 lg:border-t-0 border-border max-h-[500px] lg:max-h-none",children:[P.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Facts about"}),P.jsx("h2",{className:"text-2xl font-bold mb-4 text-foreground",children:n.name.common}),n.flags?.png&&P.jsx("div",{className:"mb-4",children:P.jsx("img",{src:n.flags.png,alt:`Flag of ${n.name.common}`,className:"w-full max-w-[250px] border border-border rounded-md shadow-sm"})}),P.jsxs("div",{className:"text-sm leading-relaxed space-y-2",children:[P.jsx(Kt,{label:"Official Name",value:n.name.official}),P.jsx(Kt,{label:"Capital",value:n.capital?.join(", ")||"N/A"}),P.jsx(Kt,{label:"Region",value:n.subregion||n.region}),P.jsx(Kt,{label:"Population",value:n.population?y4(n.population):"N/A",highlight:!0}),P.jsx(Kt,{label:"Area",value:n.area?`${y4(n.area)} km`:"N/A"}),i&&P.jsx(Kt,{label:"Population Density",value:`${i} people/km`}),P.jsx(Kt,{label:"Languages",value:e}),P.jsx(Kt,{label:"Currencies",value:t}),n.timezones&&n.timezones.length>0&&P.jsx(Kt,{label:"Timezones",value:n.timezones.length===1?n.timezones[0]:`${n.timezones.length} zones`}),n.car&&P.jsx(Kt,{label:"Drives on",value:`${n.car.side==="right"?"Right":"Left"} side`}),n.landlocked!==void 0&&P.jsx(Kt,{label:"Landlocked",value:n.landlocked?"Yes":"No"}),n.borders&&n.borders.length>0&&P.jsx(Kt,{label:"Bordering Countries",value:`${n.borders.length} countries`}),n.independent!==void 0&&P.jsx(Kt,{label:"Independent",value:n.independent?"Yes":"No"}),n.continents&&n.continents.length>0&&P.jsx(Kt,{label:"Continent(s)",value:n.continents.join(", ")})]}),n.coatOfArms?.png&&P.jsxs("div",{className:"mt-4 text-center",children:[P.jsx("p",{className:"text-xs font-bold mb-2 text-muted-foreground",children:"Coat of Arms"}),P.jsx("img",{src:n.coatOfArms.png,alt:`Coat of arms of ${n.name.common}`,className:"w-full max-w-[150px] border border-border rounded-md bg-card p-2 mx-auto"})]}),n.maps?.googleMaps&&P.jsx("div",{className:"mt-4",children:P.jsx("a",{href:n.maps.googleMaps,target:"_blank",rel:"noopener noreferrer",className:"cosmic-button inline-block",children:"View on Google Maps"})})]})},Kt=({label:n,value:e,highlight:t})=>P.jsxs("div",{className:`
    mb-3 p-2 rounded-md
    ${t?"bg-warning/20":""}
  `,children:[P.jsx("div",{className:"font-bold text-xs text-muted-foreground mb-1",children:n}),P.jsx("div",{className:"text-sm text-foreground",children:e})]}),iB=({countries:n})=>{const{isDarkMode:e}=JL(),t=e?"https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json":"https://basemaps.cartocdn.com/gl/positron-gl-style/style.json",[i,s]=L.useState(null),[o,l]=L.useState(qc),[c,f]=L.useState(null),[d,p]=L.useState(!1),[_,y]=L.useState(!1),[v,x]=L.useState(0),[S,M]=L.useState(!1),C=L.useMemo(()=>{const Z=new Set;return n.forEach(ee=>{ee.continents&&ee.continents.length>0&&ee.continents.forEach(he=>Z.add(he))}),Array.from(Z)},[n]),U=L.useMemo(()=>{const Z=new Set;return n.forEach(ee=>{ee.languages&&Object.values(ee.languages).forEach(he=>Z.add(he))}),Array.from(Z)},[n]),R=async Z=>{p(!0);try{console.log("Fetching border for:",Z);const ee=[{url:"https://raw.githubusercontent.com/datasets/geo-countries/master/data/countries.geojson",codeField:"ISO_A3"},{url:"https://raw.githubusercontent.com/johan/world.geo.json/master/countries.geo.json",codeField:"id"}];for(const he of ee)try{const _e=await(await fetch(he.url)).json();console.log("Loaded GeoJSON, searching for country...");let ge=_e.features.find(ue=>{const Se=ue.properties;return Se[he.codeField]===Z||Se.ISO_A3===Z||Se.iso_a3===Z||Se.ADM0_A3===Z||Se.id===Z});if(ge){console.log("Found country border!",ge.properties),f({type:"FeatureCollection",features:[ge]}),p(!1);return}else console.log(`Country ${Z} not found in this source`)}catch(de){console.error(`Failed to load from ${he.url}:`,de)}try{console.log("Trying Natural Earth Data...");const _e=(await(await fetch("https://d2ad6b4ur7yvpq.cloudfront.net/naturalearth-3.3.0/ne_110m_admin_0_countries.geojson")).json()).features.find(ge=>{const ue=ge.properties;return ue.ADM0_A3===Z||ue.ISO_A3===Z||ue.iso_a3===Z});if(_e){console.log("Found in Natural Earth!",_e.properties),f({type:"FeatureCollection",features:[_e]}),p(!1);return}}catch(he){console.error("Natural Earth failed:",he)}console.warn(`Country border not found for ${Z} in any source`),f(null)}catch(ee){console.error("Error fetching country border:",ee),f(null)}finally{p(!1)}},D=()=>{s(null),l(qc),f(null),x(0),M(!1)},B=()=>{if(S){D();return}l(qc),f(null);let ee=Ca(["LETTER","CONTINENT","LANGUAGE"]),he,de=[];if(ee==="LETTER"){const ge=new Set(n.map(w=>w.name.common[0].toUpperCase())),ue=Array.from(ge),Se=Ca(ue);de=n.filter(w=>w.name.common.toUpperCase().startsWith(Se)),he={type:ee,letter:Se,description:`Think of a country that starts with the letter ${Se}.`}}else if(ee==="CONTINENT"){const ge=Ca(C);console.log(`Selected continent: ${ge}`),console.log("Sample countries in this continent:",n.filter(ue=>ue.continents&&ue.continents.includes(ge)).slice(0,5).map(ue=>({name:ue.name.common,continents:ue.continents}))),de=n.filter(ue=>!ue.continents||ue.continents.length===0?!1:ue.continents.some(Se=>Se.toLowerCase()===ge.toLowerCase()||Se.includes(ge)||ge.includes(Se))),console.log(`Found ${de.length} countries in ${ge}`),he={type:ee,continent:ge,description:`Think of a country in ${ge}.`}}else{const ge=Ca(U);de=n.filter(ue=>ue.languages&&Object.values(ue.languages).includes(ge)),he={type:ee,language:ge,description:`Think of a country where people speak ${ge}.`}}if(de.length<3){B();return}s({prompt:he,options:de,secretCountry:null,userChoiceCca3:"",result:"idle"})},Q=()=>{if(!i||!i.userChoiceCca3)return;const{options:Z}=i,ee=Ca(Z),he=ee.cca3===i.userChoiceCca3;if(console.log("Selected country:",ee),R(ee.cca3),ee.latlng&&ee.latlng.length===2){const de=tB(ee.area);l({longitude:ee.latlng[1],latitude:ee.latlng[0],zoom:de,pitch:0,bearing:0})}he?M(!0):x(de=>de+1),s({...i,secretCountry:ee,result:he?"eliminated":"survived"})},ce=L.useMemo(()=>c?(console.log("Creating GeoJSON layer with data:",c),[new f2({id:"country-border",data:c,filled:!0,stroked:!0,getFillColor:[255,200,0,150],getLineColor:[255,100,0,255],getLineWidth:5,lineWidthMinPixels:3,pickable:!0,opacity:.8})]):(console.log("No country border to display"),[]),[c]);return P.jsxs("div",{className:"flex flex-col lg:flex-row gap-0 min-h-screen lg:h-[600px] relative",children:[P.jsx("button",{onClick:()=>y(!0),className:"lg:absolute lg:top-4 lg:right-4 lg:z-50 self-end m-4 lg:m-0 w-8 h-8 rounded-full bg-primary/20 hover:bg-primary/30 text-foreground border border-border flex items-center justify-center transition-colors",title:"Data sources",children:P.jsx("span",{className:"text-sm font-bold",children:""})}),_&&P.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4",onClick:()=>y(!1),children:P.jsxs("div",{className:"bg-background border-2 border-border rounded-lg p-4 lg:p-6 max-w-md w-full mx-4 shadow-xl max-h-[90vh] overflow-y-auto",onClick:Z=>Z.stopPropagation(),children:[P.jsxs("div",{className:"flex justify-between items-start mb-4",children:[P.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Data Sources"}),P.jsx("button",{onClick:()=>y(!1),className:"text-muted-foreground hover:text-foreground text-2xl leading-none",children:""})]}),P.jsxs("div",{className:"space-y-4 text-foreground",children:[P.jsxs("div",{children:[P.jsx("h3",{className:"font-semibold mb-1",children:"Country Data"}),P.jsxs("p",{className:"text-sm text-muted-foreground",children:["Country information including names, continents, languages, and capitals from"," ",P.jsx("a",{href:"https://restcountries.com",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"REST Countries API"})]})]}),P.jsxs("div",{children:[P.jsx("h3",{className:"font-semibold mb-1",children:"Geographic Borders"}),P.jsxs("p",{className:"text-sm text-muted-foreground",children:["Country border data from"," ",P.jsx("a",{href:"https://www.naturalearthdata.com/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Natural Earth Data"})," ","and"," ",P.jsx("a",{href:"https://github.com/datasets/geo-countries",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"geo-countries"})]})]}),P.jsxs("div",{children:[P.jsx("h3",{className:"font-semibold mb-1",children:"Map Tiles"}),P.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base map provided by"," ",P.jsx("a",{href:"https://www.openstreetmap.org/",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"OpenStreetMap"})," ","contributors"]})]})]})]})}),P.jsxs("div",{className:"w-full lg:w-[350px] p-4 flex flex-col gap-4 lg:border-r-2 border-b-2 lg:border-b-0 border-border",children:[P.jsxs("div",{className:"p-4 rounded-lg text-center border-2 border-primary",children:[P.jsx("div",{className:"text-primary text-sm font-bold",children:"Rounds Survived"}),P.jsx("div",{className:"text-primary text-4xl font-bold",children:v})]}),!i&&!S&&P.jsx("button",{onClick:B,className:"cosmic-button w-full",children:"Start Game"}),S&&P.jsxs("div",{className:"p-6 bg-destructive/10 rounded-lg border-3 border-destructive text-center",children:[P.jsx("h2",{className:"text-3xl font-bold mb-4 text-destructive",children:"GAME OVER!"}),P.jsxs("p",{className:"mb-4 text-foreground text-lg",children:["You survived ",P.jsx("strong",{children:v})," ",v===1?"round":"rounds","!"]}),P.jsx("button",{onClick:D,className:"cosmic-button w-full",children:"Play Again"})]}),i&&!S&&P.jsxs(P.Fragment,{children:[P.jsx("div",{className:"p-4 bg-muted rounded-lg text-foreground font-bold",children:i.prompt.description}),P.jsxs("div",{children:[P.jsx("label",{className:"block mb-2 font-bold text-foreground",children:"Begin typing and select your answer:"}),P.jsx(eB,{options:i.options,value:i.userChoiceCca3??"",onChange:Z=>{s(ee=>ee&&{...ee,userChoiceCca3:Z})},disabled:i.result!=="idle",placeholder:"Start typing a country name..."},i.prompt.description)]}),P.jsxs("div",{className:"flex gap-2",children:[P.jsx("button",{onClick:Q,disabled:!i.userChoiceCca3||i.result!=="idle",className:`
                        flex-1 p-3 font-bold rounded-md transition-all
                        ${i.userChoiceCca3&&i.result==="idle"?"cosmic-button":"bg-muted text-muted-foreground cursor-not-allowed opacity-50"}
                        `,children:"Lock In"}),P.jsx("button",{onClick:B,disabled:i.result==="idle",className:`
                        px-3 py-1 font-bold border rounded-md transition-colors
                        ${i.result==="idle"?"bg-muted text-muted-foreground cursor-not-allowed opacity-50":"cosmic-button"}
                        `,children:"Next Round"})]}),d&&P.jsx("div",{className:"p-2 text-muted-foreground text-sm",children:"Loading country border..."}),i.result!=="idle"&&i.secretCountry&&!S&&P.jsxs("div",{className:`
                p-4 rounded-lg border-2
                ${i.result==="eliminated"?"bg-destructive/10 border-destructive":"bg-success/10 border-success"}
              `,children:[P.jsxs("p",{className:"mb-2 text-foreground font-bold",children:["The answer was: ",i.secretCountry.name.common]}),i.result==="eliminated"?P.jsx("p",{className:"text-destructive font-bold text-lg",children:" You are ELIMINATED!"}):P.jsx("p",{className:"text-success font-bold text-lg",children:" You SURVIVED this round!"})]})]})]}),P.jsx("div",{className:"flex-1 relative overflow-hidden min-h-[500px] lg:h-auto",children:P.jsx(yD,{initialViewState:qc,viewState:o,onViewStateChange:Z=>l(Z.viewState),controller:!0,layers:ce,getTooltip:({object:Z})=>Z&&Z.properties&&Z.properties.ADMIN,children:P.jsx(CS,{mapLib:du(()=>import("./maplibre-gl-BiRpjiGI.js").then(Z=>Z.m),[]),mapStyle:t})})}),i?.result!=="idle"&&i?.secretCountry&&P.jsx(nB,{country:i.secretCountry})]})};function sB(){const[n,e]=L.useState([]),[t,i]=L.useState(!0),[s,o]=L.useState(null);return L.useEffect(()=>{fetch("https://restcountries.com/v3.1/independent?status=true").then(l=>{if(!l.ok)throw new Error("Failed to fetch countries");return l.json()}).then(l=>{e(l),i(!1)}).catch(l=>{o(l.message),i(!1)})},[]),P.jsx(Q4,{children:P.jsxs("div",{className:"container mx-auto my-12 px-4 py-8 bg-background text-foreground overflow-x-hidden",children:[P.jsx("h1",{className:"text-3xl font-bold mb-4 text-primary",children:"Elimination Game"}),P.jsxs("p",{className:"mb-6 text-muted-foreground",children:["Think of a ",P.jsx("span",{className:"text-primary font-bold",children:"country"})," based on the prompt.",P.jsx("br",{})," If your answer matches the randomly selected country, you're eliminated!"]}),t&&P.jsx("p",{children:"Loading countries..."}),s&&P.jsxs("p",{className:"text-red-500",children:["Error: ",s]}),!t&&!s&&P.jsx(iB,{countries:n})]})})}function rB(){return P.jsx(P.Fragment,{children:P.jsx(_T,{children:P.jsxs(qx,{children:[P.jsx(Zc,{index:!0,element:P.jsx(eS,{})}),P.jsx(Zc,{path:"/game",element:P.jsx(sB,{})}),"   ",P.jsx(Zc,{path:"*",element:P.jsx(tS,{})})]})})})}ix.createRoot(document.getElementById("root")).render(P.jsx(L.StrictMode,{children:P.jsx(rB,{})}));export{b4 as g};
